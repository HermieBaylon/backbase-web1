import { Component, Directive, ViewChild, Output, EventEmitter } from '@angular/core';
import { combineLatest } from 'rxjs';
import { pluck, map, tap } from 'rxjs/operators';
import { BbTemplate } from '@backbase/foundation-ang/core';
import * as i0 from "@angular/core";
import * as i1 from "../consent-request.service";
import * as i2 from "@angular/router";
import * as i3 from "../consent-request-preferences.service";
import * as i4 from "@backbase/ui-ang/alert";
import * as i5 from "../consent-request-tpp-information/consent-request-tpp-information.component";
import * as i6 from "../consent-request-account-selector/consent-request-account-selector.component";
import * as i7 from "../consent-request-permissions-information/consent-request-permissions-information.component";
import * as i8 from "@backbase/ui-ang/loading-indicator";
import * as i9 from "../consent-request-error/consent-request-error.component";
import * as i10 from "@angular/common";
import * as i11 from "@backbase/ui-ang/button";
import * as i12 from "@backbase/ui-ang/date-pipe";
export class ConsentRequestContainerComponent {
    constructor(service, route, consentRequestPreferencesService) {
        this.service = service;
        this.route = route;
        this.consentRequestPreferencesService = consentRequestPreferencesService;
        /**
         * Component context
         */
        this.hostRef = this;
        /**
         * Stream for Multi-account selection usage flag.
         * If true used a multi-selection account selector, else a single selection account selector.
         * Retrieving value from CXP manager.
         */
        this.multiAccountSelection$ = this.consentRequestPreferencesService.multiAccountSelection$;
        /**
         * Emitter that fires when allowing consent
         */
        this.redirectToAllowUrl = new EventEmitter();
        /**
         * Emitter that fires when rejecting consent
         */
        this.redirectToRejectUrl = new EventEmitter();
        /**
         * Notification error template reference
         */
        this.notificationErrorTemplate = '';
        /**
         * Stream of Consent Request ID
         */
        this.consentRequestId = this.getRouteParam(this.route, 'consentRequestId').pipe(map(consentRequestId => consentRequestId || ''));
        /**
         * Stream of loading spinner visibility flag
         */
        this.loading = this.service.loading;
        /**
         * Stream of Consent request errors
         */
        this.error = this.service.error;
        /**
         * Stream of saving state flag
         */
        this.saving = this.service.saving;
        /**
         * Stream of saving consent request error
         */
        this.savingError = this.service.savingError;
        /**
         * Stream of get consentRequest
         */
        this.consentRequest = this.service.consentRequest;
        /**
         * Flag for show account error
         */
        this.showAccountError = false;
    }
    /**
     * Function for allow consent request
     */
    allowConsentRequest() {
        if (this.selectedAccount) {
            this.showAccountError = false;
            this.service
                .allowConsentRequest(this.selectedAccount, this.notificationErrorTemplate)
                .pipe(tap((redirect) => {
                if (redirect.redirectUrl) {
                    this.redirectToAllowUrl.emit(redirect.redirectUrl);
                }
            }))
                .subscribe();
        }
        else {
            this.showAccountError = true;
        }
    }
    /**
     * Function for reject consent request
     */
    rejectConsentRequest() {
        this.service
            .rejectConsentRequest(this.notificationErrorTemplate)
            .pipe(tap((response) => {
            if (response.redirectUrl) {
                this.redirectToRejectUrl.emit(response.redirectUrl);
            }
        }))
            .subscribe();
    }
    ngOnInit() {
        this.service.getConsentRequestFrom(this.consentRequestId);
    }
    getRouteParam(route, param) {
        const paramValue = combineLatest(route.paramMap.pipe(pluck('params', param)), route.queryParamMap.pipe(pluck('params', param)), (params, qparams) => {
            return params ? params : qparams;
        });
        if (!route.parent) {
            return paramValue;
        }
        // ensure that level that has actual value keeps it from being cleared
        return combineLatest([paramValue, this.getRouteParam(route.parent, param)]).pipe(map(params => params[0] || params[1]));
    }
}
ConsentRequestContainerComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: ConsentRequestContainerComponent, deps: [{ token: i1.ConsentRequestService }, { token: i2.ActivatedRoute }, { token: i3.ConsentRequestPreferencesService }], target: i0.ɵɵFactoryTarget.Component });
ConsentRequestContainerComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.15", type: ConsentRequestContainerComponent, selector: "bb-consent-request-container", outputs: { redirectToAllowUrl: "redirectToAllowUrl", redirectToRejectUrl: "redirectToRejectUrl" }, viewQueries: [{ propertyName: "notificationErrorTemplate", first: true, predicate: ["notificationError"], descendants: true }], ngImport: i0, template: "<ng-container\n  bbConsentRequestWidgetCustomizable\n  [bbHostRef]=\"hostRef\"\n  [bbTemplateContext]=\"{\n    consentRequest: consentRequest | async,\n    multiAccountSelection: multiAccountSelection$ | async\n  }\">\n</ng-container>\n\n<ng-template\n  bbConsentRequestWidgetCustomizable\n  let-hostRef\n  let-consentRequest=\"context.consentRequest\"\n  let-multiAccountSelection=\"context.multiAccountSelection\">\n  <ng-container *ngIf=\"hostRef.consentRequestId | async; else errorTemplate\">\n    <ng-container *ngIf=\"!(hostRef.loading | async) as loading; else loadingTemplate\">\n      <ng-container *ngIf=\"!(hostRef.error | async); else errorTemplate\">\n        <div class=\"bb-consent-request\" *ngIf=\"consentRequest\">\n          <div\n            class=\"bb-heading-2 bb-block--lg\"\n            data-role=\"request-access-label\"\n            i18n=\"Widget header|Third party request access message@@consent-request.label.header\">\n            Third party requested access to your accounts\n          </div>\n\n          <ng-container *ngIf=\"!(hostRef.saving | async); else savingLoadingTemplate\">\n            <bb-alert-ui\n              *ngIf=\"hostRef.savingError | async\"\n              title=\"Unknown error\"\n              i18n-title=\"Unknown Error|Unknown Error Label@@consent-request.label.error.unknown\"\n              message=\"Try to make action again or contact your system administrator.\"\n              i18n-message=\"Try again|Try again error message@@consent-request.label.error.tryAgain\"\n              data-role=\"allow-consent-request-error\"></bb-alert-ui>\n\n            <div class=\"bb-block--lg\">\n              <bb-consent-request-tpp-information [tpp]=\"consentRequest.tpp\"></bb-consent-request-tpp-information>\n            </div>\n\n            <div class=\"bb-block--lg\">\n              <bb-consent-request-account-selector\n                [multiAccountSelection]=\"multiAccountSelection\"\n                [showError]=\"hostRef.showAccountError\"\n                [accounts]=\"consentRequest.accounts\"\n                [(selectedAccount)]=\"hostRef.selectedAccount\"></bb-consent-request-account-selector>\n            </div>\n\n            <div class=\"bb-block--lg\">\n              <bb-consent-request-permissions-information\n                [permissions]=\"consentRequest.permissions\"></bb-consent-request-permissions-information>\n            </div>\n\n            <div class=\"bb-block--lg\">\n              <div\n                class=\"bb-block--sm bb-text-bold\"\n                data-role=\"expiration-date-label\"\n                i18n=\"Expiration date|Consent expiration date@@consent-request.label.expiryDate\">\n                Expiration date\n              </div>\n\n              <div>{{ consentRequest.expiryDate | bbDate: 'bbShort' }}</div>\n            </div>\n          </ng-container>\n\n          <div class=\"bb-button-bar bb-button-bar--reverse\">\n            <button\n              bbButton\n              [disabled]=\"hostRef.saving | async\"\n              (click)=\"hostRef.allowConsentRequest()\"\n              i18n=\"Allow button|Allow consent request@@consent-request.label.allow\"\n              color=\"primary\"\n              class=\"bb-button-bar__button\"\n              data-role=\"allow-button\">\n              Allow\n            </button>\n            <button\n              bbButton\n              [disabled]=\"hostRef.saving | async\"\n              (click)=\"hostRef.rejectConsentRequest()\"\n              i18n=\"Reject button|Reject consent request@@consent-request.label.reject\"\n              color=\"secondary\"\n              class=\"bb-button-bar__button\"\n              data-role=\"reject-button\">\n              Reject\n            </button>\n          </div>\n\n          <ng-template #savingLoadingTemplate>\n            <div class=\"bb-state-container\">\n              <bb-loading-indicator-ui\n                text=\"Processing the request...\"\n                i18n-text=\"\n                  Processing|Processing the allow/reject request@@consent-request.label.processing\"></bb-loading-indicator-ui>\n            </div>\n          </ng-template>\n        </div>\n      </ng-container>\n    </ng-container>\n\n    <ng-template #loadingTemplate>\n      <div class=\"bb-state-container\">\n        <bb-loading-indicator-ui></bb-loading-indicator-ui>\n      </div>\n    </ng-template>\n  </ng-container>\n\n  <ng-template #errorTemplate>\n    <div class=\"bb-state-container\">\n      <bb-consent-request-error\n        [consentRequestId]=\"hostRef.consentRequestId | async\"\n        [errorKind]=\"$any(hostRef.error | async)?.kind\"></bb-consent-request-error>\n    </div>\n  </ng-template>\n\n  <ng-template #notificationError>\n    <span\n      i18n=\"\n        Operation Failed|Error notification when failing to save request\n        consent@@consent-request.label.notification.error\">\n      Operation failed\n    </span>\n  </ng-template>\n</ng-template>\n", components: [{ type: i0.forwardRef(function () { return i4.AlertComponent; }), selector: "bb-alert-ui", inputs: ["modifier", "dismissible", "title", "message"], outputs: ["close"] }, { type: i0.forwardRef(function () { return i5.ConsentRequestTppInformationComponent; }), selector: "bb-consent-request-tpp-information", inputs: ["tpp"] }, { type: i0.forwardRef(function () { return i6.ConsentRequestAccountSelectorComponent; }), selector: "bb-consent-request-account-selector", inputs: ["showError", "multiAccountSelection", "accounts", "selectedAccount"], outputs: ["selectedAccountChange"] }, { type: i0.forwardRef(function () { return i7.ConsentRequestPermissionsInformationComponent; }), selector: "bb-consent-request-permissions-information", inputs: ["permissions"] }, { type: i0.forwardRef(function () { return i8.LoadingIndicatorComponent; }), selector: "bb-loading-indicator-ui", inputs: ["text", "loaderSize", "showDelay", "hasBackground", "inline"] }, { type: i0.forwardRef(function () { return i9.ConsentRequestErrorComponent; }), selector: "bb-consent-request-error", inputs: ["consentRequestId", "errorKind"] }], directives: [{ type: i0.forwardRef(function () { return ConsentRequestWidgetCustomizableDirective; }), selector: "[bbConsentRequestWidgetCustomizable]" }, { type: i0.forwardRef(function () { return i10.NgIf; }), selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i0.forwardRef(function () { return i11.ButtonDirective; }), selector: "button[bbButton]", inputs: ["type", "color", "buttonSize", "block", "circle"] }], pipes: { "async": i0.forwardRef(function () { return i10.AsyncPipe; }), "bbDate": i0.forwardRef(function () { return i12.BbDatePipe; }) } });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: ConsentRequestContainerComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'bb-consent-request-container',
                    templateUrl: './consent-request-container.component.html',
                }]
        }], ctorParameters: function () { return [{ type: i1.ConsentRequestService }, { type: i2.ActivatedRoute }, { type: i3.ConsentRequestPreferencesService }]; }, propDecorators: { redirectToAllowUrl: [{
                type: Output
            }], redirectToRejectUrl: [{
                type: Output
            }], notificationErrorTemplate: [{
                type: ViewChild,
                args: ['notificationError']
            }] } });
export class ConsentRequestWidgetCustomizableDirective extends BbTemplate {
}
ConsentRequestWidgetCustomizableDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: ConsentRequestWidgetCustomizableDirective, deps: null, target: i0.ɵɵFactoryTarget.Directive });
ConsentRequestWidgetCustomizableDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "12.0.0", version: "12.2.15", type: ConsentRequestWidgetCustomizableDirective, selector: "[bbConsentRequestWidgetCustomizable]", usesInheritance: true, ngImport: i0 });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: ConsentRequestWidgetCustomizableDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[bbConsentRequestWidgetCustomizable]',
                }]
        }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uc2VudC1yZXF1ZXN0LWNvbnRhaW5lci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL2NvbnNlbnQtcmVxdWVzdC13aWRnZXQtYW5nL3NyYy9jb25zZW50LXJlcXVlc3Qtd2lkZ2V0L2NvbnNlbnQtcmVxdWVzdC1jb250YWluZXIvY29uc2VudC1yZXF1ZXN0LWNvbnRhaW5lci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL2NvbnNlbnQtcmVxdWVzdC13aWRnZXQtYW5nL3NyYy9jb25zZW50LXJlcXVlc3Qtd2lkZ2V0L2NvbnNlbnQtcmVxdWVzdC1jb250YWluZXIvY29uc2VudC1yZXF1ZXN0LWNvbnRhaW5lci5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQWUsTUFBTSxFQUFFLFlBQVksRUFBVSxNQUFNLGVBQWUsQ0FBQztBQUUzRyxPQUFPLEVBQWMsYUFBYSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ2pELE9BQU8sRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ2pELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7QUFVM0QsTUFBTSxPQUFPLGdDQUFnQztJQW9HM0MsWUFDbUIsT0FBOEIsRUFDOUIsS0FBcUIsRUFDOUIsZ0NBQWtFO1FBRnpELFlBQU8sR0FBUCxPQUFPLENBQXVCO1FBQzlCLFVBQUssR0FBTCxLQUFLLENBQWdCO1FBQzlCLHFDQUFnQyxHQUFoQyxnQ0FBZ0MsQ0FBa0M7UUF0RzVFOztXQUVHO1FBQ00sWUFBTyxHQUFxQyxJQUFJLENBQUM7UUFDMUQ7Ozs7V0FJRztRQUNNLDJCQUFzQixHQUF3QixJQUFJLENBQUMsZ0NBQWdDLENBQUMsc0JBQXNC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RTtZQUNqQixPQUFPLFVBQVUsQ0FBQztTQUNuQjtRQUVELHNFQUFzRTtRQUN0RSxPQUFPLGFBQWEsQ0FBQyxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FDOUUsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUN0QyxDQUFDO0lBQ0osQ0FBQzs7OEhBMUhVLGdDQUFnQztrSEFBaEMsZ0NBQWdDLHVTQ2Q3QyxrNEpBMEhBLGlxQ0RvQmEseUNBQXlDOzRGQWhJekMsZ0NBQWdDO2tCQUo1QyxTQUFTO21CQUFDO29CQUNULFFBQVEsRUFBRSw4QkFBOEI7b0JBQ3hDLFdBQVcsRUFBRSw0Q0FBNEM7aUJBQzFEO3dMQWVXLGtCQUFrQjtzQkFBM0IsTUFBTTtnQkFJRyxtQkFBbUI7c0JBQTVCLE1BQU07Z0JBS1AseUJBQXlCO3NCQUR4QixTQUFTO3VCQUFDLG1CQUFtQjs7QUEwR2hDLE1BQU0sT0FBTyx5Q0FBMEMsU0FBUSxVQUc5RDs7dUlBSFkseUNBQXlDOzJIQUF6Qyx5Q0FBeUM7NEZBQXpDLHlDQUF5QztrQkFIckQsU0FBUzttQkFBQztvQkFDVCxRQUFRLEVBQUUsc0NBQXNDO2lCQUNqRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgRGlyZWN0aXZlLCBWaWV3Q2hpbGQsIFRlbXBsYXRlUmVmLCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBBY3RpdmF0ZWRSb3V0ZSwgUGFyYW1NYXAgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgY29tYmluZUxhdGVzdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgcGx1Y2ssIG1hcCwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgQmJUZW1wbGF0ZSB9IGZyb20gJ0BiYWNrYmFzZS9mb3VuZGF0aW9uLWFuZy9jb3JlJztcblxuaW1wb3J0IHsgQ29uc2VudFJlcXVlc3RTZXJ2aWNlLCBDb25zZW50UmVxdWVzdCwgQWNjb3VudCwgUmVkaXJlY3RVcmwgfSBmcm9tICcuLi9jb25zZW50LXJlcXVlc3Quc2VydmljZSc7XG5pbXBvcnQgeyBDb25zZW50UmVxdWVzdEVycm9yIH0gZnJvbSAnLi4vY29uc2VudC1yZXF1ZXN0LWVycm9yJztcbmltcG9ydCB7IENvbnNlbnRSZXF1ZXN0UHJlZmVyZW5jZXNTZXJ2aWNlIH0gZnJvbSAnLi4vY29uc2VudC1yZXF1ZXN0LXByZWZlcmVuY2VzLnNlcnZpY2UnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdiYi1jb25zZW50LXJlcXVlc3QtY29udGFpbmVyJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2NvbnNlbnQtcmVxdWVzdC1jb250YWluZXIuY29tcG9uZW50Lmh0bWwnLFxufSlcbmV4cG9ydCBjbGFzcyBDb25zZW50UmVxdWVzdENvbnRhaW5lckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIC8qKlxuICAgKiBDb21wb25lbnQgY29udGV4dFxuICAgKi9cbiAgcmVhZG9ubHkgaG9zdFJlZjogQ29uc2VudFJlcXVlc3RDb250YWluZXJDb21wb25lbnQgPSB0aGlzO1xuICAvKipcbiAgICogU3RyZWFtIGZvciBNdWx0aS1hY2NvdW50IHNlbGVjdGlvbiB1c2FnZSBmbGFnLlxuICAgKiBJZiB0cnVlIHVzZWQgYSBtdWx0aS1zZWxlY3Rpb24gYWNjb3VudCBzZWxlY3RvciwgZWxzZSBhIHNpbmdsZSBzZWxlY3Rpb24gYWNjb3VudCBzZWxlY3Rvci5cbiAgICogUmV0cmlldmluZyB2YWx1ZSBmcm9tIENYUCBtYW5hZ2VyLlxuICAgKi9cbiAgcmVhZG9ubHkgbXVsdGlBY2NvdW50U2VsZWN0aW9uJDogT2JzZXJ2YWJsZTxib29sZWFuPiA9IHRoaXMuY29uc2VudFJlcXVlc3RQcmVmZXJlbmNlc1NlcnZpY2UubXVsdGlBY2NvdW50U2VsZWN0aW9uJDtcbiAgLyoqXG4gICAqIEVtaXR0ZXIgdGhhdCBmaXJlcyB3aGVuIGFsbG93aW5nIGNvbnNlbnRcbiAgICovXG4gIEBPdXRwdXQoKSByZWRpcmVjdFRvQWxsb3dVcmw6IEV2ZW50RW1pdHRlcjxzdHJpbmc+ID0gbmV3IEV2ZW50RW1pdHRlcjxzdHJpbmc+KCk7XG4gIC8qKlxuICAgKiBFbWl0dGVyIHRoYXQgZmlyZXMgd2hlbiByZWplY3RpbmcgY29uc2VudFxuICAgKi9cbiAgQE91dHB1dCgpIHJlZGlyZWN0VG9SZWplY3RVcmw6IEV2ZW50RW1pdHRlcjxzdHJpbmc+ID0gbmV3IEV2ZW50RW1pdHRlcjxzdHJpbmc+KCk7XG4gIC8qKlxuICAgKiBOb3RpZmljYXRpb24gZXJyb3IgdGVtcGxhdGUgcmVmZXJlbmNlXG4gICAqL1xuICBAVmlld0NoaWxkKCdub3RpZmljYXRpb25FcnJvcicpXG4gIG5vdGlmaWNhdGlvbkVycm9yVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT4gfCBzdHJpbmcgPSAnJztcbiAgLyoqXG4gICAqIFN0cmVhbSBvZiBDb25zZW50IFJlcXVlc3QgSURcbiAgICovXG4gIHJlYWRvbmx5IGNvbnNlbnRSZXF1ZXN0SWQ6IE9ic2VydmFibGU8c3RyaW5nPiA9IHRoaXMuZ2V0Um91dGVQYXJhbSh0aGlzLnJvdXRlLCAnY29uc2VudFJlcXVlc3RJZCcpLnBpcGUoXG4gICAgbWFwKGNvbnNlbnRSZXF1ZXN0SWQgPT4gY29uc2VudFJlcXVlc3RJZCB8fCAnJyksXG4gICk7XG4gIC8qKlxuICAgKiBTdHJlYW0gb2YgbG9hZGluZyBzcGlubmVyIHZpc2liaWxpdHkgZmxhZ1xuICAgKi9cbiAgcmVhZG9ubHkgbG9hZGluZzogT2JzZXJ2YWJsZTxib29sZWFuPiA9IHRoaXMuc2VydmljZS5sb2FkaW5nO1xuICAvKipcbiAgICogU3RyZWFtIG9mIENvbnNlbnQgcmVxdWVzdCBlcnJvcnNcbiAgICovXG4gIHJlYWRvbmx5IGVycm9yOiBPYnNlcnZhYmxlPENvbnNlbnRSZXF1ZXN0RXJyb3IgfCB1bmRlZmluZWQ+ID0gdGhpcy5zZXJ2aWNlLmVycm9yO1xuICAvKipcbiAgICogU3RyZWFtIG9mIHNhdmluZyBzdGF0ZSBmbGFnXG4gICAqL1xuICByZWFkb25seSBzYXZpbmc6IE9ic2VydmFibGU8Ym9vbGVhbj4gPSB0aGlzLnNlcnZpY2Uuc2F2aW5nO1xuICAvKipcbiAgICogU3RyZWFtIG9mIHNhdmluZyBjb25zZW50IHJlcXVlc3QgZXJyb3JcbiAgICovXG4gIHJlYWRvbmx5IHNhdmluZ0Vycm9yOiBPYnNlcnZhYmxlPENvbnNlbnRSZXF1ZXN0RXJyb3IgfCB1bmRlZmluZWQ+ID0gdGhpcy5zZXJ2aWNlLnNhdmluZ0Vycm9yO1xuICAvKipcbiAgICogU3RyZWFtIG9mIGdldCBjb25zZW50UmVxdWVzdFxuICAgKi9cbiAgcmVhZG9ubHkgY29uc2VudFJlcXVlc3Q6IE9ic2VydmFibGU8Q29uc2VudFJlcXVlc3QgfCB1bmRlZmluZWQ+ID0gdGhpcy5zZXJ2aWNlLmNvbnNlbnRSZXF1ZXN0O1xuICAvKipcbiAgICogTGlzdCBvZiBzZWxlY3RlZCBhY2NvdW50cyBmcm9tIGFjY291bnQgc2VsZWN0b3JcbiAgICovXG4gIHNlbGVjdGVkQWNjb3VudDogQXJyYXk8QWNjb3VudD4gfCB1bmRlZmluZWQ7XG4gIC8qKlxuICAgKiBGbGFnIGZvciBzaG93IGFjY291bnQgZXJyb3JcbiAgICovXG4gIHNob3dBY2NvdW50RXJyb3IgPSBmYWxzZTtcblxuICAvKipcbiAgICogRnVuY3Rpb24gZm9yIGFsbG93IGNvbnNlbnQgcmVxdWVzdFxuICAgKi9cbiAgYWxsb3dDb25zZW50UmVxdWVzdCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5zZWxlY3RlZEFjY291bnQpIHtcbiAgICAgIHRoaXMuc2hvd0FjY291bnRFcnJvciA9IGZhbHNlO1xuICAgICAgdGhpcy5zZXJ2aWNlXG4gICAgICAgIC5hbGxvd0NvbnNlbnRSZXF1ZXN0KHRoaXMuc2VsZWN0ZWRBY2NvdW50LCB0aGlzLm5vdGlmaWNhdGlvbkVycm9yVGVtcGxhdGUpXG4gICAgICAgIC5waXBlKFxuICAgICAgICAgIHRhcCgocmVkaXJlY3Q6IFJlZGlyZWN0VXJsKSA9PiB7XG4gICAgICAgICAgICBpZiAocmVkaXJlY3QucmVkaXJlY3RVcmwpIHtcbiAgICAgICAgICAgICAgdGhpcy5yZWRpcmVjdFRvQWxsb3dVcmwuZW1pdChyZWRpcmVjdC5yZWRpcmVjdFVybCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSksXG4gICAgICAgIClcbiAgICAgICAgLnN1YnNjcmliZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNob3dBY2NvdW50RXJyb3IgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBGdW5jdGlvbiBmb3IgcmVqZWN0IGNvbnNlbnQgcmVxdWVzdFxuICAgKi9cbiAgcmVqZWN0Q29uc2VudFJlcXVlc3QoKTogdm9pZCB7XG4gICAgdGhpcy5zZXJ2aWNlXG4gICAgICAucmVqZWN0Q29uc2VudFJlcXVlc3QodGhpcy5ub3RpZmljYXRpb25FcnJvclRlbXBsYXRlKVxuICAgICAgLnBpcGUoXG4gICAgICAgIHRhcCgocmVzcG9uc2U6IFJlZGlyZWN0VXJsKSA9PiB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnJlZGlyZWN0VXJsKSB7XG4gICAgICAgICAgICB0aGlzLnJlZGlyZWN0VG9SZWplY3RVcmwuZW1pdChyZXNwb25zZS5yZWRpcmVjdFVybCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KSxcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUoKTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMuc2VydmljZS5nZXRDb25zZW50UmVxdWVzdEZyb20odGhpcy5jb25zZW50UmVxdWVzdElkKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVhZG9ubHkgc2VydmljZTogQ29uc2VudFJlcXVlc3RTZXJ2aWNlLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgcm91dGU6IEFjdGl2YXRlZFJvdXRlLFxuICAgIHByaXZhdGUgY29uc2VudFJlcXVlc3RQcmVmZXJlbmNlc1NlcnZpY2U6IENvbnNlbnRSZXF1ZXN0UHJlZmVyZW5jZXNTZXJ2aWNlLFxuICApIHt9XG5cbiAgcHJpdmF0ZSBnZXRSb3V0ZVBhcmFtKHJvdXRlOiBBY3RpdmF0ZWRSb3V0ZSwgcGFyYW06IHN0cmluZyk6IE9ic2VydmFibGU8c3RyaW5nIHwgbnVsbD4ge1xuICAgIGNvbnN0IHBhcmFtVmFsdWUgPSBjb21iaW5lTGF0ZXN0KFxuICAgICAgcm91dGUucGFyYW1NYXAucGlwZShwbHVjazxQYXJhbU1hcCwgc3RyaW5nIHwgbnVsbD4oJ3BhcmFtcycsIHBhcmFtKSksXG4gICAgICByb3V0ZS5xdWVyeVBhcmFtTWFwLnBpcGUocGx1Y2s8UGFyYW1NYXAsIHN0cmluZyB8IG51bGw+KCdwYXJhbXMnLCBwYXJhbSkpLFxuICAgICAgKHBhcmFtcywgcXBhcmFtcykgPT4ge1xuICAgICAgICByZXR1cm4gcGFyYW1zID8gcGFyYW1zIDogcXBhcmFtcztcbiAgICAgIH0sXG4gICAgKTtcbiAgICBpZiAoIXJvdXRlLnBhcmVudCkge1xuICAgICAgcmV0dXJuIHBhcmFtVmFsdWU7XG4gICAgfVxuXG4gICAgLy8gZW5zdXJlIHRoYXQgbGV2ZWwgdGhhdCBoYXMgYWN0dWFsIHZhbHVlIGtlZXBzIGl0IGZyb20gYmVpbmcgY2xlYXJlZFxuICAgIHJldHVybiBjb21iaW5lTGF0ZXN0KFtwYXJhbVZhbHVlLCB0aGlzLmdldFJvdXRlUGFyYW0ocm91dGUucGFyZW50LCBwYXJhbSldKS5waXBlKFxuICAgICAgbWFwKHBhcmFtcyA9PiBwYXJhbXNbMF0gfHwgcGFyYW1zWzFdKSxcbiAgICApO1xuICB9XG59XG5cbkBEaXJlY3RpdmUoe1xuICBzZWxlY3RvcjogJ1tiYkNvbnNlbnRSZXF1ZXN0V2lkZ2V0Q3VzdG9taXphYmxlXScsXG59KVxuZXhwb3J0IGNsYXNzIENvbnNlbnRSZXF1ZXN0V2lkZ2V0Q3VzdG9taXphYmxlRGlyZWN0aXZlIGV4dGVuZHMgQmJUZW1wbGF0ZTxcbiAgQ29uc2VudFJlcXVlc3RDb250YWluZXJDb21wb25lbnQsXG4gIHsgY29uc2VudFJlcXVlc3Q6IENvbnNlbnRSZXF1ZXN0IHwgdW5kZWZpbmVkIHwgbnVsbDsgbXVsdGlBY2NvdW50U2VsZWN0aW9uOiBib29sZWFuIHwgbnVsbCB9XG4+IHt9XG4iLCI8bmctY29udGFpbmVyXG4gIGJiQ29uc2VudFJlcXVlc3RXaWRnZXRDdXN0b21pemFibGVcbiAgW2JiSG9zdFJlZl09XCJob3N0UmVmXCJcbiAgW2JiVGVtcGxhdGVDb250ZXh0XT1cIntcbiAgICBjb25zZW50UmVxdWVzdDogY29uc2VudFJlcXVlc3QgfCBhc3luYyxcbiAgICBtdWx0aUFjY291bnRTZWxlY3Rpb246IG11bHRpQWNjb3VudFNlbGVjdGlvbiQgfCBhc3luY1xuICB9XCI+XG48L25nLWNvbnRhaW5lcj5cblxuPG5nLXRlbXBsYXRlXG4gIGJiQ29uc2VudFJlcXVlc3RXaWRnZXRDdXN0b21pemFibGVcbiAgbGV0LWhvc3RSZWZcbiAgbGV0LWNvbnNlbnRSZXF1ZXN0PVwiY29udGV4dC5jb25zZW50UmVxdWVzdFwiXG4gIGxldC1tdWx0aUFjY291bnRTZWxlY3Rpb249XCJjb250ZXh0Lm11bHRpQWNjb3VudFNlbGVjdGlvblwiPlxuICA8bmctY29udGFpbmVyICpuZ0lmPVwiaG9zdFJlZi5jb25zZW50UmVxdWVzdElkIHwgYXN5bmM7IGVsc2UgZXJyb3JUZW1wbGF0ZVwiPlxuICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCIhKGhvc3RSZWYubG9hZGluZyB8IGFzeW5jKSBhcyBsb2FkaW5nOyBlbHNlIGxvYWRpbmdUZW1wbGF0ZVwiPlxuICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIiEoaG9zdFJlZi5lcnJvciB8IGFzeW5jKTsgZWxzZSBlcnJvclRlbXBsYXRlXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJiYi1jb25zZW50LXJlcXVlc3RcIiAqbmdJZj1cImNvbnNlbnRSZXF1ZXN0XCI+XG4gICAgICAgICAgPGRpdlxuICAgICAgICAgICAgY2xhc3M9XCJiYi1oZWFkaW5nLTIgYmItYmxvY2stLWxnXCJcbiAgICAgICAgICAgIGRhdGEtcm9sZT1cInJlcXVlc3QtYWNjZXNzLWxhYmVsXCJcbiAgICAgICAgICAgIGkxOG49XCJXaWRnZXQgaGVhZGVyfFRoaXJkIHBhcnR5IHJlcXVlc3QgYWNjZXNzIG1lc3NhZ2VAQGNvbnNlbnQtcmVxdWVzdC5sYWJlbC5oZWFkZXJcIj5cbiAgICAgICAgICAgIFRoaXJkIHBhcnR5IHJlcXVlc3RlZCBhY2Nlc3MgdG8geW91ciBhY2NvdW50c1xuICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIiEoaG9zdFJlZi5zYXZpbmcgfCBhc3luYyk7IGVsc2Ugc2F2aW5nTG9hZGluZ1RlbXBsYXRlXCI+XG4gICAgICAgICAgICA8YmItYWxlcnQtdWlcbiAgICAgICAgICAgICAgKm5nSWY9XCJob3N0UmVmLnNhdmluZ0Vycm9yIHwgYXN5bmNcIlxuICAgICAgICAgICAgICB0aXRsZT1cIlVua25vd24gZXJyb3JcIlxuICAgICAgICAgICAgICBpMThuLXRpdGxlPVwiVW5rbm93biBFcnJvcnxVbmtub3duIEVycm9yIExhYmVsQEBjb25zZW50LXJlcXVlc3QubGFiZWwuZXJyb3IudW5rbm93blwiXG4gICAgICAgICAgICAgIG1lc3NhZ2U9XCJUcnkgdG8gbWFrZSBhY3Rpb24gYWdhaW4gb3IgY29udGFjdCB5b3VyIHN5c3RlbSBhZG1pbmlzdHJhdG9yLlwiXG4gICAgICAgICAgICAgIGkxOG4tbWVzc2FnZT1cIlRyeSBhZ2FpbnxUcnkgYWdhaW4gZXJyb3IgbWVzc2FnZUBAY29uc2VudC1yZXF1ZXN0LmxhYmVsLmVycm9yLnRyeUFnYWluXCJcbiAgICAgICAgICAgICAgZGF0YS1yb2xlPVwiYWxsb3ctY29uc2VudC1yZXF1ZXN0LWVycm9yXCI+PC9iYi1hbGVydC11aT5cblxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJiLWJsb2NrLS1sZ1wiPlxuICAgICAgICAgICAgICA8YmItY29uc2VudC1yZXF1ZXN0LXRwcC1pbmZvcm1hdGlvbiBbdHBwXT1cImNvbnNlbnRSZXF1ZXN0LnRwcFwiPjwvYmItY29uc2VudC1yZXF1ZXN0LXRwcC1pbmZvcm1hdGlvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYmItYmxvY2stLWxnXCI+XG4gICAgICAgICAgICAgIDxiYi1jb25zZW50LXJlcXVlc3QtYWNjb3VudC1zZWxlY3RvclxuICAgICAgICAgICAgICAgIFttdWx0aUFjY291bnRTZWxlY3Rpb25dPVwibXVsdGlBY2NvdW50U2VsZWN0aW9uXCJcbiAgICAgICAgICAgICAgICBbc2hvd0Vycm9yXT1cImhvc3RSZWYuc2hvd0FjY291bnRFcnJvclwiXG4gICAgICAgICAgICAgICAgW2FjY291bnRzXT1cImNvbnNlbnRSZXF1ZXN0LmFjY291bnRzXCJcbiAgICAgICAgICAgICAgICBbKHNlbGVjdGVkQWNjb3VudCldPVwiaG9zdFJlZi5zZWxlY3RlZEFjY291bnRcIj48L2JiLWNvbnNlbnQtcmVxdWVzdC1hY2NvdW50LXNlbGVjdG9yPlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJiYi1ibG9jay0tbGdcIj5cbiAgICAgICAgICAgICAgPGJiLWNvbnNlbnQtcmVxdWVzdC1wZXJtaXNzaW9ucy1pbmZvcm1hdGlvblxuICAgICAgICAgICAgICAgIFtwZXJtaXNzaW9uc109XCJjb25zZW50UmVxdWVzdC5wZXJtaXNzaW9uc1wiPjwvYmItY29uc2VudC1yZXF1ZXN0LXBlcm1pc3Npb25zLWluZm9ybWF0aW9uPlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJiYi1ibG9jay0tbGdcIj5cbiAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgIGNsYXNzPVwiYmItYmxvY2stLXNtIGJiLXRleHQtYm9sZFwiXG4gICAgICAgICAgICAgICAgZGF0YS1yb2xlPVwiZXhwaXJhdGlvbi1kYXRlLWxhYmVsXCJcbiAgICAgICAgICAgICAgICBpMThuPVwiRXhwaXJhdGlvbiBkYXRlfENvbnNlbnQgZXhwaXJhdGlvbiBkYXRlQEBjb25zZW50LXJlcXVlc3QubGFiZWwuZXhwaXJ5RGF0ZVwiPlxuICAgICAgICAgICAgICAgIEV4cGlyYXRpb24gZGF0ZVxuICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICA8ZGl2Pnt7IGNvbnNlbnRSZXF1ZXN0LmV4cGlyeURhdGUgfCBiYkRhdGU6ICdiYlNob3J0JyB9fTwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiYmItYnV0dG9uLWJhciBiYi1idXR0b24tYmFyLS1yZXZlcnNlXCI+XG4gICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgIGJiQnV0dG9uXG4gICAgICAgICAgICAgIFtkaXNhYmxlZF09XCJob3N0UmVmLnNhdmluZyB8IGFzeW5jXCJcbiAgICAgICAgICAgICAgKGNsaWNrKT1cImhvc3RSZWYuYWxsb3dDb25zZW50UmVxdWVzdCgpXCJcbiAgICAgICAgICAgICAgaTE4bj1cIkFsbG93IGJ1dHRvbnxBbGxvdyBjb25zZW50IHJlcXVlc3RAQGNvbnNlbnQtcmVxdWVzdC5sYWJlbC5hbGxvd1wiXG4gICAgICAgICAgICAgIGNvbG9yPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgIGNsYXNzPVwiYmItYnV0dG9uLWJhcl9fYnV0dG9uXCJcbiAgICAgICAgICAgICAgZGF0YS1yb2xlPVwiYWxsb3ctYnV0dG9uXCI+XG4gICAgICAgICAgICAgIEFsbG93XG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgYmJCdXR0b25cbiAgICAgICAgICAgICAgW2Rpc2FibGVkXT1cImhvc3RSZWYuc2F2aW5nIHwgYXN5bmNcIlxuICAgICAgICAgICAgICAoY2xpY2spPVwiaG9zdFJlZi5yZWplY3RDb25zZW50UmVxdWVzdCgpXCJcbiAgICAgICAgICAgICAgaTE4bj1cIlJlamVjdCBidXR0b258UmVqZWN0IGNvbnNlbnQgcmVxdWVzdEBAY29uc2VudC1yZXF1ZXN0LmxhYmVsLnJlamVjdFwiXG4gICAgICAgICAgICAgIGNvbG9yPVwic2Vjb25kYXJ5XCJcbiAgICAgICAgICAgICAgY2xhc3M9XCJiYi1idXR0b24tYmFyX19idXR0b25cIlxuICAgICAgICAgICAgICBkYXRhLXJvbGU9XCJyZWplY3QtYnV0dG9uXCI+XG4gICAgICAgICAgICAgIFJlamVjdFxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICA8bmctdGVtcGxhdGUgI3NhdmluZ0xvYWRpbmdUZW1wbGF0ZT5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJiYi1zdGF0ZS1jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgPGJiLWxvYWRpbmctaW5kaWNhdG9yLXVpXG4gICAgICAgICAgICAgICAgdGV4dD1cIlByb2Nlc3NpbmcgdGhlIHJlcXVlc3QuLi5cIlxuICAgICAgICAgICAgICAgIGkxOG4tdGV4dD1cIlxuICAgICAgICAgICAgICAgICAgUHJvY2Vzc2luZ3xQcm9jZXNzaW5nIHRoZSBhbGxvdy9yZWplY3QgcmVxdWVzdEBAY29uc2VudC1yZXF1ZXN0LmxhYmVsLnByb2Nlc3NpbmdcIj48L2JiLWxvYWRpbmctaW5kaWNhdG9yLXVpPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICA8L25nLWNvbnRhaW5lcj5cblxuICAgIDxuZy10ZW1wbGF0ZSAjbG9hZGluZ1RlbXBsYXRlPlxuICAgICAgPGRpdiBjbGFzcz1cImJiLXN0YXRlLWNvbnRhaW5lclwiPlxuICAgICAgICA8YmItbG9hZGluZy1pbmRpY2F0b3ItdWk+PC9iYi1sb2FkaW5nLWluZGljYXRvci11aT5cbiAgICAgIDwvZGl2PlxuICAgIDwvbmctdGVtcGxhdGU+XG4gIDwvbmctY29udGFpbmVyPlxuXG4gIDxuZy10ZW1wbGF0ZSAjZXJyb3JUZW1wbGF0ZT5cbiAgICA8ZGl2IGNsYXNzPVwiYmItc3RhdGUtY29udGFpbmVyXCI+XG4gICAgICA8YmItY29uc2VudC1yZXF1ZXN0LWVycm9yXG4gICAgICAgIFtjb25zZW50UmVxdWVzdElkXT1cImhvc3RSZWYuY29uc2VudFJlcXVlc3RJZCB8IGFzeW5jXCJcbiAgICAgICAgW2Vycm9yS2luZF09XCIkYW55KGhvc3RSZWYuZXJyb3IgfCBhc3luYyk/LmtpbmRcIj48L2JiLWNvbnNlbnQtcmVxdWVzdC1lcnJvcj5cbiAgICA8L2Rpdj5cbiAgPC9uZy10ZW1wbGF0ZT5cblxuICA8bmctdGVtcGxhdGUgI25vdGlmaWNhdGlvbkVycm9yPlxuICAgIDxzcGFuXG4gICAgICBpMThuPVwiXG4gICAgICAgIE9wZXJhdGlvbiBGYWlsZWR8RXJyb3Igbm90aWZpY2F0aW9uIHdoZW4gZmFpbGluZyB0byBzYXZlIHJlcXVlc3RcbiAgICAgICAgY29uc2VudEBAY29uc2VudC1yZXF1ZXN0LmxhYmVsLm5vdGlmaWNhdGlvbi5lcnJvclwiPlxuICAgICAgT3BlcmF0aW9uIGZhaWxlZFxuICAgIDwvc3Bhbj5cbiAgPC9uZy10ZW1wbGF0ZT5cbjwvbmctdGVtcGxhdGU+XG4iXX0=