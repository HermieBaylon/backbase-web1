import { ChangeDetectionStrategy, Component, Input } from '@angular/core';
import BigNumber from 'bignumber.js';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
/**
 * Displays a credit limit status bar
 *
 * @usageNotes
 *
 * ```html
 * <bb-credit-limit-status-bar-ui
 *   [reserved]="100"
 *   [owed]="1000"
 *   [leftToSpend]="400"
 * ></bb-credit-limit-status-bar-ui>
 * ```
 *
 * @ngModule CreditLimitModule
 */
export class CreditLimitStatusBarComponent {
    constructor() {
        /**
         * Defines whether to display credit limit status bar in "Emptied" of "Filled" view mode. Default "Emptied"
         */
        this.viewMode = 'emptied';
    }
    /**
     * Aria labels for "reserved", "overdue", "owed" and "leftToSpend" values.
     */
    get valueAriaLabels() {
        return {
            reservedValue: $localize `:Reserved value a11y@@product-summary.credit-limit-status-bar.a11y.reserved:Reserved ${this.formatNumberForReading(this.reservedPercent)}%`,
            overdueValue: $localize `:Overdue value a11y@@product-summary.credit-limit-status-bar.a11y.overdue:Overdue ${this.formatNumberForReading(this.overduePercent)}%`,
            owedValue: $localize `:Owed value a11y@@product-summary.credit-limit-status-bar.a11y.owed:Owed ${this.formatNumberForReading(this.owedPercent)}%`,
            leftToSpendValue: $localize `:Left to spend value a11y@@product-summary.credit-limit-status-bar.a11y.leftToSpend:Left to spend ${this.formatNumberForReading(this.leftToSpendPercent)}%`,
        };
    }
    /**
     * Displayed width of "Reserved" amount.
     */
    get reservedWidth() {
        return this.reservedPercent > 0 ? `${this.reservedPercent}%` : '0';
    }
    /**
     * Displayed width of "Overdue" amount.
     */
    get overdueWidth() {
        const reservedWidth = new BigNumber(this.overduePercent).plus(this.reservedPercent).toNumber();
        return this.overduePercent > 0 ? `${reservedWidth}%` : '0';
    }
    /**
     * Displayed width of "Owed" amount.
     */
    get owedWidth() {
        const owedValue = this.toValidValue(this.owed);
        const filledValue = new BigNumber(this.owedPercent).plus(this.overduePercent).plus(this.reservedPercent).toNumber();
        const filledWidth = owedValue !== 0 ? `${filledValue}%` : '0';
        const emptiedWidth = owedValue !== 0 ? '100%' : '0';
        return this.viewMode === 'emptied' ? emptiedWidth : filledWidth;
    }
    /**
     * Displayed width of "Left to spend" amount.
     */
    get leftToSpendWidth() {
        const leftToSpendValue = this.toValidValue(this.leftToSpend);
        const emptiedValue = new BigNumber(this.leftToSpendPercent)
            .plus(this.overduePercent)
            .plus(this.reservedPercent)
            .toNumber();
        const emptiedWidth = leftToSpendValue !== 0 ? `${emptiedValue}%` : '0';
        const filledWidth = leftToSpendValue !== 0 ? '100%' : '0';
        return this.viewMode === 'emptied' ? emptiedWidth : filledWidth;
    }
    /**
     * Minimum size of "Overdue" amount.
     */
    get overdueMinSize() {
        const reservedValue = this.toValidValue(this.reserved);
        return reservedValue > 0 ? 'md' : 'sm';
    }
    /**
     * Minimum size of primary amount.
     */
    get primaryMinSize() {
        const reservedValue = this.toValidValue(this.reserved);
        const overdueValue = this.toValidValue(this.overdue);
        return reservedValue > 0 && overdueValue > 0 ? 'lg' : reservedValue > 0 || overdueValue > 0 ? 'md' : 'sm';
    }
    get reservedPercent() {
        return this.getPercentageOfLimit(this.reserved);
    }
    get overduePercent() {
        return this.getPercentageOfLimit(this.overdue);
    }
    get owedPercent() {
        return this.getPercentageOfLimit(this.owed);
    }
    get leftToSpendPercent() {
        return this.getPercentageOfLimit(this.leftToSpend);
    }
    formatNumberForReading(value, decimalPlaces = 2) {
        const number = new BigNumber(value);
        return number.decimalPlaces() > 0 ? number.toFormat(decimalPlaces) : value.toString();
    }
    getPercentageOfLimit(value) {
        const validValue = this.toValidValue(value);
        return validValue !== 0 ? new BigNumber(validValue).dividedBy(this.limit).multipliedBy(100).toNumber() : 0;
    }
    get limit() {
        const reservedValue = this.toValidValue(this.reserved);
        const overdueValue = this.toValidValue(this.overdue);
        const owedValue = this.toValidValue(this.owed);
        const leftToSpendValue = this.toValidValue(this.leftToSpend);
        return new BigNumber(reservedValue).plus(overdueValue).plus(owedValue).plus(leftToSpendValue).toNumber();
    }
    toValidValue(value) {
        return value !== undefined && !Number.isNaN(value) ? Math.abs(value) : 0;
    }
}
CreditLimitStatusBarComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: CreditLimitStatusBarComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
CreditLimitStatusBarComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.16", type: CreditLimitStatusBarComponent, selector: "bb-credit-limit-status-bar-ui", inputs: { viewMode: "viewMode", reserved: "reserved", overdue: "overdue", owed: "owed", leftToSpend: "leftToSpend" }, ngImport: i0, template: "<div class=\"bb-credit-limit-status-bar\">\n  <span\n    class=\"sr-only\"\n    data-role=\"title\"\n    aria-label=\"Credit limit status bar\"\n    i18n-aria-label=\"Credit limit status bar@@product-summary.credit-limit-status-bar.a11y.title\"\n  ></span>\n\n  <ng-container *ngTemplateOutlet=\"viewMode === 'emptied' ? owedValue : leftToSpendValue; context: { color: 'secondary' }\"></ng-container>\n  <ng-container *ngTemplateOutlet=\"viewMode === 'emptied' ? leftToSpendValue : owedValue; context: { color: 'primary' }\"></ng-container>\n\n  <ng-template #owedValue let-color=\"color\">\n    <div\n      *ngIf=\"owed\"\n      [style.width]=\"owedWidth\"\n      class=\"bb-credit-limit-status-bar__value bb-credit-limit-status-bar__value--{{primaryMinSize}} bb-credit-limit__color--{{color}}\"\n      data-role=\"owed-value\"\n      [attr.aria-label]=\"valueAriaLabels.owedValue\"\n    ></div>\n  </ng-template>\n  <ng-template #leftToSpendValue let-color=\"color\">\n    <div\n      *ngIf=\"leftToSpend\"\n      [style.width]=\"leftToSpendWidth\"\n      class=\"bb-credit-limit-status-bar__value bb-credit-limit-status-bar__value--{{primaryMinSize}} bb-credit-limit__color--{{color}}\"\n      data-role=\"left-to-spend-value\"\n      [attr.aria-label]=\"valueAriaLabels.leftToSpendValue\"\n    ></div>\n  </ng-template>\n  <div\n    *ngIf=\"overdue\"\n    [style.width]=\"overdueWidth\"\n    class=\"bb-credit-limit-status-bar__value bb-credit-limit-status-bar__value--{{overdueMinSize}} bb-credit-limit__color--danger\"\n    data-role=\"overdue-value\"\n    [attr.aria-label]=\"valueAriaLabels.overdueValue\"\n  ></div>\n  <div\n    *ngIf=\"reserved\"\n    [style.width]=\"reservedWidth\"\n    class=\"bb-credit-limit-status-bar__value bb-credit-limit-status-bar__value--sm bb-credit-limit__color--warning\"\n    data-role=\"reserved-value\"\n    [attr.aria-label]=\"valueAriaLabels.reservedValue\"\n  ></div>\n</div>\n", directives: [{ type: i1.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet"] }, { type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: CreditLimitStatusBarComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'bb-credit-limit-status-bar-ui',
                    templateUrl: './credit-limit-status-bar.component.html',
                    changeDetection: ChangeDetectionStrategy.OnPush,
                }]
        }], propDecorators: { viewMode: [{
                type: Input
            }], reserved: [{
                type: Input
            }], overdue: [{
                type: Input
            }], owed: [{
                type: Input
            }], leftToSpend: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlZGl0LWxpbWl0LXN0YXR1cy1iYXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vbGlicy9wcm9kdWN0LXN1bW1hcnktdWkvc3JjL2JiLWNyZWRpdC1saW1pdC11aS9jcmVkaXQtbGltaXQtc3RhdHVzLWJhci9jcmVkaXQtbGltaXQtc3RhdHVzLWJhci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL3Byb2R1Y3Qtc3VtbWFyeS11aS9zcmMvYmItY3JlZGl0LWxpbWl0LXVpL2NyZWRpdC1saW1pdC1zdGF0dXMtYmFyL2NyZWRpdC1saW1pdC1zdGF0dXMtYmFyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzFFLE9BQU8sU0FBUyxNQUFNLGNBQWMsQ0FBQzs7O0FBR3JDOzs7Ozs7Ozs7Ozs7OztHQWNHO0FBTUgsTUFBTSxPQUFPLDZCQUE2QjtJQUwxQztRQU1FOztXQUVHO1FBQ00sYUFBUSxHQUF3QixTQUFTLENBQUM7S0FvSXBEO0lBbEhDOztPQUVHO0lBQ0gsSUFBSSxlQUFlO1FBQ2pCLE9BQU87WUFDTCxhQUFhLEVBQUUsU0FBUyxDQUFBLHdGQUF3RixJQUFJLENBQUMsc0JBQXNCLENBQ3pJLElBQUksQ0FBQyxlQUFlLENBQ3JCLEdBQUc7WUFDSixZQUFZLEVBQUUsU0FBUyxDQUFBLHFGQUFxRixJQUFJLENBQUMsc0JBQXNCLENBQ3JJLElBQUksQ0FBQyxjQUFjLENBQ3BCLEdBQUc7WUFDSixTQUFTLEVBQUUsU0FBUyxDQUFBLDRFQUE0RSxJQUFJLENBQUMsc0JBQXNCLENBQ3pILElBQUksQ0FBQyxXQUFXLENBQ2pCLEdBQUc7WUFDSixnQkFBZ0IsRUFBRSxTQUFTLENBQUEscUdBQXFHLElBQUksQ0FBQyxzQkFBc0IsQ0FD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QUk7c0JBQVosS0FBSztnQkFJRyxXQUFXO3NCQUFuQixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksIENvbXBvbmVudCwgSW5wdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCBCaWdOdW1iZXIgZnJvbSAnYmlnbnVtYmVyLmpzJztcbmltcG9ydCB7IENyZWRpdExpbWl0Vmlld01vZGUgfSBmcm9tICcuLi90eXBlcyc7XG5cbi8qKlxuICogRGlzcGxheXMgYSBjcmVkaXQgbGltaXQgc3RhdHVzIGJhclxuICpcbiAqIEB1c2FnZU5vdGVzXG4gKlxuICogYGBgaHRtbFxuICogPGJiLWNyZWRpdC1saW1pdC1zdGF0dXMtYmFyLXVpXG4gKiAgIFtyZXNlcnZlZF09XCIxMDBcIlxuICogICBbb3dlZF09XCIxMDAwXCJcbiAqICAgW2xlZnRUb1NwZW5kXT1cIjQwMFwiXG4gKiA+PC9iYi1jcmVkaXQtbGltaXQtc3RhdHVzLWJhci11aT5cbiAqIGBgYFxuICpcbiAqIEBuZ01vZHVsZSBDcmVkaXRMaW1pdE1vZHVsZVxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdiYi1jcmVkaXQtbGltaXQtc3RhdHVzLWJhci11aScsXG4gIHRlbXBsYXRlVXJsOiAnLi9jcmVkaXQtbGltaXQtc3RhdHVzLWJhci5jb21wb25lbnQuaHRtbCcsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcbmV4cG9ydCBjbGFzcyBDcmVkaXRMaW1pdFN0YXR1c0JhckNvbXBvbmVudCB7XG4gIC8qKlxuICAgKiBEZWZpbmVzIHdoZXRoZXIgdG8gZGlzcGxheSBjcmVkaXQgbGltaXQgc3RhdHVzIGJhciBpbiBcIkVtcHRpZWRcIiBvZiBcIkZpbGxlZFwiIHZpZXcgbW9kZS4gRGVmYXVsdCBcIkVtcHRpZWRcIlxuICAgKi9cbiAgQElucHV0KCkgdmlld01vZGU6IENyZWRpdExpbWl0Vmlld01vZGUgPSAnZW1wdGllZCc7XG4gIC8qKlxuICAgKiBSZXNlcnZlZCBhbW91bnQgdG8gZGlzcGxheS4gRGVmYXVsdCBcIjBcIlxuICAgKi9cbiAgQElucHV0KCkgcmVzZXJ2ZWQ6IG51bWJlciB8IHVuZGVmaW5lZDtcbiAgLyoqXG4gICAqIE92ZXJkdWUgYW1vdW50IHRvIGRpc3BsYXkuIERlZmF1bHQgXCIwXCJcbiAgICovXG4gIEBJbnB1dCgpIG92ZXJkdWU6IG51bWJlciB8IHVuZGVmaW5lZDtcbiAgLyoqXG4gICAqIE93ZWQgYW1vdW50IHRvIGRpc3BsYXkuIERlZmF1bHQgXCIwXCJcbiAgICovXG4gIEBJbnB1dCgpIG93ZWQ6IG51bWJlciB8IHVuZGVmaW5lZDtcbiAgLyoqXG4gICAqIExlZnQgdG8gc3BlbmQgYW1vdW50IHRvIGRpc3BsYXkuIERlZmF1bHQgXCIwXCJcbiAgICovXG4gIEBJbnB1dCgpIGxlZnRUb1NwZW5kOiBudW1iZXIgfCB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIEFyaWEgbGFiZWxzIGZvciBcInJlc2VydmVkXCIsIFwib3ZlcmR1ZVwiLCBcIm93ZWRcIiBhbmQgXCJsZWZ0VG9TcGVuZFwiIHZhbHVlcy5cbiAgICovXG4gIGdldCB2YWx1ZUFyaWFMYWJlbHMoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc2VydmVkVmFsdWU6ICRsb2NhbGl6ZWA6UmVzZXJ2ZWQgdmFsdWUgYTExeUBAcHJvZHVjdC1zdW1tYXJ5LmNyZWRpdC1saW1pdC1zdGF0dXMtYmFyLmExMXkucmVzZXJ2ZWQ6UmVzZXJ2ZWQgJHt0aGlzLmZvcm1hdE51bWJlckZvclJlYWRpbmcoXG4gICAgICAgIHRoaXMucmVzZXJ2ZWRQZXJjZW50LFxuICAgICAgKX0lYCxcbiAgICAgIG92ZXJkdWVWYWx1ZTogJGxvY2FsaXplYDpPdmVyZHVlIHZhbHVlIGExMXlAQHByb2R1Y3Qtc3VtbWFyeS5jcmVkaXQtbGltaXQtc3RhdHVzLWJhci5hMTF5Lm92ZXJkdWU6T3ZlcmR1ZSAke3RoaXMuZm9ybWF0TnVtYmVyRm9yUmVhZGluZyhcbiAgICAgICAgdGhpcy5vdmVyZHVlUGVyY2VudCxcbiAgICAgICl9JWAsXG4gICAgICBvd2VkVmFsdWU6ICRsb2NhbGl6ZWA6T3dlZCB2YWx1ZSBhMTF5QEBwcm9kdWN0LXN1bW1hcnkuY3JlZGl0LWxpbWl0LXN0YXR1cy1iYXIuYTExeS5vd2VkOk93ZWQgJHt0aGlzLmZvcm1hdE51bWJlckZvclJlYWRpbmcoXG4gICAgICAgIHRoaXMub3dlZFBlcmNlbnQsXG4gICAgICApfSVgLFxuICAgICAgbGVmdFRvU3BlbmRWYWx1ZTogJGxvY2FsaXplYDpMZWZ0IHRvIHNwZW5kIHZhbHVlIGExMXlAQHByb2R1Y3Qtc3VtbWFyeS5jcmVkaXQtbGltaXQtc3RhdHVzLWJhci5hMTF5LmxlZnRUb1NwZW5kOkxlZnQgdG8gc3BlbmQgJHt0aGlzLmZvcm1hdE51bWJlckZvclJlYWRpbmcoXG4gICAgICAgIHRoaXMubGVmdFRvU3BlbmRQZXJjZW50LFxuICAgICAgKX0lYCxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIERpc3BsYXllZCB3aWR0aCBvZiBcIlJlc2VydmVkXCIgYW1vdW50LlxuICAgKi9cbiAgZ2V0IHJlc2VydmVkV2lkdGgoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5yZXNlcnZlZFBlcmNlbnQgPiAwID8gYCR7dGhpcy5yZXNlcnZlZFBlcmNlbnR9JWAgOiAnMCc7XG4gIH1cblxuICAvKipcbiAgICogRGlzcGxheWVkIHdpZHRoIG9mIFwiT3ZlcmR1ZVwiIGFtb3VudC5cbiAgICovXG4gIGdldCBvdmVyZHVlV2lkdGgoKTogc3RyaW5nIHtcbiAgICBjb25zdCByZXNlcnZlZFdpZHRoID0gbmV3IEJpZ051bWJlcih0aGlzLm92ZXJkdWVQZXJjZW50KS5wbHVzKHRoaXMucmVzZXJ2ZWRQZXJjZW50KS50b051bWJlcigpO1xuICAgIHJldHVybiB0aGlzLm92ZXJkdWVQZXJjZW50ID4gMCA/IGAke3Jlc2VydmVkV2lkdGh9JWAgOiAnMCc7XG4gIH1cblxuICAvKipcbiAgICogRGlzcGxheWVkIHdpZHRoIG9mIFwiT3dlZFwiIGFtb3VudC5cbiAgICovXG4gIGdldCBvd2VkV2lkdGgoKTogc3RyaW5nIHtcbiAgICBjb25zdCBvd2VkVmFsdWUgPSB0aGlzLnRvVmFsaWRWYWx1ZSh0aGlzLm93ZWQpO1xuICAgIGNvbnN0IGZpbGxlZFZhbHVlID0gbmV3IEJpZ051bWJlcih0aGlzLm93ZWRQZXJjZW50KS5wbHVzKHRoaXMub3ZlcmR1ZVBlcmNlbnQpLnBsdXModGhpcy5yZXNlcnZlZFBlcmNlbnQpLnRvTnVtYmVyKCk7XG4gICAgY29uc3QgZmlsbGVkV2lkdGggPSBvd2VkVmFsdWUgIT09IDAgPyBgJHtmaWxsZWRWYWx1ZX0lYCA6ICcwJztcbiAgICBjb25zdCBlbXB0aWVkV2lkdGggPSBvd2VkVmFsdWUgIT09IDAgPyAnMTAwJScgOiAnMCc7XG4gICAgcmV0dXJuIHRoaXMudmlld01vZGUgPT09ICdlbXB0aWVkJyA/IGVtcHRpZWRXaWR0aCA6IGZpbGxlZFdpZHRoO1xuICB9XG5cbiAgLyoqXG4gICAqIERpc3BsYXllZCB3aWR0aCBvZiBcIkxlZnQgdG8gc3BlbmRcIiBhbW91bnQuXG4gICAqL1xuICBnZXQgbGVmdFRvU3BlbmRXaWR0aCgpOiBzdHJpbmcge1xuICAgIGNvbnN0IGxlZnRUb1NwZW5kVmFsdWUgPSB0aGlzLnRvVmFsaWRWYWx1ZSh0aGlzLmxlZnRUb1NwZW5kKTtcbiAgICBjb25zdCBlbXB0aWVkVmFsdWUgPSBuZXcgQmlnTnVtYmVyKHRoaXMubGVmdFRvU3BlbmRQZXJjZW50KVxuICAgICAgLnBsdXModGhpcy5vdmVyZHVlUGVyY2VudClcbiAgICAgIC5wbHVzKHRoaXMucmVzZXJ2ZWRQZXJjZW50KVxuICAgICAgLnRvTnVtYmVyKCk7XG4gICAgY29uc3QgZW1wdGllZFdpZHRoID0gbGVmdFRvU3BlbmRWYWx1ZSAhPT0gMCA/IGAke2VtcHRpZWRWYWx1ZX0lYCA6ICcwJztcbiAgICBjb25zdCBmaWxsZWRXaWR0aCA9IGxlZnRUb1NwZW5kVmFsdWUgIT09IDAgPyAnMTAwJScgOiAnMCc7XG4gICAgcmV0dXJuIHRoaXMudmlld01vZGUgPT09ICdlbXB0aWVkJyA/IGVtcHRpZWRXaWR0aCA6IGZpbGxlZFdpZHRoO1xuICB9XG5cbiAgLyoqXG4gICAqIE1pbmltdW0gc2l6ZSBvZiBcIk92ZXJkdWVcIiBhbW91bnQuXG4gICAqL1xuICBnZXQgb3ZlcmR1ZU1pblNpemUoKTogc3RyaW5nIHtcbiAgICBjb25zdCByZXNlcnZlZFZhbHVlID0gdGhpcy50b1ZhbGlkVmFsdWUodGhpcy5yZXNlcnZlZCk7XG4gICAgcmV0dXJuIHJlc2VydmVkVmFsdWUgPiAwID8gJ21kJyA6ICdzbSc7XG4gIH1cblxuICAvKipcbiAgICogTWluaW11bSBzaXplIG9mIHByaW1hcnkgYW1vdW50LlxuICAgKi9cbiAgZ2V0IHByaW1hcnlNaW5TaXplKCk6IHN0cmluZyB7XG4gICAgY29uc3QgcmVzZXJ2ZWRWYWx1ZSA9IHRoaXMudG9WYWxpZFZhbHVlKHRoaXMucmVzZXJ2ZWQpO1xuICAgIGNvbnN0IG92ZXJkdWVWYWx1ZSA9IHRoaXMudG9WYWxpZFZhbHVlKHRoaXMub3ZlcmR1ZSk7XG4gICAgcmV0dXJuIHJlc2VydmVkVmFsdWUgPiAwICYmIG92ZXJkdWVWYWx1ZSA+IDAgPyAnbGcnIDogcmVzZXJ2ZWRWYWx1ZSA+IDAgfHwgb3ZlcmR1ZVZhbHVlID4gMCA/ICdtZCcgOiAnc20nO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXQgcmVzZXJ2ZWRQZXJjZW50KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0UGVyY2VudGFnZU9mTGltaXQodGhpcy5yZXNlcnZlZCk7XG4gIH1cblxuICBwcml2YXRlIGdldCBvdmVyZHVlUGVyY2VudCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmdldFBlcmNlbnRhZ2VPZkxpbWl0KHRoaXMub3ZlcmR1ZSk7XG4gIH1cblxuICBwcml2YXRlIGdldCBvd2VkUGVyY2VudCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmdldFBlcmNlbnRhZ2VPZkxpbWl0KHRoaXMub3dlZCk7XG4gIH1cblxuICBwcml2YXRlIGdldCBsZWZ0VG9TcGVuZFBlcmNlbnQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5nZXRQZXJjZW50YWdlT2ZMaW1pdCh0aGlzLmxlZnRUb1NwZW5kKTtcbiAgfVxuXG4gIHByaXZhdGUgZm9ybWF0TnVtYmVyRm9yUmVhZGluZyh2YWx1ZTogbnVtYmVyLCBkZWNpbWFsUGxhY2VzID0gMik6IHN0cmluZyB7XG4gICAgY29uc3QgbnVtYmVyID0gbmV3IEJpZ051bWJlcih2YWx1ZSk7XG4gICAgcmV0dXJuIG51bWJlci5kZWNpbWFsUGxhY2VzKCkgPiAwID8gbnVtYmVyLnRvRm9ybWF0KGRlY2ltYWxQbGFjZXMpIDogdmFsdWUudG9TdHJpbmcoKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0UGVyY2VudGFnZU9mTGltaXQodmFsdWU/OiBudW1iZXIpOiBudW1iZXIge1xuICAgIGNvbnN0IHZhbGlkVmFsdWUgPSB0aGlzLnRvVmFsaWRWYWx1ZSh2YWx1ZSk7XG4gICAgcmV0dXJuIHZhbGlkVmFsdWUgIT09IDAgPyBuZXcgQmlnTnVtYmVyKHZhbGlkVmFsdWUpLmRpdmlkZWRCeSh0aGlzLmxpbWl0KS5tdWx0aXBsaWVkQnkoMTAwKS50b051bWJlcigpIDogMDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0IGxpbWl0KCk6IG51bWJlciB7XG4gICAgY29uc3QgcmVzZXJ2ZWRWYWx1ZSA9IHRoaXMudG9WYWxpZFZhbHVlKHRoaXMucmVzZXJ2ZWQpO1xuICAgIGNvbnN0IG92ZXJkdWVWYWx1ZSA9IHRoaXMudG9WYWxpZFZhbHVlKHRoaXMub3ZlcmR1ZSk7XG4gICAgY29uc3Qgb3dlZFZhbHVlID0gdGhpcy50b1ZhbGlkVmFsdWUodGhpcy5vd2VkKTtcbiAgICBjb25zdCBsZWZ0VG9TcGVuZFZhbHVlID0gdGhpcy50b1ZhbGlkVmFsdWUodGhpcy5sZWZ0VG9TcGVuZCk7XG4gICAgcmV0dXJuIG5ldyBCaWdOdW1iZXIocmVzZXJ2ZWRWYWx1ZSkucGx1cyhvdmVyZHVlVmFsdWUpLnBsdXMob3dlZFZhbHVlKS5wbHVzKGxlZnRUb1NwZW5kVmFsdWUpLnRvTnVtYmVyKCk7XG4gIH1cblxuICBwcml2YXRlIHRvVmFsaWRWYWx1ZSh2YWx1ZT86IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgJiYgIU51bWJlci5pc05hTih2YWx1ZSkgPyBNYXRoLmFicyh2YWx1ZSkgOiAwO1xuICB9XG59XG4iLCI8ZGl2IGNsYXNzPVwiYmItY3JlZGl0LWxpbWl0LXN0YXR1cy1iYXJcIj5cbiAgPHNwYW5cbiAgICBjbGFzcz1cInNyLW9ubHlcIlxuICAgIGRhdGEtcm9sZT1cInRpdGxlXCJcbiAgICBhcmlhLWxhYmVsPVwiQ3JlZGl0IGxpbWl0IHN0YXR1cyBiYXJcIlxuICAgIGkxOG4tYXJpYS1sYWJlbD1cIkNyZWRpdCBsaW1pdCBzdGF0dXMgYmFyQEBwcm9kdWN0LXN1bW1hcnkuY3JlZGl0LWxpbWl0LXN0YXR1cy1iYXIuYTExeS50aXRsZVwiXG4gID48L3NwYW4+XG5cbiAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cInZpZXdNb2RlID09PSAnZW1wdGllZCcgPyBvd2VkVmFsdWUgOiBsZWZ0VG9TcGVuZFZhbHVlOyBjb250ZXh0OiB7IGNvbG9yOiAnc2Vjb25kYXJ5JyB9XCI+PC9uZy1jb250YWluZXI+XG4gIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJ2aWV3TW9kZSA9PT0gJ2VtcHRpZWQnID8gbGVmdFRvU3BlbmRWYWx1ZSA6IG93ZWRWYWx1ZTsgY29udGV4dDogeyBjb2xvcjogJ3ByaW1hcnknIH1cIj48L25nLWNvbnRhaW5lcj5cblxuICA8bmctdGVtcGxhdGUgI293ZWRWYWx1ZSBsZXQtY29sb3I9XCJjb2xvclwiPlxuICAgIDxkaXZcbiAgICAgICpuZ0lmPVwib3dlZFwiXG4gICAgICBbc3R5bGUud2lkdGhdPVwib3dlZFdpZHRoXCJcbiAgICAgIGNsYXNzPVwiYmItY3JlZGl0LWxpbWl0LXN0YXR1cy1iYXJfX3ZhbHVlIGJiLWNyZWRpdC1saW1pdC1zdGF0dXMtYmFyX192YWx1ZS0te3twcmltYXJ5TWluU2l6ZX19IGJiLWNyZWRpdC1saW1pdF9fY29sb3ItLXt7Y29sb3J9fVwiXG4gICAgICBkYXRhLXJvbGU9XCJvd2VkLXZhbHVlXCJcbiAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwidmFsdWVBcmlhTGFiZWxzLm93ZWRWYWx1ZVwiXG4gICAgPjwvZGl2PlxuICA8L25nLXRlbXBsYXRlPlxuICA8bmctdGVtcGxhdGUgI2xlZnRUb1NwZW5kVmFsdWUgbGV0LWNvbG9yPVwiY29sb3JcIj5cbiAgICA8ZGl2XG4gICAgICAqbmdJZj1cImxlZnRUb1NwZW5kXCJcbiAgICAgIFtzdHlsZS53aWR0aF09XCJsZWZ0VG9TcGVuZFdpZHRoXCJcbiAgICAgIGNsYXNzPVwiYmItY3JlZGl0LWxpbWl0LXN0YXR1cy1iYXJfX3ZhbHVlIGJiLWNyZWRpdC1saW1pdC1zdGF0dXMtYmFyX192YWx1ZS0te3twcmltYXJ5TWluU2l6ZX19IGJiLWNyZWRpdC1saW1pdF9fY29sb3ItLXt7Y29sb3J9fVwiXG4gICAgICBkYXRhLXJvbGU9XCJsZWZ0LXRvLXNwZW5kLXZhbHVlXCJcbiAgICAgIFthdHRyLmFyaWEtbGFiZWxdPVwidmFsdWVBcmlhTGFiZWxzLmxlZnRUb1NwZW5kVmFsdWVcIlxuICAgID48L2Rpdj5cbiAgPC9uZy10ZW1wbGF0ZT5cbiAgPGRpdlxuICAgICpuZ0lmPVwib3ZlcmR1ZVwiXG4gICAgW3N0eWxlLndpZHRoXT1cIm92ZXJkdWVXaWR0aFwiXG4gICAgY2xhc3M9XCJiYi1jcmVkaXQtbGltaXQtc3RhdHVzLWJhcl9fdmFsdWUgYmItY3JlZGl0LWxpbWl0LXN0YXR1cy1iYXJfX3ZhbHVlLS17e292ZXJkdWVNaW5TaXplfX0gYmItY3JlZGl0LWxpbWl0X19jb2xvci0tZGFuZ2VyXCJcbiAgICBkYXRhLXJvbGU9XCJvdmVyZHVlLXZhbHVlXCJcbiAgICBbYXR0ci5hcmlhLWxhYmVsXT1cInZhbHVlQXJpYUxhYmVscy5vdmVyZHVlVmFsdWVcIlxuICA+PC9kaXY+XG4gIDxkaXZcbiAgICAqbmdJZj1cInJlc2VydmVkXCJcbiAgICBbc3R5bGUud2lkdGhdPVwicmVzZXJ2ZWRXaWR0aFwiXG4gICAgY2xhc3M9XCJiYi1jcmVkaXQtbGltaXQtc3RhdHVzLWJhcl9fdmFsdWUgYmItY3JlZGl0LWxpbWl0LXN0YXR1cy1iYXJfX3ZhbHVlLS1zbSBiYi1jcmVkaXQtbGltaXRfX2NvbG9yLS13YXJuaW5nXCJcbiAgICBkYXRhLXJvbGU9XCJyZXNlcnZlZC12YWx1ZVwiXG4gICAgW2F0dHIuYXJpYS1sYWJlbF09XCJ2YWx1ZUFyaWFMYWJlbHMucmVzZXJ2ZWRWYWx1ZVwiXG4gID48L2Rpdj5cbjwvZGl2PlxuIl19