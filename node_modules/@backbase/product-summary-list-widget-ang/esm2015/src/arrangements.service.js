import { Injectable } from '@angular/core';
import { combineLatest, of, ReplaySubject } from 'rxjs';
import { catchError, map, switchMap, tap } from 'rxjs/operators';
import { parseError } from './product-summary-error';
import { ProductSummaryBaseService } from './product-summary-base.service';
import { ProductKindNames, ProductKindUri } from '@backbase/product-summary-common-ang';
import * as i0 from "@angular/core";
import * as i1 from "@backbase/arrangement-manager-http-ang";
const clearUndefinedProperties = (obj) => JSON.parse(JSON.stringify(obj));
const getBalanceFromBalanceAggregation = (balanceAggregation, groupName) => {
    if (balanceAggregation[groupName] === undefined)
        return undefined;
    const [currency, { amount }] = Object.entries(balanceAggregation[groupName])[0];
    return {
        aggregatedBalance: amount || '',
        currency,
    };
};
const isProductVisible = (element) => element.attributes.visible === undefined || element.attributes.visible.value === 'true';
const hasVisibleProducts = (elements = []) => elements.some(isProductVisible);
const mapArrangementGroupAttributes = (arrangementGroupAttributes) => {
    const mappedAttributes = {};
    Object.entries(arrangementGroupAttributes).forEach(([key, variant]) => {
        switch (variant.type) {
            case 'BOOLEAN':
                mappedAttributes[key] = variant.value === 'true';
                break;
            case 'DECIMAL':
                mappedAttributes[key] = Number(variant.value);
                break;
            case 'NUMBER':
                mappedAttributes[key] = Number(variant.value);
                break;
            case 'INTEGER':
                mappedAttributes[key] = Number(variant.value);
                break;
            default:
                mappedAttributes[key] = variant.value;
        }
    });
    return mappedAttributes;
};
const getProductKindName = (kindUri) => {
    switch (kindUri) {
        case ProductKindUri.CURRENT_ACCOUNT:
            return ProductKindNames.CURRENT_ACCOUNT;
        case ProductKindUri.SAVINGS_ACCOUNT:
            return ProductKindNames.SAVINGS_ACCOUNT;
        case ProductKindUri.TERM_DEPOSIT:
            return ProductKindNames.TERM_DEPOSIT;
        case ProductKindUri.LOAN:
            return ProductKindNames.LOAN;
        case ProductKindUri.CREDIT_CARD:
            return ProductKindNames.CREDIT_CARD;
        case ProductKindUri.DEBIT_CARD:
            return ProductKindNames.DEBIT_CARD;
        case ProductKindUri.INVESTMENT_ACCOUNT:
            return ProductKindNames.INVESTMENT_ACCOUNT;
        default:
            return kindUri;
    }
};
const objectToProductKind = (groupName, group, balanceAggregation) => {
    var _a;
    const hasProducts = group && group.elements && group.elements.length > 0;
    const balance = balanceAggregation ? getBalanceFromBalanceAggregation(balanceAggregation, groupName) : undefined;
    if (hasProducts && hasVisibleProducts(group.elements)) {
        return {
            id: groupName,
            name: groupName,
            aggregatedBalance: balance === null || balance === void 0 ? void 0 : balance.aggregatedBalance,
            currency: balance === null || balance === void 0 ? void 0 : balance.currency,
            products: (_a = group.elements) === null || _a === void 0 ? void 0 : _a.filter(isProductVisible).map((element) => {
                var _a, _b, _c, _d, _e, _f, _g, _h, _j;
                const product = mapArrangementGroupAttributes(element.attributes);
                return Object.assign(Object.assign({}, product), { id: element.id, kind: groupName, bookedBalance: (_b = ((_a = product.bookedBalance) !== null && _a !== void 0 ? _a : product.primaryBalance)) === null || _b === void 0 ? void 0 : _b.toString(), principalAmount: (_c = product.principalAmount) !== null && _c !== void 0 ? _c : product.primaryBalance, currentInvestmentValue: (_e = ((_d = product.currentInvestmentValue) !== null && _d !== void 0 ? _d : product.primaryBalance)) === null || _e === void 0 ? void 0 : _e.toString(), availableBalance: (_g = ((_f = product.availableBalance) !== null && _f !== void 0 ? _f : product.secondaryBalance)) === null || _g === void 0 ? void 0 : _g.toString(), accruedInterest: (_h = product.accruedInterest) !== null && _h !== void 0 ? _h : product.secondaryBalance, creditLimitUsage: (_j = product.creditLimitUsage) !== null && _j !== void 0 ? _j : product.tertiaryBalance, productKindName: product.productKindUri ? getProductKindName(product.productKindUri) : undefined, state: product.state ? { state: product.state } : undefined });
            }),
        };
    }
    return undefined;
};
const toProductKindList = (groups, balanceAggregation) => {
    let product = Object.entries(groups)
        .filter(([groupName]) => groupName !== 'overdueAccounts')
        .map(([groupName, group]) => objectToProductKind(groupName, group, balanceAggregation))
        .filter(Boolean);
    const overdueProductKind = objectToProductKind('overdueAccounts', groups['overdueAccounts'], balanceAggregation);
    if (overdueProductKind) {
        product = [overdueProductKind, ...product];
    }
    return product;
};
const responseToProductKinds = (res) => {
    var _a, _b, _c;
    return clearUndefinedProperties({
        total: ((_a = res.metadata) === null || _a === void 0 ? void 0 : _a.balanceAggregations)
            ? getBalanceFromBalanceAggregation((_b = res.metadata) === null || _b === void 0 ? void 0 : _b.balanceAggregations, 'all')
            : undefined,
        productKinds: res && res.groups ? toProductKindList(res.groups, (_c = res.metadata) === null || _c === void 0 ? void 0 : _c.balanceAggregations) : [],
    });
};
/**
 * Service for fetching and storing product kinds
 *
 * This service relies on providers from `ProductSummaryListWidgetModule`.
 *
 * @see ProductSummaryListWidgetModule
 *
 * @usageNotes
 *
 * ### Ensure the ProductSummaryListWidgetModule is imported to your component module
 *
 * ```ts
 * @NgModule({
 *   ...
 *   imports: [
 *     ...
 *     ProductSummaryListWidgetModule,
 *   ],
 * })
 * export class MyWidgetModule {}
 * ```
 *
 * ### Inject this service into your component
 *
 * ```ts
 * @Component({
 *   ...
 *   providers: [ProductSummaryService],
 * })
 *  export class MyComponent {
 * ```
 */
export class ArrangementsService extends ProductSummaryBaseService {
    constructor(arrangementViewsHttpService) {
        super();
        this.arrangementViewsHttpService = arrangementViewsHttpService;
        this.viewNameSubject = new ReplaySubject();
        this.productKinds = combineLatest([
            this.viewNameSubject,
            this.productKindsRefresh,
        ]).pipe(tap(() => {
            this.isLoading.next(true);
        }), switchMap(([viewName]) => this.arrangementViewsHttpService.getArrangementView({ viewName }).pipe(map(res => responseToProductKinds(res)), catchError((error) => {
            this.error.next(parseError(error));
            return of(undefined);
        }))), tap(() => {
            this.isLoading.next(false);
        }));
    }
    setViewName(viewName) {
        this.viewNameSubject.next(viewName);
    }
}
ArrangementsService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: ArrangementsService, deps: [{ token: i1.ArrangementViewsHttpService }], target: i0.ɵɵFactoryTarget.Injectable });
ArrangementsService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: ArrangementsService });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: ArrangementsService, decorators: [{
            type: Injectable
        }], ctorParameters: function () { return [{ type: i1.ArrangementViewsHttpService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXJyYW5nZW1lbnRzLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9saWJzL3Byb2R1Y3Qtc3VtbWFyeS1saXN0LXdpZGdldC1hbmcvc3JjL2FycmFuZ2VtZW50cy5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFHM0MsT0FBTyxFQUFFLGFBQWEsRUFBYyxFQUFFLEVBQUUsYUFBYSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ3BFLE9BQU8sRUFBRSxVQUFVLEVBQUUsR0FBRyxFQUFFLFNBQVMsRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUdqRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFLckQsT0FBTyxFQUFnQix5QkFBeUIsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBRXpGLE9BQU8sRUFBVyxnQkFBZ0IsRUFBRSxjQUFjLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQzs7O0FBUWpHLE1BQU0sd0JBQXdCLEdBQUcsQ0FBSSxHQUFNLEVBQUssRUFBRSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBRW5GLE1BQU0sZ0NBQWdDLEdBQUcsQ0FDdkMsa0JBQXNDLEVBQ3RDLFNBQWlCLEVBQ1MsRUFBRTtJQUM1QixJQUFJLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxLQUFLLFNBQVM7UUFBRSxPQUFPLFNBQVMsQ0FBQztJQUVsRSxNQUFNLENBQUMsUUFBUSxFQUFFLEVBQUUsTUFBTSxFQUFFLENBQUMsR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFFaEYsT0FBTztRQUNMLGlCQUFpQixFQUFFLE1BQU0sSUFBSSxFQUFFO1FBQy9CLFFBQVE7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RUFBRSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ3ZCLENBQUMsQ0FBQyxDQUNILENBQ0YsRUFDRCxHQUFHLENBQUMsR0FBRyxFQUFFO1lBQ1AsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDN0IsQ0FBQyxDQUFDLENBQ0gsQ0FBQztJQXJCRixDQUFDO0lBdUJELFdBQVcsQ0FBQyxRQUFnQjtRQUMxQixJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUN0QyxDQUFDOztpSEE5QlUsbUJBQW1CO3FIQUFuQixtQkFBbUI7NEZBQW5CLG1CQUFtQjtrQkFEL0IsVUFBVSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEh0dHBFcnJvclJlc3BvbnNlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuXG5pbXBvcnQgeyBjb21iaW5lTGF0ZXN0LCBPYnNlcnZhYmxlLCBvZiwgUmVwbGF5U3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgY2F0Y2hFcnJvciwgbWFwLCBzd2l0Y2hNYXAsIHRhcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IEFycmFuZ2VtZW50R3JvdXBJdGVtLCBBcnJhbmdlbWVudFZpZXdzSHR0cFNlcnZpY2UgfSBmcm9tICdAYmFja2Jhc2UvYXJyYW5nZW1lbnQtbWFuYWdlci1odHRwLWFuZyc7XG5cbmltcG9ydCB7IHBhcnNlRXJyb3IgfSBmcm9tICcuL3Byb2R1Y3Qtc3VtbWFyeS1lcnJvcic7XG5pbXBvcnQgeyBBcnJhbmdlbWVudFZpZXdSZXNwb25zZSB9IGZyb20gJ0BiYWNrYmFzZS9hcnJhbmdlbWVudC1tYW5hZ2VyLWh0dHAtYW5nL21vZGVsL2FycmFuZ2VtZW50Vmlld1Jlc3BvbnNlJztcbmltcG9ydCB7IEFycmFuZ2VtZW50R3JvdXBSZXNwb25zZSB9IGZyb20gJ0BiYWNrYmFzZS9hcnJhbmdlbWVudC1tYW5hZ2VyLWh0dHAtYW5nL21vZGVsL2FycmFuZ2VtZW50R3JvdXBSZXNwb25zZSc7XG5pbXBvcnQgeyBWYXJpYW50IH0gZnJvbSAnQGJhY2tiYXNlL2FycmFuZ2VtZW50LW1hbmFnZXItaHR0cC1hbmcvbW9kZWwvdmFyaWFudCc7XG5pbXBvcnQgeyBQcm9kdWN0S2luZCwgVG90YWxCYWxhbmNlIH0gZnJvbSAnLi9wcm9kdWN0LXN1bW1hcnkuc2VydmljZSc7XG5pbXBvcnQgeyBQcm9kdWN0S2luZHMsIFByb2R1Y3RTdW1tYXJ5QmFzZVNlcnZpY2UgfSBmcm9tICcuL3Byb2R1Y3Qtc3VtbWFyeS1iYXNlLnNlcnZpY2UnO1xuaW1wb3J0IHsgVmlld0JhbGFuY2VBZ2dyZWdhdGlvbiB9IGZyb20gJ0BiYWNrYmFzZS9hcnJhbmdlbWVudC1tYW5hZ2VyLWh0dHAtYW5nL21vZGVsL3ZpZXdCYWxhbmNlQWdncmVnYXRpb24nO1xuaW1wb3J0IHsgUHJvZHVjdCwgUHJvZHVjdEtpbmROYW1lcywgUHJvZHVjdEtpbmRVcmkgfSBmcm9tICdAYmFja2Jhc2UvcHJvZHVjdC1zdW1tYXJ5LWNvbW1vbi1hbmcnO1xuXG5pbnRlcmZhY2UgQmFsYW5jZUFnZ3JlZ2F0aW9uIHtcbiAgW2tleTogc3RyaW5nXToge1xuICAgIFtrZXk6IHN0cmluZ106IFZpZXdCYWxhbmNlQWdncmVnYXRpb247XG4gIH07XG59XG5cbmNvbnN0IGNsZWFyVW5kZWZpbmVkUHJvcGVydGllcyA9IDxUPihvYmo6IFQpOiBUID0+IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2JqKSk7XG5cbmNvbnN0IGdldEJhbGFuY2VGcm9tQmFsYW5jZUFnZ3JlZ2F0aW9uID0gKFxuICBiYWxhbmNlQWdncmVnYXRpb246IEJhbGFuY2VBZ2dyZWdhdGlvbixcbiAgZ3JvdXBOYW1lOiBzdHJpbmcsXG4pOiBUb3RhbEJhbGFuY2UgfCB1bmRlZmluZWQgPT4ge1xuICBpZiAoYmFsYW5jZUFnZ3JlZ2F0aW9uW2dyb3VwTmFtZV0gPT09IHVuZGVmaW5lZCkgcmV0dXJuIHVuZGVmaW5lZDtcblxuICBjb25zdCBbY3VycmVuY3ksIHsgYW1vdW50IH1dID0gT2JqZWN0LmVudHJpZXMoYmFsYW5jZUFnZ3JlZ2F0aW9uW2dyb3VwTmFtZV0pWzBdO1xuXG4gIHJldHVybiB7XG4gICAgYWdncmVnYXRlZEJhbGFuY2U6IGFtb3VudCB8fCAnJyxcbiAgICBjdXJyZW5jeSxcbiAgfTtcbn07XG5cbmNvbnN0IGlzUHJvZHVjdFZpc2libGUgPSAoZWxlbWVudDogQXJyYW5nZW1lbnRHcm91cEl0ZW0pID0+XG4gIGVsZW1lbnQuYXR0cmlidXRlcy52aXNpYmxlID09PSB1bmRlZmluZWQgfHwgZWxlbWVudC5hdHRyaWJ1dGVzLnZpc2libGUudmFsdWUgPT09ICd0cnVlJztcblxuY29uc3QgaGFzVmlzaWJsZVByb2R1Y3RzID0gKGVsZW1lbnRzOiBBcnJheTxBcnJhbmdlbWVudEdyb3VwSXRlbT4gPSBbXSk6IGJvb2xlYW4gPT4gZWxlbWVudHMuc29tZShpc1Byb2R1Y3RWaXNpYmxlKTtcblxuY29uc3QgbWFwQXJyYW5nZW1lbnRHcm91cEF0dHJpYnV0ZXMgPSAoYXJyYW5nZW1lbnRHcm91cEF0dHJpYnV0ZXM6IHsgW2tleTogc3RyaW5nXTogVmFyaWFudCB9KTogUGFydGlhbDxQcm9kdWN0PiA9PiB7XG4gIGNvbnN0IG1hcHBlZEF0dHJpYnV0ZXM6IFBhcnRpYWw8UHJvZHVjdD4gPSB7fTtcblxuICAoT2JqZWN0LmVudHJpZXMoYXJyYW5nZW1lbnRHcm91cEF0dHJpYnV0ZXMpIGFzIFtrZXlvZiBQcm9kdWN0LCBWYXJpYW50XVtdKS5mb3JFYWNoKChba2V5LCB2YXJpYW50XSkgPT4ge1xuICAgIHN3aXRjaCAodmFyaWFudC50eXBlKSB7XG4gICAgICBjYXNlICdCT09MRUFOJzpcbiAgICAgICAgbWFwcGVkQXR0cmlidXRlc1trZXldID0gdmFyaWFudC52YWx1ZSA9PT0gJ3RydWUnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ0RFQ0lNQUwnOlxuICAgICAgICBtYXBwZWRBdHRyaWJ1dGVzW2tleV0gPSBOdW1iZXIodmFyaWFudC52YWx1ZSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnTlVNQkVSJzpcbiAgICAgICAgbWFwcGVkQXR0cmlidXRlc1trZXldID0gTnVtYmVyKHZhcmlhbnQudmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ0lOVEVHRVInOlxuICAgICAgICBtYXBwZWRBdHRyaWJ1dGVzW2tleV0gPSBOdW1iZXIodmFyaWFudC52YWx1ZSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgbWFwcGVkQXR0cmlidXRlc1trZXldID0gdmFyaWFudC52YWx1ZTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBtYXBwZWRBdHRyaWJ1dGVzO1xufTtcblxuY29uc3QgZ2V0UHJvZHVjdEtpbmROYW1lID0gKGtpbmRVcmk6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gIHN3aXRjaCAoa2luZFVyaSkge1xuICAgIGNhc2UgUHJvZHVjdEtpbmRVcmkuQ1VSUkVOVF9BQ0NPVU5UOlxuICAgICAgcmV0dXJuIFByb2R1Y3RLaW5kTmFtZXMuQ1VSUkVOVF9BQ0NPVU5UO1xuICAgIGNhc2UgUHJvZHVjdEtpbmRVcmkuU0FWSU5HU19BQ0NPVU5UOlxuICAgICAgcmV0dXJuIFByb2R1Y3RLaW5kTmFtZXMuU0FWSU5HU19BQ0NPVU5UO1xuICAgIGNhc2UgUHJvZHVjdEtpbmRVcmkuVEVSTV9ERVBPU0lUOlxuICAgICAgcmV0dXJuIFByb2R1Y3RLaW5kTmFtZXMuVEVSTV9ERVBPU0lUO1xuICAgIGNhc2UgUHJvZHVjdEtpbmRVcmkuTE9BTjpcbiAgICAgIHJldHVybiBQcm9kdWN0S2luZE5hbWVzLkxPQU47XG4gICAgY2FzZSBQcm9kdWN0S2luZFVyaS5DUkVESVRfQ0FSRDpcbiAgICAgIHJldHVybiBQcm9kdWN0S2luZE5hbWVzLkNSRURJVF9DQVJEO1xuICAgIGNhc2UgUHJvZHVjdEtpbmRVcmkuREVCSVRfQ0FSRDpcbiAgICAgIHJldHVybiBQcm9kdWN0S2luZE5hbWVzLkRFQklUX0NBUkQ7XG4gICAgY2FzZSBQcm9kdWN0S2luZFVyaS5JTlZFU1RNRU5UX0FDQ09VTlQ6XG4gICAgICByZXR1cm4gUHJvZHVjdEtpbmROYW1lcy5JTlZFU1RNRU5UX0FDQ09VTlQ7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBraW5kVXJpO1xuICB9XG59O1xuXG5jb25zdCBvYmplY3RUb1Byb2R1Y3RLaW5kID0gKFxuICBncm91cE5hbWU6IHN0cmluZyxcbiAgZ3JvdXA6IEFycmFuZ2VtZW50R3JvdXBSZXNwb25zZSxcbiAgYmFsYW5jZUFnZ3JlZ2F0aW9uPzogQmFsYW5jZUFnZ3JlZ2F0aW9uLFxuKTogUHJvZHVjdEtpbmQgfCB1bmRlZmluZWQgPT4ge1xuICBjb25zdCBoYXNQcm9kdWN0cyA9IGdyb3VwICYmIGdyb3VwLmVsZW1lbnRzICYmIGdyb3VwLmVsZW1lbnRzLmxlbmd0aCA+IDA7XG4gIGNvbnN0IGJhbGFuY2UgPSBiYWxhbmNlQWdncmVnYXRpb24gPyBnZXRCYWxhbmNlRnJvbUJhbGFuY2VBZ2dyZWdhdGlvbihiYWxhbmNlQWdncmVnYXRpb24sIGdyb3VwTmFtZSkgOiB1bmRlZmluZWQ7XG5cbiAgaWYgKGhhc1Byb2R1Y3RzICYmIGhhc1Zpc2libGVQcm9kdWN0cyhncm91cC5lbGVtZW50cykpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IGdyb3VwTmFtZSxcbiAgICAgIG5hbWU6IGdyb3VwTmFtZSxcbiAgICAgIGFnZ3JlZ2F0ZWRCYWxhbmNlOiBiYWxhbmNlPy5hZ2dyZWdhdGVkQmFsYW5jZSxcbiAgICAgIGN1cnJlbmN5OiBiYWxhbmNlPy5jdXJyZW5jeSxcbiAgICAgIHByb2R1Y3RzOiBncm91cC5lbGVtZW50cz8uZmlsdGVyKGlzUHJvZHVjdFZpc2libGUpLm1hcCgoZWxlbWVudDogQXJyYW5nZW1lbnRHcm91cEl0ZW0pID0+IHtcbiAgICAgICAgY29uc3QgcHJvZHVjdCA9IG1hcEFycmFuZ2VtZW50R3JvdXBBdHRyaWJ1dGVzKGVsZW1lbnQuYXR0cmlidXRlcyk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5wcm9kdWN0LFxuICAgICAgICAgIGlkOiBlbGVtZW50LmlkLFxuICAgICAgICAgIGtpbmQ6IGdyb3VwTmFtZSxcbiAgICAgICAgICBib29rZWRCYWxhbmNlOiAocHJvZHVjdC5ib29rZWRCYWxhbmNlID8/IHByb2R1Y3QucHJpbWFyeUJhbGFuY2UpPy50b1N0cmluZygpLFxuICAgICAgICAgIHByaW5jaXBhbEFtb3VudDogcHJvZHVjdC5wcmluY2lwYWxBbW91bnQgPz8gcHJvZHVjdC5wcmltYXJ5QmFsYW5jZSxcbiAgICAgICAgICBjdXJyZW50SW52ZXN0bWVudFZhbHVlOiAocHJvZHVjdC5jdXJyZW50SW52ZXN0bWVudFZhbHVlID8/IHByb2R1Y3QucHJpbWFyeUJhbGFuY2UpPy50b1N0cmluZygpLFxuICAgICAgICAgIGF2YWlsYWJsZUJhbGFuY2U6IChwcm9kdWN0LmF2YWlsYWJsZUJhbGFuY2UgPz8gcHJvZHVjdC5zZWNvbmRhcnlCYWxhbmNlKT8udG9TdHJpbmcoKSxcbiAgICAgICAgICBhY2NydWVkSW50ZXJlc3Q6IHByb2R1Y3QuYWNjcnVlZEludGVyZXN0ID8/IHByb2R1Y3Quc2Vjb25kYXJ5QmFsYW5jZSxcbiAgICAgICAgICBjcmVkaXRMaW1pdFVzYWdlOiBwcm9kdWN0LmNyZWRpdExpbWl0VXNhZ2UgPz8gcHJvZHVjdC50ZXJ0aWFyeUJhbGFuY2UsXG4gICAgICAgICAgcHJvZHVjdEtpbmROYW1lOiBwcm9kdWN0LnByb2R1Y3RLaW5kVXJpID8gZ2V0UHJvZHVjdEtpbmROYW1lKHByb2R1Y3QucHJvZHVjdEtpbmRVcmkpIDogdW5kZWZpbmVkLFxuICAgICAgICAgIHN0YXRlOiBwcm9kdWN0LnN0YXRlID8geyBzdGF0ZTogcHJvZHVjdC5zdGF0ZSB9IDogdW5kZWZpbmVkLFxuICAgICAgICB9IGFzIFByb2R1Y3Q7XG4gICAgICB9KSxcbiAgICB9O1xuICB9XG4gIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5jb25zdCB0b1Byb2R1Y3RLaW5kTGlzdCA9IChcbiAgZ3JvdXBzOiB7IFtrZXk6IHN0cmluZ106IEFycmFuZ2VtZW50R3JvdXBSZXNwb25zZSB9LFxuICBiYWxhbmNlQWdncmVnYXRpb24/OiBCYWxhbmNlQWdncmVnYXRpb24sXG4pOiBQcm9kdWN0S2luZFtdID0+IHtcbiAgbGV0IHByb2R1Y3QgPSBPYmplY3QuZW50cmllcyhncm91cHMpXG4gICAgLmZpbHRlcigoW2dyb3VwTmFtZV0pID0+IGdyb3VwTmFtZSAhPT0gJ292ZXJkdWVBY2NvdW50cycpXG4gICAgLm1hcCgoW2dyb3VwTmFtZSwgZ3JvdXBdKSA9PiBvYmplY3RUb1Byb2R1Y3RLaW5kKGdyb3VwTmFtZSwgZ3JvdXAsIGJhbGFuY2VBZ2dyZWdhdGlvbikpXG4gICAgLmZpbHRlcihCb29sZWFuKTtcblxuICBjb25zdCBvdmVyZHVlUHJvZHVjdEtpbmQgPSBvYmplY3RUb1Byb2R1Y3RLaW5kKCdvdmVyZHVlQWNjb3VudHMnLCBncm91cHNbJ292ZXJkdWVBY2NvdW50cyddLCBiYWxhbmNlQWdncmVnYXRpb24pO1xuXG4gIGlmIChvdmVyZHVlUHJvZHVjdEtpbmQpIHtcbiAgICBwcm9kdWN0ID0gW292ZXJkdWVQcm9kdWN0S2luZCwgLi4ucHJvZHVjdF07XG4gIH1cblxuICByZXR1cm4gcHJvZHVjdCBhcyBQcm9kdWN0S2luZFtdO1xufTtcblxuY29uc3QgcmVzcG9uc2VUb1Byb2R1Y3RLaW5kcyA9IChyZXM6IEFycmFuZ2VtZW50Vmlld1Jlc3BvbnNlKTogUHJvZHVjdEtpbmRzID0+XG4gIGNsZWFyVW5kZWZpbmVkUHJvcGVydGllcyh7XG4gICAgdG90YWw6IHJlcy5tZXRhZGF0YT8uYmFsYW5jZUFnZ3JlZ2F0aW9uc1xuICAgICAgPyBnZXRCYWxhbmNlRnJvbUJhbGFuY2VBZ2dyZWdhdGlvbihyZXMubWV0YWRhdGE/LmJhbGFuY2VBZ2dyZWdhdGlvbnMsICdhbGwnKVxuICAgICAgOiB1bmRlZmluZWQsXG4gICAgcHJvZHVjdEtpbmRzOiByZXMgJiYgcmVzLmdyb3VwcyA/IHRvUHJvZHVjdEtpbmRMaXN0KHJlcy5ncm91cHMsIHJlcy5tZXRhZGF0YT8uYmFsYW5jZUFnZ3JlZ2F0aW9ucykgOiBbXSxcbiAgfSk7XG5cbi8qKlxuICogU2VydmljZSBmb3IgZmV0Y2hpbmcgYW5kIHN0b3JpbmcgcHJvZHVjdCBraW5kc1xuICpcbiAqIFRoaXMgc2VydmljZSByZWxpZXMgb24gcHJvdmlkZXJzIGZyb20gYFByb2R1Y3RTdW1tYXJ5TGlzdFdpZGdldE1vZHVsZWAuXG4gKlxuICogQHNlZSBQcm9kdWN0U3VtbWFyeUxpc3RXaWRnZXRNb2R1bGVcbiAqXG4gKiBAdXNhZ2VOb3Rlc1xuICpcbiAqICMjIyBFbnN1cmUgdGhlIFByb2R1Y3RTdW1tYXJ5TGlzdFdpZGdldE1vZHVsZSBpcyBpbXBvcnRlZCB0byB5b3VyIGNvbXBvbmVudCBtb2R1bGVcbiAqXG4gKiBgYGB0c1xuICogQE5nTW9kdWxlKHtcbiAqICAgLi4uXG4gKiAgIGltcG9ydHM6IFtcbiAqICAgICAuLi5cbiAqICAgICBQcm9kdWN0U3VtbWFyeUxpc3RXaWRnZXRNb2R1bGUsXG4gKiAgIF0sXG4gKiB9KVxuICogZXhwb3J0IGNsYXNzIE15V2lkZ2V0TW9kdWxlIHt9XG4gKiBgYGBcbiAqXG4gKiAjIyMgSW5qZWN0IHRoaXMgc2VydmljZSBpbnRvIHlvdXIgY29tcG9uZW50XG4gKlxuICogYGBgdHNcbiAqIEBDb21wb25lbnQoe1xuICogICAuLi5cbiAqICAgcHJvdmlkZXJzOiBbUHJvZHVjdFN1bW1hcnlTZXJ2aWNlXSxcbiAqIH0pXG4gKiAgZXhwb3J0IGNsYXNzIE15Q29tcG9uZW50IHtcbiAqIGBgYFxuICovXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgQXJyYW5nZW1lbnRzU2VydmljZSBleHRlbmRzIFByb2R1Y3RTdW1tYXJ5QmFzZVNlcnZpY2Uge1xuICBwcml2YXRlIHJlYWRvbmx5IHZpZXdOYW1lU3ViamVjdCA9IG5ldyBSZXBsYXlTdWJqZWN0PHN0cmluZz4oKTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IGFycmFuZ2VtZW50Vmlld3NIdHRwU2VydmljZTogQXJyYW5nZW1lbnRWaWV3c0h0dHBTZXJ2aWNlKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIHJlYWRvbmx5IHByb2R1Y3RLaW5kczogT2JzZXJ2YWJsZTxQcm9kdWN0S2luZHMgfCB1bmRlZmluZWQ+ID0gY29tYmluZUxhdGVzdChbXG4gICAgdGhpcy52aWV3TmFtZVN1YmplY3QsXG4gICAgdGhpcy5wcm9kdWN0S2luZHNSZWZyZXNoLFxuICBdKS5waXBlKFxuICAgIHRhcCgoKSA9PiB7XG4gICAgICB0aGlzLmlzTG9hZGluZy5uZXh0KHRydWUpO1xuICAgIH0pLFxuICAgIHN3aXRjaE1hcCgoW3ZpZXdOYW1lXSkgPT5cbiAgICAgIHRoaXMuYXJyYW5nZW1lbnRWaWV3c0h0dHBTZXJ2aWNlLmdldEFycmFuZ2VtZW50Vmlldyh7IHZpZXdOYW1lIH0pLnBpcGUoXG4gICAgICAgIG1hcChyZXMgPT4gcmVzcG9uc2VUb1Byb2R1Y3RLaW5kcyhyZXMpKSxcbiAgICAgICAgY2F0Y2hFcnJvcigoZXJyb3I6IEh0dHBFcnJvclJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgdGhpcy5lcnJvci5uZXh0KHBhcnNlRXJyb3IoZXJyb3IpKTtcbiAgICAgICAgICByZXR1cm4gb2YodW5kZWZpbmVkKTtcbiAgICAgICAgfSksXG4gICAgICApLFxuICAgICksXG4gICAgdGFwKCgpID0+IHtcbiAgICAgIHRoaXMuaXNMb2FkaW5nLm5leHQoZmFsc2UpO1xuICAgIH0pLFxuICApO1xuXG4gIHNldFZpZXdOYW1lKHZpZXdOYW1lOiBzdHJpbmcpIHtcbiAgICB0aGlzLnZpZXdOYW1lU3ViamVjdC5uZXh0KHZpZXdOYW1lKTtcbiAgfVxufVxuIl19