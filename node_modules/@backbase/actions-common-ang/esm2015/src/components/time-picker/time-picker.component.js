import { ChangeDetectionStrategy, Component, forwardRef, Input } from '@angular/core';
import { FormControl, NG_VALUE_ACCESSOR } from '@angular/forms';
import { BehaviorSubject, Subject } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
import { getTimeOptions } from '../../helpers/time.helper';
import * as i0 from "@angular/core";
import * as i1 from "@backbase/ui-ang/dropdown-single-select";
import * as i2 from "@angular/forms";
export class TimePickerComponent {
    constructor() {
        this.timeOptions = [];
        this.excludedOptions$$ = new BehaviorSubject([]);
        this.componentDestroyed$ = new Subject();
        /**
         * Start time
         */
        this.startTime = 0;
        /**
         * Step on minutes for time options
         */
        this.minutesStep = 60;
        /**
         * Time form control
         */
        this.timeControl = new FormControl();
        /**
         * Change event handler
         */
        this.onChange = (_time) => { }; // NOSONAR
        /**
         * Touched event handler
         */
        this.onTouched = () => { }; // NOSONAR
    }
    /**
     * Options to exclude
     */
    set excludedOptions(options) {
        this.excludedOptions$$.next(options || []);
    }
    ngOnInit() {
        this.onExcludedOptionsChange();
        this.onFormValueChange();
    }
    onExcludedOptionsChange() {
        this.excludedOptions$$.pipe(takeUntil(this.componentDestroyed$)).subscribe(options => {
            var _a, _b;
            const timeControlValue = ((_a = this.timeControl.value) === null || _a === void 0 ? void 0 : _a.time) || ((_b = this.controlRef) === null || _b === void 0 ? void 0 : _b.value);
            const excludedOptions = timeControlValue || timeControlValue === 0 ? options.filter(option => option !== timeControlValue) : [];
            this.timeOptions = getTimeOptions(this.startTime, this.minutesStep, excludedOptions, this.amPmFormat);
            const selection = this.timeOptions.find(option => option.time === timeControlValue);
            this.timeControl.setValue(selection);
        });
    }
    onFormValueChange() {
        this.timeControl.valueChanges.pipe(takeUntil(this.componentDestroyed$)).subscribe(value => {
            if (value) {
                this.onChange(value.time);
            }
        });
    }
    /**
     * Method to register change event handler
     *
     * @param fn
     */
    registerOnChange(fn) {
        this.onChange = fn;
    }
    /**
     * Method to register touched event handler
     *
     * @param fn
     */
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
    /**
     * Method to write initial value to the input
     *
     * @param time
     */
    writeValue(time) {
        this.timeControl.setValue(this.timeOptions.find(ts => ts.time === time));
    }
    markAsTouched(event) {
        const target = event.target;
        target.blur();
        this.onTouched();
    }
    ngOnDestroy() {
        this.componentDestroyed$.next(true);
    }
}
TimePickerComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.14", ngImport: i0, type: TimePickerComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
TimePickerComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.14", type: TimePickerComponent, selector: "bb-time-picker", inputs: { startTime: "startTime", minutesStep: "minutesStep", amPmFormat: "amPmFormat", excludedOptions: "excludedOptions", controlRef: "controlRef", label: "label" }, providers: [
        {
            provide: NG_VALUE_ACCESSOR,
            useExisting: forwardRef(() => TimePickerComponent),
            multi: true,
        },
    ], ngImport: i0, template: "<bb-dropdown-single-select-ui\n  iconName=\"caret-down\"\n  [options]=\"timeOptions\"\n  [label]=\"label\"\n  (change)=\"markAsTouched($event)\"\n  [formControl]=\"timeControl\"\n  displayAttributePath=\"label\"\n  data-role=\"time-picker-dropdown\"\n>\n</bb-dropdown-single-select-ui>\n", components: [{ type: i1.DropdownSingleSelectComponent, selector: "bb-dropdown-single-select-ui", inputs: ["placeholder", "defaultOptionAsPlaceholder", "options", "displayAttributePath", "iconName", "compareWithFn"] }], directives: [{ type: i2.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { type: i2.FormControlDirective, selector: "[formControl]", inputs: ["disabled", "formControl", "ngModel"], outputs: ["ngModelChange"], exportAs: ["ngForm"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.14", ngImport: i0, type: TimePickerComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'bb-time-picker',
                    templateUrl: './time-picker.component.html',
                    providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef(() => TimePickerComponent),
                            multi: true,
                        },
                    ],
                    changeDetection: ChangeDetectionStrategy.OnPush,
                }]
        }], propDecorators: { startTime: [{
                type: Input
            }], minutesStep: [{
                type: Input
            }], amPmFormat: [{
                type: Input
            }], excludedOptions: [{
                type: Input
            }], controlRef: [{
                type: Input
            }], label: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGltZS1waWNrZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vbGlicy9hY3Rpb25zLWNvbW1vbi1hbmcvc3JjL2NvbXBvbmVudHMvdGltZS1waWNrZXIvdGltZS1waWNrZXIuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vbGlicy9hY3Rpb25zLWNvbW1vbi1hbmcvc3JjL2NvbXBvbmVudHMvdGltZS1waWNrZXIvdGltZS1waWNrZXIuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLHVCQUF1QixFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFxQixNQUFNLGVBQWUsQ0FBQztBQUN6RyxPQUFPLEVBQXdCLFdBQVcsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3RGLE9BQU8sRUFBRSxlQUFlLEVBQUUsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ2hELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUUzQyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sMkJBQTJCLENBQUM7Ozs7QUFlM0QsTUFBTSxPQUFPLG1CQUFtQjtJQVpoQztRQWFFLGdCQUFXLEdBQWlCLEVBQUUsQ0FBQztRQUNkLHNCQUFpQixHQUFHLElBQUksZUFBZSxDQUFXLEVBQUUsQ0FBQyxDQUFDO1FBQ3RELHdCQUFtQixHQUFHLElBQUksT0FBTyxFQUFXLENBQUM7UUFFOUQ7O1dBRUc7UUFDTSxjQUFTLEdBQUcsQ0FBQyxDQUFDO1FBRXZCOztXQUVHO1FBQ00sZ0JBQVcsR0FBZ0IsRUFBRSxDQUFDO1FBd0J2Qzs7V0FFRztRQUNNLGdCQUFXLEdBQUcsSUFBSSxXQUFXLEVBQUUsQ0FBQztRQTBCekM7O1dBRUc7UUFDSCxhQUFRLEdBQUcsQ0FBQyxLQUFhLEVBQUUsRUFBRSxHQUFFLENBQUMsQ0FBQyxDQUFD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QzFCLFdBQVcsRUFBRSxVQUFVLENBQUMsR0FBRyxFQUFFLENBQUMsbUJBQW1CLENBQUM7WUFDbEQsS0FBSyxFQUFFLElBQUk7U0FDWjtLQUNGLDBCQ2pCSCxpU0FVQTs0RkRVYSxtQkFBbUI7a0JBWi9CLFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLGdCQUFnQjtvQkFDMUIsV0FBVyxFQUFFLDhCQUE4QjtvQkFDM0MsU0FBUyxFQUFFO3dCQUNUOzRCQUNFLE9BQU8sRUFBRSxpQkFBaUI7NEJBQzFCLFdBQVcsRUFBRSxVQUFVLENBQUMsR0FBRyxFQUFFLG9CQUFvQixDQUFDOzRCQUNsRCxLQUFLLEVBQUUsSUFBSTt5QkFDWjtxQkFDRjtvQkFDRCxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTtpQkFDaEQ7OEJBU1UsU0FBUztzQkFBakIsS0FBSztnQkFLRyxXQUFXO3NCQUFuQixLQUFLO2dCQUtHLFVBQVU7c0JBQWxCLEtBQUs7Z0JBS08sZUFBZTtzQkFBM0IsS0FBSztnQkFPRyxVQUFVO3NCQUFsQixLQUFLO2dCQUtHLEtBQUs7c0JBQWIsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDb21wb25lbnQsIGZvcndhcmRSZWYsIElucHV0LCBPbkRlc3Ryb3ksIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29udHJvbFZhbHVlQWNjZXNzb3IsIEZvcm1Db250cm9sLCBOR19WQUxVRV9BQ0NFU1NPUiB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgdGFrZVVudGlsIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5pbXBvcnQgeyBnZXRUaW1lT3B0aW9ucyB9IGZyb20gJy4uLy4uL2hlbHBlcnMvdGltZS5oZWxwZXInO1xuaW1wb3J0IHsgTWludXRlc1N0ZXAsIFRpbWVPcHRpb24gfSBmcm9tICcuLi8uLi9tb2RlbHMvc2NoZWR1bGUtbm90aWZpY2F0aW9ucy5tb2RlbCc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2JiLXRpbWUtcGlja2VyJyxcbiAgdGVtcGxhdGVVcmw6ICcuL3RpbWUtcGlja2VyLmNvbXBvbmVudC5odG1sJyxcbiAgcHJvdmlkZXJzOiBbXG4gICAge1xuICAgICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXG4gICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBUaW1lUGlja2VyQ29tcG9uZW50KSxcbiAgICAgIG11bHRpOiB0cnVlLFxuICAgIH0sXG4gIF0sXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxufSlcbmV4cG9ydCBjbGFzcyBUaW1lUGlja2VyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3ksIENvbnRyb2xWYWx1ZUFjY2Vzc29yIHtcbiAgdGltZU9wdGlvbnM6IFRpbWVPcHRpb25bXSA9IFtdO1xuICBwcml2YXRlIHJlYWRvbmx5IGV4Y2x1ZGVkT3B0aW9ucyQkID0gbmV3IEJlaGF2aW9yU3ViamVjdDxudW1iZXJbXT4oW10pO1xuICBwcml2YXRlIHJlYWRvbmx5IGNvbXBvbmVudERlc3Ryb3llZCQgPSBuZXcgU3ViamVjdDxib29sZWFuPigpO1xuXG4gIC8qKlxuICAgKiBTdGFydCB0aW1lXG4gICAqL1xuICBASW5wdXQoKSBzdGFydFRpbWUgPSAwO1xuXG4gIC8qKlxuICAgKiBTdGVwIG9uIG1pbnV0ZXMgZm9yIHRpbWUgb3B0aW9uc1xuICAgKi9cbiAgQElucHV0KCkgbWludXRlc1N0ZXA6IE1pbnV0ZXNTdGVwID0gNjA7XG5cbiAgLyoqXG4gICAqIFRpbWUgZm9ybWF0XG4gICAqL1xuICBASW5wdXQoKSBhbVBtRm9ybWF0ITogZmFsc2U7XG5cbiAgLyoqXG4gICAqIE9wdGlvbnMgdG8gZXhjbHVkZVxuICAgKi9cbiAgQElucHV0KCkgc2V0IGV4Y2x1ZGVkT3B0aW9ucyhvcHRpb25zOiBudW1iZXJbXSkge1xuICAgIHRoaXMuZXhjbHVkZWRPcHRpb25zJCQubmV4dChvcHRpb25zIHx8IFtdKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JtIGNvbnRyb2wgcmVmZXJlbmNlXG4gICAqL1xuICBASW5wdXQoKSBjb250cm9sUmVmITogRm9ybUNvbnRyb2w7XG5cbiAgLyoqXG4gICAqIElucHV0J3MgbGFiZWxcbiAgICovXG4gIEBJbnB1dCgpIGxhYmVsOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIFRpbWUgZm9ybSBjb250cm9sXG4gICAqL1xuICByZWFkb25seSB0aW1lQ29udHJvbCA9IG5ldyBGb3JtQ29udHJvbCgpO1xuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMub25FeGNsdWRlZE9wdGlvbnNDaGFuZ2UoKTtcbiAgICB0aGlzLm9uRm9ybVZhbHVlQ2hhbmdlKCk7XG4gIH1cblxuICBwcml2YXRlIG9uRXhjbHVkZWRPcHRpb25zQ2hhbmdlKCkge1xuICAgIHRoaXMuZXhjbHVkZWRPcHRpb25zJCQucGlwZSh0YWtlVW50aWwodGhpcy5jb21wb25lbnREZXN0cm95ZWQkKSkuc3Vic2NyaWJlKG9wdGlvbnMgPT4ge1xuICAgICAgY29uc3QgdGltZUNvbnRyb2xWYWx1ZSA9IHRoaXMudGltZUNvbnRyb2wudmFsdWU/LnRpbWUgfHwgdGhpcy5jb250cm9sUmVmPy52YWx1ZTtcbiAgICAgIGNvbnN0IGV4Y2x1ZGVkT3B0aW9ucyA9XG4gICAgICAgIHRpbWVDb250cm9sVmFsdWUgfHwgdGltZUNvbnRyb2xWYWx1ZSA9PT0gMCA/IG9wdGlvbnMuZmlsdGVyKG9wdGlvbiA9PiBvcHRpb24gIT09IHRpbWVDb250cm9sVmFsdWUpIDogW107XG4gICAgICB0aGlzLnRpbWVPcHRpb25zID0gZ2V0VGltZU9wdGlvbnModGhpcy5zdGFydFRpbWUsIHRoaXMubWludXRlc1N0ZXAsIGV4Y2x1ZGVkT3B0aW9ucywgdGhpcy5hbVBtRm9ybWF0KTtcbiAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IHRoaXMudGltZU9wdGlvbnMuZmluZChvcHRpb24gPT4gb3B0aW9uLnRpbWUgPT09IHRpbWVDb250cm9sVmFsdWUpO1xuICAgICAgdGhpcy50aW1lQ29udHJvbC5zZXRWYWx1ZShzZWxlY3Rpb24pO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBvbkZvcm1WYWx1ZUNoYW5nZSgpIHtcbiAgICB0aGlzLnRpbWVDb250cm9sLnZhbHVlQ2hhbmdlcy5waXBlKHRha2VVbnRpbCh0aGlzLmNvbXBvbmVudERlc3Ryb3llZCQpKS5zdWJzY3JpYmUodmFsdWUgPT4ge1xuICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgIHRoaXMub25DaGFuZ2UodmFsdWUudGltZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ2hhbmdlIGV2ZW50IGhhbmRsZXJcbiAgICovXG4gIG9uQ2hhbmdlID0gKF90aW1lOiBudW1iZXIpID0+IHt9OyAvLyBOT1NPTkFSXG5cbiAgLyoqXG4gICAqIFRvdWNoZWQgZXZlbnQgaGFuZGxlclxuICAgKi9cbiAgb25Ub3VjaGVkID0gKCkgPT4ge307IC8vIE5PU09OQVJcblxuICAvKipcbiAgICogTWV0aG9kIHRvIHJlZ2lzdGVyIGNoYW5nZSBldmVudCBoYW5kbGVyXG4gICAqXG4gICAqIEBwYXJhbSBmblxuICAgKi9cbiAgcmVnaXN0ZXJPbkNoYW5nZShmbjogYW55KSB7XG4gICAgdGhpcy5vbkNoYW5nZSA9IGZuO1xuICB9XG5cbiAgLyoqXG4gICAqIE1ldGhvZCB0byByZWdpc3RlciB0b3VjaGVkIGV2ZW50IGhhbmRsZXJcbiAgICpcbiAgICogQHBhcmFtIGZuXG4gICAqL1xuICByZWdpc3Rlck9uVG91Y2hlZChmbjogYW55KSB7XG4gICAgdGhpcy5vblRvdWNoZWQgPSBmbjtcbiAgfVxuXG4gIC8qKlxuICAgKiBNZXRob2QgdG8gd3JpdGUgaW5pdGlhbCB2YWx1ZSB0byB0aGUgaW5wdXRcbiAgICpcbiAgICogQHBhcmFtIHRpbWVcbiAgICovXG4gIHdyaXRlVmFsdWUodGltZTogbnVtYmVyKSB7XG4gICAgdGhpcy50aW1lQ29udHJvbC5zZXRWYWx1ZSh0aGlzLnRpbWVPcHRpb25zLmZpbmQodHMgPT4gdHMudGltZSA9PT0gdGltZSkpO1xuICB9XG5cbiAgbWFya0FzVG91Y2hlZChldmVudDogRXZlbnQpIHtcbiAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQgYXMgSFRNTFRleHRBcmVhRWxlbWVudDtcbiAgICB0YXJnZXQuYmx1cigpO1xuICAgIHRoaXMub25Ub3VjaGVkKCk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLmNvbXBvbmVudERlc3Ryb3llZCQubmV4dCh0cnVlKTtcbiAgfVxufVxuIiwiPGJiLWRyb3Bkb3duLXNpbmdsZS1zZWxlY3QtdWlcbiAgaWNvbk5hbWU9XCJjYXJldC1kb3duXCJcbiAgW29wdGlvbnNdPVwidGltZU9wdGlvbnNcIlxuICBbbGFiZWxdPVwibGFiZWxcIlxuICAoY2hhbmdlKT1cIm1hcmtBc1RvdWNoZWQoJGV2ZW50KVwiXG4gIFtmb3JtQ29udHJvbF09XCJ0aW1lQ29udHJvbFwiXG4gIGRpc3BsYXlBdHRyaWJ1dGVQYXRoPVwibGFiZWxcIlxuICBkYXRhLXJvbGU9XCJ0aW1lLXBpY2tlci1kcm9wZG93blwiXG4+XG48L2JiLWRyb3Bkb3duLXNpbmdsZS1zZWxlY3QtdWk+XG4iXX0=