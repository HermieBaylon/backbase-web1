import { Directive, EventEmitter, Input, Output, ViewChild, } from '@angular/core';
import { BehaviorSubject, combineLatest, iif, merge, of, ReplaySubject, Subject } from 'rxjs';
import { TransactionsBackendError } from '../model/transactions-backend-error.model';
import { map, mergeMap, publishReplay, refCount, scan, takeUntil, tap } from 'rxjs/operators';
import { filterInputParameters, notificationTtl } from '../constants';
import { combineExportTypesConfig, } from '../model/transactions-export-options.model';
import { BbTemplate } from '@backbase/foundation-ang/core';
import { getNameFromContentDispositionHeader } from '../model/transactions-list-utils.model';
import * as i0 from "@angular/core";
import * as i1 from "../services/transactions.service";
import * as i2 from "../services/widget-properties.service";
import * as i3 from "@backbase/ui-ang/notification";
import * as i4 from "../services/pending-transactions.service";
import * as i5 from "../services/transaction-details.service";
import * as i6 from "../services/available-filters-config.service";
// eslint-disable-next-line
export class BaseTransactionsContainer {
    constructor(model, widgetProperties, cd, eventBusService, notificationService, pendingTransactionsService, transactionDetailsService, availableFiltersConfigService, showDetailsConfig) {
        this.model = model;
        this.widgetProperties = widgetProperties;
        this.cd = cd;
        this.eventBusService = eventBusService;
        this.notificationService = notificationService;
        this.pendingTransactionsService = pendingTransactionsService;
        this.transactionDetailsService = transactionDetailsService;
        this.availableFiltersConfigService = availableFiltersConfigService;
        this.showDetailsConfig = showDetailsConfig;
        /**
         * Reference to instance of customizable component.
         */
        this.hostRef = this;
        this.apiKeySubject = new BehaviorSubject(undefined);
        /**
         * Observable of options to initialize the filter with.  By default, it is empty.
         */
        this.initialFilterOptions = of({});
        /**
         * Observable of options to initialize the sort options with.  By default, it is empty.
         */
        this.initialSortOptions = of(undefined);
        this.transactionSelected = new EventEmitter();
        this.transactionsLoaded = new EventEmitter();
        this.pageSizeSubject = new BehaviorSubject(undefined);
        this.maxNavPagesSubject = new BehaviorSubject(undefined);
        this.paginationTypeSubject = new BehaviorSubject(undefined);
        this.showControlsSubject = new BehaviorSubject(undefined);
        this.showChangeCategorySubject = new BehaviorSubject(undefined);
        this.showPendingTransactionsOnTopSubject = new BehaviorSubject(undefined);
        this.showCheckImageSubject = new BehaviorSubject(undefined);
        this.showManageNotesSubject = new BehaviorSubject(undefined);
        this.getOrPostEndpointsSubject = new BehaviorSubject(undefined);
        this.disputeByBillingStatusSubject = new BehaviorSubject(undefined);
        this.disputeEligibilityDaysSubject = new BehaviorSubject(undefined);
        this.disputeTransactionTypesSubject = new BehaviorSubject(undefined);
        this.enableDisputeAndInquirySubject = new BehaviorSubject(false);
        this.inquireTopicIdSubject = new BehaviorSubject('');
        this.disputeTopicIdSubject = new BehaviorSubject('');
        /**
         * Events registered to transactions widgets
         */
        this.registeredRefreshTransactionsListEvents = [];
        this.unsubscribeSubject = new Subject();
        /**
         * Subject that listens the transactionsList observable and provides the export types
         */
        this.exportConfig = new BehaviorSubject({});
        this.exportErrorMessagesRef = {};
        this.numberOfResultsFound = new ReplaySubject();
        this.numberOfResultsDisplayed = new ReplaySubject();
        this.availableFiltersConfig = new ReplaySubject(1);
        this.availableFilters = this.availableFiltersConfigService.availableFilters$;
        this.refreshTransactionsListHandler = () => {
            this.model.refreshTransactions();
        };
        /**
         * @deprecated will be removed in 11.0.0
         */
        this.handleError = (errorResponse) => {
            this.errors = TransactionsBackendError.fromHttpErrorsResponse(errorResponse);
            return of({
                items: [],
                totalCount: 0,
            });
        };
        this.inquireTopicId = filterInputParameters(this.inquireTopicIdSubject.asObservable(), this.widgetProperties.inquireTopicId);
        this.disputeTopicId = filterInputParameters(this.disputeTopicIdSubject.asObservable(), this.widgetProperties.disputeTopicId);
        this.inquireAndDisputeTopics = combineLatest([
            this.inquireTopicId,
            this.disputeTopicId,
        ]).pipe(map(([inquire, dispute]) => ({ inquire, dispute })));
    }
    /**
     * API key needed for the google maps to work.
     */
    // eslint-disable-next-line
    set googleAPIKey(key) {
        this.apiKeySubject.next(key);
    }
    /**
     * input parameters that will take the place of model properties--
     */
    set pageSizeValue(value) {
        this.pageSizeSubject.next(value);
    }
    set maxNavPagesValue(value) {
        this.maxNavPagesSubject.next(value);
    }
    set paginationTypeValue(value) {
        this.paginationTypeSubject.next(value);
    }
    set showControlsValue(value) {
        this.showControlsSubject.next(value);
    }
    set showChangeCategoryValue(value) {
        this.showChangeCategorySubject.next(value);
    }
    set showPendingTransactionsOnTopValue(value) {
        this.showPendingTransactionsOnTopSubject.next(value);
    }
    set showCheckImageValue(value) {
        this.showCheckImageSubject.next(value);
    }
    set showManageNotesValue(value) {
        this.showManageNotesSubject.next(value);
    }
    set getOrPostEndpointsValue(value) {
        this.getOrPostEndpointsSubject.next(value);
    }
    set disputeByBillingStatusValue(value) {
        this.disputeByBillingStatusSubject.next(typeof value === 'boolean' ? value : value === 'true');
    }
    set disputeEligibilityDaysValue(value) {
        this.disputeEligibilityDaysSubject.next(value);
    }
    set disputeTransactionTypesValue(value) {
        this.disputeTransactionTypesSubject.next((value || '').split(','));
    }
    set enableDisputeAndInquiryValue(value) {
        this.enableDisputeAndInquirySubject.next(typeof value === 'boolean' ? value : value === 'true');
    }
    set availableFiltersValue(availableFiltersConfig) {
        this.availableFiltersConfig.next(availableFiltersConfig);
    }
    /** end input parameters--- */
    /**
     * Information about the backend error, if it occurs.
     */
    /**
     * @deprecated will be removed in 11.0.0
     */
    get error() {
        return this.errors && this.errors[0];
    }
    clearRefreshTransactionsListEvents() {
        this.registeredRefreshTransactionsListEvents.forEach((eventName) => {
            this.eventBusService.unsubscribe(eventName, this.refreshTransactionsListHandler);
        });
        this.registeredRefreshTransactionsListEvents = [];
    }
    retry() {
        this.model.retryFiltering();
        this.pendingTransactionsService.retryFiltering();
    }
    ngOnDestroy() {
        this.clearRefreshTransactionsListEvents();
        this.unsubscribeSubject.next();
        this.unsubscribeSubject.complete();
    }
    get pageSize() {
        return filterInputParameters(this.pageSizeSubject.asObservable(), this.widgetProperties.pageSize);
    }
    get maxNavPages() {
        return filterInputParameters(this.maxNavPagesSubject.asObservable(), this.widgetProperties.maxNavPages);
    }
    get showControls() {
        return filterInputParameters(this.showControlsSubject.asObservable(), this.widgetProperties.showControls);
    }
    get isFilterApplied() {
        return this.model.isFilterApplied;
    }
    get isSearchApplied() {
        return this.model.isSearchApplied;
    }
    get paginationType() {
        return filterInputParameters(this.paginationTypeSubject.asObservable(), this.widgetProperties.paginationType);
    }
    get showPendingTransactionsOnTop() {
        return filterInputParameters(this.showPendingTransactionsOnTopSubject.asObservable(), this.widgetProperties.showPendingTransactionsOnTop);
    }
    get showChangeCategory() {
        return filterInputParameters(this.showChangeCategorySubject.asObservable(), this.widgetProperties.showChangeCategory);
    }
    get showCheckImage() {
        return filterInputParameters(this.showCheckImageSubject.asObservable(), this.widgetProperties.showCheckImage);
    }
    get showManageNotes() {
        return filterInputParameters(this.showManageNotesSubject, this.widgetProperties.showManageNotes);
    }
    get getOrPostEndpoint() {
        return filterInputParameters(this.getOrPostEndpointsSubject.asObservable(), this.widgetProperties.getOrPostEndpoints);
    }
    get gmapsAPIKey() {
        return combineLatest([this.apiKeySubject.asObservable(), this.widgetProperties.gmapsAPIKey]).pipe(map(([inputVal, propVal]) => inputVal || propVal));
    }
    get enableDisputeAndInquiry() {
        return filterInputParameters(this.enableDisputeAndInquirySubject.asObservable(), this.widgetProperties.enableDisputeAndInquiry);
    }
    get disputeByBillingStatus() {
        return filterInputParameters(this.disputeByBillingStatusSubject.asObservable(), this.widgetProperties.disputeByBillingStatus);
    }
    get disputeEligibilityDays() {
        return filterInputParameters(this.disputeEligibilityDaysSubject.asObservable(), this.widgetProperties.disputeEligibilityDays);
    }
    get disputeTransactionTypes() {
        return filterInputParameters(this.disputeTransactionTypesSubject.asObservable(), this.widgetProperties.disputeTransactionTypes);
    }
    onLoadMore() {
        this.model.loadMore();
    }
    ngOnInit() {
        if (typeof this.selectedAccount === 'undefined') {
            throw new Error(`"selectedAccount" input is required in "${this.constructor.name}"`);
        }
        const initialListOptions = combineLatest([
            this.initialFilterOptions,
            this.initialSortOptions,
        ]).pipe(map(([initialFilterOptions, initialSortOptions]) => ({
            filter: initialFilterOptions,
            sort: initialSortOptions,
        })));
        this.model.getTransactionsFrom(this.selectedAccount, this.pageSize, initialListOptions, this.showPendingTransactionsOnTop, this.getOrPostEndpoint);
        if (this.showDetailsConfig) {
            this.checkImagesList = this.transactionDetailsService.fromCheckImages(this.showCheckImage);
            this.transactionDetailsLoadingStatus = this.transactionDetailsService.loadingState;
            this.transactionDetailsService
                .fromGeolocation(this.gmapsAPIKey)
                .pipe(takeUntil(this.unsubscribeSubject))
                .subscribe();
        }
        this.transactionsList = this.model.getTransactionsList().pipe(publishReplay(1), refCount(), tap((data) => {
            this.errors = data.httpResponseError
                ? TransactionsBackendError.fromHttpErrorsResponse(data.httpResponseError)
                : undefined;
            this.cd.markForCheck();
        }));
        this.pendingTransactionsService.getTransactionsFrom(this.selectedAccount, initialListOptions, this.getOrPostEndpoint);
        this.pendingTransactionsList = this.pendingTransactionsService.getTransactionsList().pipe(publishReplay(1), refCount(), tap((data) => {
            this.errors = data.httpResponseError
                ? TransactionsBackendError.fromHttpErrorsResponse(data.httpResponseError)
                : undefined;
            this.cd.markForCheck();
        }));
        this.transactionsList
            .pipe(takeUntil(this.unsubscribeSubject), map((transactionsList) => {
            if (!transactionsList) {
                return {};
            }
            const { availableExportTypesHeader, unavailableExportTypesReasonsHeader } = transactionsList;
            return combineExportTypesConfig({
                availableExportTypesHeader,
                unavailableExportTypesReasonsHeader,
            });
        }))
            .subscribe(this.exportConfig);
        const transactionsListCount = this.transactionsList.pipe(map((trans) => ({ history: trans ? trans.totalCount : 0 })));
        const pendingTransactionsListCount = this.pendingTransactionsList.pipe(map((trans) => ({ pending: trans ? trans.totalCount : 0 })));
        const transactionsListItemsToDisplay = this.transactionsList.pipe(map((trans) => ({ history: trans ? trans.items.length : 0 })));
        const pendingTransactionsListItemsToDisplay = this.pendingTransactionsList.pipe(map((trans) => ({ pending: trans ? trans.items.length : 0 })));
        this.sumTransactionsResults(transactionsListCount, pendingTransactionsListCount)
            .pipe(takeUntil(this.unsubscribeSubject))
            .subscribe(this.numberOfResultsFound);
        this.sumTransactionsResults(transactionsListItemsToDisplay, pendingTransactionsListItemsToDisplay)
            .pipe(takeUntil(this.unsubscribeSubject))
            .subscribe(this.numberOfResultsDisplayed);
        this.currentPage = this.model.getCurrentPage();
        this.loadingState = this.model.loadingState;
        this.loadingPendingState = this.pendingTransactionsService.loadingState;
        this.widgetProperties.refreshTransactionsListEvents.pipe(takeUntil(this.unsubscribeSubject)).subscribe((events) => {
            this.clearRefreshTransactionsListEvents();
            if (events) {
                this.registeredRefreshTransactionsListEvents = events.split(',');
                this.registeredRefreshTransactionsListEvents.forEach((eventName) => {
                    this.eventBusService.subscribe(eventName, this.refreshTransactionsListHandler);
                });
            }
        });
        this.configureTransctionsDetailsOutputBehaviour();
        this.transactionDetailsService.fromInquiryAndDispute(this.enableDisputeAndInquiry, this.disputeByBillingStatus, this.disputeEligibilityDays, this.disputeTransactionTypes);
        this.availableFiltersConfigService.setFilterConfigurationAndAccount(this.availableFiltersConfig.asObservable(), this.selectedAccount);
    }
    configureTransctionsDetailsOutputBehaviour() {
        if (this.transactionsList && this.pendingTransactionsList && !this.showDetailsConfig) {
            const pending = this.showPendingTransactionsOnTop.pipe(mergeMap((cond) => iif(() => cond, this.pendingTransactionsList, of({ items: [], totalCount: 0 }))));
            combineLatest([pending, this.transactionsList])
                .pipe(takeUntil(this.unsubscribeSubject), map(([pendingTransactionsList, transactionsList]) => {
                const pendingTransactions = pendingTransactionsList ? pendingTransactionsList.items : [];
                const transactions = transactionsList ? transactionsList.items : [];
                const mixed = {
                    items: [...pendingTransactions, ...transactions],
                    totalCount: ((pendingTransactionsList === null || pendingTransactionsList === void 0 ? void 0 : pendingTransactionsList.totalCount) || 0) + ((transactionsList === null || transactionsList === void 0 ? void 0 : transactionsList.totalCount) || 0),
                };
                return mixed;
            }))
                .subscribe((data) => {
                this.transactionsLoaded.emit(data);
            });
        }
    }
    sumTransactionsResults(historyCount, pendingCount) {
        return this.showPendingTransactionsOnTop.pipe(mergeMap((showPendingTransactionsOnTop) => iif(() => showPendingTransactionsOnTop, merge(historyCount, pendingCount), historyCount)), scan((acc, curr) => (Object.assign(Object.assign({}, acc), curr)), { history: 0, pending: 0 }), map(({ history = 0, pending = 0 }) => history + pending));
    }
    onPageChange(page) {
        this.model.pageChange(page);
    }
    onSearch(query) {
        // search ui component sends an unexpected event
        // that is type Event. To avoid calling backend with that event
        // it has to be string
        if (typeof query === 'string') {
            this.model.search(query);
            this.pendingTransactionsService.search(query);
        }
    }
    onFilter(filterOptions) {
        this.model.filter(filterOptions);
        this.pendingTransactionsService.filter(filterOptions);
    }
    onSort(sortOptions) {
        this.model.sort(sortOptions);
    }
    onPrint() {
        window.print();
    }
    onExport(exportType) {
        this.storedExportType = Object.assign({}, exportType);
        if (exportType.isAvailable) {
            this.model
                .exportToType(exportType.name)
                .pipe(takeUntil(this.unsubscribeSubject))
                .subscribe((response) => {
                const anchorTag = document.createElement('a');
                anchorTag.href = URL.createObjectURL(response.body);
                const fileName = getNameFromContentDispositionHeader(response);
                const defaultName = exportType.name.toLowerCase() === 'pdf' ? 'Account Activities' : 'transactions';
                anchorTag.download = fileName !== '' ? fileName : defaultName;
                anchorTag.click();
            }, () => {
                this.notificationService.showNotification({
                    header: this.notificationServerErrorHeader,
                    message: this.notificationServerErrorMessage || '',
                    modifier: 'error',
                });
            });
        }
        else {
            this.pushNotification({
                header: this.notificationErrorUpdateHeaderTemplate,
                message: this.notificationErrorUpdateMessageTemplate,
                modifier: 'error',
            });
        }
    }
    onDetailOpen(transaction) {
        if (!this.showDetailsConfig) {
            this.transactionSelected.emit(transaction);
        }
        else {
            this.transactionDetailsService.selectTransaction(transaction);
        }
    }
    pushNotification(notificationMessage) {
        this.notificationService.showNotification(Object.assign({ dismissible: true, ttl: notificationTtl }, notificationMessage));
    }
}
BaseTransactionsContainer.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: BaseTransactionsContainer, deps: "invalid", target: i0.ɵɵFactoryTarget.Directive });
BaseTransactionsContainer.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "12.0.0", version: "12.2.16", type: BaseTransactionsContainer, inputs: { googleAPIKey: "googleAPIKey", selectedAccount: "selectedAccount", initialFilterOptions: "initialFilterOptions", initialSortOptions: "initialSortOptions", pageSizeValue: ["pageSize", "pageSizeValue"], maxNavPagesValue: ["maxNavPages", "maxNavPagesValue"], paginationTypeValue: ["paginationType", "paginationTypeValue"], showControlsValue: ["showControls", "showControlsValue"], showChangeCategoryValue: ["showChangeCategory", "showChangeCategoryValue"], showPendingTransactionsOnTopValue: ["showPendingTransactionsOnTop", "showPendingTransactionsOnTopValue"], showCheckImageValue: ["showCheckImage", "showCheckImageValue"], showManageNotesValue: ["showManageNotes", "showManageNotesValue"], getOrPostEndpointsValue: ["getOrPostEndpoints", "getOrPostEndpointsValue"], disputeByBillingStatusValue: ["disputeByBillingStatus", "disputeByBillingStatusValue"], disputeEligibilityDaysValue: ["disputeEligibilityDays", "disputeEligibilityDaysValue"], disputeTransactionTypesValue: ["disputeTransactionTypes", "disputeTransactionTypesValue"], enableDisputeAndInquiryValue: ["enableDisputeAndInquiry", "enableDisputeAndInquiryValue"], availableFiltersValue: ["availableFiltersConfig", "availableFiltersValue"], inquireTopicIdValue: ["inquireTopicId", "inquireTopicIdValue"], disputeTopicIdValue: ["disputeTopicId", "disputeTopicIdValue"] }, outputs: { transactionSelected: "transactionSelected", transactionsLoaded: "transactionsLoaded" }, viewQueries: [{ propertyName: "notificationErrorUpdateHeaderTemplate", first: true, predicate: ["notificationErrorUpdateHeader"], descendants: true }, { propertyName: "notificationErrorUpdateMessageTemplate", first: true, predicate: ["notificationErrorUpdateMessage"], descendants: true }, { propertyName: "notificationServerErrorHeader", first: true, predicate: ["notificationServerErrorHeader"], descendants: true }, { propertyName: "notificationServerErrorMessage", first: true, predicate: ["notificationServerErrorMessage"], descendants: true }], ngImport: i0 });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: BaseTransactionsContainer, decorators: [{
            type: Directive
        }], ctorParameters: function () { return [{ type: i1.TransactionsService }, { type: i2.WidgetPropertiesService }, { type: i0.ChangeDetectorRef }, { type: undefined }, { type: i3.NotificationService }, { type: i4.PendingTransactionsService }, { type: i5.TransactionDetailsService }, { type: i6.AvailableFiltersConfigService }, { type: undefined }]; }, propDecorators: { notificationErrorUpdateHeaderTemplate: [{
                type: ViewChild,
                args: ['notificationErrorUpdateHeader']
            }], notificationErrorUpdateMessageTemplate: [{
                type: ViewChild,
                args: ['notificationErrorUpdateMessage']
            }], notificationServerErrorHeader: [{
                type: ViewChild,
                args: ['notificationServerErrorHeader', { static: false }]
            }], notificationServerErrorMessage: [{
                type: ViewChild,
                args: ['notificationServerErrorMessage', { static: false }]
            }], googleAPIKey: [{
                type: Input
            }], selectedAccount: [{
                type: Input
            }], initialFilterOptions: [{
                type: Input
            }], initialSortOptions: [{
                type: Input
            }], pageSizeValue: [{
                type: Input,
                args: ['pageSize']
            }], maxNavPagesValue: [{
                type: Input,
                args: ['maxNavPages']
            }], paginationTypeValue: [{
                type: Input,
                args: ['paginationType']
            }], showControlsValue: [{
                type: Input,
                args: ['showControls']
            }], showChangeCategoryValue: [{
                type: Input,
                args: ['showChangeCategory']
            }], showPendingTransactionsOnTopValue: [{
                type: Input,
                args: ['showPendingTransactionsOnTop']
            }], showCheckImageValue: [{
                type: Input,
                args: ['showCheckImage']
            }], showManageNotesValue: [{
                type: Input,
                args: ['showManageNotes']
            }], getOrPostEndpointsValue: [{
                type: Input,
                args: ['getOrPostEndpoints']
            }], disputeByBillingStatusValue: [{
                type: Input,
                args: ['disputeByBillingStatus']
            }], disputeEligibilityDaysValue: [{
                type: Input,
                args: ['disputeEligibilityDays']
            }], disputeTransactionTypesValue: [{
                type: Input,
                args: ['disputeTransactionTypes']
            }], enableDisputeAndInquiryValue: [{
                type: Input,
                args: ['enableDisputeAndInquiry']
            }], availableFiltersValue: [{
                type: Input,
                args: ['availableFiltersConfig']
            }], inquireTopicIdValue: [{
                type: Input,
                args: ['inquireTopicId']
            }], disputeTopicIdValue: [{
                type: Input,
                args: ['disputeTopicId']
            }], transactionSelected: [{
                type: Output
            }], transactionsLoaded: [{
                type: Output
            }] } });
export class TransactionsNoAccountSelectedStateCustomizableDirective extends BbTemplate {
}
TransactionsNoAccountSelectedStateCustomizableDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: TransactionsNoAccountSelectedStateCustomizableDirective, deps: null, target: i0.ɵɵFactoryTarget.Directive });
TransactionsNoAccountSelectedStateCustomizableDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "12.0.0", version: "12.2.16", type: TransactionsNoAccountSelectedStateCustomizableDirective, selector: "[bbTransactionsNoAccountSelectedStateCustomizable]", usesInheritance: true, ngImport: i0 });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: TransactionsNoAccountSelectedStateCustomizableDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[bbTransactionsNoAccountSelectedStateCustomizable]',
                }]
        }] });
export class TransactionsErrorStateCustomizableDirective extends BbTemplate {
}
TransactionsErrorStateCustomizableDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: TransactionsErrorStateCustomizableDirective, deps: null, target: i0.ɵɵFactoryTarget.Directive });
TransactionsErrorStateCustomizableDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "12.0.0", version: "12.2.16", type: TransactionsErrorStateCustomizableDirective, selector: "[bbTransactionsErrorStateCustomizable]", usesInheritance: true, ngImport: i0 });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: TransactionsErrorStateCustomizableDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[bbTransactionsErrorStateCustomizable]',
                }]
        }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS10cmFuc2FjdGlvbnMtY29udGFpbmVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vbGlicy90cmFuc2FjdGlvbnMtY29tbW9uLWFuZy9zcmMvY29tcG9uZW50cy9iYXNlLXRyYW5zYWN0aW9ucy1jb250YWluZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUVMLFNBQVMsRUFDVCxZQUFZLEVBQ1osS0FBSyxFQUdMLE1BQU0sRUFFTixTQUFTLEdBQ1YsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLGVBQWUsRUFBRSxhQUFhLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBYyxFQUFFLEVBQUUsYUFBYSxFQUFFLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUMxRyxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSwyQ0FBMkMsQ0FBQztBQU1yRixPQUFPLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxhQUFhLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFJOUYsT0FBTyxFQUFFLHFCQUFxQixFQUFFLGVBQWUsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUN0RSxPQUFPLEVBQ0wsd0JBQXdCLEdBR3pCLE1BQU0sNENBQTRDLENBQUM7QUFNcEQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQzNELE9BQU8sRUFBRSxtQ0FBbUMsRUFBRSxNQUFNLHdDQUF3QyxDQUFDOzs7Ozs7OztBQVE3RiwyQkFBMkI7QUFDM0IsTUFBTSxPQUFPLHlCQUF5QjtJQXNpQnBDLFlBQ3FCLEtBQTBCLEVBQzFCLGdCQUF5QyxFQUN6QyxFQUFxQixFQUNyQixlQUF1QixFQUN2QixtQkFBd0MsRUFDeEMsMEJBQXNELEVBQ3RELHlCQUFvRCxFQUNwRCw2QkFBNEQsRUFDNUQsaUJBQTJCO1FBUjNCLFVBQUssR0FBTCxLQUFL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c0JBQTNDLEtBQUs7dUJBQUMsY0FBYztnQkFHWSx1QkFBdUI7c0JBQXZELEtBQUs7dUJBQUMsb0JBQW9CO2dCQUdnQixpQ0FBaUM7c0JBQTNFLEtBQUs7dUJBQUMsOEJBQThCO2dCQUdSLG1CQUFtQjtzQkFBL0MsS0FBSzt1QkFBQyxnQkFBZ0I7Z0JBR08sb0JBQW9CO3NCQUFqRCxLQUFLO3VCQUFDLGlCQUFpQjtnQkFHUyx1QkFBdUI7c0JBQXZELEtBQUs7dUJBQUMsb0JBQW9CO2dCQUdVLDJCQUEyQjtzQkFBL0QsS0FBSzt1QkFBQyx3QkFBd0I7Z0JBR00sMkJBQTJCO3NCQUEvRCxLQUFLO3VCQUFDLHdCQUF3QjtnQkFHTyw0QkFBNEI7c0JBQWpFLEtBQUs7dUJBQUMseUJBQXlCO2dCQUlNLDRCQUE0QjtzQkFBakUsS0FBSzt1QkFBQyx5QkFBeUI7Z0JBR0sscUJBQXFCO3NCQUF6RCxLQUFLO3VCQUFDLHdCQUF3QjtnQkFJTixtQkFBbUI7c0JBQTNDLEtBQUs7dUJBQUMsZ0JBQWdCO2dCQUNFLG1CQUFtQjtzQkFBM0MsS0FBSzt1QkFBQyxnQkFBZ0I7Z0JBRWIsbUJBQW1CO3NCQUE1QixNQUFNO2dCQUNHLGtCQUFrQjtzQkFBM0IsTUFBTTs7QUE2ZFQsTUFBTSxPQUFPLHVEQUF3RCxTQUFRLFVBRzVFOztxSkFIWSx1REFBdUQ7eUlBQXZELHVEQUF1RDs0RkFBdkQsdURBQXVEO2tCQUhuRSxTQUFTO21CQUFDO29CQUNULFFBQVEsRUFBRSxvREFBb0Q7aUJBQy9EOztBQVNELE1BQU0sT0FBTywyQ0FBNEMsU0FBUSxVQUFnRDs7eUlBQXBHLDJDQUEyQzs2SEFBM0MsMkNBQTJDOzRGQUEzQywyQ0FBMkM7a0JBSHZELFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLHdDQUF3QztpQkFDbkQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgRGlyZWN0aXZlLFxuICBFdmVudEVtaXR0ZXIsXG4gIElucHV0LFxuICBPbkRlc3Ryb3ksXG4gIE9uSW5pdCxcbiAgT3V0cHV0LFxuICBUZW1wbGF0ZVJlZixcbiAgVmlld0NoaWxkLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgY29tYmluZUxhdGVzdCwgaWlmLCBtZXJnZSwgT2JzZXJ2YWJsZSwgb2YsIFJlcGxheVN1YmplY3QsIFN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IFRyYW5zYWN0aW9uc0JhY2tlbmRFcnJvciB9IGZyb20gJy4uL21vZGVsL3RyYW5zYWN0aW9ucy1iYWNrZW5kLWVycm9yLm1vZGVsJztcbmltcG9ydCB7IFRyYW5zYWN0aW9uc0ZpbHRlck9wdGlvbnMgfSBmcm9tICcuLi9tb2RlbC90cmFuc2FjdGlvbnMtZmlsdGVyLW9wdGlvbnMubW9kZWwnO1xuaW1wb3J0IHsgVHJhbnNhY3Rpb25zTGlzdCB9IGZyb20gJy4uL21vZGVsL3RyYW5zYWN0aW9ucy1saXN0Lm1vZGVsJztcbmltcG9ydCB7IExvYWRpbmdTdGF0ZSwgVHJhbnNhY3Rpb25zU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL3RyYW5zYWN0aW9ucy5zZXJ2aWNlJztcbmltcG9ydCB7IEVuZHBvaW50VHlwZSwgUGFnaW5hdGlvblR5cGUsIFdpZGdldFByb3BlcnRpZXNTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvd2lkZ2V0LXByb3BlcnRpZXMuc2VydmljZSc7XG5pbXBvcnQgeyBUcmFuc2FjdGlvbnNMaXN0T3B0aW9ucyB9IGZyb20gJy4uL21vZGVsL3RyYW5zYWN0aW9ucy1saXN0LW9wdGlvbnMubW9kZWwnO1xuaW1wb3J0IHsgbWFwLCBtZXJnZU1hcCwgcHVibGlzaFJlcGxheSwgcmVmQ291bnQsIHNjYW4sIHRha2VVbnRpbCwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgUHVic3ViIH0gZnJvbSAnQGJhY2tiYXNlL2ZvdW5kYXRpb24tYW5nL3dlYi1zZGsnO1xuaW1wb3J0IHsgVHJhbnNhY3Rpb25zU29ydE9wdGlvbnMgfSBmcm9tICcuLi9tb2RlbC90cmFuc2FjdGlvbnMtc29ydC1vcHRpb25zLm1vZGVsJztcblxuaW1wb3J0IHsgZmlsdGVySW5wdXRQYXJhbWV0ZXJzLCBub3RpZmljYXRpb25UdGwgfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHtcbiAgY29tYmluZUV4cG9ydFR5cGVzQ29uZmlnLFxuICBUcmFuc2FjdGlvbnNFeHBvcnRDb25maWcsXG4gIFRyYW5zYWN0aW9uc0V4cG9ydFR5cGVFbGVtZW50LFxufSBmcm9tICcuLi9tb2RlbC90cmFuc2FjdGlvbnMtZXhwb3J0LW9wdGlvbnMubW9kZWwnO1xuaW1wb3J0IHsgUGVuZGluZ1RyYW5zYWN0aW9uc1NlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9wZW5kaW5nLXRyYW5zYWN0aW9ucy5zZXJ2aWNlJztcbmltcG9ydCB7IFRyYW5zYWN0aW9uQ2hlY2tJbWFnZVJlc3BvbnNlIH0gZnJvbSAnLi4vbW9kZWwvdHJhbnNhY3Rpb25zLWNoZWNrLWltYWdlcy5tb2RlbCc7XG5pbXBvcnQgeyBUcmFuc2FjdGlvbiB9IGZyb20gJy4uL21vZGVsL3RyYW5zYWN0aW9uLm1vZGVsJztcbmltcG9ydCB7IFRyYW5zYWN0aW9uRGV0YWlsc1NlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy90cmFuc2FjdGlvbi1kZXRhaWxzLnNlcnZpY2UnO1xuaW1wb3J0IHsgVHJhbnNhY3Rpb25zRGV0YWlsc0xvYWRpbmcgfSBmcm9tICcuLi9tb2RlbC90cmFuc2FjdGlvbnMtZGV0YWlscy5tb2RlbCc7XG5pbXBvcnQgeyBCYlRlbXBsYXRlIH0gZnJvbSAnQGJhY2tiYXNlL2ZvdW5kYXRpb24tYW5nL2NvcmUnO1xuaW1wb3J0IHsgZ2V0TmFtZUZyb21Db250ZW50RGlzcG9zaXRpb25IZWFkZXIgfSBmcm9tICcuLi9tb2RlbC90cmFuc2FjdGlvbnMtbGlzdC11dGlscy5tb2RlbCc7XG5pbXBvcnQgeyBIdHRwRXJyb3JSZXNwb25zZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7IElucXVpcmVBbmREaXNwdXRlVG9waWNzIH0gZnJvbSAnLi4vbW9kZWwvbWVzc2FnZXMubW9kZWwnO1xuaW1wb3J0IHsgQXZhaWxhYmxlRmlsdGVycywgQXZhaWxhYmxlRmlsdGVyc0NvbmZpZyB9IGZyb20gJy4uL21vZGVsL2F2YWlsYWJsZS1maWx0ZXJzLm1vZGVsJztcbmltcG9ydCB7IEF2YWlsYWJsZUZpbHRlcnNDb25maWdTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvYXZhaWxhYmxlLWZpbHRlcnMtY29uZmlnLnNlcnZpY2UnO1xuaW1wb3J0IHsgTm90aWZpY2F0aW9uU2VydmljZSB9IGZyb20gJ0BiYWNrYmFzZS91aS1hbmcvbm90aWZpY2F0aW9uJztcblxuQERpcmVjdGl2ZSgpXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbmV4cG9ydCBjbGFzcyBCYXNlVHJhbnNhY3Rpb25zQ29udGFpbmVyIGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgQFZpZXdDaGlsZCgnbm90aWZpY2F0aW9uRXJyb3JVcGRhdGVIZWFkZXInKSBub3RpZmljYXRpb25FcnJvclVwZGF0ZUhlYWRlclRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxzdHJpbmc+IHwgdW5kZWZpbmVkO1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgQFZpZXdDaGlsZCgnbm90aWZpY2F0aW9uRXJyb3JVcGRhdGVNZXNzYWdlJykgbm90aWZpY2F0aW9uRXJyb3JVcGRhdGVNZXNzYWdlVGVtcGxhdGU6IFRlbXBsYXRlUmVmPHN0cmluZz4gfCB1bmRlZmluZWQ7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICBAVmlld0NoaWxkKCdub3RpZmljYXRpb25TZXJ2ZXJFcnJvckhlYWRlcicsIHsgc3RhdGljOiBmYWxzZSB9KVxuICBub3RpZmljYXRpb25TZXJ2ZXJFcnJvckhlYWRlcjogVGVtcGxhdGVSZWY8c3RyaW5nPiB8IHVuZGVmaW5lZDtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gIEBWaWV3Q2hpbGQoJ25vdGlmaWNhdGlvblNlcnZlckVycm9yTWVzc2FnZScsIHsgc3RhdGljOiBmYWxzZSB9KVxuICBub3RpZmljYXRpb25TZXJ2ZXJFcnJvck1lc3NhZ2U6IFRlbXBsYXRlUmVmPHN0cmluZz4gfCB1bmRlZmluZWQ7XG4gIC8qKlxuICAgKiBSZWZlcmVuY2UgdG8gaW5zdGFuY2Ugb2YgY3VzdG9taXphYmxlIGNvbXBvbmVudC5cbiAgICovXG4gIHJlYWRvbmx5IGhvc3RSZWYgPSB0aGlzO1xuICBwcml2YXRlIHJlYWRvbmx5IGFwaUtleVN1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PHN0cmluZyB8IHVuZGVmaW5lZD4odW5kZWZpbmVkKTtcbiAgLyoqXG4gICAqIEFQSSBrZXkgbmVlZGVkIGZvciB0aGUgZ29vZ2xlIG1hcHMgdG8gd29yay5cbiAgICovXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICBASW5wdXQoKVxuICBzZXQgZ29vZ2xlQVBJS2V5KGtleTogc3RyaW5nIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5hcGlLZXlTdWJqZWN0Lm5leHQoa2V5KTtcbiAgfVxuICAvKipcbiAgICogT2JzZXJ2YWJsZSBvZiB0aGUgYXJyYW5nZW1lbnQgSUQgdGhpcyBjb21wb25lbnQgc2hvdWxkIHJldHJpZXZlIHRoZSB0cmFuc2FjdGlvbnMgZm9yLlxuICAgKi9cbiAgQElucHV0KCkgc2VsZWN0ZWRBY2NvdW50OiBPYnNlcnZhYmxlPEFycmF5PHN0cmluZz4+IHwgdW5kZWZpbmVkO1xuICAvKipcbiAgICogT2JzZXJ2YWJsZSBvZiBvcHRpb25zIHRvIGluaXRpYWxpemUgdGhlIGZpbHRlciB3aXRoLiAgQnkgZGVmYXVsdCwgaXQgaXMgZW1wdHkuXG4gICAqL1xuICBASW5wdXQoKSBpbml0aWFsRmlsdGVyT3B0aW9uczogT2JzZXJ2YWJsZTxUcmFuc2FjdGlvbnNGaWx0ZXJPcHRpb25zPiA9IG9mKHt9KTtcbiAgLyoqXG4gICAqIE9ic2VydmFibGUgb2Ygb3B0aW9ucyB0byBpbml0aWFsaXplIHRoZSBzb3J0IG9wdGlvbnMgd2l0aC4gIEJ5IGRlZmF1bHQsIGl0IGlzIGVtcHR5LlxuICAgKi9cbiAgQElucHV0KCkgaW5pdGlhbFNvcnRPcHRpb25zOiBPYnNlcnZhYmxlPFRyYW5zYWN0aW9uc1NvcnRPcHRpb25zIHwgdW5kZWZpbmVkPiA9IG9mKHVuZGVmaW5lZCk7XG5cbiAgLyoqXG4gICAqIGlucHV0IHBhcmFtZXRlcnMgdGhhdCB3aWxsIHRha2UgdGhlIHBsYWNlIG9mIG1vZGVsIHByb3BlcnRpZXMtLVxuICAgKi9cblxuICBASW5wdXQoJ3BhZ2VTaXplJykgc2V0IHBhZ2VTaXplVmFsdWUodmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMucGFnZVNpemVTdWJqZWN0Lm5leHQodmFsdWUpO1xuICB9XG4gIEBJbnB1dCgnbWF4TmF2UGFnZXMnKSBzZXQgbWF4TmF2UGFnZXNWYWx1ZSh2YWx1ZTogbnVtYmVyKSB7XG4gICAgdGhpcy5tYXhOYXZQYWdlc1N1YmplY3QubmV4dCh2YWx1ZSk7XG4gIH1cbiAgQElucHV0KCdwYWdpbmF0aW9uVHlwZScpIHNldCBwYWdpbmF0aW9uVHlwZVZhbHVlKHZhbHVlOiBzdHJpbmcpIHtcbiAgICB0aGlzLnBhZ2luYXRpb25UeXBlU3ViamVjdC5uZXh0KHZhbHVlIGFzIFBhZ2luYXRpb25UeXBlKTtcbiAgfVxuICBASW5wdXQoJ3Nob3dDb250cm9scycpIHNldCBzaG93Q29udHJvbHNWYWx1ZSh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuc2hvd0NvbnRyb2xzU3ViamVjdC5uZXh0KHZhbHVlKTtcbiAgfVxuICBASW5wdXQoJ3Nob3dDaGFuZ2VDYXRlZ29yeScpIHNldCBzaG93Q2hhbmdlQ2F0ZWdvcnlWYWx1ZSh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuc2hvd0NoYW5nZUNhdGVnb3J5U3ViamVjdC5uZXh0KHZhbHVlKTtcbiAgfVxuICBASW5wdXQoJ3Nob3dQZW5kaW5nVHJhbnNhY3Rpb25zT25Ub3AnKSBzZXQgc2hvd1BlbmRpbmdUcmFuc2FjdGlvbnNPblRvcFZhbHVlKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpcy5zaG93UGVuZGluZ1RyYW5zYWN0aW9uc09uVG9wU3ViamVjdC5uZXh0KHZhbHVlKTtcbiAgfVxuICBASW5wdXQoJ3Nob3dDaGVja0ltYWdlJykgc2V0IHNob3dDaGVja0ltYWdlVmFsdWUodmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLnNob3dDaGVja0ltYWdlU3ViamVjdC5uZXh0KHZhbHVlKTtcbiAgfVxuICBASW5wdXQoJ3Nob3dNYW5hZ2VOb3RlcycpIHNldCBzaG93TWFuYWdlTm90ZXNWYWx1ZSh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuc2hvd01hbmFnZU5vdGVzU3ViamVjdC5uZXh0KHZhbHVlKTtcbiAgfVxuICBASW5wdXQoJ2dldE9yUG9zdEVuZHBvaW50cycpIHNldCBnZXRPclBvc3RFbmRwb2ludHNWYWx1ZSh2YWx1ZTogRW5kcG9pbnRUeXBlKSB7XG4gICAgdGhpcy5nZXRPclBvc3RFbmRwb2ludHNTdWJqZWN0Lm5leHQodmFsdWUpO1xuICB9XG4gIEBJbnB1dCgnZGlzcHV0ZUJ5QmlsbGluZ1N0YXR1cycpIHNldCBkaXNwdXRlQnlCaWxsaW5nU3RhdHVzVmFsdWUodmFsdWU6IHN0cmluZyB8IGJvb2xlYW4pIHtcbiAgICB0aGlzLmRpc3B1dGVCeUJpbGxpbmdTdGF0dXNTdWJqZWN0Lm5leHQodHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicgPyB2YWx1ZSA6IHZhbHVlID09PSAndHJ1ZScpO1xuICB9XG4gIEBJbnB1dCgnZGlzcHV0ZUVsaWdpYmlsaXR5RGF5cycpIHNldCBkaXNwdXRlRWxpZ2liaWxpdHlEYXlzVmFsdWUodmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuZGlzcHV0ZUVsaWdpYmlsaXR5RGF5c1N1YmplY3QubmV4dCh2YWx1ZSk7XG4gIH1cbiAgQElucHV0KCdkaXNwdXRlVHJhbnNhY3Rpb25UeXBlcycpIHNldCBkaXNwdXRlVHJhbnNhY3Rpb25UeXBlc1ZhbHVlKHZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLmRpc3B1dGVUcmFuc2FjdGlvblR5cGVzU3ViamVjdC5uZXh0KCh2YWx1ZSB8fCAnJykuc3BsaXQoJywnKSk7XG4gIH1cblxuICBASW5wdXQoJ2VuYWJsZURpc3B1dGVBbmRJbnF1aXJ5Jykgc2V0IGVuYWJsZURpc3B1dGVBbmRJbnF1aXJ5VmFsdWUodmFsdWU6IHN0cmluZyB8IGJvb2xlYW4pIHtcbiAgICB0aGlzLmVuYWJsZURpc3B1dGVBbmRJbnF1aXJ5U3ViamVjdC5uZXh0KHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nID8gdmFsdWUgOiB2YWx1ZSA9PT0gJ3RydWUnKTtcbiAgfVxuICBASW5wdXQoJ2F2YWlsYWJsZUZpbHRlcnNDb25maWcnKSBzZXQgYXZhaWxhYmxlRmlsdGVyc1ZhbHVlKGF2YWlsYWJsZUZpbHRlcnNDb25maWc6IEF2YWlsYWJsZUZpbHRlcnNDb25maWcpIHtcbiAgICB0aGlzLmF2YWlsYWJsZUZpbHRlcnNDb25maWcubmV4dChhdmFpbGFibGVGaWx0ZXJzQ29uZmlnKTtcbiAgfVxuXG4gIEBJbnB1dCgnaW5xdWlyZVRvcGljSWQnKSBpbnF1aXJlVG9waWNJZFZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gIEBJbnB1dCgnZGlzcHV0ZVRvcGljSWQnKSBkaXNwdXRlVG9waWNJZFZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG5cbiAgQE91dHB1dCgpIHRyYW5zYWN0aW9uU2VsZWN0ZWQgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcbiAgQE91dHB1dCgpIHRyYW5zYWN0aW9uc0xvYWRlZCA9IG5ldyBFdmVudEVtaXR0ZXI8VHJhbnNhY3Rpb25zTGlzdCB8IG51bGw+KCk7XG5cbiAgcHJpdmF0ZSBwYWdlU2l6ZVN1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PG51bWJlciB8IHVuZGVmaW5lZD4odW5kZWZpbmVkKTtcbiAgcHJpdmF0ZSBtYXhOYXZQYWdlc1N1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PG51bWJlciB8IHVuZGVmaW5lZD4odW5kZWZpbmVkKTtcbiAgcHJpdmF0ZSBwYWdpbmF0aW9uVHlwZVN1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PFBhZ2luYXRpb25UeXBlIHwgdW5kZWZpbmVkPih1bmRlZmluZWQpO1xuICBwcml2YXRlIHNob3dDb250cm9sc1N1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4gfCB1bmRlZmluZWQ+KHVuZGVmaW5lZCk7XG4gIHByaXZhdGUgc2hvd0NoYW5nZUNhdGVnb3J5U3ViamVjdCA9IG5ldyBCZWhhdmlvclN1YmplY3Q8Ym9vbGVhbiB8IHVuZGVmaW5lZD4odW5kZWZpbmVkKTtcbiAgcHJpdmF0ZSBzaG93UGVuZGluZ1RyYW5zYWN0aW9uc09uVG9wU3ViamVjdCA9IG5ldyBCZWhhdmlvclN1YmplY3Q8Ym9vbGVhbiB8IHVuZGVmaW5lZD4odW5kZWZpbmVkKTtcbiAgcHJpdmF0ZSBzaG93Q2hlY2tJbWFnZVN1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4gfCB1bmRlZmluZWQ+KHVuZGVmaW5lZCk7XG4gIHByaXZhdGUgc2hvd01hbmFnZU5vdGVzU3ViamVjdCA9IG5ldyBCZWhhdmlvclN1YmplY3Q8Ym9vbGVhbiB8IHVuZGVmaW5lZD4odW5kZWZpbmVkKTtcbiAgcHJpdmF0ZSBnZXRPclBvc3RFbmRwb2ludHNTdWJqZWN0ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxFbmRwb2ludFR5cGUgfCB1bmRlZmluZWQ+KHVuZGVmaW5lZCk7XG4gIHByaXZhdGUgZGlzcHV0ZUJ5QmlsbGluZ1N0YXR1c1N1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4gfCB1bmRlZmluZWQ+KHVuZGVmaW5lZCk7XG4gIHByaXZhdGUgZGlzcHV0ZUVsaWdpYmlsaXR5RGF5c1N1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PG51bWJlciB8IHVuZGVmaW5lZD4odW5kZWZpbmVkKTtcbiAgcHJpdmF0ZSBkaXNwdXRlVHJhbnNhY3Rpb25UeXBlc1N1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PEFycmF5PHN0cmluZz4gfCB1bmRlZmluZWQ+KHVuZGVmaW5lZCk7XG4gIHByaXZhdGUgZW5hYmxlRGlzcHV0ZUFuZElucXVpcnlTdWJqZWN0ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxib29sZWFuPihmYWxzZSk7XG4gIHByaXZhdGUgaW5xdWlyZVRvcGljSWRTdWJqZWN0ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxzdHJpbmc+KCcnKTtcbiAgcHJpdmF0ZSBkaXNwdXRlVG9waWNJZFN1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PHN0cmluZz4oJycpO1xuICAvKiogZW5kIGlucHV0IHBhcmFtZXRlcnMtLS0gKi9cblxuICAvKipcbiAgICogSW5mb3JtYXRpb24gYWJvdXQgdGhlIGJhY2tlbmQgZXJyb3IsIGlmIGl0IG9jY3Vycy5cbiAgICovXG4gIC8qKlxuICAgKiBAZGVwcmVjYXRlZCB3aWxsIGJlIHJlbW92ZWQgaW4gMTEuMC4wXG4gICAqL1xuICBnZXQgZXJyb3IoKTogVHJhbnNhY3Rpb25zQmFja2VuZEVycm9yIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5lcnJvcnMgJiYgdGhpcy5lcnJvcnNbMF07XG4gIH1cblxuICBlcnJvcnM6IFRyYW5zYWN0aW9uc0JhY2tlbmRFcnJvcltdIHwgdW5kZWZpbmVkO1xuICAvKipcbiAgICogT2JzZXJ2YWJsZSBvZiB0aGUgdHJhbnNhY3Rpb25zIGxpc3QuXG4gICAqL1xuICB0cmFuc2FjdGlvbnNMaXN0OiBPYnNlcnZhYmxlPFRyYW5zYWN0aW9uc0xpc3QgfCBudWxsPiB8IHVuZGVmaW5lZDtcbiAgLyoqXG4gICAqIE9ic2VydmFibGUgb2YgdGhlIHRyYW5zYWN0aW9ucyBsaXN0LlxuICAgKi9cbiAgcGVuZGluZ1RyYW5zYWN0aW9uc0xpc3Q6IE9ic2VydmFibGU8VHJhbnNhY3Rpb25zTGlzdCB8IG51bGw+IHwgdW5kZWZpbmVkO1xuICAvKipcbiAgICogT2JzZXJ2YWJsZSBvZiB0aGUgY3VycmVudCBwYWdlLlxuICAgKi9cbiAgY3VycmVudFBhZ2U6IE9ic2VydmFibGU8bnVtYmVyPiB8IHVuZGVmaW5lZDtcbiAgLyoqXG4gICAqIE9ic2VydmFibGUgb2YgdGhlIGxvYWRpbmcgc3RhdGUgb2YgdGhlIHNlcnZpY2UuXG4gICAqL1xuICBsb2FkaW5nU3RhdGU6IE9ic2VydmFibGU8TG9hZGluZ1N0YXRlPiB8IHVuZGVmaW5lZDtcbiAgLyoqXG4gICAqIE9ic2VydmFibGUgb2YgdGhlIGxvYWRpbmcgc3RhdGUgb2YgdGhlIHBlbmRpbmcgdHJhbnNhY3Rpb25zIHNlcnZpY2UuXG4gICAqL1xuICBsb2FkaW5nUGVuZGluZ1N0YXRlOiBPYnNlcnZhYmxlPExvYWRpbmdTdGF0ZT4gfCB1bmRlZmluZWQ7XG4gIGxvYWRpbmdEZXRhaWxzOiBPYnNlcnZhYmxlPFRyYW5zYWN0aW9uc0RldGFpbHNMb2FkaW5nPiB8IHVuZGVmaW5lZDtcbiAgLyoqXG4gICAqIEV2ZW50cyByZWdpc3RlcmVkIHRvIHRyYW5zYWN0aW9ucyB3aWRnZXRzXG4gICAqL1xuICBwcml2YXRlIHJlZ2lzdGVyZWRSZWZyZXNoVHJhbnNhY3Rpb25zTGlzdEV2ZW50czogc3RyaW5nW10gPSBbXTtcbiAgcHJpdmF0ZSB1bnN1YnNjcmliZVN1YmplY3QgPSBuZXcgU3ViamVjdDx2b2lkPigpO1xuICAvKipcbiAgICogU3ViamVjdCB0aGF0IGxpc3RlbnMgdGhlIHRyYW5zYWN0aW9uc0xpc3Qgb2JzZXJ2YWJsZSBhbmQgcHJvdmlkZXMgdGhlIGV4cG9ydCB0eXBlc1xuICAgKi9cbiAgZXhwb3J0Q29uZmlnID0gbmV3IEJlaGF2aW9yU3ViamVjdDxUcmFuc2FjdGlvbnNFeHBvcnRDb25maWc+KHt9KTtcbiAgZXhwb3J0RXJyb3JNZXNzYWdlc1JlZjogeyBba2V5OiBzdHJpbmddOiBUZW1wbGF0ZVJlZjxzdHJpbmc+IHwgdW5kZWZpbmVkIH0gPSB7fTtcbiAgc3RvcmVkRXhwb3J0VHlwZTogVHJhbnNhY3Rpb25zRXhwb3J0VHlwZUVsZW1lbnQgfCB1bmRlZmluZWQ7XG4gIG51bWJlck9mUmVzdWx0c0ZvdW5kID0gbmV3IFJlcGxheVN1YmplY3Q8bnVtYmVyPigpO1xuICBudW1iZXJPZlJlc3VsdHNEaXNwbGF5ZWQgPSBuZXcgUmVwbGF5U3ViamVjdDxudW1iZXI+KCk7XG4gIGNoZWNrSW1hZ2VzTGlzdDogT2JzZXJ2YWJsZTxUcmFuc2FjdGlvbkNoZWNrSW1hZ2VSZXNwb25zZT4gfCB1bmRlZmluZWQ7XG4gIHRyYW5zYWN0aW9uRGV0YWlsc0xvYWRpbmdTdGF0dXM6IE9ic2VydmFibGU8VHJhbnNhY3Rpb25zRGV0YWlsc0xvYWRpbmc+IHwgdW5kZWZpbmVkO1xuICBhdmFpbGFibGVGaWx0ZXJzQ29uZmlnOiBSZXBsYXlTdWJqZWN0PEF2YWlsYWJsZUZpbHRlcnNDb25maWc+ID0gbmV3IFJlcGxheVN1YmplY3Q8QXZhaWxhYmxlRmlsdGVyc0NvbmZpZz4oMSk7XG4gIGF2YWlsYWJsZUZpbHRlcnM6IE9ic2VydmFibGU8QXZhaWxhYmxlRmlsdGVycz4gPSB0aGlzLmF2YWlsYWJsZUZpbHRlcnNDb25maWdTZXJ2aWNlLmF2YWlsYWJsZUZpbHRlcnMkO1xuXG4gIHByaXZhdGUgcmVhZG9ubHkgcmVmcmVzaFRyYW5zYWN0aW9uc0xpc3RIYW5kbGVyID0gKCkgPT4ge1xuICAgIHRoaXMubW9kZWwucmVmcmVzaFRyYW5zYWN0aW9ucygpO1xuICB9O1xuXG4gIHByaXZhdGUgY2xlYXJSZWZyZXNoVHJhbnNhY3Rpb25zTGlzdEV2ZW50cygpIHtcbiAgICB0aGlzLnJlZ2lzdGVyZWRSZWZyZXNoVHJhbnNhY3Rpb25zTGlzdEV2ZW50cy5mb3JFYWNoKChldmVudE5hbWUpID0+IHtcbiAgICAgIHRoaXMuZXZlbnRCdXNTZXJ2aWNlLnVuc3Vic2NyaWJlKGV2ZW50TmFtZSwgdGhpcy5yZWZyZXNoVHJhbnNhY3Rpb25zTGlzdEhhbmRsZXIpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5yZWdpc3RlcmVkUmVmcmVzaFRyYW5zYWN0aW9uc0xpc3RFdmVudHMgPSBbXTtcbiAgfVxuXG4gIHJldHJ5KCkge1xuICAgIHRoaXMubW9kZWwucmV0cnlGaWx0ZXJpbmcoKTtcbiAgICB0aGlzLnBlbmRpbmdUcmFuc2FjdGlvbnNTZXJ2aWNlLnJldHJ5RmlsdGVyaW5nKCk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLmNsZWFyUmVmcmVzaFRyYW5zYWN0aW9uc0xpc3RFdmVudHMoKTtcbiAgICB0aGlzLnVuc3Vic2NyaWJlU3ViamVjdC5uZXh0KCk7XG4gICAgdGhpcy51bnN1YnNjcmliZVN1YmplY3QuY29tcGxldGUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVwcmVjYXRlZCB3aWxsIGJlIHJlbW92ZWQgaW4gMTEuMC4wXG4gICAqL1xuICBoYW5kbGVFcnJvciA9IChlcnJvclJlc3BvbnNlOiBIdHRwRXJyb3JSZXNwb25zZSkgPT4ge1xuICAgIHRoaXMuZXJyb3JzID0gVHJhbnNhY3Rpb25zQmFja2VuZEVycm9yLmZyb21IdHRwRXJyb3JzUmVzcG9uc2UoZXJyb3JSZXNwb25zZSk7XG5cbiAgICByZXR1cm4gb2Yoe1xuICAgICAgaXRlbXM6IFtdLFxuICAgICAgdG90YWxDb3VudDogMCxcbiAgICB9KTtcbiAgfTtcblxuICBnZXQgcGFnZVNpemUoKTogT2JzZXJ2YWJsZTxudW1iZXI+IHtcbiAgICByZXR1cm4gZmlsdGVySW5wdXRQYXJhbWV0ZXJzKHRoaXMucGFnZVNpemVTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpLCB0aGlzLndpZGdldFByb3BlcnRpZXMucGFnZVNpemUpO1xuICB9XG5cbiAgZ2V0IG1heE5hdlBhZ2VzKCk6IE9ic2VydmFibGU8bnVtYmVyPiB7XG4gICAgcmV0dXJuIGZpbHRlcklucHV0UGFyYW1ldGVycyh0aGlzLm1heE5hdlBhZ2VzU3ViamVjdC5hc09ic2VydmFibGUoKSwgdGhpcy53aWRnZXRQcm9wZXJ0aWVzLm1heE5hdlBhZ2VzKTtcbiAgfVxuXG4gIGdldCBzaG93Q29udHJvbHMoKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIGZpbHRlcklucHV0UGFyYW1ldGVycyh0aGlzLnNob3dDb250cm9sc1N1YmplY3QuYXNPYnNlcnZhYmxlKCksIHRoaXMud2lkZ2V0UHJvcGVydGllcy5zaG93Q29udHJvbHMpO1xuICB9XG5cbiAgZ2V0IGlzRmlsdGVyQXBwbGllZCgpIHtcbiAgICByZXR1cm4gdGhpcy5tb2RlbC5pc0ZpbHRlckFwcGxpZWQ7XG4gIH1cblxuICBnZXQgaXNTZWFyY2hBcHBsaWVkKCkge1xuICAgIHJldHVybiB0aGlzLm1vZGVsLmlzU2VhcmNoQXBwbGllZDtcbiAgfVxuXG4gIGdldCBwYWdpbmF0aW9uVHlwZSgpOiBPYnNlcnZhYmxlPFBhZ2luYXRpb25UeXBlPiB7XG4gICAgcmV0dXJuIGZpbHRlcklucHV0UGFyYW1ldGVycyh0aGlzLnBhZ2luYXRpb25UeXBlU3ViamVjdC5hc09ic2VydmFibGUoKSwgdGhpcy53aWRnZXRQcm9wZXJ0aWVzLnBhZ2luYXRpb25UeXBlKTtcbiAgfVxuXG4gIGdldCBzaG93UGVuZGluZ1RyYW5zYWN0aW9uc09uVG9wKCk6IE9ic2VydmFibGU8Ym9vbGVhbj4ge1xuICAgIHJldHVybiBmaWx0ZXJJbnB1dFBhcmFtZXRlcnMoXG4gICAgICB0aGlzLnNob3dQZW5kaW5nVHJhbnNhY3Rpb25zT25Ub3BTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpLFxuICAgICAgdGhpcy53aWRnZXRQcm9wZXJ0aWVzLnNob3dQZW5kaW5nVHJhbnNhY3Rpb25zT25Ub3AsXG4gICAgKTtcbiAgfVxuXG4gIGdldCBzaG93Q2hhbmdlQ2F0ZWdvcnkoKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIGZpbHRlcklucHV0UGFyYW1ldGVycyhcbiAgICAgIHRoaXMuc2hvd0NoYW5nZUNhdGVnb3J5U3ViamVjdC5hc09ic2VydmFibGUoKSxcbiAgICAgIHRoaXMud2lkZ2V0UHJvcGVydGllcy5zaG93Q2hhbmdlQ2F0ZWdvcnksXG4gICAgKTtcbiAgfVxuXG4gIGdldCBzaG93Q2hlY2tJbWFnZSgpOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHtcbiAgICByZXR1cm4gZmlsdGVySW5wdXRQYXJhbWV0ZXJzKHRoaXMuc2hvd0NoZWNrSW1hZ2VTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpLCB0aGlzLndpZGdldFByb3BlcnRpZXMuc2hvd0NoZWNrSW1hZ2UpO1xuICB9XG5cbiAgZ2V0IHNob3dNYW5hZ2VOb3RlcygpOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHtcbiAgICByZXR1cm4gZmlsdGVySW5wdXRQYXJhbWV0ZXJzKHRoaXMuc2hvd01hbmFnZU5vdGVzU3ViamVjdCwgdGhpcy53aWRnZXRQcm9wZXJ0aWVzLnNob3dNYW5hZ2VOb3Rlcyk7XG4gIH1cblxuICBnZXQgZ2V0T3JQb3N0RW5kcG9pbnQoKTogT2JzZXJ2YWJsZTxFbmRwb2ludFR5cGU+IHtcbiAgICByZXR1cm4gZmlsdGVySW5wdXRQYXJhbWV0ZXJzKFxuICAgICAgdGhpcy5nZXRPclBvc3RFbmRwb2ludHNTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpLFxuICAgICAgdGhpcy53aWRnZXRQcm9wZXJ0aWVzLmdldE9yUG9zdEVuZHBvaW50cyxcbiAgICApO1xuICB9XG5cbiAgZ2V0IGdtYXBzQVBJS2V5KCk6IE9ic2VydmFibGU8c3RyaW5nPiB7XG4gICAgcmV0dXJuIGNvbWJpbmVMYXRlc3QoW3RoaXMuYXBpS2V5U3ViamVjdC5hc09ic2VydmFibGUoKSwgdGhpcy53aWRnZXRQcm9wZXJ0aWVzLmdtYXBzQVBJS2V5XSkucGlwZShcbiAgICAgIG1hcCgoW2lucHV0VmFsLCBwcm9wVmFsXSkgPT4gaW5wdXRWYWwgfHwgcHJvcFZhbCksXG4gICAgKTtcbiAgfVxuXG4gIGdldCBlbmFibGVEaXNwdXRlQW5kSW5xdWlyeSgpIHtcbiAgICByZXR1cm4gZmlsdGVySW5wdXRQYXJhbWV0ZXJzKFxuICAgICAgdGhpcy5lbmFibGVEaXNwdXRlQW5kSW5xdWlyeVN1YmplY3QuYXNPYnNlcnZhYmxlKCksXG4gICAgICB0aGlzLndpZGdldFByb3BlcnRpZXMuZW5hYmxlRGlzcHV0ZUFuZElucXVpcnksXG4gICAgKTtcbiAgfVxuXG4gIGdldCBkaXNwdXRlQnlCaWxsaW5nU3RhdHVzKCk6IE9ic2VydmFibGU8Ym9vbGVhbj4ge1xuICAgIHJldHVybiBmaWx0ZXJJbnB1dFBhcmFtZXRlcnMoXG4gICAgICB0aGlzLmRpc3B1dGVCeUJpbGxpbmdTdGF0dXNTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpLFxuICAgICAgdGhpcy53aWRnZXRQcm9wZXJ0aWVzLmRpc3B1dGVCeUJpbGxpbmdTdGF0dXMsXG4gICAgKTtcbiAgfVxuXG4gIGdldCBkaXNwdXRlRWxpZ2liaWxpdHlEYXlzKCk6IE9ic2VydmFibGU8bnVtYmVyPiB7XG4gICAgcmV0dXJuIGZpbHRlcklucHV0UGFyYW1ldGVycyhcbiAgICAgIHRoaXMuZGlzcHV0ZUVsaWdpYmlsaXR5RGF5c1N1YmplY3QuYXNPYnNlcnZhYmxlKCksXG4gICAgICB0aGlzLndpZGdldFByb3BlcnRpZXMuZGlzcHV0ZUVsaWdpYmlsaXR5RGF5cyxcbiAgICApO1xuICB9XG5cbiAgZ2V0IGRpc3B1dGVUcmFuc2FjdGlvblR5cGVzKCk6IE9ic2VydmFibGU8QXJyYXk8c3RyaW5nPj4ge1xuICAgIHJldHVybiBmaWx0ZXJJbnB1dFBhcmFtZXRlcnMoXG4gICAgICB0aGlzLmRpc3B1dGVUcmFuc2FjdGlvblR5cGVzU3ViamVjdC5hc09ic2VydmFibGUoKSxcbiAgICAgIHRoaXMud2lkZ2V0UHJvcGVydGllcy5kaXNwdXRlVHJhbnNhY3Rpb25UeXBlcyxcbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBpbnF1aXJlVG9waWNJZCA9IGZpbHRlcklucHV0UGFyYW1ldGVycyhcbiAgICB0aGlzLmlucXVpcmVUb3BpY0lkU3ViamVjdC5hc09ic2VydmFibGUoKSxcbiAgICB0aGlzLndpZGdldFByb3BlcnRpZXMuaW5xdWlyZVRvcGljSWQsXG4gICk7XG5cbiAgcHJpdmF0ZSBkaXNwdXRlVG9waWNJZCA9IGZpbHRlcklucHV0UGFyYW1ldGVycyhcbiAgICB0aGlzLmRpc3B1dGVUb3BpY0lkU3ViamVjdC5hc09ic2VydmFibGUoKSxcbiAgICB0aGlzLndpZGdldFByb3BlcnRpZXMuZGlzcHV0ZVRvcGljSWQsXG4gICk7XG5cbiAgaW5xdWlyZUFuZERpc3B1dGVUb3BpY3M6IE9ic2VydmFibGU8SW5xdWlyZUFuZERpc3B1dGVUb3BpY3M+ID0gY29tYmluZUxhdGVzdChbXG4gICAgdGhpcy5pbnF1aXJlVG9waWNJZCxcbiAgICB0aGlzLmRpc3B1dGVUb3BpY0lkLFxuICBdKS5waXBlKG1hcCgoW2lucXVpcmUsIGRpc3B1dGVdKSA9PiAoeyBpbnF1aXJlLCBkaXNwdXRlIH0pKSk7XG5cbiAgb25Mb2FkTW9yZSgpIHtcbiAgICB0aGlzLm1vZGVsLmxvYWRNb3JlKCk7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICBpZiAodHlwZW9mIHRoaXMuc2VsZWN0ZWRBY2NvdW50ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBcInNlbGVjdGVkQWNjb3VudFwiIGlucHV0IGlzIHJlcXVpcmVkIGluIFwiJHt0aGlzLmNvbnN0cnVjdG9yLm5hbWV9XCJgKTtcbiAgICB9XG5cbiAgICBjb25zdCBpbml0aWFsTGlzdE9wdGlvbnM6IE9ic2VydmFibGU8UGFydGlhbDxUcmFuc2FjdGlvbnNMaXN0T3B0aW9ucz4+ID0gY29tYmluZUxhdGVzdChbXG4gICAgICB0aGlzLmluaXRpYWxGaWx0ZXJPcHRpb25zLFxuICAgICAgdGhpcy5pbml0aWFsU29ydE9wdGlvbnMsXG4gICAgXSkucGlwZShcbiAgICAgIG1hcCgoW2luaXRpYWxGaWx0ZXJPcHRpb25zLCBpbml0aWFsU29ydE9wdGlvbnNdKSA9PiAoe1xuICAgICAgICBmaWx0ZXI6IGluaXRpYWxGaWx0ZXJPcHRpb25zLFxuICAgICAgICBzb3J0OiBpbml0aWFsU29ydE9wdGlvbnMsXG4gICAgICB9KSksXG4gICAgKTtcblxuICAgIHRoaXMubW9kZWwuZ2V0VHJhbnNhY3Rpb25zRnJvbShcbiAgICAgIHRoaXMuc2VsZWN0ZWRBY2NvdW50LFxuICAgICAgdGhpcy5wYWdlU2l6ZSxcbiAgICAgIGluaXRpYWxMaXN0T3B0aW9ucyxcbiAgICAgIHRoaXMuc2hvd1BlbmRpbmdUcmFuc2FjdGlvbnNPblRvcCxcbiAgICAgIHRoaXMuZ2V0T3JQb3N0RW5kcG9pbnQsXG4gICAgKTtcbiAgICBpZiAodGhpcy5zaG93RGV0YWlsc0NvbmZpZykge1xuICAgICAgdGhpcy5jaGVja0ltYWdlc0xpc3QgPSB0aGlzLnRyYW5zYWN0aW9uRGV0YWlsc1NlcnZpY2UuZnJvbUNoZWNrSW1hZ2VzKHRoaXMuc2hvd0NoZWNrSW1hZ2UpO1xuXG4gICAgICB0aGlzLnRyYW5zYWN0aW9uRGV0YWlsc0xvYWRpbmdTdGF0dXMgPSB0aGlzLnRyYW5zYWN0aW9uRGV0YWlsc1NlcnZpY2UubG9hZGluZ1N0YXRlO1xuXG4gICAgICB0aGlzLnRyYW5zYWN0aW9uRGV0YWlsc1NlcnZpY2VcbiAgICAgICAgLmZyb21HZW9sb2NhdGlvbih0aGlzLmdtYXBzQVBJS2V5KVxuICAgICAgICAucGlwZSh0YWtlVW50aWwodGhpcy51bnN1YnNjcmliZVN1YmplY3QpKVxuICAgICAgICAuc3Vic2NyaWJlKCk7XG4gICAgfVxuXG4gICAgdGhpcy50cmFuc2FjdGlvbnNMaXN0ID0gdGhpcy5tb2RlbC5nZXRUcmFuc2FjdGlvbnNMaXN0KCkucGlwZShcbiAgICAgIHB1Ymxpc2hSZXBsYXkoMSksXG4gICAgICByZWZDb3VudCgpLFxuICAgICAgdGFwKChkYXRhKSA9PiB7XG4gICAgICAgIHRoaXMuZXJyb3JzID0gZGF0YS5odHRwUmVzcG9uc2VFcnJvclxuICAgICAgICAgID8gVHJhbnNhY3Rpb25zQmFja2VuZEVycm9yLmZyb21IdHRwRXJyb3JzUmVzcG9uc2UoZGF0YS5odHRwUmVzcG9uc2VFcnJvcilcbiAgICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5jZC5tYXJrRm9yQ2hlY2soKTtcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICB0aGlzLnBlbmRpbmdUcmFuc2FjdGlvbnNTZXJ2aWNlLmdldFRyYW5zYWN0aW9uc0Zyb20oXG4gICAgICB0aGlzLnNlbGVjdGVkQWNjb3VudCxcbiAgICAgIGluaXRpYWxMaXN0T3B0aW9ucyxcbiAgICAgIHRoaXMuZ2V0T3JQb3N0RW5kcG9pbnQsXG4gICAgKTtcbiAgICB0aGlzLnBlbmRpbmdUcmFuc2FjdGlvbnNMaXN0ID0gdGhpcy5wZW5kaW5nVHJhbnNhY3Rpb25zU2VydmljZS5nZXRUcmFuc2FjdGlvbnNMaXN0KCkucGlwZShcbiAgICAgIHB1Ymxpc2hSZXBsYXkoMSksXG4gICAgICByZWZDb3VudCgpLFxuICAgICAgdGFwKChkYXRhKSA9PiB7XG4gICAgICAgIHRoaXMuZXJyb3JzID0gZGF0YS5odHRwUmVzcG9uc2VFcnJvclxuICAgICAgICAgID8gVHJhbnNhY3Rpb25zQmFja2VuZEVycm9yLmZyb21IdHRwRXJyb3JzUmVzcG9uc2UoZGF0YS5odHRwUmVzcG9uc2VFcnJvcilcbiAgICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5jZC5tYXJrRm9yQ2hlY2soKTtcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICB0aGlzLnRyYW5zYWN0aW9uc0xpc3RcbiAgICAgIC5waXBlKFxuICAgICAgICB0YWtlVW50aWwodGhpcy51bnN1YnNjcmliZVN1YmplY3QpLFxuICAgICAgICBtYXAoKHRyYW5zYWN0aW9uc0xpc3QpID0+IHtcbiAgICAgICAgICBpZiAoIXRyYW5zYWN0aW9uc0xpc3QpIHtcbiAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCB7IGF2YWlsYWJsZUV4cG9ydFR5cGVzSGVhZGVyLCB1bmF2YWlsYWJsZUV4cG9ydFR5cGVzUmVhc29uc0hlYWRlciB9ID0gdHJhbnNhY3Rpb25zTGlzdDtcblxuICAgICAgICAgIHJldHVybiBjb21iaW5lRXhwb3J0VHlwZXNDb25maWcoe1xuICAgICAgICAgICAgYXZhaWxhYmxlRXhwb3J0VHlwZXNIZWFkZXIsXG4gICAgICAgICAgICB1bmF2YWlsYWJsZUV4cG9ydFR5cGVzUmVhc29uc0hlYWRlcixcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSksXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKHRoaXMuZXhwb3J0Q29uZmlnKTtcblxuICAgIGNvbnN0IHRyYW5zYWN0aW9uc0xpc3RDb3VudCA9IHRoaXMudHJhbnNhY3Rpb25zTGlzdC5waXBlKFxuICAgICAgbWFwKCh0cmFucykgPT4gKHsgaGlzdG9yeTogdHJhbnMgPyB0cmFucy50b3RhbENvdW50IDogMCB9KSksXG4gICAgKTtcblxuICAgIGNvbnN0IHBlbmRpbmdUcmFuc2FjdGlvbnNMaXN0Q291bnQgPSB0aGlzLnBlbmRpbmdUcmFuc2FjdGlvbnNMaXN0LnBpcGUoXG4gICAgICBtYXAoKHRyYW5zKSA9PiAoeyBwZW5kaW5nOiB0cmFucyA/IHRyYW5zLnRvdGFsQ291bnQgOiAwIH0pKSxcbiAgICApO1xuXG4gICAgY29uc3QgdHJhbnNhY3Rpb25zTGlzdEl0ZW1zVG9EaXNwbGF5ID0gdGhpcy50cmFuc2FjdGlvbnNMaXN0LnBpcGUoXG4gICAgICBtYXAoKHRyYW5zKSA9PiAoeyBoaXN0b3J5OiB0cmFucyA/IHRyYW5zLml0ZW1zLmxlbmd0aCA6IDAgfSkpLFxuICAgICk7XG5cbiAgICBjb25zdCBwZW5kaW5nVHJhbnNhY3Rpb25zTGlzdEl0ZW1zVG9EaXNwbGF5ID0gdGhpcy5wZW5kaW5nVHJhbnNhY3Rpb25zTGlzdC5waXBlKFxuICAgICAgbWFwKCh0cmFucykgPT4gKHsgcGVuZGluZzogdHJhbnMgPyB0cmFucy5pdGVtcy5sZW5ndGggOiAwIH0pKSxcbiAgICApO1xuXG4gICAgdGhpcy5zdW1UcmFuc2FjdGlvbnNSZXN1bHRzKHRyYW5zYWN0aW9uc0xpc3RDb3VudCwgcGVuZGluZ1RyYW5zYWN0aW9uc0xpc3RDb3VudClcbiAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLnVuc3Vic2NyaWJlU3ViamVjdCkpXG4gICAgICAuc3Vic2NyaWJlKHRoaXMubnVtYmVyT2ZSZXN1bHRzRm91bmQpO1xuXG4gICAgdGhpcy5zdW1UcmFuc2FjdGlvbnNSZXN1bHRzKHRyYW5zYWN0aW9uc0xpc3RJdGVtc1RvRGlzcGxheSwgcGVuZGluZ1RyYW5zYWN0aW9uc0xpc3RJdGVtc1RvRGlzcGxheSlcbiAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLnVuc3Vic2NyaWJlU3ViamVjdCkpXG4gICAgICAuc3Vic2NyaWJlKHRoaXMubnVtYmVyT2ZSZXN1bHRzRGlzcGxheWVkKTtcblxuICAgIHRoaXMuY3VycmVudFBhZ2UgPSB0aGlzLm1vZGVsLmdldEN1cnJlbnRQYWdlKCk7XG4gICAgdGhpcy5sb2FkaW5nU3RhdGUgPSB0aGlzLm1vZGVsLmxvYWRpbmdTdGF0ZTtcbiAgICB0aGlzLmxvYWRpbmdQZW5kaW5nU3RhdGUgPSB0aGlzLnBlbmRpbmdUcmFuc2FjdGlvbnNTZXJ2aWNlLmxvYWRpbmdTdGF0ZTtcblxuICAgIHRoaXMud2lkZ2V0UHJvcGVydGllcy5yZWZyZXNoVHJhbnNhY3Rpb25zTGlzdEV2ZW50cy5waXBlKHRha2VVbnRpbCh0aGlzLnVuc3Vic2NyaWJlU3ViamVjdCkpLnN1YnNjcmliZSgoZXZlbnRzKSA9PiB7XG4gICAgICB0aGlzLmNsZWFyUmVmcmVzaFRyYW5zYWN0aW9uc0xpc3RFdmVudHMoKTtcbiAgICAgIGlmIChldmVudHMpIHtcbiAgICAgICAgdGhpcy5yZWdpc3RlcmVkUmVmcmVzaFRyYW5zYWN0aW9uc0xpc3RFdmVudHMgPSBldmVudHMuc3BsaXQoJywnKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlcmVkUmVmcmVzaFRyYW5zYWN0aW9uc0xpc3RFdmVudHMuZm9yRWFjaCgoZXZlbnROYW1lKSA9PiB7XG4gICAgICAgICAgdGhpcy5ldmVudEJ1c1NlcnZpY2Uuc3Vic2NyaWJlKGV2ZW50TmFtZSwgdGhpcy5yZWZyZXNoVHJhbnNhY3Rpb25zTGlzdEhhbmRsZXIpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuY29uZmlndXJlVHJhbnNjdGlvbnNEZXRhaWxzT3V0cHV0QmVoYXZpb3VyKCk7XG5cbiAgICB0aGlzLnRyYW5zYWN0aW9uRGV0YWlsc1NlcnZpY2UuZnJvbUlucXVpcnlBbmREaXNwdXRlKFxuICAgICAgdGhpcy5lbmFibGVEaXNwdXRlQW5kSW5xdWlyeSxcbiAgICAgIHRoaXMuZGlzcHV0ZUJ5QmlsbGluZ1N0YXR1cyxcbiAgICAgIHRoaXMuZGlzcHV0ZUVsaWdpYmlsaXR5RGF5cyxcbiAgICAgIHRoaXMuZGlzcHV0ZVRyYW5zYWN0aW9uVHlwZXMsXG4gICAgKTtcblxuICAgIHRoaXMuYXZhaWxhYmxlRmlsdGVyc0NvbmZpZ1NlcnZpY2Uuc2V0RmlsdGVyQ29uZmlndXJhdGlvbkFuZEFjY291bnQoXG4gICAgICB0aGlzLmF2YWlsYWJsZUZpbHRlcnNDb25maWcuYXNPYnNlcnZhYmxlKCksXG4gICAgICB0aGlzLnNlbGVjdGVkQWNjb3VudCxcbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBjb25maWd1cmVUcmFuc2N0aW9uc0RldGFpbHNPdXRwdXRCZWhhdmlvdXIoKSB7XG4gICAgaWYgKHRoaXMudHJhbnNhY3Rpb25zTGlzdCAmJiB0aGlzLnBlbmRpbmdUcmFuc2FjdGlvbnNMaXN0ICYmICF0aGlzLnNob3dEZXRhaWxzQ29uZmlnKSB7XG4gICAgICBjb25zdCBwZW5kaW5nID0gdGhpcy5zaG93UGVuZGluZ1RyYW5zYWN0aW9uc09uVG9wLnBpcGUoXG4gICAgICAgIG1lcmdlTWFwKChjb25kKSA9PlxuICAgICAgICAgIGlpZigoKSA9PiBjb25kLCB0aGlzLnBlbmRpbmdUcmFuc2FjdGlvbnNMaXN0LCBvZih7IGl0ZW1zOiBbXSwgdG90YWxDb3VudDogMCB9IGFzIFRyYW5zYWN0aW9uc0xpc3QpKSxcbiAgICAgICAgKSxcbiAgICAgICk7XG5cbiAgICAgIGNvbWJpbmVMYXRlc3QoW3BlbmRpbmcsIHRoaXMudHJhbnNhY3Rpb25zTGlzdF0pXG4gICAgICAgIC5waXBlKFxuICAgICAgICAgIHRha2VVbnRpbCh0aGlzLnVuc3Vic2NyaWJlU3ViamVjdCksXG4gICAgICAgICAgbWFwKChbcGVuZGluZ1RyYW5zYWN0aW9uc0xpc3QsIHRyYW5zYWN0aW9uc0xpc3RdKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBwZW5kaW5nVHJhbnNhY3Rpb25zID0gcGVuZGluZ1RyYW5zYWN0aW9uc0xpc3QgPyBwZW5kaW5nVHJhbnNhY3Rpb25zTGlzdC5pdGVtcyA6IFtdO1xuICAgICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25zID0gdHJhbnNhY3Rpb25zTGlzdCA/IHRyYW5zYWN0aW9uc0xpc3QuaXRlbXMgOiBbXTtcblxuICAgICAgICAgICAgY29uc3QgbWl4ZWQ6IFRyYW5zYWN0aW9uc0xpc3QgPSB7XG4gICAgICAgICAgICAgIGl0ZW1zOiBbLi4ucGVuZGluZ1RyYW5zYWN0aW9ucywgLi4udHJhbnNhY3Rpb25zXSxcbiAgICAgICAgICAgICAgdG90YWxDb3VudDogKHBlbmRpbmdUcmFuc2FjdGlvbnNMaXN0Py50b3RhbENvdW50IHx8IDApICsgKHRyYW5zYWN0aW9uc0xpc3Q/LnRvdGFsQ291bnQgfHwgMCksXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXR1cm4gbWl4ZWQ7XG4gICAgICAgICAgfSksXG4gICAgICAgIClcbiAgICAgICAgLnN1YnNjcmliZSgoZGF0YSkgPT4ge1xuICAgICAgICAgIHRoaXMudHJhbnNhY3Rpb25zTG9hZGVkLmVtaXQoZGF0YSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc3VtVHJhbnNhY3Rpb25zUmVzdWx0cyhoaXN0b3J5Q291bnQ6IE9ic2VydmFibGU8YW55PiwgcGVuZGluZ0NvdW50OiBPYnNlcnZhYmxlPGFueT4pIHtcbiAgICByZXR1cm4gdGhpcy5zaG93UGVuZGluZ1RyYW5zYWN0aW9uc09uVG9wLnBpcGUoXG4gICAgICBtZXJnZU1hcCgoc2hvd1BlbmRpbmdUcmFuc2FjdGlvbnNPblRvcCkgPT5cbiAgICAgICAgaWlmKCgpID0+IHNob3dQZW5kaW5nVHJhbnNhY3Rpb25zT25Ub3AsIG1lcmdlKGhpc3RvcnlDb3VudCwgcGVuZGluZ0NvdW50KSwgaGlzdG9yeUNvdW50KSxcbiAgICAgICksXG4gICAgICBzY2FuKChhY2MsIGN1cnIpID0+ICh7IC4uLmFjYywgLi4uY3VyciB9KSwgeyBoaXN0b3J5OiAwLCBwZW5kaW5nOiAwIH0pLFxuICAgICAgbWFwKCh7IGhpc3RvcnkgPSAwLCBwZW5kaW5nID0gMCB9KSA9PiBoaXN0b3J5ICsgcGVuZGluZyksXG4gICAgKTtcbiAgfVxuXG4gIG9uUGFnZUNoYW5nZShwYWdlOiBudW1iZXIpIHtcbiAgICB0aGlzLm1vZGVsLnBhZ2VDaGFuZ2UocGFnZSk7XG4gIH1cblxuICBvblNlYXJjaChxdWVyeTogc3RyaW5nKSB7XG4gICAgLy8gc2VhcmNoIHVpIGNvbXBvbmVudCBzZW5kcyBhbiB1bmV4cGVjdGVkIGV2ZW50XG4gICAgLy8gdGhhdCBpcyB0eXBlIEV2ZW50LiBUbyBhdm9pZCBjYWxsaW5nIGJhY2tlbmQgd2l0aCB0aGF0IGV2ZW50XG4gICAgLy8gaXQgaGFzIHRvIGJlIHN0cmluZ1xuICAgIGlmICh0eXBlb2YgcXVlcnkgPT09ICdzdHJpbmcnKSB7XG4gICAgICB0aGlzLm1vZGVsLnNlYXJjaChxdWVyeSk7XG4gICAgICB0aGlzLnBlbmRpbmdUcmFuc2FjdGlvbnNTZXJ2aWNlLnNlYXJjaChxdWVyeSk7XG4gICAgfVxuICB9XG5cbiAgb25GaWx0ZXIoZmlsdGVyT3B0aW9uczogVHJhbnNhY3Rpb25zRmlsdGVyT3B0aW9ucykge1xuICAgIHRoaXMubW9kZWwuZmlsdGVyKGZpbHRlck9wdGlvbnMpO1xuICAgIHRoaXMucGVuZGluZ1RyYW5zYWN0aW9uc1NlcnZpY2UuZmlsdGVyKGZpbHRlck9wdGlvbnMpO1xuICB9XG5cbiAgb25Tb3J0KHNvcnRPcHRpb25zOiBUcmFuc2FjdGlvbnNTb3J0T3B0aW9ucykge1xuICAgIHRoaXMubW9kZWwuc29ydChzb3J0T3B0aW9ucyk7XG4gIH1cblxuICBvblByaW50KCkge1xuICAgIHdpbmRvdy5wcmludCgpO1xuICB9XG5cbiAgb25FeHBvcnQoZXhwb3J0VHlwZTogVHJhbnNhY3Rpb25zRXhwb3J0VHlwZUVsZW1lbnQpIHtcbiAgICB0aGlzLnN0b3JlZEV4cG9ydFR5cGUgPSB7IC4uLmV4cG9ydFR5cGUgfTtcbiAgICBpZiAoZXhwb3J0VHlwZS5pc0F2YWlsYWJsZSkge1xuICAgICAgdGhpcy5tb2RlbFxuICAgICAgICAuZXhwb3J0VG9UeXBlKGV4cG9ydFR5cGUubmFtZSlcbiAgICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMudW5zdWJzY3JpYmVTdWJqZWN0KSlcbiAgICAgICAgLnN1YnNjcmliZShcbiAgICAgICAgICAocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGFuY2hvclRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgICAgICAgIGFuY2hvclRhZy5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChyZXNwb25zZS5ib2R5KTtcblxuICAgICAgICAgICAgY29uc3QgZmlsZU5hbWUgPSBnZXROYW1lRnJvbUNvbnRlbnREaXNwb3NpdGlvbkhlYWRlcihyZXNwb25zZSk7XG4gICAgICAgICAgICBjb25zdCBkZWZhdWx0TmFtZSA9IGV4cG9ydFR5cGUubmFtZS50b0xvd2VyQ2FzZSgpID09PSAncGRmJyA/ICdBY2NvdW50IEFjdGl2aXRpZXMnIDogJ3RyYW5zYWN0aW9ucyc7XG5cbiAgICAgICAgICAgIGFuY2hvclRhZy5kb3dubG9hZCA9IGZpbGVOYW1lICE9PSAnJyA/IGZpbGVOYW1lIDogZGVmYXVsdE5hbWU7XG4gICAgICAgICAgICBhbmNob3JUYWcuY2xpY2soKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMubm90aWZpY2F0aW9uU2VydmljZS5zaG93Tm90aWZpY2F0aW9uKHtcbiAgICAgICAgICAgICAgaGVhZGVyOiB0aGlzLm5vdGlmaWNhdGlvblNlcnZlckVycm9ySGVhZGVyLFxuICAgICAgICAgICAgICBtZXNzYWdlOiB0aGlzLm5vdGlmaWNhdGlvblNlcnZlckVycm9yTWVzc2FnZSB8fCAnJyxcbiAgICAgICAgICAgICAgbW9kaWZpZXI6ICdlcnJvcicsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnB1c2hOb3RpZmljYXRpb24oe1xuICAgICAgICBoZWFkZXI6IHRoaXMubm90aWZpY2F0aW9uRXJyb3JVcGRhdGVIZWFkZXJUZW1wbGF0ZSxcbiAgICAgICAgbWVzc2FnZTogdGhpcy5ub3RpZmljYXRpb25FcnJvclVwZGF0ZU1lc3NhZ2VUZW1wbGF0ZSxcbiAgICAgICAgbW9kaWZpZXI6ICdlcnJvcicsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBvbkRldGFpbE9wZW4odHJhbnNhY3Rpb246IFRyYW5zYWN0aW9uKSB7XG4gICAgaWYgKCF0aGlzLnNob3dEZXRhaWxzQ29uZmlnKSB7XG4gICAgICB0aGlzLnRyYW5zYWN0aW9uU2VsZWN0ZWQuZW1pdCh0cmFuc2FjdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudHJhbnNhY3Rpb25EZXRhaWxzU2VydmljZS5zZWxlY3RUcmFuc2FjdGlvbih0cmFuc2FjdGlvbik7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBwdXNoTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbk1lc3NhZ2U6IHtcbiAgICBoZWFkZXI6IFRlbXBsYXRlUmVmPGFueT4gfCBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgbWVzc2FnZTogYW55O1xuICAgIG1vZGlmaWVyOiAnZXJyb3InIHwgJ3N1Y2Nlc3MnIHwgJ2luZm8nIHwgJ3dhcm5pbmcnIHwgJ2FsZXJ0JyB8IHVuZGVmaW5lZDtcbiAgfSkge1xuICAgIHRoaXMubm90aWZpY2F0aW9uU2VydmljZS5zaG93Tm90aWZpY2F0aW9uKHtcbiAgICAgIGRpc21pc3NpYmxlOiB0cnVlLFxuICAgICAgdHRsOiBub3RpZmljYXRpb25UdGwsXG4gICAgICAuLi5ub3RpZmljYXRpb25NZXNzYWdlLFxuICAgIH0pO1xuICB9XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IG1vZGVsOiBUcmFuc2FjdGlvbnNTZXJ2aWNlLFxuICAgIHByb3RlY3RlZCByZWFkb25seSB3aWRnZXRQcm9wZXJ0aWVzOiBXaWRnZXRQcm9wZXJ0aWVzU2VydmljZSxcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgY2Q6IENoYW5nZURldGVjdG9yUmVmLFxuICAgIHByb3RlY3RlZCByZWFkb25seSBldmVudEJ1c1NlcnZpY2U6IFB1YnN1YixcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgbm90aWZpY2F0aW9uU2VydmljZTogTm90aWZpY2F0aW9uU2VydmljZSxcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgcGVuZGluZ1RyYW5zYWN0aW9uc1NlcnZpY2U6IFBlbmRpbmdUcmFuc2FjdGlvbnNTZXJ2aWNlLFxuICAgIHByb3RlY3RlZCByZWFkb25seSB0cmFuc2FjdGlvbkRldGFpbHNTZXJ2aWNlOiBUcmFuc2FjdGlvbkRldGFpbHNTZXJ2aWNlLFxuICAgIHByb3RlY3RlZCByZWFkb25seSBhdmFpbGFibGVGaWx0ZXJzQ29uZmlnU2VydmljZTogQXZhaWxhYmxlRmlsdGVyc0NvbmZpZ1NlcnZpY2UsXG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IHNob3dEZXRhaWxzQ29uZmlnPzogYm9vbGVhbixcbiAgKSB7fVxufVxuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICdbYmJUcmFuc2FjdGlvbnNOb0FjY291bnRTZWxlY3RlZFN0YXRlQ3VzdG9taXphYmxlXScsXG59KVxuZXhwb3J0IGNsYXNzIFRyYW5zYWN0aW9uc05vQWNjb3VudFNlbGVjdGVkU3RhdGVDdXN0b21pemFibGVEaXJlY3RpdmUgZXh0ZW5kcyBCYlRlbXBsYXRlPFxuICBCYXNlVHJhbnNhY3Rpb25zQ29udGFpbmVyLFxuICB1bmRlZmluZWRcbj4ge31cblxuQERpcmVjdGl2ZSh7XG4gIHNlbGVjdG9yOiAnW2JiVHJhbnNhY3Rpb25zRXJyb3JTdGF0ZUN1c3RvbWl6YWJsZV0nLFxufSlcbmV4cG9ydCBjbGFzcyBUcmFuc2FjdGlvbnNFcnJvclN0YXRlQ3VzdG9taXphYmxlRGlyZWN0aXZlIGV4dGVuZHMgQmJUZW1wbGF0ZTxCYXNlVHJhbnNhY3Rpb25zQ29udGFpbmVyLCB1bmRlZmluZWQ+IHt9XG4iXX0=