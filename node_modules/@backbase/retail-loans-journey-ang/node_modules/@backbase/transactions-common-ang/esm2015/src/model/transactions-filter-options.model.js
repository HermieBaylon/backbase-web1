/* eslint-disable no-redeclare*/
export var TransactionsFilterOptions;
(function (TransactionsFilterOptions) {
    function isEmpty(options) {
        return Object.values(options)
            .filter((value) => typeof value !== 'undefined')
            .every((value) => !value || (typeof value === 'object' && isEmpty(value)));
    }
    TransactionsFilterOptions.isEmpty = isEmpty;
    // converts a Date object to `dddd-MM-yy` string format
    // eslint-disable-next-line complexity
    const formatDate = (date) => {
        const year = date.getFullYear().toString();
        const month = (date.getMonth() + 1).toString();
        const day = date.getDate().toString();
        return `${year}-${month[1] ? month : '0' + month[0]}-${day[1] ? day : '0' + day[0]}`;
    };
    function toHttpGetParams(options = {}) {
        const params = {};
        const setIfExists = (paramName, conditionFn, valueFn) => {
            if (conditionFn(options)) {
                params[paramName] = valueFn(options);
            }
        };
        setIfExists('creditDebitIndicator', (option) => option.creditDebitIndicator !== undefined && option.creditDebitIndicator.value !== undefined, (option) => option.creditDebitIndicator.value);
        setIfExists('types', (option) => option.type !== undefined && option.type.value !== undefined, (option) => (Array.isArray(option.type.value) ? option.type.value : [option.type.value]));
        setIfExists('billingStatus', (option) => option.billingStatus !== undefined && option.billingStatus.value !== undefined, (option) => option.billingStatus.value);
        setIfExists('amountGreaterThan', (option) => option.amount && option.amount.from, (option) => option.amount.from);
        setIfExists('amountLessThan', (option) => option.amount && option.amount.to, (option) => option.amount.to);
        setIfExists('bookingDateGreaterThan', (option) => option.date && option.date.from && Object.keys(option.date.from).length, (option) => formatDate(new Date(option.date.from)));
        setIfExists('bookingDateLessThan', (option) => option.date && option.date.to && Object.keys(option.date.to).length, (option) => formatDate(new Date(option.date.to)));
        setIfExists('fromCheckSerialNumber', (option) => option.checkSerialNumber && option.checkSerialNumber.from, (option) => option.checkSerialNumber.from);
        setIfExists('toCheckSerialNumber', (option) => option.checkSerialNumber && option.checkSerialNumber.to, (option) => option.checkSerialNumber.to);
        return params;
    }
    TransactionsFilterOptions.toHttpGetParams = toHttpGetParams;
    // eslint-disable-next-line complexity
    function fromHttpGetParams(params) {
        const options = {};
        if (params.creditDebitIndicator) {
            options.creditDebitIndicator = { value: params.creditDebitIndicator };
        }
        if (params.type) {
            if (Array.isArray(params.type)) {
                options.types = params.type.map((value) => ({ value }));
            }
            else {
                options.types = { value: params.type };
            }
        }
        if (params.billingStatus) {
            options.billingStatus = { value: params.billingStatus };
        }
        if (params.amountGreaterThan) {
            options.amount = { from: parseInt(params.amountGreaterThan, 10) };
        }
        if (params.amountLessThan) {
            options.amount = Object.assign(Object.assign({}, options.amount), { to: parseInt(params.amountLessThan, 10) });
        }
        if (params.bookingDateGreaterThan) {
            options.date = {
                from: params.bookingDateGreaterThan,
            };
        }
        if (params.bookingDateLessThan) {
            options.date = Object.assign(Object.assign({}, options.date), { to: params.bookingDateLessThan });
        }
        if (params.fromCheckSerialNumber) {
            options.checkSerialNumber = {
                from: parseInt(params.fromCheckSerialNumber, 10),
            };
        }
        if (params.toCheckSerialNumber) {
            options.checkSerialNumber = Object.assign(Object.assign({}, options.checkSerialNumber), { to: parseInt(params.toCheckSerialNumber, 10) });
        }
        return options;
    }
    TransactionsFilterOptions.fromHttpGetParams = fromHttpGetParams;
})(TransactionsFilterOptions || (TransactionsFilterOptions = {}));
/* eslint-enable no-redeclare*/
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNhY3Rpb25zLWZpbHRlci1vcHRpb25zLm1vZGVsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vbGlicy90cmFuc2FjdGlvbnMtY29tbW9uLWFuZy9zcmMvbW9kZWwvdHJhbnNhY3Rpb25zLWZpbHRlci1vcHRpb25zLm1vZGVsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQW9CQSxnQ0FBZ0M7QUFDaEMsTUFBTSxLQUFXLHlCQUF5QixDQXFJekM7QUFySUQsV0FBaUIseUJBQXlCO0lBQ3hDLFNBQWdCLE9BQU8sQ0FBQyxPQUEyQztRQUNqRSxPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDO2FBQzFCLE1BQU0sQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsT0FBTyxLQUFLLEtBQUssV0FBVyxDQUFDO2FBQy9DLEtBQUssQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQyxLQUFLLElBQUksQ0FBQyxPQUFPLEtBQUssS0FBSyxRQUFRLElBQUksT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMvRSxDQUFDO0lBSmUsaUNBQU8sVUFJdEIsQ0FBQTtJQUVELHVEQUF1RDtJQUN2RCxzQ0FBc0M7SUFDdEMsTUFBTSxVQUFVLEdBQUcsQ0FBQyxJQUFVLEVBQUUsRUFBRTtRQUNoQyxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDM0MsTUFBTSxLQUFLLEdBQUcsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDL0MsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBRXRDLE9BQU8sR0FBRyxJQUFJLElBQUksS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FB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LG1DQUNwQixPQUFPLENBQUMsaUJBQWlCLEtBQzVCLEVBQUUsRUFBRSxRQUFRLENBQUMsTUFBTSxDQUFDLG1CQUFtQixFQUFFLEVBQUUsQ0FBQyxHQUM3QyxDQUFDO1NBQ0g7UUFFRCxPQUFPLE9BQU8sQ0FBQztJQUNqQixDQUFDO0lBekRlLDJDQUFpQixvQkF5RGhDLENBQUE7QUFDSCxDQUFDLEVBcklnQix5QkFBeUIsS0FBekIseUJBQXlCLFFBcUl6QztBQUNELCtCQUErQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRyYW5zYWN0aW9uc0VudW1WYWx1ZSB9IGZyb20gJy4vdHJhbnNhY3Rpb25zLWVudW0tdmFsdWUubW9kZWwnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRyYW5zYWN0aW9uc0ZpbHRlck9wdGlvbnMge1xuICBjcmVkaXREZWJpdEluZGljYXRvcj86IFRyYW5zYWN0aW9uc0VudW1WYWx1ZTtcbiAgdHlwZXM/OiBUcmFuc2FjdGlvbnNFbnVtVmFsdWVbXSB8IFRyYW5zYWN0aW9uc0VudW1WYWx1ZTtcbiAgYmlsbGluZ1N0YXR1cz86IFRyYW5zYWN0aW9uc0VudW1WYWx1ZTtcbiAgYW1vdW50Pzoge1xuICAgIGZyb20/OiBudW1iZXI7XG4gICAgdG8/OiBudW1iZXI7XG4gIH07XG4gIGRhdGU/OiB7XG4gICAgZnJvbT86IHN0cmluZztcbiAgICB0bz86IHN0cmluZztcbiAgfTtcbiAgY2F0ZWdvcmllcz86IHN0cmluZ1tdO1xuICBjaGVja1NlcmlhbE51bWJlcj86IHtcbiAgICBmcm9tPzogbnVtYmVyO1xuICAgIHRvPzogbnVtYmVyO1xuICB9O1xufVxuLyogZXNsaW50LWRpc2FibGUgbm8tcmVkZWNsYXJlKi9cbmV4cG9ydCBuYW1lc3BhY2UgVHJhbnNhY3Rpb25zRmlsdGVyT3B0aW9ucyB7XG4gIGV4cG9ydCBmdW5jdGlvbiBpc0VtcHR5KG9wdGlvbnM6IFRyYW5zYWN0aW9uc0ZpbHRlck9wdGlvbnMgfCBvYmplY3QpOiBib29sZWFuIHtcbiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhvcHRpb25zKVxuICAgICAgLmZpbHRlcigodmFsdWUpID0+IHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAuZXZlcnkoKHZhbHVlKSA9PiAhdmFsdWUgfHwgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgaXNFbXB0eSh2YWx1ZSkpKTtcbiAgfVxuXG4gIC8vIGNvbnZlcnRzIGEgRGF0ZSBvYmplY3QgdG8gYGRkZGQtTU0teXlgIHN0cmluZyBmb3JtYXRcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNvbXBsZXhpdHlcbiAgY29uc3QgZm9ybWF0RGF0ZSA9IChkYXRlOiBEYXRlKSA9PiB7XG4gICAgY29uc3QgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpO1xuICAgIGNvbnN0IG1vbnRoID0gKGRhdGUuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCk7XG4gICAgY29uc3QgZGF5ID0gZGF0ZS5nZXREYXRlKCkudG9TdHJpbmcoKTtcblxuICAgIHJldHVybiBgJHt5ZWFyfS0ke21vbnRoWzFdID8gbW9udGggOiAnMCcgKyBtb250aFswXX0tJHtkYXlbMV0gPyBkYXkgOiAnMCcgKyBkYXlbMF19YDtcbiAgfTtcblxuICBleHBvcnQgZnVuY3Rpb24gdG9IdHRwR2V0UGFyYW1zKG9wdGlvbnM6IFRyYW5zYWN0aW9uc0ZpbHRlck9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IHBhcmFtczogYW55ID0ge307XG5cbiAgICBjb25zdCBzZXRJZkV4aXN0cyA9IChwYXJhbU5hbWU6IHN0cmluZywgY29uZGl0aW9uRm46IChvcHRpb246IGFueSkgPT4gYW55LCB2YWx1ZUZuOiAob3B0aW9uOiBhbnkpID0+IGFueSkgPT4ge1xuICAgICAgaWYgKGNvbmRpdGlvbkZuKG9wdGlvbnMpKSB7XG4gICAgICAgIHBhcmFtc1twYXJhbU5hbWVdID0gdmFsdWVGbihvcHRpb25zKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgc2V0SWZFeGlzdHMoXG4gICAgICAnY3JlZGl0RGViaXRJbmRpY2F0b3InLFxuICAgICAgKG9wdGlvbikgPT4gb3B0aW9uLmNyZWRpdERlYml0SW5kaWNhdG9yICE9PSB1bmRlZmluZWQgJiYgb3B0aW9uLmNyZWRpdERlYml0SW5kaWNhdG9yLnZhbHVlICE9PSB1bmRlZmluZWQsXG4gICAgICAob3B0aW9uKSA9PiBvcHRpb24uY3JlZGl0RGViaXRJbmRpY2F0b3IudmFsdWUsXG4gICAgKTtcbiAgICBzZXRJZkV4aXN0cyhcbiAgICAgICd0eXBlcycsXG4gICAgICAob3B0aW9uKSA9PiBvcHRpb24udHlwZSAhPT0gdW5kZWZpbmVkICYmIG9wdGlvbi50eXBlLnZhbHVlICE9PSB1bmRlZmluZWQsXG4gICAgICAob3B0aW9uKSA9PiAoQXJyYXkuaXNBcnJheShvcHRpb24udHlwZS52YWx1ZSkgPyBvcHRpb24udHlwZS52YWx1ZSA6IFtvcHRpb24udHlwZS52YWx1ZV0pLFxuICAgICk7XG4gICAgc2V0SWZFeGlzdHMoXG4gICAgICAnYmlsbGluZ1N0YXR1cycsXG4gICAgICAob3B0aW9uKSA9PiBvcHRpb24uYmlsbGluZ1N0YXR1cyAhPT0gdW5kZWZpbmVkICYmIG9wdGlvbi5iaWxsaW5nU3RhdHVzLnZhbHVlICE9PSB1bmRlZmluZWQsXG4gICAgICAob3B0aW9uKSA9PiBvcHRpb24uYmlsbGluZ1N0YXR1cy52YWx1ZSxcbiAgICApO1xuICAgIHNldElmRXhpc3RzKFxuICAgICAgJ2Ftb3VudEdyZWF0ZXJUaGFuJyxcbiAgICAgIChvcHRpb24pID0+IG9wdGlvbi5hbW91bnQgJiYgb3B0aW9uLmFtb3VudC5mcm9tLFxuICAgICAgKG9wdGlvbikgPT4gb3B0aW9uLmFtb3VudC5mcm9tLFxuICAgICk7XG4gICAgc2V0SWZFeGlzdHMoXG4gICAgICAnYW1vdW50TGVzc1RoYW4nLFxuICAgICAgKG9wdGlvbikgPT4gb3B0aW9uLmFtb3VudCAmJiBvcHRpb24uYW1vdW50LnRvLFxuICAgICAgKG9wdGlvbikgPT4gb3B0aW9uLmFtb3VudC50byxcbiAgICApO1xuICAgIHNldElmRXhpc3RzKFxuICAgICAgJ2Jvb2tpbmdEYXRlR3JlYXRlclRoYW4nLFxuICAgICAgKG9wdGlvbikgPT4gb3B0aW9uLmRhdGUgJiYgb3B0aW9uLmRhdGUuZnJvbSAmJiBPYmplY3Qua2V5cyhvcHRpb24uZGF0ZS5mcm9tKS5sZW5ndGgsXG4gICAgICAob3B0aW9uKSA9PiBmb3JtYXREYXRlKG5ldyBEYXRlKG9wdGlvbi5kYXRlLmZyb20pKSxcbiAgICApO1xuICAgIHNldElmRXhpc3RzKFxuICAgICAgJ2Jvb2tpbmdEYXRlTGVzc1RoYW4nLFxuICAgICAgKG9wdGlvbikgPT4gb3B0aW9uLmRhdGUgJiYgb3B0aW9uLmRhdGUudG8gJiYgT2JqZWN0LmtleXMob3B0aW9uLmRhdGUudG8pLmxlbmd0aCxcbiAgICAgIChvcHRpb24pID0+IGZvcm1hdERhdGUobmV3IERhdGUob3B0aW9uLmRhdGUudG8pKSxcbiAgICApO1xuICAgIHNldElmRXhpc3RzKFxuICAgICAgJ2Zyb21DaGVja1NlcmlhbE51bWJlcicsXG4gICAgICAob3B0aW9uKSA9PiBvcHRpb24uY2hlY2tTZXJpYWxOdW1iZXIgJiYgb3B0aW9uLmNoZWNrU2VyaWFsTnVtYmVyLmZyb20sXG4gICAgICAob3B0aW9uKSA9PiBvcHRpb24uY2hlY2tTZXJpYWxOdW1iZXIuZnJvbSxcbiAgICApO1xuICAgIHNldElmRXhpc3RzKFxuICAgICAgJ3RvQ2hlY2tTZXJpYWxOdW1iZXInLFxuICAgICAgKG9wdGlvbikgPT4gb3B0aW9uLmNoZWNrU2VyaWFsTnVtYmVyICYmIG9wdGlvbi5jaGVja1NlcmlhbE51bWJlci50byxcbiAgICAgIChvcHRpb24pID0+IG9wdGlvbi5jaGVja1NlcmlhbE51bWJlci50byxcbiAgICApO1xuXG4gICAgcmV0dXJuIHBhcmFtcztcbiAgfVxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY29tcGxleGl0eVxuICBleHBvcnQgZnVuY3Rpb24gZnJvbUh0dHBHZXRQYXJhbXMocGFyYW1zOiBhbnkpOiBUcmFuc2FjdGlvbnNGaWx0ZXJPcHRpb25zIHtcbiAgICBjb25zdCBvcHRpb25zOiBUcmFuc2FjdGlvbnNGaWx0ZXJPcHRpb25zID0ge307XG5cbiAgICBpZiAocGFyYW1zLmNyZWRpdERlYml0SW5kaWNhdG9yKSB7XG4gICAgICBvcHRpb25zLmNyZWRpdERlYml0SW5kaWNhdG9yID0geyB2YWx1ZTogcGFyYW1zLmNyZWRpdERlYml0SW5kaWNhdG9yIH07XG4gICAgfVxuXG4gICAgaWYgKHBhcmFtcy50eXBlKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShwYXJhbXMudHlwZSkpIHtcbiAgICAgICAgb3B0aW9ucy50eXBlcyA9IHBhcmFtcy50eXBlLm1hcCgodmFsdWU6IGFueSkgPT4gKHsgdmFsdWUgfSkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb3B0aW9ucy50eXBlcyA9IHsgdmFsdWU6IHBhcmFtcy50eXBlIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHBhcmFtcy5iaWxsaW5nU3RhdHVzKSB7XG4gICAgICBvcHRpb25zLmJpbGxpbmdTdGF0dXMgPSB7IHZhbHVlOiBwYXJhbXMuYmlsbGluZ1N0YXR1cyB9O1xuICAgIH1cblxuICAgIGlmIChwYXJhbXMuYW1vdW50R3JlYXRlclRoYW4pIHtcbiAgICAgIG9wdGlvbnMuYW1vdW50ID0geyBmcm9tOiBwYXJzZUludChwYXJhbXMuYW1vdW50R3JlYXRlclRoYW4sIDEwKSB9O1xuICAgIH1cblxuICAgIGlmIChwYXJhbXMuYW1vdW50TGVzc1RoYW4pIHtcbiAgICAgIG9wdGlvbnMuYW1vdW50ID0ge1xuICAgICAgICAuLi5vcHRpb25zLmFtb3VudCxcbiAgICAgICAgdG86IHBhcnNlSW50KHBhcmFtcy5hbW91bnRMZXNzVGhhbiwgMTApLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAocGFyYW1zLmJvb2tpbmdEYXRlR3JlYXRlclRoYW4pIHtcbiAgICAgIG9wdGlvbnMuZGF0ZSA9IHtcbiAgICAgICAgZnJvbTogcGFyYW1zLmJvb2tpbmdEYXRlR3JlYXRlclRoYW4sXG4gICAgICB9O1xuICAgIH1cblxuICAgIGlmIChwYXJhbXMuYm9va2luZ0RhdGVMZXNzVGhhbikge1xuICAgICAgb3B0aW9ucy5kYXRlID0ge1xuICAgICAgICAuLi5vcHRpb25zLmRhdGUsXG4gICAgICAgIHRvOiBwYXJhbXMuYm9va2luZ0RhdGVMZXNzVGhhbixcbiAgICAgIH07XG4gICAgfVxuXG4gICAgaWYgKHBhcmFtcy5mcm9tQ2hlY2tTZXJpYWxOdW1iZXIpIHtcbiAgICAgIG9wdGlvbnMuY2hlY2tTZXJpYWxOdW1iZXIgPSB7XG4gICAgICAgIGZyb206IHBhcnNlSW50KHBhcmFtcy5mcm9tQ2hlY2tTZXJpYWxOdW1iZXIsIDEwKSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgaWYgKHBhcmFtcy50b0NoZWNrU2VyaWFsTnVtYmVyKSB7XG4gICAgICBvcHRpb25zLmNoZWNrU2VyaWFsTnVtYmVyID0ge1xuICAgICAgICAuLi5vcHRpb25zLmNoZWNrU2VyaWFsTnVtYmVyLFxuICAgICAgICB0bzogcGFyc2VJbnQocGFyYW1zLnRvQ2hlY2tTZXJpYWxOdW1iZXIsIDEwKSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIG9wdGlvbnM7XG4gIH1cbn1cbi8qIGVzbGludC1lbmFibGUgbm8tcmVkZWNsYXJlKi9cbiJdfQ==