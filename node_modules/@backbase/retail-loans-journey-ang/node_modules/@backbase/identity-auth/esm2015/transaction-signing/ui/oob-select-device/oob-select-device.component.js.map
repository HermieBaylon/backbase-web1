{"version":3,"file":"oob-select-device.component.js","sourceRoot":"","sources":["../../../../../../../libs/identity-auth/transaction-signing/ui/oob-select-device/oob-select-device.component.ts","../../../../../../../libs/identity-auth/transaction-signing/ui/oob-select-device/oob-select-device.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,uBAAuB,EAAE,SAAS,EAAE,YAAY,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,eAAe,CAAC;AAChG,OAAO,EAAE,WAAW,EAAa,UAAU,EAAE,MAAM,gBAAgB,CAAC;;;;;;;;AAQpE,MAAM,OAAO,0CAA0C;IA0BrD,YAA6B,WAAwB;QAAxB,gBAAW,GAAX,WAAW,CAAa;QAzB3C,WAAM,GAAG,IAAI,YAAY,EAAQ,CAAC;QAClC,gBAAW,GAAG,IAAI,YAAY,EAAS,CAAC;QACxC,mBAAc,GAAG,IAAI,YAAY,EAAwB,CAAC;QAgB3D,SAAI,GAAc,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;YAChD,MAAM,EAAE,CAAC,SAAS,EAAE,UAAU,CAAC,QAAQ,CAAC;SACzC,CAAC,CAAC;QAGH,eAAU,GAAG,KAAK,CAAC;IAEqC,CAAC;IArBzD,IACI,IAAI,CAAC,KAAmC;QAC1C,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;IAC7B,CAAC;IAED,IAAI,IAAI;QACN,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;YACvB,MAAM,IAAI,KAAK,CAAC,uBAAuB,CAAC,CAAC;SAC1C;QACD,OAAO,IAAI,CAAC,aAAa,CAAC;IAC5B,CAAC;IAaD,QAAQ;QACN,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QACvB,IAAI,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;YACrB,OAAO;SACR;QAED,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,EAA0B,CAAC,CAAC;IAClG,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;IACrB,CAAC;IAED,qBAAqB,CAAC,MAA6B;QACjD,OAAO,OAAO,MAAM,CAAC,YAAY,KAAK,QAAQ,CAAC;IACjD,CAAC;IAED,wBAAwB,CAAC,MAA6B;QACpD,OAAO,MAAM,CAAC,MAAM,IAAI,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,IAAI,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC;IACpF,CAAC;IAED,IAAI,wBAAwB;QAC1B,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;IACjC,CAAC;;2JAnDU,0CAA0C;+IAA1C,0CAA0C,uNCTvD,+0JAoHA;4FD3Ga,0CAA0C;kBALtD,SAAS;mBAAC;oBACT,QAAQ,EAAE,0CAA0C;oBACpD,WAAW,EAAE,kCAAkC;oBAC/C,eAAe,EAAE,uBAAuB,CAAC,MAAM;iBAChD;kGAEW,MAAM;sBAAf,MAAM;gBACG,WAAW;sBAApB,MAAM;gBACG,cAAc;sBAAvB,MAAM;gBAGH,IAAI;sBADP,KAAK;gBAYG,KAAK;sBAAb,KAAK","sourcesContent":["import { ChangeDetectionStrategy, Component, EventEmitter, Input, Output } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ChallengeError, ChallengeOobSelectDeviceData, DeviceInformationData, OobSelectDeviceEvent } from '../../util';\n\n@Component({\n  selector: 'bb-transaction-signing-oob-select-device',\n  templateUrl: 'oob-select-device.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class TransactionSigningOobSelectDeviceComponent {\n  @Output() cancel = new EventEmitter<void>();\n  @Output() acceptError = new EventEmitter<Error>();\n  @Output() submitResponse = new EventEmitter<OobSelectDeviceEvent>();\n\n  @Input()\n  set data(value: ChallengeOobSelectDeviceData) {\n    this.challengeData = value;\n  }\n\n  get data(): ChallengeOobSelectDeviceData | never {\n    if (!this.challengeData) {\n      throw new Error('No challenge data set');\n    }\n    return this.challengeData;\n  }\n\n  @Input() error: ChallengeError | undefined;\n\n  readonly form: FormGroup = this.formBuilder.group({\n    device: [undefined, Validators.required],\n  });\n\n  challengeData: ChallengeOobSelectDeviceData | undefined;\n  showErrors = false;\n\n  constructor(private readonly formBuilder: FormBuilder) {}\n\n  onSubmit(): void {\n    this.showErrors = true;\n    if (this.form.invalid) {\n      return;\n    }\n\n    this.submitResponse.emit({ deviceId: this.form.controls.device.value } as OobSelectDeviceEvent);\n  }\n\n  onCancel(): void {\n    this.cancel.emit();\n  }\n\n  deviceHasFriendlyName(device: DeviceInformationData): boolean {\n    return typeof device.friendlyName === 'string';\n  }\n\n  deviceGetVendorModelName(device: DeviceInformationData): string | boolean {\n    return device.vendor && device.model ? `${device.vendor} ${device.model}` : false;\n  }\n\n  get showDeviceNotChosenError(): boolean {\n    return !this.form.value.device;\n  }\n}\n","<bb-transaction-signing-error *ngIf=\"error; else displayForm\" [error]=\"error\" (closeModal)=\"acceptError.emit($event)\">\n</bb-transaction-signing-error>\n\n<ng-template #displayForm>\n  <form [formGroup]=\"form\" (submit)=\"onSubmit()\" class=\"bb-block bb-block--md\">\n    <label\n      for=\"bb-transaction-signing-select-device-dropdown\"\n      i18n=\"Select device text@@bb-oob-select-device-signing.text.label\"\n    >\n      Select the device you would like to sign this transaction with.\n    </label>\n    <p>\n      <small i18n=\"Devices ordered text@@bb-oob-select-device-signing.text.hint\">\n        (Devices ordered by most recent registered)\n      </small>\n    </p>\n\n    <div class=\"form-group\">\n      <bb-dropdown-single-select-ui\n        data-role=\"ts-select-device-control\"\n        id=\"bb-transaction-signing-select-device-dropdown\"\n        i18n-placeholder=\"Select device placeholder@@bb-oob-select-device-signing.input.select-placeholder\"\n        placeholder=\"Select a device...\"\n        formControlName=\"device\"\n        [required]=\"true\"\n      >\n        <ng-container *ngIf=\"challengeData && challengeData.devices\">\n          <ng-container *ngFor=\"let device of challengeData.devices\">\n            <bb-dropdown-single-select-option-ui\n              *ngIf=\"deviceHasFriendlyName(device); else noFriendlyNameDevice\"\n              data-role=\"ts-oob-select-device-option-with-name\"\n              label=\"{{ device.friendlyName }} (Registered on: {{ device.created | date: 'medium' }})\"\n              i18n-label=\"\n                Select device friendly name option@@bb-oob-select-device-signing.input.select-option-friendly-name\"\n              [value]=\"device.deviceId\"\n            >\n            </bb-dropdown-single-select-option-ui>\n\n            <ng-template #noFriendlyNameDevice>\n              <ng-container\n                *ngIf=\"device.vendor && device.model; then displayVendorModelDevice; else displayUnknownDevice\"\n              ></ng-container>\n            </ng-template>\n\n            <ng-template #displayVendorModelDevice>\n              <bb-dropdown-single-select-option-ui\n                data-role=\"ts-oob-select-device-option-with-vendor-model\"\n                label=\"{{ deviceGetVendorModelName(device) }} (Registered on: {{ device.created | date: 'medium' }})\"\n                i18n-label=\"\n                  Select device vendor model option@@bb-oob-select-device-signing.input.select-option-vendor-model\"\n                [value]=\"device.deviceId\"\n              >\n              </bb-dropdown-single-select-option-ui>\n            </ng-template>\n            <ng-template #displayUnknownDevice>\n              <bb-dropdown-single-select-option-ui\n                data-role=\"ts-oob-select-device-option-without-name\"\n                label=\"Unknown Device (Registered on: {{ device.created | date: 'medium' }})\"\n                i18n-label=\"Select device unknown option@@bb-oob-select-device-signing.input.select-option-unknown\"\n                [value]=\"device.deviceId\"\n              >\n              </bb-dropdown-single-select-option-ui>\n            </ng-template>\n          </ng-container>\n        </ng-container>\n      </bb-dropdown-single-select-ui>\n      <bb-input-validation-message-ui [showErrors]=\"showErrors\">\n        <span\n          *ngIf=\"showDeviceNotChosenError\"\n          data-role=\"ts-oob-select-device-missing-error\"\n          i18n=\"Device not chosen error message@@bb-oob-select-device-signing.errors.missing\"\n        >\n          You must choose a device.\n        </span>\n      </bb-input-validation-message-ui>\n    </div>\n\n    <p>\n      <strong\n        i18n=\"Selected device action description@@bb-oob-select-device-signing.text.selected-action-description\"\n        data-role=\"ts-select-device-validation-message\"\n      >\n        Your selected device will be sent a notification to sign the transaction.\n      </strong>\n    </p>\n    <hr />\n    <p>\n      <small i18n=\"Navigation away notice@@bb-oob-select-device-signing.text.navigation-away\">\n        Note: Navigation away from this modal will result in a cancellation of this transaction signing process.\n      </small>\n    </p>\n\n    <div class=\"bb-button-bar\">\n      <button\n        bbButton\n        data-role=\"ts-select-device-continue\"\n        class=\"bb-button-bar__button\"\n        color=\"primary\"\n        type=\"submit\"\n        i18n=\"Complete button@@bb-oob-select-device-signing.complete\"\n      >\n        Continue\n      </button>\n      <button\n        bbButton\n        data-role=\"ts-select-device-cancel\"\n        class=\"bb-button-bar__button\"\n        color=\"secondary\"\n        (click)=\"onCancel()\"\n        i18n=\"Cancel button@@bb-oob-select-device-signing.cancel\"\n      >\n        Cancel transaction\n      </button>\n    </div>\n  </form>\n</ng-template>\n"]}