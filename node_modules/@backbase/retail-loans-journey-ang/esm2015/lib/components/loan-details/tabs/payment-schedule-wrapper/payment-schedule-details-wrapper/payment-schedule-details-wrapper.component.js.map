{"version":3,"file":"payment-schedule-details-wrapper.component.js","sourceRoot":"","sources":["../../../../../../../../../../libs/retail-loans-journey/src/lib/components/loan-details/tabs/payment-schedule-wrapper/payment-schedule-details-wrapper/payment-schedule-details-wrapper.component.ts","../../../../../../../../../../libs/retail-loans-journey/src/lib/components/loan-details/tabs/payment-schedule-wrapper/payment-schedule-details-wrapper/payment-schedule-details-wrapper.component.html"],"names":[],"mappings":"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","sourcesContent":["import { ChangeDetectionStrategy, Component, Inject } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { DOCUMENT } from '@angular/common';\nimport { filter, pluck, takeUntil } from 'rxjs/operators';\nimport { combineLatest, Observable } from 'rxjs';\n\nimport { NgbModalOptions } from '@ng-bootstrap/ng-bootstrap';\n\nimport { DestroyableComponent, Loan } from '@backbase/loans-collection-ui-ang';\nimport { PresentationAmortizationPayment } from '@backbase/data-ang/loans';\n\nimport { scheduleIdParam } from '../../../../../config/route-params.model';\nimport { PaymentScheduleStoreService } from '../../../../../store/payment-schedule/store.service';\nimport { isErrorState, isLoadingState, stateMap } from '../../../../../utils/call-state.util';\nimport { LoansStoreService } from '../../../../../store/loans/store.service';\nimport { RemoteConfigService } from '@backbase/remote-config-ang';\nimport { RetailAppRemoteConfig } from '../../../../../models/remote-config.model';\n\n/**\n * @dynamic\n */\n@Component({\n  selector: 'bb-payment-schedule-details-wrapper',\n  templateUrl: './payment-schedule-details-wrapper.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class PaymentScheduleDetailsWrapperComponent extends DestroyableComponent {\n  private readonly callStates$ = combineLatest([\n    this.paymentScheduleStoreService.amortizedPaymentCallState$,\n    this.loansStoreService.loanCallState$,\n  ]);\n  /**\n   *  Stream of payment id param\n   */\n  readonly paymentId$: Observable<string> = this.activatedRoute.params.pipe(pluck(scheduleIdParam));\n  /**\n   * Stream of scheduled amortized payment\n   */\n  readonly amortizedPayment$: Observable<PresentationAmortizationPayment | undefined> =\n    this.paymentScheduleStoreService.amortizedPayment$;\n  /**\n   * Flag represents loading state\n   */\n  readonly isLoading$: Observable<boolean> = this.callStates$.pipe(stateMap(isLoadingState));\n  /**\n   * Flag represents error state\n   */\n  readonly isErrorState$: Observable<boolean> = this.callStates$.pipe(stateMap(isErrorState));\n  /**\n   * Stream of loan\n   */\n  readonly loan$: Observable<Loan | undefined> = this.loansStoreService.loan$;\n  /**\n   * Hide or show payment status\n   */\n  readonly showPaymentStatus = this.remoteConfig.getValue('show_payment_status_retail_loans');\n  /**\n   * Modal options\n   */\n  readonly modalOptions: NgbModalOptions = {\n    backdrop: 'static',\n    keyboard: true,\n    centered: true,\n    ariaDescribedBy: 'bb-payment-schedule-details-modal-body',\n  };\n\n  constructor(\n    private readonly activatedRoute: ActivatedRoute,\n    private readonly router: Router,\n    private readonly paymentScheduleStoreService: PaymentScheduleStoreService,\n    private readonly loansStoreService: LoansStoreService,\n    @Inject(DOCUMENT) private readonly document: Document,\n    private readonly remoteConfig: RemoteConfigService<RetailAppRemoteConfig>,\n  ) {\n    super();\n\n    combineLatest([this.paymentId$, this.loan$])\n      .pipe(\n        filter(([, loan]) => Boolean(loan)),\n        takeUntil(this.componentDestroyed$),\n      )\n      .subscribe(([amortizationPaymentId, loan]) => {\n        this.paymentScheduleStoreService.fetchAmortizationPayment({ loanId: (loan as Loan).id, amortizationPaymentId });\n      });\n  }\n\n  onCloseModal(): void {\n    this.router.navigate(['..'], { relativeTo: this.activatedRoute });\n  }\n\n  onPrint(): void {\n    this.document.defaultView?.print();\n  }\n}\n","<bb-modal-ui\n  [modalOptions]=\"modalOptions\"\n  [isOpen]=\"true\"\n  (isOpenChange)=\"onCloseModal()\"\n  data-role=\"bb-loan-payment-schedule-details-modal\"\n>\n  <bb-modal-header-ui>\n    <ng-template bbCustomModalHeader>\n      <bb-payment-schedule-details-modal-header\n        class=\"bb-stack\"\n        data-role=\"bb-loan-payment-schedule-details-modal__header\"\n        (closeModal)=\"onCloseModal()\"\n        (printModal)=\"onPrint()\"\n      ></bb-payment-schedule-details-modal-header>\n    </ng-template>\n  </bb-modal-header-ui>\n  <bb-modal-body-ui>\n    <ng-template bbCustomModalBody>\n      <bb-loans-main-container\n        [isLoadingState]=\"isLoading$ | async\"\n        [isErrorState]=\"isErrorState$ | async\"\n        [containerHeightFitToContent]=\"true\"\n        rootWrapperClasses=\"\"\n        contentWrapperClasses=\"\"\n      >\n        <bb-loan-amortized-payment-schedule-details\n          data-role=\"bb-loan-payment-schedule-details-modal__body\"\n          *ngIf=\"amortizedPayment$ | async as amortizedPayment\"\n          [amortizationPayment]=\"amortizedPayment\"\n          [loan]=\"(loan$ | async)!\"\n          [id]=\"modalOptions.ariaDescribedBy\"\n          [showStatus]=\"showPaymentStatus\"\n        ></bb-loan-amortized-payment-schedule-details>\n      </bb-loans-main-container>\n    </ng-template>\n  </bb-modal-body-ui>\n</bb-modal-ui>\n"]}