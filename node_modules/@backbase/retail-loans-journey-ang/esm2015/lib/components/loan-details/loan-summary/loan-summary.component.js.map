{"version":3,"file":"loan-summary.component.js","sourceRoot":"","sources":["../../../../../../../../libs/retail-loans-journey/src/lib/components/loan-details/loan-summary/loan-summary.component.ts","../../../../../../../../libs/retail-loans-journey/src/lib/components/loan-details/loan-summary/loan-summary.component.html"],"names":[],"mappings":"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","sourcesContent":["import { LOAN_JOURNEY_COMMUNICATOR, LoanCommunicationService } from '../../../services/communication.service';\nimport { ChangeDetectionStrategy, Component, Inject, Input, Optional } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { CONDITIONS, PropertyResolver } from '@backbase/foundation-ang/entitlements';\nimport {\n  Loan,\n  LoanDefaultViewType,\n  PaymentOptions,\n  RetailLoanSummaryDataConfig,\n} from '@backbase/loans-collection-ui-ang';\nimport { ACCOUNT_ALIAS_DISPLAYING_LEVEL, AccountAliasDisplayingLevel } from '@backbase/product-summary-common-ang';\nimport { InputInlineEditState } from '@backbase/ui-ang/input-inline-edit';\n\nimport { LoanDetailsBaseComponent } from '../../base/loan-details/loan-details-base-component';\nimport { accountEditEntitlementsConfig, getRetailLoanSummaryDataConfig } from './loan-summary.config';\nimport { LoansStoreService } from '../../../store/loans/store.service';\nimport { PresentationPaymentOptions } from '@backbase/data-ang/loans';\nimport { RemoteConfigService } from '@backbase/remote-config-ang';\nimport { RetailAppRemoteConfig } from '../../../models/remote-config.model';\n\n@Component({\n  selector: 'bb-loan-summary',\n  templateUrl: './loan-summary.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class LoanSummaryComponent extends LoanDetailsBaseComponent<RetailLoanSummaryDataConfig> {\n  owedAmountFocus: boolean | undefined;\n\n  /**\n   * Loan id\n   */\n  @Input() set loanId(id: string) {\n    this.storeService.fetchLoanById(id);\n  }\n  /**\n   * Stream represents edit states for loan alias\n   */\n  readonly aliasEditState$: Observable<InputInlineEditState> = this.storeService.aliasEditState$;\n  /**\n   * Flag represents user permissions to edit an alias\n   */\n  readonly canEditAlias!: Promise<boolean>;\n\n  readonly PaymentOptions = PaymentOptions;\n\n  readonly LoanDefaultViewType = LoanDefaultViewType;\n\n  constructor(\n    storeService: LoansStoreService,\n    @Inject(CONDITIONS) private readonly conditions: PropertyResolver,\n    @Optional()\n    @Inject(ACCOUNT_ALIAS_DISPLAYING_LEVEL)\n    private readonly accountAliasDisplayingLevel: AccountAliasDisplayingLevel,\n    @Optional() @Inject(LOAN_JOURNEY_COMMUNICATOR) public loanCommunication: LoanCommunicationService,\n    private remoteConfig: RemoteConfigService<RetailAppRemoteConfig>,\n  ) {\n    super(storeService);\n\n    this.accountAliasDisplayingLevel = accountAliasDisplayingLevel || AccountAliasDisplayingLevel.USER;\n    this.canEditAlias = this.conditions.resolveEntitlements(\n      accountEditEntitlementsConfig[this.accountAliasDisplayingLevel],\n    );\n  }\n  /**\n   * Configuration for loan summary container\n   */\n  getDataConfig({ viewType }: Loan): RetailLoanSummaryDataConfig {\n    const owedAmountFocus = this.remoteConfig.getValue('owed_amount_focus');\n\n    return getRetailLoanSummaryDataConfig(viewType, owedAmountFocus);\n  }\n\n  /**\n   * Updates a loan alias\n   *\n   * @param name\n   */\n  onUpdateAlias(name: string): void {\n    this.storeService.updateAlias(name);\n  }\n\n  /**\n   * Cancel(discard) current loan alias update\n   */\n  onCancelAliasUpdate(): void {\n    this.storeService.cancelAliasUpdate();\n  }\n\n  onDrawAmount(): void {\n    if (this.loanCommunication) {\n      this.loanCommunication.navigateToLoanAdvance();\n    } else {\n      throw new Error('[bb-loans]: Communication service is missing');\n    }\n  }\n\n  onPayDown(): void {\n    if (this.loanCommunication) {\n      this.loanCommunication.navigateToLoanPayment();\n    } else {\n      throw new Error('[bb-loans]: Communication service is missing');\n    }\n  }\n\n  getAllowedPaymentOption(paymentOptionName: PaymentOptions, options: PresentationPaymentOptions | undefined): boolean {\n    return (\n      !!options?.paymentOptions.find((option) => option.name === paymentOptionName)?.allowed && !!this.loanCommunication\n    );\n  }\n}\n","<bb-loans-main-container [isLoadingState]=\"isLoading$ | async\" [isErrorState]=\"isErrorState$ | async\">\n  <bb-retail-loan-summary-container\n    *ngIf=\"loan$ | async as loan\"\n    [loan]=\"loan\"\n    [dataConfig]=\"getDataConfig(loan)\"\n    [showPayDownButton]=\"getAllowedPaymentOption(PaymentOptions.LoanPayment, loan.paymentOptions)\"\n    [showDrawAmountButton]=\"getAllowedPaymentOption(PaymentOptions.LoanAdvance, loan.paymentOptions)\"\n    [showFormula]=\"false\"\n    [showInterestRateOnTop]=\"loan.loanType === LoanDefaultViewType.Mortgage\"\n    [owedAmountFocus]=\"owedAmountFocus\"\n    (updateAlias)=\"onUpdateAlias($event)\"\n    (cancelAliasUpdate)=\"onCancelAliasUpdate()\"\n    (drawAmount)=\"onDrawAmount()\"\n    (payDown)=\"onPayDown()\"\n  ></bb-retail-loan-summary-container>\n</bb-loans-main-container>\n"]}