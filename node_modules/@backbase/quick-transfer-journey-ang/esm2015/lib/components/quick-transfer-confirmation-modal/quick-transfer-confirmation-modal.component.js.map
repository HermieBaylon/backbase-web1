{"version":3,"file":"quick-transfer-confirmation-modal.component.js","sourceRoot":"","sources":["../../../../../../../libs/quick-transfer-journey/src/lib/components/quick-transfer-confirmation-modal/quick-transfer-confirmation-modal.component.ts","../../../../../../../libs/quick-transfer-journey/src/lib/components/quick-transfer-confirmation-modal/quick-transfer-confirmation-modal.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,uBAAuB,EAAE,SAAS,EAAE,KAAK,EAAa,MAAM,eAAe,CAAC;AACrF,OAAO,EAAE,aAAa,EAA4B,MAAM,MAAM,CAAC;AAC/D,OAAO,EAAE,IAAI,EAAE,MAAM,gBAAgB,CAAC;AAGtC,OAAO,EAAa,YAAY,EAAE,MAAM,0BAA0B,CAAC;AACnE,OAAO,EAAE,SAAS,EAAE,MAAM,yBAAyB,CAAC;AACpD,OAAO,EAAE,yBAAyB,EAAE,MAAM,2BAA2B,CAAC;AACtE,OAAO,EAAE,cAAc,EAAE,MAAM,4BAA4B,CAAC;;;;;;;;;;AAO5D,MAAM,OAAO,uCAAuC;IA2ClD,YAA6B,KAAgC;QAAhC,UAAK,GAAL,KAAK,CAA2B;QA9B7D;;WAEG;QACM,aAAQ,GAAwC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;QAC7E;;WAEG;QACM,iBAAY,GAAwC,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC;QACrF;;WAEG;QACM,YAAO,GAA2C,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;QAE9E;;WAEG;QACM,YAAO,GAAwB,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC;QAChE;;WAEG;QACM,2BAAsB,GAA0B,IAAI,CAAC,KAAK,CAAC,sBAAsB,CAAC;QAC3F;;WAEG;QACM,iBAAY,GAAG,YAAY,CAAC;QACrC;;WAEG;QACM,cAAS,GAAG,SAAS,CAAC;IAEiC,CAAC;IACjE;;OAEG;IACH,UAAU;QACR,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;IACjC,CAAC;IACD;;OAEG;IACH,aAAa;QACX,IAAI,CAAC,cAAc,GAAG,aAAa,CAAC,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;aAClF,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;aACb,SAAS,CAAC,CAAC,CAAC,WAAW,EAAE,OAAO,EAAE,MAAM,CAAC,EAAE,EAAE;YAC5C,IAAI,WAAW,IAAI,OAAO,IAAI,MAAM,EAAE;gBACpC,MAAM,QAAQ,GAAG,cAAc,CAAC,WAAW,EAAE,OAAO,EAAE,MAAM,EAAE,IAAI,CAAC,YAAY,IAAK,EAAmB,CAAC,CAAC;gBACzG,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;aACvC;QACH,CAAC,CAAC,CAAC;IACP,CAAC;IACD,WAAW;QACT,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,IAAI,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC;SACnC;IACH,CAAC;;wJAnEU,uCAAuC;4IAAvC,uCAAuC,2ICfpD,2vJAiHA;4FDlGa,uCAAuC;kBALnD,SAAS;mBAAC;oBACT,QAAQ,EAAE,yCAAyC;oBACnD,WAAW,EAAE,oDAAoD;oBACjE,eAAe,EAAE,uBAAuB,CAAC,MAAM;iBAChD;gHAKU,YAAY;sBAApB,KAAK;gBAIG,MAAM;sBAAd,KAAK","sourcesContent":["import { ChangeDetectionStrategy, Component, Input, OnDestroy } from '@angular/core';\nimport { combineLatest, Observable, Subscription } from 'rxjs';\nimport { take } from 'rxjs/operators';\nimport { PaymentTypes, QuickTransferJourneyConfiguration } from '../../models/config.model';\nimport { AccountItem, TransferAmount } from '../../models/items.model';\nimport { CallState, LoadingState } from '../../models/state.model';\nimport { ViewState } from '../../models/view.model';\nimport { QuickTransferStoreService } from '../../store/store.service';\nimport { mapPaymentData } from '../../utils/payment-mapper';\n\n@Component({\n  selector: 'bb-quick-transfer-confirmation-modal-ui',\n  templateUrl: './quick-transfer-confirmation-modal.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class QuickTransferConfirmationModalComponent implements OnDestroy {\n  /**\n   * success events array\n   */\n  @Input() paymentTypes?: PaymentTypes;\n  /**\n   * Quick Transfer configuration\n   */\n  @Input() config?: QuickTransferJourneyConfiguration;\n  /**\n   * Subscriptions for form fields\n   */\n  subscriptions$: Subscription | undefined;\n  /**\n   * Stream of toPayee\n   */\n  readonly toPayee$: Observable<AccountItem | undefined> = this.store.toPayee$;\n  /**\n   * Stream of fromAccount\n   */\n  readonly fromAccount$: Observable<AccountItem | undefined> = this.store.fromAccount$;\n  /**\n   * Stream of transfer amount\n   */\n  readonly amount$: Observable<TransferAmount | undefined> = this.store.amount$;\n\n  /**\n   * Stream of isModalOpen\n   */\n  readonly isOpen$: Observable<boolean> = this.store.isModalOpen$;\n  /**\n   * Stream of loading\n   */\n  readonly paymentOrderCallState$: Observable<CallState> = this.store.paymentOrderCallState$;\n  /**\n   * Enum for loadingstate\n   */\n  readonly loadingstate = LoadingState;\n  /**\n   * Enum for current View\n   */\n  readonly viewState = ViewState;\n\n  constructor(private readonly store: QuickTransferStoreService) {}\n  /**\n   * close the modal\n   */\n  closeModal() {\n    this.store.setModalOpen(false);\n  }\n  /**\n   * close the modal\n   */\n  handleConfirm() {\n    this.subscriptions$ = combineLatest([this.fromAccount$, this.toPayee$, this.amount$])\n      .pipe(take(1))\n      .subscribe(([fromAccount, toPayee, amount]) => {\n        if (fromAccount && toPayee && amount) {\n          const postData = mapPaymentData(fromAccount, toPayee, amount, this.paymentTypes || ({} as PaymentTypes));\n          this.store.sendTranferOrder(postData);\n        }\n      });\n  }\n  ngOnDestroy() {\n    if (this.subscriptions$) {\n      this.subscriptions$.unsubscribe();\n    }\n  }\n}\n","<bb-modal-ui\n  class=\"bb-quick-transfer__modal\"\n  [isOpen]=\"isOpen$ | async\"\n  (cancel)=\"closeModal()\"\n  (confirm)=\"handleConfirm()\"\n>\n  <bb-modal-header-ui [title]=\"config?.titles?.[viewState.FORM]\"></bb-modal-header-ui>\n  <bb-modal-body-ui>\n    <ng-template bbCustomModalBody>\n      <div class=\"bb-block bb-block--md\" *ngIf=\"amount$ | async as amount\" data-role=\"quick-transfer-review-amount\">\n        <label\n          class=\"bb-block bb-block--xs font-weight-normal bb-text-support bb-subtitle\"\n          i18n=\"Amount label|Label for transfer amount@@quick-transfer.confirmation-modal.amount-label\"\n          >Amount</label\n        ><br />\n        <bb-amount-ui\n          data-role=\"confirmation-amount\"\n          class=\"bb-highlight\"\n          [currency]=\"amount.currency\"\n          [amount]=\"amount.amount\"\n          [mapCurrency]=\"true\"\n          [showPlusSign]=\"false\"\n        ></bb-amount-ui>\n      </div>\n      <div class=\"bb-stack\">\n        <div\n          class=\"bb-stack__item bb-stack__item--align-top bb-stack__item--spacing-lg bb-quick-transfer__modal-from bb-stack__item--fill\"\n          *ngIf=\"fromAccount$ | async as fromAccount\"\n        >\n          <div class=\"bb-quick-transfer__modal-wrap\">\n            <label\n              class=\"bb-text-support bb-subtitle font-weight-normal bb-block bb-block--xs\"\n              i18n=\"\n                From account label|Label for account to be transferred\n                from@@quick-transfer.confirmation-modal.from-label\"\n              >From</label\n            >\n            <div>\n              <bb-product-item-basic-account-ui\n                data-role=\"confirmation-from-account\"\n                [title]=\"fromAccount.name\"\n                [productNumber]=\"fromAccount.number\"\n                [amount]=\"fromAccount?.balance\"\n                [currency]=\"fromAccount?.currency\"\n                [productNumberFormat]=\"config?.uiComponentProps.accountNumberFormat\"\n                [showCurrencySymbol]=\"config?.uiComponentProps.mapCurrency\"\n                [highlight]=\"config?.uiComponentProps.productItemHighlight\"\n                [active]=\"false\"\n              ></bb-product-item-basic-account-ui>\n            </div>\n          </div>\n        </div>\n        <div class=\"bb-stack__item bb-stack__item--spacing-lg\" aria-hidden=\"true\">\n          <bb-icon-ui name=\"arrow-forward\" size=\"md\"></bb-icon-ui>\n        </div>\n        <div\n          class=\"bb-stack__item bb-stack__item--align-top bb-stack__item--fill\"\n          *ngIf=\"toPayee$ | async as toAccount\"\n        >\n          <div class=\"bb-quick-transfer__modal-wrap\">\n            <label\n              class=\"bb-text-support bb-subtitle font-weight-normal bb-block bb-block--xs\"\n              i18n=\"To account label|Label for account to be transferred to@@quick-transfer.confirmation-modal.to-label\"\n              >To</label\n            >\n            <div>\n              <bb-product-item-basic-account-ui\n                data-role=\"confirmation-to-account\"\n                [title]=\"toAccount.name\"\n                [productNumber]=\"toAccount.number\"\n                [amount]=\"toAccount?.balance\"\n                [currency]=\"toAccount?.currency\"\n                [productNumberFormat]=\"config?.uiComponentProps.accountNumberFormat\"\n                [showCurrencySymbol]=\"config?.uiComponentProps.mapCurrency\"\n                [highlight]=\"config?.uiComponentProps.productItemHighlight\"\n                [active]=\"false\"\n              ></bb-product-item-basic-account-ui>\n            </div>\n          </div>\n        </div>\n      </div>\n    </ng-template>\n  </bb-modal-body-ui>\n  <bb-modal-footer-ui>\n    <ng-template bbCustomModalFooter>\n      <div class=\"bb-button-bar\">\n        <bb-load-button-ui\n          class=\"bb-button-bar__button\"\n          color=\"primary\"\n          (click)=\"handleConfirm()\"\n          i18n=\"Confirm button|Button for to confirm transfer@@quick-transfer.confirmation-modal.confirm\"\n          data-role=\"modal-confirm-button\"\n          [isLoading]=\"(paymentOrderCallState$ | async) === loadingstate.LOADING\"\n        >\n          Confirm transfer\n        </bb-load-button-ui>\n        <button\n          bbButton\n          data-role=\"cancel-button\"\n          color=\"link\"\n          class=\"bb-button-bar__button\"\n          (click)=\"closeModal()\"\n          [disabled]=\"(paymentOrderCallState$ | async) === loadingstate.LOADING\"\n        >\n          <span\n            i18n=\"Cancel button|Button for to cancel transfer confirmation@@quick-transfer.confirmation-modal.cancel\"\n            >Cancel</span\n          >\n        </button>\n      </div>\n    </ng-template>\n  </bb-modal-footer-ui>\n</bb-modal-ui>\n"]}