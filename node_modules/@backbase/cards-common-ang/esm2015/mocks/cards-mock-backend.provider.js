import { Injectable } from '@angular/core';
import { HttpResponse, HTTP_INTERCEPTORS, } from '@angular/common/http';
import { of } from 'rxjs';
import { flatMap, materialize, delay, dematerialize, map } from 'rxjs/operators';
import cardsGetHook from './cards-get';
import cardsGetErrorHook from './cards-get/error';
import cardGetHook from './card-get';
import cardGetErrorHook from './card-get/error';
import cardsLockStatusPostHook from './cards-lock-status-post';
import cardsReplacementPostHook from './cards-replacement-post';
import cardsActivationPostHook from './cards-activation-post';
import cardsLimitsPostHook from './cards-limit-post';
import travelNoticeGetHook from './travel-notice-get';
import travelNoticePostHook from './travel-notice-post';
import travelNoticeDeleteHook from './travel-notice-delete';
import * as i0 from "@angular/core";
export class CardsMockBackendInterceptor {
    intercept(request, next) {
        return of(undefined).pipe(
        // eslint-disable-next-line
        flatMap(() => {
            console.log(request.method, request.urlWithParams);
            if (request.url.endsWith('/cards') && request.method === 'GET') {
                return of(new HttpResponse({
                    body: [],
                    status: 200,
                })).pipe(map(cardsGetHook), map((response) => cardsGetErrorHook(response, request.params)));
            }
            if (request.url.indexOf('/cards/') > -1 && request.method === 'GET') {
                const paymentCardId = request.url.split('/')[request.url.split('/').length - 1];
                return of(new HttpResponse({
                    body: [],
                    status: 200,
                })).pipe(map(() => cardGetHook(paymentCardId)), map((response) => cardGetErrorHook(response)));
            }
            if (request.url.endsWith('/travel-notices') && request.method === 'GET') {
                return of(new HttpResponse({
                    body: [],
                    status: 200,
                })).pipe(map(travelNoticeGetHook));
            }
            if (request.url.endsWith('/travel-notices') && request.method === 'POST') {
                const travelNoticeItem = request.body;
                return of(new HttpResponse({
                    body: [],
                    status: 200,
                })).pipe(map(() => travelNoticePostHook(travelNoticeItem)));
            }
            if (request.url.indexOf('/travel-notices') !== -1 && request.method === 'DELETE') {
                const travelNoticeItemId = request.url.split('/')[request.url.split('/').length - 1];
                return of(new HttpResponse({
                    body: [],
                    status: 200,
                })).pipe(map(() => travelNoticeDeleteHook(travelNoticeItemId)));
            }
            if (request.url.endsWith('/lock-status') && request.method === 'POST') {
                const paymentCardId = request.url.split('/')[request.url.split('/').length - 2];
                return of(new HttpResponse({
                    body: [],
                    status: 200,
                })).pipe(map(() => cardGetHook(paymentCardId)), map((response) => cardsLockStatusPostHook(request, response)));
            }
            if (request.url.endsWith('/replacement') && request.method === 'POST') {
                const paymentCardId = request.url.split('/')[request.url.split('/').length - 2];
                return of(new HttpResponse({
                    body: [],
                    status: 200,
                })).pipe(map(() => cardGetHook(paymentCardId)), map((response) => cardsReplacementPostHook(response)));
            }
            if (request.url.endsWith('/limits') && request.method === 'POST') {
                const paymentCardId = request.url.split('/')[request.url.split('/').length - 2];
                const limits = request.body;
                return of(new HttpResponse({
                    body: [],
                    status: 200,
                })).pipe(map(() => cardGetHook(paymentCardId)), map((response) => cardsLimitsPostHook(response, limits)));
            }
            if (request.url.endsWith('/activation') && request.method === 'POST') {
                const paymentCardId = request.url.split('/')[request.url.split('/').length - 2];
                return of(new HttpResponse({
                    body: [],
                    status: 200,
                })).pipe(map(() => cardGetHook(paymentCardId)), map((response) => cardsActivationPostHook(response)));
            }
            if (request.url.endsWith('/pin/reset') && request.method === 'POST') {
                const paymentCardId = request.url.split('/')[request.url.split('/').length - 3];
                return of(new HttpResponse({
                    body: [],
                    status: 200,
                })).pipe(map(() => cardGetHook(paymentCardId)));
            }
            if (request.url.endsWith('/pin/request') && request.method === 'POST') {
                const paymentCardId = request.url.split('/')[request.url.split('/').length - 3];
                return of(new HttpResponse({
                    body: [],
                    status: 200,
                })).pipe(map(() => cardGetHook(paymentCardId)));
            }
            return next.handle(request);
        }), materialize(), delay(1000), dematerialize());
    }
}
CardsMockBackendInterceptor.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: CardsMockBackendInterceptor, deps: [], target: i0.ɵɵFactoryTarget.Injectable });
CardsMockBackendInterceptor.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: CardsMockBackendInterceptor });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: CardsMockBackendInterceptor, decorators: [{
            type: Injectable
        }] });
export const CardsMockBackendProvider = {
    provide: HTTP_INTERCEPTORS,
    useClass: CardsMockBackendInterceptor,
    multi: true,
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FyZHMtbW9jay1iYWNrZW5kLnByb3ZpZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vbGlicy9jYXJkcy1jb21tb24tYW5nL21vY2tzL2NhcmRzLW1vY2stYmFja2VuZC5wcm92aWRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUE0QixNQUFNLGVBQWUsQ0FBQztBQUNyRSxPQUFPLEVBS0wsWUFBWSxFQUNaLGlCQUFpQixHQUNsQixNQUFNLHNCQUFzQixDQUFDO0FBQzlCLE9BQU8sRUFBYyxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDdEMsT0FBTyxFQUFFLE9BQU8sRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLGFBQWEsRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUVqRixPQUFPLFlBQVksTUFBTSxhQUFhLENBQUM7QUFDdkMsT0FBTyxpQkFBaUIsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRCxPQUFPLFdBQVcsTUFBTSxZQUFZLENBQUM7QUFDckMsT0FBTyxnQkFBZ0IsTUFBTSxrQkFBa0IsQ0FBQztBQUNoRCxPQUFPLHVCQUF1QixNQUFNLDBCQUEwQixDQUFDO0FBQy9ELE9BQU8sd0JBQXdCLE1BQU0sMEJBQTBCLENBQUM7QUFDaEUsT0FBTyx1QkFBdUIsTUFBTSx5QkFBeUIsQ0FBQztBQUM5RCxPQUFPLG1CQUFtQixNQUFNLG9CQUFvQixDQUFDO0FBQ3JELE9BQU8sbUJBQW1CLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxvQkFBb0IsTUFBTSxzQkFBc0IsQ0FBQztBQUN4RCxPQUFPLHNCQUFzQixNQUFNLHdCQUF3QixDQUFDOztBQUc1RCxNQUFNLE9BQU8sMkJBQTJCO0lBQ3RDLFNBQVMsQ0FBQyxPQUF5QixFQUFFLElBQWlCO1FBQ3BELE9BQU8sRUFBRSxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUk7UUFDdkIsMkJBQTJCO1FBQzNCLE9BQU8s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QUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDL0M7WUFFRCxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDOUIsQ0FBQyxDQUFDLEVBQ0YsV0FBVyxFQUFFLEVBQ2IsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUNYLGFBQWEsRUFBRSxDQUNoQixDQUFDO0lBQ0osQ0FBQzs7eUhBckpVLDJCQUEyQjs2SEFBM0IsMkJBQTJCOzRGQUEzQiwyQkFBMkI7a0JBRHZDLFVBQVU7O0FBeUpYLE1BQU0sQ0FBQyxNQUFNLHdCQUF3QixHQUFhO0lBQ2hELE9BQU8sRUFBRSxpQkFBc0Q7SUFDL0QsUUFBUSxFQUFFLDJCQUEyQjtJQUNyQyxLQUFLLEVBQUUsSUFBSTtDQUNaLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBQcm92aWRlciwgSW5qZWN0aW9uVG9rZW4gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIEh0dHBJbnRlcmNlcHRvcixcbiAgSHR0cFJlcXVlc3QsXG4gIEh0dHBIYW5kbGVyLFxuICBIdHRwRXZlbnQsXG4gIEh0dHBSZXNwb25zZSxcbiAgSFRUUF9JTlRFUkNFUFRPUlMsXG59IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBmbGF0TWFwLCBtYXRlcmlhbGl6ZSwgZGVsYXksIGRlbWF0ZXJpYWxpemUsIG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IGNhcmRzR2V0SG9vayBmcm9tICcuL2NhcmRzLWdldCc7XG5pbXBvcnQgY2FyZHNHZXRFcnJvckhvb2sgZnJvbSAnLi9jYXJkcy1nZXQvZXJyb3InO1xuaW1wb3J0IGNhcmRHZXRIb29rIGZyb20gJy4vY2FyZC1nZXQnO1xuaW1wb3J0IGNhcmRHZXRFcnJvckhvb2sgZnJvbSAnLi9jYXJkLWdldC9lcnJvcic7XG5pbXBvcnQgY2FyZHNMb2NrU3RhdHVzUG9zdEhvb2sgZnJvbSAnLi9jYXJkcy1sb2NrLXN0YXR1cy1wb3N0JztcbmltcG9ydCBjYXJkc1JlcGxhY2VtZW50UG9zdEhvb2sgZnJvbSAnLi9jYXJkcy1yZXBsYWNlbWVudC1wb3N0JztcbmltcG9ydCBjYXJkc0FjdGl2YXRpb25Qb3N0SG9vayBmcm9tICcuL2NhcmRzLWFjdGl2YXRpb24tcG9zdCc7XG5pbXBvcnQgY2FyZHNMaW1pdHNQb3N0SG9vayBmcm9tICcuL2NhcmRzLWxpbWl0LXBvc3QnO1xuaW1wb3J0IHRyYXZlbE5vdGljZUdldEhvb2sgZnJvbSAnLi90cmF2ZWwtbm90aWNlLWdldCc7XG5pbXBvcnQgdHJhdmVsTm90aWNlUG9zdEhvb2sgZnJvbSAnLi90cmF2ZWwtbm90aWNlLXBvc3QnO1xuaW1wb3J0IHRyYXZlbE5vdGljZURlbGV0ZUhvb2sgZnJvbSAnLi90cmF2ZWwtbm90aWNlLWRlbGV0ZSc7XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBDYXJkc01vY2tCYWNrZW5kSW50ZXJjZXB0b3IgaW1wbGVtZW50cyBIdHRwSW50ZXJjZXB0b3Ige1xuICBpbnRlcmNlcHQocmVxdWVzdDogSHR0cFJlcXVlc3Q8YW55PiwgbmV4dDogSHR0cEhhbmRsZXIpOiBPYnNlcnZhYmxlPEh0dHBFdmVudDxhbnk+PiB7XG4gICAgcmV0dXJuIG9mKHVuZGVmaW5lZCkucGlwZShcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgICAgZmxhdE1hcCgoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlcXVlc3QubWV0aG9kLCByZXF1ZXN0LnVybFdpdGhQYXJhbXMpO1xuXG4gICAgICAgIGlmIChyZXF1ZXN0LnVybC5lbmRzV2l0aCgnL2NhcmRzJykgJiYgcmVxdWVzdC5tZXRob2QgPT09ICdHRVQnKSB7XG4gICAgICAgICAgcmV0dXJuIG9mKFxuICAgICAgICAgICAgbmV3IEh0dHBSZXNwb25zZSh7XG4gICAgICAgICAgICAgIGJvZHk6IFtdLFxuICAgICAgICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICkucGlwZShcbiAgICAgICAgICAgIG1hcChjYXJkc0dldEhvb2spLFxuICAgICAgICAgICAgbWFwKChyZXNwb25zZSkgPT4gY2FyZHNHZXRFcnJvckhvb2socmVzcG9uc2UsIHJlcXVlc3QucGFyYW1zKSksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyZXF1ZXN0LnVybC5pbmRleE9mKCcvY2FyZHMvJykgPiAtMSAmJiByZXF1ZXN0Lm1ldGhvZCA9PT0gJ0dFVCcpIHtcbiAgICAgICAgICBjb25zdCBwYXltZW50Q2FyZElkID0gcmVxdWVzdC51cmwuc3BsaXQoJy8nKVtyZXF1ZXN0LnVybC5zcGxpdCgnLycpLmxlbmd0aCAtIDFdO1xuXG4gICAgICAgICAgcmV0dXJuIG9mKFxuICAgICAgICAgICAgbmV3IEh0dHBSZXNwb25zZSh7XG4gICAgICAgICAgICAgIGJvZHk6IFtdLFxuICAgICAgICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICkucGlwZShcbiAgICAgICAgICAgIG1hcCgoKSA9PiBjYXJkR2V0SG9vayhwYXltZW50Q2FyZElkKSksXG4gICAgICAgICAgICBtYXAoKHJlc3BvbnNlKSA9PiBjYXJkR2V0RXJyb3JIb29rKHJlc3BvbnNlKSksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyZXF1ZXN0LnVybC5lbmRzV2l0aCgnL3RyYXZlbC1ub3RpY2VzJykgJiYgcmVxdWVzdC5tZXRob2QgPT09ICdHRVQnKSB7XG4gICAgICAgICAgcmV0dXJuIG9mKFxuICAgICAgICAgICAgbmV3IEh0dHBSZXNwb25zZSh7XG4gICAgICAgICAgICAgIGJvZHk6IFtdLFxuICAgICAgICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICkucGlwZShtYXAodHJhdmVsTm90aWNlR2V0SG9vaykpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJlcXVlc3QudXJsLmVuZHNXaXRoKCcvdHJhdmVsLW5vdGljZXMnKSAmJiByZXF1ZXN0Lm1ldGhvZCA9PT0gJ1BPU1QnKSB7XG4gICAgICAgICAgY29uc3QgdHJhdmVsTm90aWNlSXRlbSA9IHJlcXVlc3QuYm9keTtcblxuICAgICAgICAgIHJldHVybiBvZihcbiAgICAgICAgICAgIG5ldyBIdHRwUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICBib2R5OiBbXSxcbiAgICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICApLnBpcGUobWFwKCgpID0+IHRyYXZlbE5vdGljZVBvc3RIb29rKHRyYXZlbE5vdGljZUl0ZW0pKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVxdWVzdC51cmwuaW5kZXhPZignL3RyYXZlbC1ub3RpY2VzJykgIT09IC0xICYmIHJlcXVlc3QubWV0aG9kID09PSAnREVMRVRFJykge1xuICAgICAgICAgIGNvbnN0IHRyYXZlbE5vdGljZUl0ZW1JZCA9IHJlcXVlc3QudXJsLnNwbGl0KCcvJylbcmVxdWVzdC51cmwuc3BsaXQoJy8nKS5sZW5ndGggLSAxXTtcblxuICAgICAgICAgIHJldHVybiBvZihcbiAgICAgICAgICAgIG5ldyBIdHRwUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICBib2R5OiBbXSxcbiAgICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICApLnBpcGUobWFwKCgpID0+IHRyYXZlbE5vdGljZURlbGV0ZUhvb2sodHJhdmVsTm90aWNlSXRlbUlkKSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJlcXVlc3QudXJsLmVuZHNXaXRoKCcvbG9jay1zdGF0dXMnKSAmJiByZXF1ZXN0Lm1ldGhvZCA9PT0gJ1BPU1QnKSB7XG4gICAgICAgICAgY29uc3QgcGF5bWVudENhcmRJZCA9IHJlcXVlc3QudXJsLnNwbGl0KCcvJylbcmVxdWVzdC51cmwuc3BsaXQoJy8nKS5sZW5ndGggLSAyXTtcblxuICAgICAgICAgIHJldHVybiBvZihcbiAgICAgICAgICAgIG5ldyBIdHRwUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICBib2R5OiBbXSxcbiAgICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICApLnBpcGUoXG4gICAgICAgICAgICBtYXAoKCkgPT4gY2FyZEdldEhvb2socGF5bWVudENhcmRJZCkpLFxuICAgICAgICAgICAgbWFwKChyZXNwb25zZSkgPT4gY2FyZHNMb2NrU3RhdHVzUG9zdEhvb2socmVxdWVzdCwgcmVzcG9uc2UpKSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJlcXVlc3QudXJsLmVuZHNXaXRoKCcvcmVwbGFjZW1lbnQnKSAmJiByZXF1ZXN0Lm1ldGhvZCA9PT0gJ1BPU1QnKSB7XG4gICAgICAgICAgY29uc3QgcGF5bWVudENhcmRJZCA9IHJlcXVlc3QudXJsLnNwbGl0KCcvJylbcmVxdWVzdC51cmwuc3BsaXQoJy8nKS5sZW5ndGggLSAyXTtcblxuICAgICAgICAgIHJldHVybiBvZihcbiAgICAgICAgICAgIG5ldyBIdHRwUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICBib2R5OiBbXSxcbiAgICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICApLnBpcGUoXG4gICAgICAgICAgICBtYXAoKCkgPT4gY2FyZEdldEhvb2socGF5bWVudENhcmRJZCkpLFxuICAgICAgICAgICAgbWFwKChyZXNwb25zZSkgPT4gY2FyZHNSZXBsYWNlbWVudFBvc3RIb29rKHJlc3BvbnNlKSksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyZXF1ZXN0LnVybC5lbmRzV2l0aCgnL2xpbWl0cycpICYmIHJlcXVlc3QubWV0aG9kID09PSAnUE9TVCcpIHtcbiAgICAgICAgICBjb25zdCBwYXltZW50Q2FyZElkID0gcmVxdWVzdC51cmwuc3BsaXQoJy8nKVtyZXF1ZXN0LnVybC5zcGxpdCgnLycpLmxlbmd0aCAtIDJdO1xuICAgICAgICAgIGNvbnN0IGxpbWl0cyA9IHJlcXVlc3QuYm9keTtcblxuICAgICAgICAgIHJldHVybiBvZihcbiAgICAgICAgICAgIG5ldyBIdHRwUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICBib2R5OiBbXSxcbiAgICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICApLnBpcGUoXG4gICAgICAgICAgICBtYXAoKCkgPT4gY2FyZEdldEhvb2socGF5bWVudENhcmRJZCkpLFxuICAgICAgICAgICAgbWFwKChyZXNwb25zZSkgPT4gY2FyZHNMaW1pdHNQb3N0SG9vayhyZXNwb25zZSwgbGltaXRzKSksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyZXF1ZXN0LnVybC5lbmRzV2l0aCgnL2FjdGl2YXRpb24nKSAmJiByZXF1ZXN0Lm1ldGhvZCA9PT0gJ1BPU1QnKSB7XG4gICAgICAgICAgY29uc3QgcGF5bWVudENhcmRJZCA9IHJlcXVlc3QudXJsLnNwbGl0KCcvJylbcmVxdWVzdC51cmwuc3BsaXQoJy8nKS5sZW5ndGggLSAyXTtcblxuICAgICAgICAgIHJldHVybiBvZihcbiAgICAgICAgICAgIG5ldyBIdHRwUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICBib2R5OiBbXSxcbiAgICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICApLnBpcGUoXG4gICAgICAgICAgICBtYXAoKCkgPT4gY2FyZEdldEhvb2socGF5bWVudENhcmRJZCkpLFxuICAgICAgICAgICAgbWFwKChyZXNwb25zZSkgPT4gY2FyZHNBY3RpdmF0aW9uUG9zdEhvb2socmVzcG9uc2UpKSxcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJlcXVlc3QudXJsLmVuZHNXaXRoKCcvcGluL3Jlc2V0JykgJiYgcmVxdWVzdC5tZXRob2QgPT09ICdQT1NUJykge1xuICAgICAgICAgIGNvbnN0IHBheW1lbnRDYXJkSWQgPSByZXF1ZXN0LnVybC5zcGxpdCgnLycpW3JlcXVlc3QudXJsLnNwbGl0KCcvJykubGVuZ3RoIC0gM107XG5cbiAgICAgICAgICByZXR1cm4gb2YoXG4gICAgICAgICAgICBuZXcgSHR0cFJlc3BvbnNlKHtcbiAgICAgICAgICAgICAgYm9keTogW10sXG4gICAgICAgICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgKS5waXBlKG1hcCgoKSA9PiBjYXJkR2V0SG9vayhwYXltZW50Q2FyZElkKSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJlcXVlc3QudXJsLmVuZHNXaXRoKCcvcGluL3JlcXVlc3QnKSAmJiByZXF1ZXN0Lm1ldGhvZCA9PT0gJ1BPU1QnKSB7XG4gICAgICAgICAgY29uc3QgcGF5bWVudENhcmRJZCA9IHJlcXVlc3QudXJsLnNwbGl0KCcvJylbcmVxdWVzdC51cmwuc3BsaXQoJy8nKS5sZW5ndGggLSAzXTtcblxuICAgICAgICAgIHJldHVybiBvZihcbiAgICAgICAgICAgIG5ldyBIdHRwUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICBib2R5OiBbXSxcbiAgICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICApLnBpcGUobWFwKCgpID0+IGNhcmRHZXRIb29rKHBheW1lbnRDYXJkSWQpKSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV4dC5oYW5kbGUocmVxdWVzdCk7XG4gICAgICB9KSxcbiAgICAgIG1hdGVyaWFsaXplKCksXG4gICAgICBkZWxheSgxMDAwKSxcbiAgICAgIGRlbWF0ZXJpYWxpemUoKSxcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBDYXJkc01vY2tCYWNrZW5kUHJvdmlkZXI6IFByb3ZpZGVyID0ge1xuICBwcm92aWRlOiBIVFRQX0lOVEVSQ0VQVE9SUyBhcyBJbmplY3Rpb25Ub2tlbjxIdHRwSW50ZXJjZXB0b3JbXT4sXG4gIHVzZUNsYXNzOiBDYXJkc01vY2tCYWNrZW5kSW50ZXJjZXB0b3IsXG4gIG11bHRpOiB0cnVlLFxufTtcbiJdfQ==