{"version":3,"file":"payord-schedule-switch.component.js","sourceRoot":"","sources":["../../../../../../../libs/payord-form-builder-ang/src/lib/components/schedule-switch/payord-schedule-switch.component.ts","../../../../../../../libs/payord-form-builder-ang/src/lib/components/schedule-switch/payord-schedule-switch.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAqB,MAAM,eAAe,CAAC;AAE7D,OAAO,EAEL,qBAAqB,EAErB,cAAc,GACf,MAAM,8BAA8B,CAAC;AACtC,OAAO,EAAE,OAAO,EAAE,MAAM,MAAM,CAAC;AAC/B,OAAO,EAAE,oBAAoB,EAAE,SAAS,EAAE,MAAM,gBAAgB,CAAC;AACjE,OAAO,EAAE,mBAAmB,EAAE,MAAM,4BAA4B,CAAC;AACjE,OAAO,EAAE,WAAW,EAAE,MAAM,6BAA6B,CAAC;;;;;;;;AAM1D,MAAM,OAAO,6BAA6B;IAJ1C;QAQU,aAAQ,GAAG,IAAI,OAAO,EAAE,CAAC;QACxB,OAAE,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;KA0CpC;IAxCC,QAAQ;QACN,mBAAmB,CACjB,IAAI,CAAC,KAAK,EACV,IAAI,CAAC,MAAM,CAAC,IAAI,EAChB,IAAI,CAAC,OAAO,CAAC,UAAU,EACvB,IAAI,CAAC,OAAO,CAAC,eAAe,EAC5B,IAAI,CAAC,OAAO,CAAC,YAAY,EACzB,IAAI,CAAC,MAAM,CACZ,CAAC;QACF,mBAAmB,CAAC,IAAI,CAAC,KAAK,EAAE,cAAc,CAAC,SAAS,CAAC,CAAC;QAC1D,mBAAmB,CAAC,IAAI,CAAC,KAAK,EAAE,cAAc,CAAC,YAAY,CAAC,CAAC;QAE7D,WAAW,CAAC,qBAAqB,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;QAChD,IAAI,CAAC,QAAQ,EAAE,CAAC;IAClB,CAAC;IAED,WAAW;QACT,WAAW,CAAC,qBAAqB,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;QACnD,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;QACrB,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;IAC3B,CAAC;IAEO,QAAQ;;QACd,6DAA6D;QAC7D,MAAA,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,0CAAE,YAAY,CAChD,IAAI,CAAC,oBAAoB,EAAE,EAAE,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,EACrD,SAAS,CAAC,CAAC,WAAW,EAAE,EAAE;;YACzB,yFAAyF;YACzF,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE;gBACvB,MAAM,SAAS,GAAG,WAAW;oBAC3B,CAAC,CAAC,MAAA,IAAI,CAAC,OAAO,CAAC,MAAM,0CAAE,EAAE;oBACzB,CAAC,CAAC,MAAA,IAAI,CAAC,OAAO,CAAC,MAAM,0CAAE,GAAG,CAAC;gBAC7B,MAAM,SAAS,GAAG,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC,SAAS,CAAC;gBACrE,MAAA,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,0CAAE,UAAU,CAAC,SAAS,CAAC,CAAC;gBACrE,MAAA,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,0CAAE,UAAU,CAC1D,SAAS,CACV,CAAC;aACH;QACH,CAAC,CAAC,CAAC;IACP,CAAC;;8IA9CU,6BAA6B;kIAA7B,6BAA6B,oECjB1C,6sDAoDA;4FDnCa,6BAA6B;kBAJzC,SAAS;mBAAC;oBACT,QAAQ,EAAE,8BAA8B;oBACxC,WAAW,EAAE,yCAAyC;iBACvD","sourcesContent":["import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport {\n  PaymentFormFieldConfig,\n  PaymentFormFieldHooks,\n  PaymentFormFieldOptions,\n  ScheduleFields,\n} from '@backbase/payment-orders-ang';\nimport { Subject } from 'rxjs';\nimport { distinctUntilChanged, takeUntil } from 'rxjs/operators';\nimport { registerFormControl } from '../../helpers/form-helpers';\nimport { triggerHook } from '../../helpers/hooks-helpers';\n\n@Component({\n  selector: 'bb-payord-schedule-switch-ui',\n  templateUrl: './payord-schedule-switch.component.html',\n})\nexport class PayordScheduleSwitchComponent implements OnInit, OnDestroy {\n  options!: PaymentFormFieldOptions;\n  config!: PaymentFormFieldConfig;\n  group!: FormGroup;\n  private destroy$ = new Subject();\n  readonly id = new Date().getTime();\n\n  ngOnInit() {\n    registerFormControl(\n      this.group,\n      this.config.name,\n      this.options.validators,\n      this.options.asyncValidators,\n      this.options.defaultValue,\n      this.config\n    );\n    registerFormControl(this.group, ScheduleFields.frequency);\n    registerFormControl(this.group, ScheduleFields.scheduleInfo);\n\n    triggerHook(PaymentFormFieldHooks.onInit, this);\n    this.setValue();\n  }\n\n  ngOnDestroy() {\n    triggerHook(PaymentFormFieldHooks.onDestroy, this);\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  private setValue() {\n    // listen changes to reset value before hiding this component\n    this.group.controls[this.config.name]?.valueChanges\n      .pipe(distinctUntilChanged(), takeUntil(this.destroy$))\n      .subscribe((switchValue) => {\n        // the condition is added to avoid unnecessary subscriptions when the component is hidden\n        if (!this.config.hidden) {\n          const freqValue = switchValue\n            ? this.options.values?.on\n            : this.options.values?.off;\n          const infoValue = switchValue ? this.options.description : undefined;\n          this.group.controls[ScheduleFields.frequency]?.patchValue(freqValue);\n          this.group.controls[ScheduleFields.scheduleInfo]?.patchValue(\n            infoValue\n          );\n        }\n      });\n  }\n}\n","<ng-container *ngIf=\"!config?.hidden\">\n  <div\n    class=\"form-group bb-dynamic-input bb-schedule-switch\"\n    [formGroup]=\"group\"\n    [ngClass]=\"options?.cssClasses\"\n  >\n    <div class=\"bb-inline-stack bb-stack--align-top\">\n      <div class=\"bb-inline-stack__item--spacing-md\">\n        <bb-switch-ui\n          [id]=\"'bb-payord-schedule-switch-' + id\"\n          [formControlName]=\"config.name\"\n        >\n        </bb-switch-ui>\n      </div>\n      <div>\n        <div class=\"b-block bb-block--xs bb-stack bb-schedule-switch__label\">\n          <label\n            [attr.for]=\"'bb-payord-schedule-switch-' + id\"\n            *ngIf=\"options?.label\"\n            class=\"bb-stack__item bb-stack__item--spacing-xs bb-block bb-block--no-margin\"\n            >{{ options?.label }}</label\n          >\n          <span\n            [bbTooltip]=\"options?.tooltipMessage\"\n            placement=\"bottom\"\n            [triggers]=\"'hover'\"\n          >\n            <bb-icon-ui\n              name=\"info\"\n              color=\"secondary\"\n              size=\"sm\"\n              class=\"\"\n            ></bb-icon-ui>\n          </span>\n        </div>\n        <div\n          class=\"bb-subtitle bb-text-support bb-schedule-switch__description\"\n        >\n          <span\n            *ngIf=\"options?.description && group.controls[config.name]?.value\"\n            >{{ options?.description }}</span\n          >\n        </div>\n      </div>\n    </div>\n    <bb-payord-validation-message\n      [control]=\"group?.controls[config.name]\"\n      [validationMessages]=\"options?.validationMessages\"\n      [label]=\"options?.label\"\n    ></bb-payord-validation-message>\n  </div>\n</ng-container>\n"]}