{"version":3,"file":"charge-bearer.component.js","sourceRoot":"","sources":["../../../../../../../libs/payord-form-builder-ang/src/lib/components/charge-bearer/charge-bearer.component.ts","../../../../../../../libs/payord-form-builder-ang/src/lib/components/charge-bearer/charge-bearer.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { registerFormControl } from '../../helpers/form-helpers';\nimport { ActivatableFormField } from '../../models/activatable-form-field';\nimport { VisibilityService } from '../../services/visibility.service';\nimport { triggerHook } from '../../helpers/hooks-helpers';\nimport {\n  PaymentFormFieldHooks,\n  PaymentOptionFields,\n  TemplateModeType,\n} from '@backbase/payment-orders-ang';\nimport { AbstractControl, Validators } from '@angular/forms';\nimport { startWith, tap } from 'rxjs/operators';\nimport { BehaviorSubject, Subscription, Observable } from 'rxjs';\n\n@Component({\n  selector: 'bb-charge-bearer',\n  templateUrl: './charge-bearer.component.html',\n})\nexport class PayordChargeBearerComponent\n  extends ActivatableFormField\n  implements OnInit, OnDestroy\n{\n  chargeBearerOptionsControl?: AbstractControl | null;\n  chargeBearerOptionsSubject$ = new BehaviorSubject<Array<string>>([]);\n  chargeBearerOptions$: Observable<string[]> =\n    this.chargeBearerOptionsSubject$.asObservable();\n  subscription?: Subscription;\n\n  constructor(private readonly visibilityService: VisibilityService) {\n    super(visibilityService);\n  }\n\n  ngOnInit() {\n    this.control = registerFormControl(\n      this.group,\n      this.config.name,\n      this.options.validators,\n      this.options.asyncValidators,\n      this.options.defaultValue,\n      this.config\n    );\n    this.chargeBearerOptionsControl = registerFormControl(\n      this.group,\n      PaymentOptionFields.chargeBearerOptions\n    );\n    if (this.chargeBearerOptionsControl) {\n      this.subscription = this.chargeBearerOptionsControl.valueChanges\n        .pipe(\n          startWith(this.chargeBearerOptionsControl.value),\n          tap((chargeBearerOptions: Array<string> | null) => {\n            chargeBearerOptions = chargeBearerOptions || [];\n            this.control.setValidators(\n              chargeBearerOptions.length ? Validators.required : null\n            );\n            this.control.updateValueAndValidity();\n            if (\n              this.control.value &&\n              chargeBearerOptions.length &&\n              chargeBearerOptions.indexOf(this.control.value) === -1 &&\n              this.options.templateModeType !== TemplateModeType.EDIT\n            ) {\n              this.control.reset();\n            }\n            this.chargeBearerOptionsSubject$.next(chargeBearerOptions);\n          })\n        )\n        .subscribe();\n    }\n    this.toggleDependants();\n    triggerHook(PaymentFormFieldHooks.onInit, this);\n  }\n\n  ngOnDestroy() {\n    if (this.subscription) {\n      this.subscription.unsubscribe();\n    }\n    triggerHook(PaymentFormFieldHooks.onDestroy, this);\n  }\n}\n","<ng-container *ngIf=\"chargeBearerOptions$ | async as chargeBearerOptions\">\n  <ng-container *ngIf=\"chargeBearerOptions.length\">\n    <div\n      *ngIf=\"!config?.hidden\"\n      class=\"bb-dynamic-input form-group charge-bearer-options\"\n      [formGroup]=\"group\"\n      [ngClass]=\"options?.cssClasses\"\n    >\n      <div class=\"bb-label\" [textContent]=\"options?.label || ''\"></div>\n      <span\n        class=\"bb-dynamic-input__helper-text bb-text-support\"\n        *ngIf=\"options?.helperText\"\n        [id]=\"inputEl?.id + '__desc'\"\n        [textContent]=\"options?.helperText\"\n      >\n      </span>\n\n      <bb-input-radio-group-ui\n        [label]=\"options?.label\"\n        [formControlName]=\"config?.name\"\n        (change)=\"toggleDependants()\"\n        [horizontal]=\"options?.horizontal\"\n        [preselect]=\"options?.preselect\"\n        data-role=\"charge-bearer-radio-group\"\n        [bbDynamicAriaAttribute]=\"{\n          charge_bearer__error: control?.touched && control?.invalid,\n          charge_bearer__desc: options?.description\n        }\"\n        [prependInputId]=\"false\"\n        inputSelector=\".bb-input-radio-group\"\n        #inputEl\n      >\n        <bb-input-radio-ui\n          *ngFor=\"let option of chargeBearerOptions\"\n          [value]=\"option\"\n          [labelTemplate]=\"paymentOptionTmpl\"\n          [labelTemplateContext]=\"option\"\n          [attr.data-role]=\"option\"\n        ></bb-input-radio-ui>\n      </bb-input-radio-group-ui>\n      <bb-payord-validation-message\n        [control]=\"group?.controls[config.name]\"\n        [validationMessages]=\"options?.validationMessages\"\n        [label]=\"options?.label\"\n        [id]=\"'charge_bearer__error'\"\n      ></bb-payord-validation-message>\n\n      <div\n        class=\"bb-dynamic-input__desc bb-text-support bb-subtitle\"\n        [attr.aria-hidden]=\"!options?.description\"\n        [hidden]=\"!options?.description\"\n        [id]=\"'charge_bearer__desc'\"\n        [textContent]=\"options?.description || ''\"\n        #descElem\n      ></div>\n    </div>\n  </ng-container>\n</ng-container>\n\n<ng-template let-context=\"labelTemplateContext\" #paymentOptionTmpl>\n  <ng-container [ngSwitch]=\"context\">\n    <div class=\"font-weight-normal\" *ngSwitchCase=\"'OUR'\">\n      I pay all fees (OUR)\n      <div *ngIf=\"control?.value === 'OUR'\" class=\"bb-text-support bb-subtitle\">\n        The beneficiary receives the payment amount in full. You pay the fees\n        charged by our bank initially (fees will be charged separately). You\n        will also pay the fees charged by the payeeâ€™s bank, including any\n        correspondent/intermediary fees (this could be days or weeks after you\n        have made the payment).\n      </div>\n    </div>\n    <div class=\"font-weight-normal\" *ngSwitchCase=\"'BEN'\">\n      <div>Beneficiary pays all fees (BEN)</div>\n      <div *ngIf=\"control?.value === 'BEN'\" class=\"bb-text-support bb-subtitle\">\n        The beneficiary pays any fees charged by our bank and/or the recipient\n        bank (including any correspondent/intermediary fees). The beneficiary\n        will typically receive the payment minus the transfer charges.\n      </div>\n    </div>\n    <div class=\"font-weight-normal\" *ngSwitchCase=\"'SHA'\">\n      <div>Fees are shared (SHA)</div>\n      <div *ngIf=\"control?.value === 'SHA'\" class=\"bb-text-support bb-subtitle\">\n        You pay the fees charged by our bank (fees will be charged separately).\n        The beneficiary will pay all fees charged by their bank, including any\n        correspondent/intermediary fees.\n      </div>\n    </div>\n  </ng-container>\n</ng-template>\n"]}