{"version":3,"file":"form-container.component.js","sourceRoot":"","sources":["../../../../../../../libs/payord-stop-checks-widget-ang/src/lib/containers/form-container/form-container.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { Observable } from 'rxjs';\nimport { pluck, take, withLatestFrom } from 'rxjs/operators';\n\nimport { accMap } from '../../mappers';\nimport { StopCheckRequestInfo } from '../../models/types';\nimport { ApiHttpService } from '../../services/data.service';\nimport { StateService } from '../../store/state.service';\nimport { StopChecksPreferencesService } from '../../services/stop-checks-preferences.service';\nimport {\n  InternalAccountFormItem,\n  pastDateValidator,\n} from '@backbase/payment-orders-ang';\n\n@Component({\n  selector: 'bb-form-container',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  template: `\n    <bb-stop-check-form\n      [currencies]=\"currenciesList | async\"\n      [relativeFormGroup]=\"requestStopCheckFrom\"\n      [payFromAccounts$]=\"accounts$\"\n      [checksRangeNumber]=\"checksRangeNumber | async\"\n      (formSubmit)=\"onContinue()\"\n      (cancelForm)=\"onCancelForm()\"\n    ></bb-stop-check-form>\n  `,\n})\nexport class FormContainerComponent implements OnInit {\n  private fb = new FormBuilder();\n  readonly accounts$: Observable<Array<InternalAccountFormItem>> =\n    this.apiService.debitAccounts$.pipe(\n      withLatestFrom(this.stopChecksPreferencesService.schemeName$),\n      accMap()\n    );\n\n  requestStopCheckFrom!: FormGroup;\n  currenciesList = this.stopChecksPreferencesService.currencies$;\n  checksRangeNumber = this.stopChecksPreferencesService.checksRangeNumber$;\n\n  private buildForm(initValue: StopCheckRequestInfo) {\n    const {\n      payFromAccount: {\n        id,\n        name,\n        accountNumber,\n        balance,\n        currency,\n        accountType,\n      },\n      amountGroup,\n    } = initValue;\n\n    return this.fb.group({\n      payFromAccount: this.fb.group({\n        id: [id, [Validators.required]],\n        name: [name, [Validators.required]],\n        accountNumber: [accountNumber, [Validators.required]],\n        accountType: [accountType, [Validators.required]],\n        balance: [balance],\n        currency: [currency],\n      }),\n      checkNumber: [initValue.checkNumber],\n      firstCheckNumber: [initValue.firstCheckNumber],\n      lastCheckNumber: [initValue.lastCheckNumber],\n      stopRangeType: [initValue.stopRangeType, [Validators.required]],\n      amountGroup: [amountGroup],\n      payeeName: [initValue.payeeName],\n      dateIssued: [initValue.dateIssued],\n      expirationDate: [initValue.expirationDate, [pastDateValidator]],\n      stopReason: [initValue.stopReason],\n      otherReason: [initValue.otherReason],\n    });\n  }\n\n  constructor(\n    private readonly stateService: StateService,\n    private readonly apiService: ApiHttpService,\n    private readonly stopChecksPreferencesService: StopChecksPreferencesService\n  ) {}\n\n  ngOnInit() {\n    this.stateService.store\n      .pipe(pluck('requestInfo'), take(1))\n      .subscribe((requestInfo) => {\n        if (requestInfo) {\n          this.requestStopCheckFrom = this.buildForm(requestInfo);\n        }\n      });\n  }\n\n  onContinue() {\n    if (this.requestStopCheckFrom && this.requestStopCheckFrom.valid) {\n      this.stateService.sendStopRequestToReview(\n        this.requestStopCheckFrom.value\n      );\n    }\n  }\n\n  onCancelForm() {\n    this.stateService.initStopCheckRequest();\n  }\n}\n"]}