import { Component, Directive, Input, TemplateRef, ViewChild } from '@angular/core';
import { BbTemplate } from '@backbase/foundation-ang/core';
import * as i0 from "@angular/core";
import * as i1 from "@backbase/ui-ang/icon";
import * as i2 from "@backbase/ui-ang/file-attachment";
import * as i3 from "../messages-preview/messages-preview.component";
import * as i4 from "@backbase/ui-ang/keyboard-click-directive";
import * as i5 from "@angular/common";
import * as i6 from "@backbase/ui-ang/tooltip-directive";
/**
 * @name MessagesConversationMessageComponent
 *
 * @description
 * Component displays conversation message.
 */
export class MessagesConversationMessageComponent {
    constructor() {
        /**
         * Toggles message collapse (text-truncate and replacement HTML-tags)
         */
        this.opened = false;
        /**
         * Is message body contains html
         */
        this.isBodyHtml = false;
        /**
         * The unique ID HTML property for each widget component instance.
         */
        this.messageId = `messages-conversation-message-${MessagesConversationMessageComponent.counter++}`;
        this.replaceTags = (content) => (content ? content.replace(/<[^>]+>/gi, '') : '');
    }
    /**
     * Text of the message, could have HTML-tags
     */
    set message(value) {
        this.messageText = value;
        this.messageTextWithoutTags = value ? this.replaceTags(value) : undefined;
    }
    /**
     * Toggle message on click
     *
     * @param event Click event
     */
    onClick(event) {
        const selection = document.getSelection();
        if ((selection && selection.toString().length) ||
            (event.target.tagName.toLowerCase() === 'a' && event.target.href)) {
            return;
        }
        this.opened = !this.opened;
    }
    /**
     * Get sender template
     *
     * @returns Sender template
     */
    getSenderTemplate() {
        if (this.sender instanceof TemplateRef) {
            return this.sender;
        }
        return this.defaultSenderTemplate;
    }
    ngOnInit() {
        if (typeof this.messageText === 'undefined') {
            throw new Error(`"message" input is required in "${this.constructor.name}"`);
        }
    }
}
MessagesConversationMessageComponent.counter = 0;
MessagesConversationMessageComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.14", ngImport: i0, type: MessagesConversationMessageComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
MessagesConversationMessageComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.14", type: MessagesConversationMessageComponent, selector: "bb-messages-conversation-message, bb-message-ui", inputs: { created: "created", message: "message", sender: "sender", opened: "opened", attachments: "attachments", isBodyHtml: "isBodyHtml" }, viewQueries: [{ propertyName: "defaultSenderTemplate", first: true, predicate: ["defaultSenderTemplate"], descendants: true, static: true }], ngImport: i0, template: "<ng-container bbMessagesConversationMessageCustomizable [bbHostRef]=\"this\"></ng-container>\n\n<ng-template bbMessagesConversationMessageCustomizable let-host>\n  <div\n    class=\"bb-message-ui card-body\"\n    [attr.role]=\"host.isBodyHtml ? null : 'button'\"\n    (bbKeyboardClick)=\"!host.isBodyHtml && host.onClick($event)\"\n    tabindex=\"0\"\n    data-role=\"conversation-message\"\n    [attr.aria-controls]=\"host.messageId\"\n    [attr.aria-expanded]=\"host.opened\"\n  >\n    <div class=\"bb-stack bb-block--md\">\n      <span class=\"sr-only\" i18n=\"Message from|Before sender name@@messages.messagesCommon.messageFrom\"\n        >Message from</span\n      >\n      <span class=\"bb-text-semi-bold\" data-role=\"sender-name\">\n        <ng-container *ngTemplateOutlet=\"host.getSenderTemplate()\"></ng-container>\n      </span>\n      <div class=\"bb-stack__item bb-stack__item--push-right\">\n        <div class=\"bb-stack\">\n          <bb-icon-ui\n            class=\"bb-stack__item bb-text-support\"\n            *ngIf=\"host.attachments && host.attachments.length\"\n            name=\"attachment\"\n            data-role=\"messages-attachment\"\n            aria-label=\"Contains attachments\"\n            i18n-aria-label=\"\n              Contains attachments|Message contains attachments@@messages.messagesCommon.containsAttachments\"\n            bbTooltip=\"Contains attachments\"\n            i18n-bbTooltip=\"@@messages.messagesCommon.containsAttachments\"\n            triggers=\"hover\"\n            placement=\"top\"\n            container=\"body\"\n          ></bb-icon-ui>\n          <div *ngIf=\"host.created\" data-role=\"messages-creation-date\">\n            <span\n              class=\"sr-only\"\n              i18n=\"Date|'Date:' word that precedes message creation date@@messages.messagesCommon.labelForDate\"\n              >Date:</span\n            >\n            <span>{{ host.created | date: 'fullDate' }} </span>\n            <span\n              i18n=\"At|To bridge date and time (Monday March 28th, 2018 at 9:15 AM)@@messages.messagesCommon.createdAt\"\n              >at</span\n            >\n            <span> {{ host.created | date: 'shortTime' }}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-12\" [ngClass]=\"{ 'col-md-8': !host.opened }\" [attr.id]=\"host.messageId\">\n        <div\n          data-role=\"message-content\"\n          *ngIf=\"!host.isBodyHtml; else htmlViewTmpl\"\n          [innerHtml]=\"host.opened ? host.messageText : host.messageTextWithoutTags\"\n          [ngClass]=\"{\n            'text-truncate': !host.opened,\n            'bb-block--md': host.opened && host.attachments\n          }\"\n        ></div>\n        <div data-role=\"attachments-wrapper\" class=\"row\" *ngIf=\"host.opened && host.attachments?.length\">\n          <div class=\"col-4\" *ngFor=\"let attachment of host.attachments\">\n            <bb-file-attachment-ui\n              [name]=\"attachment.filename\"\n              [size]=\"attachment.size\"\n              [fileContent]=\"attachment.linkStream\"\n            ></bb-file-attachment-ui>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <ng-template #htmlViewTmpl>\n    <bb-messages-body-preview [body]=\"host.messageText\"></bb-messages-body-preview>\n  </ng-template>\n</ng-template>\n\n<ng-template #defaultSenderTemplate>\n  {{ sender }}\n</ng-template>\n", components: [{ type: i0.forwardRef(function () { return i1.IconComponent; }), selector: "bb-icon-ui", inputs: ["name", "inverse", "size", "color", "animate", "aria-label", "cropped", "backgroundType"] }, { type: i0.forwardRef(function () { return i2.FileAttachmentComponent; }), selector: "bb-file-attachment-ui", inputs: ["name", "size", "fileContent", "loading", "deletable", "disabled", "block"], outputs: ["delete"] }, { type: i0.forwardRef(function () { return i3.MessagesBodyPreviewComponent; }), selector: "bb-messages-body-preview, bb-message-preview", inputs: ["body"] }], directives: [{ type: i0.forwardRef(function () { return MessagesConversationMessageCustomizableDirective; }), selector: "[bbMessagesConversationMessageCustomizable]" }, { type: i0.forwardRef(function () { return i4.KeyboardClickDirective; }), selector: "[bbKeyboardClick]", outputs: ["bbKeyboardClick"] }, { type: i0.forwardRef(function () { return i5.NgTemplateOutlet; }), selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet"] }, { type: i0.forwardRef(function () { return i5.NgIf; }), selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i0.forwardRef(function () { return i6.TooltipDirective; }), selector: "[bbTooltip]", inputs: ["bbTooltip", "triggers"] }, { type: i0.forwardRef(function () { return i5.NgClass; }), selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i0.forwardRef(function () { return i5.NgForOf; }), selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }], pipes: { "date": i0.forwardRef(function () { return i5.DatePipe; }) } });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.14", ngImport: i0, type: MessagesConversationMessageComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'bb-messages-conversation-message, bb-message-ui',
                    templateUrl: './messages-conversation-message.component.html',
                }]
        }], propDecorators: { created: [{
                type: Input
            }], message: [{
                type: Input,
                args: ['message']
            }], sender: [{
                type: Input
            }], opened: [{
                type: Input
            }], attachments: [{
                type: Input
            }], isBodyHtml: [{
                type: Input
            }], defaultSenderTemplate: [{
                type: ViewChild,
                args: ['defaultSenderTemplate', { static: true }]
            }] } });
export class MessagesConversationMessageCustomizableDirective extends BbTemplate {
}
MessagesConversationMessageCustomizableDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.14", ngImport: i0, type: MessagesConversationMessageCustomizableDirective, deps: null, target: i0.ɵɵFactoryTarget.Directive });
MessagesConversationMessageCustomizableDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "12.0.0", version: "12.2.14", type: MessagesConversationMessageCustomizableDirective, selector: "[bbMessagesConversationMessageCustomizable]", usesInheritance: true, ngImport: i0 });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.14", ngImport: i0, type: MessagesConversationMessageCustomizableDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[bbMessagesConversationMessageCustomizable]',
                }]
        }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzc2FnZXMtY29udmVyc2F0aW9uLW1lc3NhZ2UuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vbGlicy9tZXNzYWdlcy1jb21tb24vc3JjL2NvbXBvbmVudHMvbWVzc2FnZXMtY29udmVyc2F0aW9uLW1lc3NhZ2UvbWVzc2FnZXMtY29udmVyc2F0aW9uLW1lc3NhZ2UuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vbGlicy9tZXNzYWdlcy1jb21tb24vc3JjL2NvbXBvbmVudHMvbWVzc2FnZXMtY29udmVyc2F0aW9uLW1lc3NhZ2UvbWVzc2FnZXMtY29udmVyc2F0aW9uLW1lc3NhZ2UuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLFdBQVcsRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFNUYsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLCtCQUErQixDQUFDOzs7Ozs7OztBQUUzRDs7Ozs7R0FLRztBQUtILE1BQU0sT0FBTyxvQ0FBb0M7SUFKakQ7UUF5QkU7O1dBRUc7UUFDTSxXQUFNLEdBQUcsS0FBSyxDQUFDO1FBTXhCOztXQUVHO1FBQ00sZUFBVSxHQUFHLEtBQUssQ0FBQztRQWlCNUI7O1dBRUc7UUFDSCxjQUFTLEdBQUcsaUNBQWlDLG9DQUFvQyxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUM7UUF1QzdFLGdCQUFXLEdBQUcsQ0FBQyxPQUFlLEVBQUUsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7S0FDdkc7SUFyRkM7O09BRUc7SUFDSCxJQUNJLE9BQU8sQ0FBQyxLQUF5QjtRQUNuQyxJQUFJLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQztRQUN6QixJQUFJLENBQUMsc0JBQXNCLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7SUFDNUUsQ0FBQztJQXdDRDs7OztPQUlHO0lBQ0gsT0FBTyxDQUFDLEtBQVU7UUFDaEIsTUFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLFlBQVksRUFBRSxDQUFDO1FBRTFDLElBQ0UsQ0FBQyxTQUFTLElBQUksU0FBUyxDQUFDLFFBQVEsRUFBRSxDQUFDLE1BQU0sQ0FBQztZQUMxQyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxLQUFLLEdBQUcsSUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUNqRTtZQUNBLE9BQU87U0FDUjtRQUVELElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQzdCLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsaUJBQWlCO1FBQ2YsSUFBSSxJQUFJLENBQUMsTUFBTSxZQUFZLFdBQVcsRUFBRTtZQUN0QyxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUM7U0FDcEI7UUFFRCxPQUFPLElBQUksQ0FBQyxxQkFBcUIsQ0FBQztJQUNwQyxDQUFDO0lBRUQsUUFBUTtRQUNOLElBQUksT0FBTyxJQUFJLENBQUMsV0FBVyxLQUFLLFdBQVcsRUFBRTtZQUMzQyxNQUFNLElBQUksS0FBSyxDQUFDLG1DQUFtQyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksR0FBRyxDQUFDLENBQUM7U0FDOUU7SUFDSCxDQUFDOztBQXpGYyw0Q0FBTyxHQUFHLENBQUMsQ0FBQztrSUFEaEIsb0NBQW9DO3NIQUFwQyxvQ0FBb0MsbVhDZGpELHc0R0FtRkEsZ29CRDZCYSxnREFBZ0Q7NEZBbEdoRCxvQ0FBb0M7a0JBSmhELFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLGlEQUFpRDtvQkFDM0QsV0FBVyxFQUFFLGdEQUFnRDtpQkFDOUQ7OEJBT1UsT0FBTztzQkFBZixLQUFLO2dCQU1GLE9BQU87c0JBRFYsS0FBSzt1QkFBQyxTQUFTO2dCQVNQLE1BQU07c0JBQWQsS0FBSztnQkFJRyxNQUFNO3NCQUFkLEtBQUs7Z0JBSUcsV0FBVztzQkFBbkIsS0FBSztnQkFLRyxVQUFVO3NCQUFsQixLQUFLO2dCQUtnRCxxQkFBcUI7c0JBQTFFLFNBQVM7dUJBQUMsdUJBQXVCLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFOztBQTREdEQsTUFBTSxPQUFPLGdEQUFpRCxTQUFRLFVBR3JFOzs4SUFIWSxnREFBZ0Q7a0lBQWhELGdEQUFnRDs0RkFBaEQsZ0RBQWdEO2tCQUg1RCxTQUFTO21CQUFDO29CQUNULFFBQVEsRUFBRSw2Q0FBNkM7aUJBQ3hEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBEaXJlY3RpdmUsIElucHV0LCBPbkluaXQsIFRlbXBsYXRlUmVmLCBWaWV3Q2hpbGQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEF0dGFjaG1lbnQgfSBmcm9tICcuLi8uLi9tb2RlbHMvYXR0YWNobWVudC5tb2RlbCc7XG5pbXBvcnQgeyBCYlRlbXBsYXRlIH0gZnJvbSAnQGJhY2tiYXNlL2ZvdW5kYXRpb24tYW5nL2NvcmUnO1xuXG4vKipcbiAqIEBuYW1lIE1lc3NhZ2VzQ29udmVyc2F0aW9uTWVzc2FnZUNvbXBvbmVudFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQ29tcG9uZW50IGRpc3BsYXlzIGNvbnZlcnNhdGlvbiBtZXNzYWdlLlxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdiYi1tZXNzYWdlcy1jb252ZXJzYXRpb24tbWVzc2FnZSwgYmItbWVzc2FnZS11aScsXG4gIHRlbXBsYXRlVXJsOiAnLi9tZXNzYWdlcy1jb252ZXJzYXRpb24tbWVzc2FnZS5jb21wb25lbnQuaHRtbCcsXG59KVxuZXhwb3J0IGNsYXNzIE1lc3NhZ2VzQ29udmVyc2F0aW9uTWVzc2FnZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIHByaXZhdGUgc3RhdGljIGNvdW50ZXIgPSAwO1xuXG4gIC8qKlxuICAgKiBEYXRldGltZSBvZiB0aGUgbWVzc2FnZSBjcmVhdGlvbiwgZm9ybWF0IGRhdGUtdGltZVxuICAgKi9cbiAgQElucHV0KCkgY3JlYXRlZDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBUZXh0IG9mIHRoZSBtZXNzYWdlLCBjb3VsZCBoYXZlIEhUTUwtdGFnc1xuICAgKi9cbiAgQElucHV0KCdtZXNzYWdlJylcbiAgc2V0IG1lc3NhZ2UodmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMubWVzc2FnZVRleHQgPSB2YWx1ZTtcbiAgICB0aGlzLm1lc3NhZ2VUZXh0V2l0aG91dFRhZ3MgPSB2YWx1ZSA/IHRoaXMucmVwbGFjZVRhZ3ModmFsdWUpIDogdW5kZWZpbmVkO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbmRlcnMgbmFtZSBvciB0ZW1wbGF0ZVJlZlxuICAgKi9cbiAgQElucHV0KCkgc2VuZGVyOiBzdHJpbmcgfCBUZW1wbGF0ZVJlZjxhbnk+IHwgdW5kZWZpbmVkO1xuICAvKipcbiAgICogVG9nZ2xlcyBtZXNzYWdlIGNvbGxhcHNlICh0ZXh0LXRydW5jYXRlIGFuZCByZXBsYWNlbWVudCBIVE1MLXRhZ3MpXG4gICAqL1xuICBASW5wdXQoKSBvcGVuZWQgPSBmYWxzZTtcbiAgLyoqXG4gICAqIEFycmF5IG9mIHRoZSBhdHRhY2hlZCBmaWxlc1xuICAgKi9cbiAgQElucHV0KCkgYXR0YWNobWVudHM6IEF0dGFjaG1lbnRbXSB8IHVuZGVmaW5lZDtcblxuICAvKipcbiAgICogSXMgbWVzc2FnZSBib2R5IGNvbnRhaW5zIGh0bWxcbiAgICovXG4gIEBJbnB1dCgpIGlzQm9keUh0bWwgPSBmYWxzZTtcblxuICAvKipcbiAgICogRGVmYXVsdCBzZW5kZXIgdGVtcGxhdGVcbiAgICovXG4gIEBWaWV3Q2hpbGQoJ2RlZmF1bHRTZW5kZXJUZW1wbGF0ZScsIHsgc3RhdGljOiB0cnVlIH0pIGRlZmF1bHRTZW5kZXJUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PiB8IHVuZGVmaW5lZDtcblxuICAvKipcbiAgICogTWVzc2FnZSB0ZXh0XG4gICAqL1xuICBtZXNzYWdlVGV4dDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBNZXNzYWdlIHRleHQgd2l0aG91dCB0YWdzXG4gICAqL1xuICBtZXNzYWdlVGV4dFdpdGhvdXRUYWdzOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIFRoZSB1bmlxdWUgSUQgSFRNTCBwcm9wZXJ0eSBmb3IgZWFjaCB3aWRnZXQgY29tcG9uZW50IGluc3RhbmNlLlxuICAgKi9cbiAgbWVzc2FnZUlkID0gYG1lc3NhZ2VzLWNvbnZlcnNhdGlvbi1tZXNzYWdlLSR7TWVzc2FnZXNDb252ZXJzYXRpb25NZXNzYWdlQ29tcG9uZW50LmNvdW50ZXIrK31gO1xuXG4gIC8qKlxuICAgKiBUb2dnbGUgbWVzc2FnZSBvbiBjbGlja1xuICAgKlxuICAgKiBAcGFyYW0gZXZlbnQgQ2xpY2sgZXZlbnRcbiAgICovXG4gIG9uQ2xpY2soZXZlbnQ6IGFueSkge1xuICAgIGNvbnN0IHNlbGVjdGlvbiA9IGRvY3VtZW50LmdldFNlbGVjdGlvbigpO1xuXG4gICAgaWYgKFxuICAgICAgKHNlbGVjdGlvbiAmJiBzZWxlY3Rpb24udG9TdHJpbmcoKS5sZW5ndGgpIHx8XG4gICAgICAoZXZlbnQudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2EnICYmIGV2ZW50LnRhcmdldC5ocmVmKVxuICAgICkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMub3BlbmVkID0gIXRoaXMub3BlbmVkO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzZW5kZXIgdGVtcGxhdGVcbiAgICpcbiAgICogQHJldHVybnMgU2VuZGVyIHRlbXBsYXRlXG4gICAqL1xuICBnZXRTZW5kZXJUZW1wbGF0ZSgpOiBUZW1wbGF0ZVJlZjxhbnk+IHwgdW5kZWZpbmVkIHtcbiAgICBpZiAodGhpcy5zZW5kZXIgaW5zdGFuY2VvZiBUZW1wbGF0ZVJlZikge1xuICAgICAgcmV0dXJuIHRoaXMuc2VuZGVyO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmRlZmF1bHRTZW5kZXJUZW1wbGF0ZTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIGlmICh0eXBlb2YgdGhpcy5tZXNzYWdlVGV4dCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgXCJtZXNzYWdlXCIgaW5wdXQgaXMgcmVxdWlyZWQgaW4gXCIke3RoaXMuY29uc3RydWN0b3IubmFtZX1cImApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcmVhZG9ubHkgcmVwbGFjZVRhZ3MgPSAoY29udGVudDogc3RyaW5nKSA9PiAoY29udGVudCA/IGNvbnRlbnQucmVwbGFjZSgvPFtePl0rPi9naSwgJycpIDogJycpO1xufVxuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICdbYmJNZXNzYWdlc0NvbnZlcnNhdGlvbk1lc3NhZ2VDdXN0b21pemFibGVdJyxcbn0pXG5leHBvcnQgY2xhc3MgTWVzc2FnZXNDb252ZXJzYXRpb25NZXNzYWdlQ3VzdG9taXphYmxlRGlyZWN0aXZlIGV4dGVuZHMgQmJUZW1wbGF0ZTxcbiAgTWVzc2FnZXNDb252ZXJzYXRpb25NZXNzYWdlQ29tcG9uZW50LFxuICB1bmRlZmluZWRcbj4ge31cbiIsIjxuZy1jb250YWluZXIgYmJNZXNzYWdlc0NvbnZlcnNhdGlvbk1lc3NhZ2VDdXN0b21pemFibGUgW2JiSG9zdFJlZl09XCJ0aGlzXCI+PC9uZy1jb250YWluZXI+XG5cbjxuZy10ZW1wbGF0ZSBiYk1lc3NhZ2VzQ29udmVyc2F0aW9uTWVzc2FnZUN1c3RvbWl6YWJsZSBsZXQtaG9zdD5cbiAgPGRpdlxuICAgIGNsYXNzPVwiYmItbWVzc2FnZS11aSBjYXJkLWJvZHlcIlxuICAgIFthdHRyLnJvbGVdPVwiaG9zdC5pc0JvZHlIdG1sID8gbnVsbCA6ICdidXR0b24nXCJcbiAgICAoYmJLZXlib2FyZENsaWNrKT1cIiFob3N0LmlzQm9keUh0bWwgJiYgaG9zdC5vbkNsaWNrKCRldmVudClcIlxuICAgIHRhYmluZGV4PVwiMFwiXG4gICAgZGF0YS1yb2xlPVwiY29udmVyc2F0aW9uLW1lc3NhZ2VcIlxuICAgIFthdHRyLmFyaWEtY29udHJvbHNdPVwiaG9zdC5tZXNzYWdlSWRcIlxuICAgIFthdHRyLmFyaWEtZXhwYW5kZWRdPVwiaG9zdC5vcGVuZWRcIlxuICA+XG4gICAgPGRpdiBjbGFzcz1cImJiLXN0YWNrIGJiLWJsb2NrLS1tZFwiPlxuICAgICAgPHNwYW4gY2xhc3M9XCJzci1vbmx5XCIgaTE4bj1cIk1lc3NhZ2UgZnJvbXxCZWZvcmUgc2VuZGVyIG5hbWVAQG1lc3NhZ2VzLm1lc3NhZ2VzQ29tbW9uLm1lc3NhZ2VGcm9tXCJcbiAgICAgICAgPk1lc3NhZ2UgZnJvbTwvc3BhblxuICAgICAgPlxuICAgICAgPHNwYW4gY2xhc3M9XCJiYi10ZXh0LXNlbWktYm9sZFwiIGRhdGEtcm9sZT1cInNlbmRlci1uYW1lXCI+XG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJob3N0LmdldFNlbmRlclRlbXBsYXRlKClcIj48L25nLWNvbnRhaW5lcj5cbiAgICAgIDwvc3Bhbj5cbiAgICAgIDxkaXYgY2xhc3M9XCJiYi1zdGFja19faXRlbSBiYi1zdGFja19faXRlbS0tcHVzaC1yaWdodFwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiYmItc3RhY2tcIj5cbiAgICAgICAgICA8YmItaWNvbi11aVxuICAgICAgICAgICAgY2xhc3M9XCJiYi1zdGFja19faXRlbSBiYi10ZXh0LXN1cHBvcnRcIlxuICAgICAgICAgICAgKm5nSWY9XCJob3N0LmF0dGFjaG1lbnRzICYmIGhvc3QuYXR0YWNobWVudHMubGVuZ3RoXCJcbiAgICAgICAgICAgIG5hbWU9XCJhdHRhY2htZW50XCJcbiAgICAgICAgICAgIGRhdGEtcm9sZT1cIm1lc3NhZ2VzLWF0dGFjaG1lbnRcIlxuICAgICAgICAgICAgYXJpYS1sYWJlbD1cIkNvbnRhaW5zIGF0dGFjaG1lbnRzXCJcbiAgICAgICAgICAgIGkxOG4tYXJpYS1sYWJlbD1cIlxuICAgICAgICAgICAgICBDb250YWlucyBhdHRhY2htZW50c3xNZXNzYWdlIGNvbnRhaW5zIGF0dGFjaG1lbnRzQEBtZXNzYWdlcy5tZXNzYWdlc0NvbW1vbi5jb250YWluc0F0dGFjaG1lbnRzXCJcbiAgICAgICAgICAgIGJiVG9vbHRpcD1cIkNvbnRhaW5zIGF0dGFjaG1lbnRzXCJcbiAgICAgICAgICAgIGkxOG4tYmJUb29sdGlwPVwiQEBtZXNzYWdlcy5tZXNzYWdlc0NvbW1vbi5jb250YWluc0F0dGFjaG1lbnRzXCJcbiAgICAgICAgICAgIHRyaWdnZXJzPVwiaG92ZXJcIlxuICAgICAgICAgICAgcGxhY2VtZW50PVwidG9wXCJcbiAgICAgICAgICAgIGNvbnRhaW5lcj1cImJvZHlcIlxuICAgICAgICAgID48L2JiLWljb24tdWk+XG4gICAgICAgICAgPGRpdiAqbmdJZj1cImhvc3QuY3JlYXRlZFwiIGRhdGEtcm9sZT1cIm1lc3NhZ2VzLWNyZWF0aW9uLWRhdGVcIj5cbiAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgIGNsYXNzPVwic3Itb25seVwiXG4gICAgICAgICAgICAgIGkxOG49XCJEYXRlfCdEYXRlOicgd29yZCB0aGF0IHByZWNlZGVzIG1lc3NhZ2UgY3JlYXRpb24gZGF0ZUBAbWVzc2FnZXMubWVzc2FnZXNDb21tb24ubGFiZWxGb3JEYXRlXCJcbiAgICAgICAgICAgICAgPkRhdGU6PC9zcGFuXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICA8c3Bhbj57eyBob3N0LmNyZWF0ZWQgfCBkYXRlOiAnZnVsbERhdGUnIH19IDwvc3Bhbj5cbiAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgIGkxOG49XCJBdHxUbyBicmlkZ2UgZGF0ZSBhbmQgdGltZSAoTW9uZGF5IE1hcmNoIDI4dGgsIDIwMTggYXQgOToxNSBBTSlAQG1lc3NhZ2VzLm1lc3NhZ2VzQ29tbW9uLmNyZWF0ZWRBdFwiXG4gICAgICAgICAgICAgID5hdDwvc3BhblxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgPHNwYW4+IHt7IGhvc3QuY3JlYXRlZCB8IGRhdGU6ICdzaG9ydFRpbWUnIH19PC9zcGFuPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICAgIDxkaXYgY2xhc3M9XCJyb3dcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJjb2wtMTJcIiBbbmdDbGFzc109XCJ7ICdjb2wtbWQtOCc6ICFob3N0Lm9wZW5lZCB9XCIgW2F0dHIuaWRdPVwiaG9zdC5tZXNzYWdlSWRcIj5cbiAgICAgICAgPGRpdlxuICAgICAgICAgIGRhdGEtcm9sZT1cIm1lc3NhZ2UtY29udGVudFwiXG4gICAgICAgICAgKm5nSWY9XCIhaG9zdC5pc0JvZHlIdG1sOyBlbHNlIGh0bWxWaWV3VG1wbFwiXG4gICAgICAgICAgW2lubmVySHRtbF09XCJob3N0Lm9wZW5lZCA/IGhvc3QubWVzc2FnZVRleHQgOiBob3N0Lm1lc3NhZ2VUZXh0V2l0aG91dFRhZ3NcIlxuICAgICAgICAgIFtuZ0NsYXNzXT1cIntcbiAgICAgICAgICAgICd0ZXh0LXRydW5jYXRlJzogIWhvc3Qub3BlbmVkLFxuICAgICAgICAgICAgJ2JiLWJsb2NrLS1tZCc6IGhvc3Qub3BlbmVkICYmIGhvc3QuYXR0YWNobWVudHNcbiAgICAgICAgICB9XCJcbiAgICAgICAgPjwvZGl2PlxuICAgICAgICA8ZGl2IGRhdGEtcm9sZT1cImF0dGFjaG1lbnRzLXdyYXBwZXJcIiBjbGFzcz1cInJvd1wiICpuZ0lmPVwiaG9zdC5vcGVuZWQgJiYgaG9zdC5hdHRhY2htZW50cz8ubGVuZ3RoXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImNvbC00XCIgKm5nRm9yPVwibGV0IGF0dGFjaG1lbnQgb2YgaG9zdC5hdHRhY2htZW50c1wiPlxuICAgICAgICAgICAgPGJiLWZpbGUtYXR0YWNobWVudC11aVxuICAgICAgICAgICAgICBbbmFtZV09XCJhdHRhY2htZW50LmZpbGVuYW1lXCJcbiAgICAgICAgICAgICAgW3NpemVdPVwiYXR0YWNobWVudC5zaXplXCJcbiAgICAgICAgICAgICAgW2ZpbGVDb250ZW50XT1cImF0dGFjaG1lbnQubGlua1N0cmVhbVwiXG4gICAgICAgICAgICA+PC9iYi1maWxlLWF0dGFjaG1lbnQtdWk+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuXG4gIDxuZy10ZW1wbGF0ZSAjaHRtbFZpZXdUbXBsPlxuICAgIDxiYi1tZXNzYWdlcy1ib2R5LXByZXZpZXcgW2JvZHldPVwiaG9zdC5tZXNzYWdlVGV4dFwiPjwvYmItbWVzc2FnZXMtYm9keS1wcmV2aWV3PlxuICA8L25nLXRlbXBsYXRlPlxuPC9uZy10ZW1wbGF0ZT5cblxuPG5nLXRlbXBsYXRlICNkZWZhdWx0U2VuZGVyVGVtcGxhdGU+XG4gIHt7IHNlbmRlciB9fVxuPC9uZy10ZW1wbGF0ZT5cbiJdfQ==