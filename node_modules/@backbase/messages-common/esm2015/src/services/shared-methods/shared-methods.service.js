import { Inject, Injectable } from '@angular/core';
import { Observable } from 'rxjs';
import { PUBSUB } from '@backbase/foundation-ang/web-sdk';
import * as i0 from "@angular/core";
import * as i1 from "@backbase/ui-ang/notification";
export class SharedMethodsService {
    constructor(notificationService, pubSub) {
        this.notificationService = notificationService;
        this.pubSub = pubSub;
    }
    /**
     * Check is form valid
     *
     * @param form Form object
     * @param prevValue Previous value
     * @returns Is form valid flag
     */
    isFormInvalid(form, prevValue) {
        if (form && form.dirty) {
            const formVal = form.value || {};
            const keys = Object.keys(formVal);
            for (const field of keys) {
                if (prevValue) {
                    if (prevValue[field] !== formVal[field]) {
                        return true;
                    }
                }
                else if (formVal[field]) {
                    return Array.isArray(formVal[field]) ? formVal[field].length > 0 : true;
                }
            }
        }
        return false;
    }
    /**
     * Check if form has value
     *
     * @param form Form object
     * @returns Has form value flag
     */
    hasFormValue(form) {
        const formVal = (form && form.value) || {};
        const keys = Object.keys(formVal);
        for (const field of keys) {
            if (formVal[field]) {
                return Array.isArray(formVal[field]) ? formVal[field].length > 0 : true;
            }
        }
        return false;
    }
    /**
     * Handles a given event
     *
     * @param eventName Event name
     */
    eventBusFactory(eventName) {
        return new Observable(observer => {
            const handler = (data) => observer.next(data);
            this.pubSub.subscribe(eventName, handler);
            return () => {
                this.pubSub.unsubscribe(eventName, handler);
            };
        });
    }
    /**
     * Publish a given event
     *
     * @template T
     * @param eventName Event name
     * @param body Event data
     */
    eventBusPublish(eventName, body) {
        this.pubSub.publish(eventName, body);
    }
    /**
     * Get error message from error body
     *
     * @param error Error value
     * @returns Error message
     */
    getErrorMessage(error) {
        return typeof error !== 'string' ? (error.error && error.error.message) || error.message : error;
    }
    /**
     * Open notification
     *
     * @param header Notification header
     * @param modifier Notification type
     * @param message Notification message
     */
    openNotification(header, modifier = 'success', message = '') {
        if (!header)
            return;
        this.notificationService.showNotification({
            header,
            message,
            modifier,
            dismissible: false,
        });
    }
    /**
     * Map response to take body and total count
     *
     * @template T
     * @param rawData Response data
     * @returns Response body and total count
     */
    processData(rawData) {
        const totalCount = (rawData && parseInt(String(rawData.headers.get('x-total-count')), 10)) || 0;
        return {
            data: (rawData && rawData.body) || [],
            totalCount,
        };
    }
}
SharedMethodsService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.14", ngImport: i0, type: SharedMethodsService, deps: [{ token: i1.NotificationService }, { token: PUBSUB }], target: i0.ɵɵFactoryTarget.Injectable });
SharedMethodsService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "12.2.14", ngImport: i0, type: SharedMethodsService });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.14", ngImport: i0, type: SharedMethodsService, decorators: [{
            type: Injectable
        }], ctorParameters: function () { return [{ type: i1.NotificationService }, { type: undefined, decorators: [{
                    type: Inject,
                    args: [PUBSUB]
                }] }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hhcmVkLW1ldGhvZHMuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2xpYnMvbWVzc2FnZXMtY29tbW9uL3NyYy9zZXJ2aWNlcy9zaGFyZWQtbWV0aG9kcy9zaGFyZWQtbWV0aG9kcy5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFlLE1BQU0sZUFBZSxDQUFDO0FBR2hFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFHbEMsT0FBTyxFQUFVLE1BQU0sRUFBRSxNQUFNLGtDQUFrQyxDQUFDOzs7QUFHbEUsTUFBTSxPQUFPLG9CQUFvQjtJQUMvQixZQUNtQixtQkFBd0MsRUFDeEIsTUFBYztRQUQ5Qix3QkFBbUIsR0FBbkIsbUJBQW1CLENBQXFCO1FBQ3hCLFdBQU0sR0FBTixNQUFNLENBQVE7SUFDOUMsQ0FBQztJQUVKOzs7Ozs7T0FNRztJQUNILGFBQWEsQ0FBQyxJQUEyQixFQUFFLFNBQWtDO1FBQzNFLElBQUksSUFBSSxJQUFJLElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDdEIsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLEtBQUssSUFBSSxFQUFFLENBQUM7WUFDakMsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUVsQyxLQUFLLE1BQU0sS0FBSyxJQUFJLElBQUksRUFBRTtnQkFDeEIsSUFBSSxTQUFTLEVBQUU7b0JBQ2IsSUFBSSxTQUFTLENBQUMsS0FBSyxDQUFDLEtBQUssT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFO3dCQUN2QyxPQUFPLElBQUksQ0FBQztxQkFDYjtpQkFDRjtxQkFBTSxJQUFJLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTtvQkFDekIsT0FBTyxLQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFD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dCB7IEluamVjdCwgSW5qZWN0YWJsZSwgVGVtcGxhdGVSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEh0dHBFcnJvclJlc3BvbnNlLCBIdHRwUmVzcG9uc2UgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQgeyBGb3JtR3JvdXAgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5cbmltcG9ydCB7IE5vdGlmaWNhdGlvblNlcnZpY2UgfSBmcm9tICdAYmFja2Jhc2UvdWktYW5nL25vdGlmaWNhdGlvbic7XG5pbXBvcnQgeyBQdWJzdWIsIFBVQlNVQiB9IGZyb20gJ0BiYWNrYmFzZS9mb3VuZGF0aW9uLWFuZy93ZWItc2RrJztcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIFNoYXJlZE1ldGhvZHNTZXJ2aWNlIHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSByZWFkb25seSBub3RpZmljYXRpb25TZXJ2aWNlOiBOb3RpZmljYXRpb25TZXJ2aWNlLFxuICAgIEBJbmplY3QoUFVCU1VCKSBwcml2YXRlIHJlYWRvbmx5IHB1YlN1YjogUHVic3ViLFxuICApIHt9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlzIGZvcm0gdmFsaWRcbiAgICpcbiAgICogQHBhcmFtIGZvcm0gRm9ybSBvYmplY3RcbiAgICogQHBhcmFtIHByZXZWYWx1ZSBQcmV2aW91cyB2YWx1ZVxuICAgKiBAcmV0dXJucyBJcyBmb3JtIHZhbGlkIGZsYWdcbiAgICovXG4gIGlzRm9ybUludmFsaWQoZm9ybTogRm9ybUdyb3VwIHwgdW5kZWZpbmVkLCBwcmV2VmFsdWU/OiB7IFtrZXk6IHN0cmluZ106IGFueSB9KTogYm9vbGVhbiB7XG4gICAgaWYgKGZvcm0gJiYgZm9ybS5kaXJ0eSkge1xuICAgICAgY29uc3QgZm9ybVZhbCA9IGZvcm0udmFsdWUgfHwge307XG4gICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoZm9ybVZhbCk7XG5cbiAgICAgIGZvciAoY29uc3QgZmllbGQgb2Yga2V5cykge1xuICAgICAgICBpZiAocHJldlZhbHVlKSB7XG4gICAgICAgICAgaWYgKHByZXZWYWx1ZVtmaWVsZF0gIT09IGZvcm1WYWxbZmllbGRdKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoZm9ybVZhbFtmaWVsZF0pIHtcbiAgICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheShmb3JtVmFsW2ZpZWxkXSkgPyBmb3JtVmFsW2ZpZWxkXS5sZW5ndGggPiAwIDogdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBmb3JtIGhhcyB2YWx1ZVxuICAgKlxuICAgKiBAcGFyYW0gZm9ybSBGb3JtIG9iamVjdFxuICAgKiBAcmV0dXJucyBIYXMgZm9ybSB2YWx1ZSBmbGFnXG4gICAqL1xuICBoYXNGb3JtVmFsdWUoZm9ybTogRm9ybUdyb3VwIHwgdW5kZWZpbmVkKTogYm9vbGVhbiB7XG4gICAgY29uc3QgZm9ybVZhbCA9IChmb3JtICYmIGZvcm0udmFsdWUpIHx8IHt9O1xuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhmb3JtVmFsKTtcblxuICAgIGZvciAoY29uc3QgZmllbGQgb2Yga2V5cykge1xuICAgICAgaWYgKGZvcm1WYWxbZmllbGRdKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KGZvcm1WYWxbZmllbGRdKSA/IGZvcm1WYWxbZmllbGRdLmxlbmd0aCA+IDAgOiB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGVzIGEgZ2l2ZW4gZXZlbnRcbiAgICpcbiAgICogQHBhcmFtIGV2ZW50TmFtZSBFdmVudCBuYW1lXG4gICAqL1xuICBldmVudEJ1c0ZhY3RvcnkoZXZlbnROYW1lOiBzdHJpbmcpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShvYnNlcnZlciA9PiB7XG4gICAgICBjb25zdCBoYW5kbGVyID0gKGRhdGE6IGFueSkgPT4gb2JzZXJ2ZXIubmV4dChkYXRhKTtcbiAgICAgIHRoaXMucHViU3ViLnN1YnNjcmliZShldmVudE5hbWUsIGhhbmRsZXIpO1xuXG4gICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICB0aGlzLnB1YlN1Yi51bnN1YnNjcmliZShldmVudE5hbWUsIGhhbmRsZXIpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQdWJsaXNoIGEgZ2l2ZW4gZXZlbnRcbiAgICpcbiAgICogQHRlbXBsYXRlIFRcbiAgICogQHBhcmFtIGV2ZW50TmFtZSBFdmVudCBuYW1lXG4gICAqIEBwYXJhbSBib2R5IEV2ZW50IGRhdGFcbiAgICovXG4gIGV2ZW50QnVzUHVibGlzaDxUPihldmVudE5hbWU6IHN0cmluZywgYm9keTogVCkge1xuICAgIHRoaXMucHViU3ViLnB1Ymxpc2goZXZlbnROYW1lLCBib2R5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZXJyb3IgbWVzc2FnZSBmcm9tIGVycm9yIGJvZHlcbiAgICpcbiAgICogQHBhcmFtIGVycm9yIEVycm9yIHZhbHVlXG4gICAqIEByZXR1cm5zIEVycm9yIG1lc3NhZ2VcbiAgICovXG4gIGdldEVycm9yTWVzc2FnZShlcnJvcjogSHR0cEVycm9yUmVzcG9uc2UgfCBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiB0eXBlb2YgZXJyb3IgIT09ICdzdHJpbmcnID8gKGVycm9yLmVycm9yICYmIGVycm9yLmVycm9yLm1lc3NhZ2UpIHx8IGVycm9yLm1lc3NhZ2UgOiBlcnJvcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBPcGVuIG5vdGlmaWNhdGlvblxuICAgKlxuICAgKiBAcGFyYW0gaGVhZGVyIE5vdGlmaWNhdGlvbiBoZWFkZXJcbiAgICogQHBhcmFtIG1vZGlmaWVyIE5vdGlmaWNhdGlvbiB0eXBlXG4gICAqIEBwYXJhbSBtZXNzYWdlIE5vdGlmaWNhdGlvbiBtZXNzYWdlXG4gICAqL1xuICBvcGVuTm90aWZpY2F0aW9uKGhlYWRlcjogVGVtcGxhdGVSZWY8YW55PiB8IHN0cmluZyB8IHVuZGVmaW5lZCwgbW9kaWZpZXIgPSAnc3VjY2VzcycgYXMgYW55LCBtZXNzYWdlID0gJycpIHtcbiAgICBpZiAoIWhlYWRlcikgcmV0dXJuO1xuICAgIHRoaXMubm90aWZpY2F0aW9uU2VydmljZS5zaG93Tm90aWZpY2F0aW9uKHtcbiAgICAgIGhlYWRlcixcbiAgICAgIG1lc3NhZ2UsXG4gICAgICBtb2RpZmllcixcbiAgICAgIGRpc21pc3NpYmxlOiBmYWxzZSxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNYXAgcmVzcG9uc2UgdG8gdGFrZSBib2R5IGFuZCB0b3RhbCBjb3VudFxuICAgKlxuICAgKiBAdGVtcGxhdGUgVFxuICAgKiBAcGFyYW0gcmF3RGF0YSBSZXNwb25zZSBkYXRhXG4gICAqIEByZXR1cm5zIFJlc3BvbnNlIGJvZHkgYW5kIHRvdGFsIGNvdW50XG4gICAqL1xuICBwcm9jZXNzRGF0YTxUPihyYXdEYXRhOiBIdHRwUmVzcG9uc2U8VD4pOiB7IGRhdGE6IFQgfCBbXTsgdG90YWxDb3VudDogbnVtYmVyIH0ge1xuICAgIGNvbnN0IHRvdGFsQ291bnQ6IG51bWJlciA9IChyYXdEYXRhICYmIHBhcnNlSW50KFN0cmluZyhyYXdEYXRhLmhlYWRlcnMuZ2V0KCd4LXRvdGFsLWNvdW50JykpLCAxMCkpIHx8IDA7XG5cbiAgICByZXR1cm4ge1xuICAgICAgZGF0YTogKHJhd0RhdGEgJiYgcmF3RGF0YS5ib2R5KSB8fCBbXSxcbiAgICAgIHRvdGFsQ291bnQsXG4gICAgfTtcbiAgfVxufVxuIl19