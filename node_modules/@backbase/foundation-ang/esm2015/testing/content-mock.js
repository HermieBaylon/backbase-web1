import { ContentType, StructuredContentType, ContentTypes, } from '@backbase/lib-bb-page-bootstrap-cdn';
/**
 * PortalContentMock class which functions as a mock content store
 *
 * @usageNotes
 * ```typescript
 * // Store content in mock content store and get contentRef back
 * const contentRef = PortalContentMock.addImageContent({ url: '/image.png' });
 *
 * // use PortalContentMock to get content from the mock content store
 * const portalContent = new PortalContentMock();
 * portalContent.getContent(contentRef);
 * ```
 */
export class PortalContentMock {
    /**
     * Add image item to mock content store
     * @param content image item
     * @return content ref
     */
    static addImageContent(content, contentRef) {
        return PortalContentMock.addContentItem(ContentTypes.IMAGE, content, undefined, contentRef);
    }
    /**
     * Add document item to mock content store
     * @param content document item
     * @return content ref
     */
    static addDocumentContent(content, contentRef) {
        return PortalContentMock.addContentItem(ContentTypes.DOCUMENT, content, undefined, contentRef);
    }
    /**
     * Add structured content item to mock content store
     * @param typeDefinitionName type definition name of the strucutred content item
     * @param content structured content (JSON)
     * @return content ref
     */
    static addStructuredContent(typeDefinitionName, content, contentRef) {
        return PortalContentMock.addContentItem(ContentTypes.STRUCTURED_CONTENT, content, typeDefinitionName, contentRef);
    }
    /**
     * Add plain text content item to mock content store
     * @param content plain text
     * @return content ref
     */
    static addPlainTextContent(content, contentRef) {
        return PortalContentMock.addStructuredContent(StructuredContentType.PLAIN_TEXT, { content }, contentRef);
    }
    /**
     * Add rich text content item to mock content store
     * @param content rich text (HTML)
     * @return content ref
     */
    static addRichTextContent(content, contentRef) {
        return PortalContentMock.addStructuredContent(StructuredContentType.RICH_TEXT, { content }, contentRef);
    }
    static addContentItem(type, content, typeDefinitionName, contentRef = PortalContentMock.getContentRef()) {
        const contentItem = {
            type,
            content,
            properties: {},
        };
        if (typeDefinitionName) {
            contentItem.typeDefinitionName = typeDefinitionName;
        }
        PortalContentMock.contentMockMap[contentRef] = content;
        PortalContentMock.contentItemMockMap[contentRef] = contentItem;
        return contentRef;
    }
    static getContentRef() {
        PortalContentMock.id += 1;
        return `cs:mockRepository:${PortalContentMock.id}`;
    }
    get(contentRef) {
        const contentItem = PortalContentMock.contentItemMockMap[contentRef];
        if (!contentItem) {
            // Return empty text so deprecated content widget logic doesn't break
            return Promise.resolve({
                id: contentRef,
                type: ContentType.STRUCTURED_CONTENT,
                content: '',
            });
        }
        if (contentItem.type === ContentTypes.IMAGE) {
            const content = contentItem.content;
            const imageContentItem = {
                id: contentRef,
                type: ContentType.IMAGE,
                contentRef: content.url,
            };
            return Promise.resolve(imageContentItem);
        }
        if (contentItem.type === ContentTypes.STRUCTURED_CONTENT) {
            const content = contentItem.content;
            const structuredContentItem = {
                id: contentRef,
                type: ContentType.STRUCTURED_CONTENT,
                content: content.content,
            };
            return Promise.resolve(structuredContentItem);
        }
        return Promise.reject(`Couldn't map a content item of type ${contentItem.type}`);
    }
    getContent(contentRef) {
        return Promise.resolve(PortalContentMock.contentMockMap[contentRef]);
    }
    getContentItem(contentRef) {
        return Promise.resolve(PortalContentMock.contentItemMockMap[contentRef]);
    }
    subscribeContentUpdate() {
        return () => { };
    }
    subscribeContentItemUpdate() {
        return () => { };
    }
}
PortalContentMock.id = 0;
PortalContentMock.contentMockMap = {};
PortalContentMock.contentItemMockMap = {};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGVudC1tb2NrLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvYmFja2Jhc2UvZm91bmRhdGlvbi1hbmcvdGVzdGluZy9zcmMvY29udGVudC1tb2NrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDTCxXQUFXLEVBQ1gscUJBQXFCLEVBR3JCLFlBQVksR0FNYixNQUFNLHFDQUFxQyxDQUFDO0FBVTdDOzs7Ozs7Ozs7Ozs7R0FZRztBQUNILE1BQU0sT0FBTyxpQkFBaUI7SUFPNUI7Ozs7T0FJRztJQUNJLE1BQU0sQ0FBQyxlQUFlLENBQUMsT0FBMkIsRUFBRSxVQUFtQjtRQUM1RSxPQUFPLGlCQUFpQixDQUFDLGNBQWMsQ0FBQyxZQUFZLENBQUMsS0FBSyxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUUsVUFBVSxDQUFDLENBQUM7SUFDOUYsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxNQUFNLENBQUMsa0JBQWtCLENBQUMsT0FBOEIsRUFBRSxVQUFtQjtRQUNsRixPQUFPLGlCQUFpQixDQUFDLGNBQWMsQ0FBQyxZQUFZLENBQUMsUUFBUSxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUUsVUFBVSxDQUFDLENBQUM7SUFDakcsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksTUFBTSxDQUFDLG9CQUFvQixDQUNoQyxrQkFBMEIsRUFDMUIsT0FBVSxFQUNWLFVBQW1CO1FBRW5CLE9BQU8saUJBQWlCLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FBQyxrQkFBa0IsRUFBRSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsVUFBVSxDQUFDLENBQUM7SUFDcEgsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxNQUFNLENBQUMsbUJBQW1CLENBQUMsT0FBZSxFQUFFLFVBQW1CO1FBQ3BFLE9BQU8saUJBQWlCLENBQUMsb0JBQW9CLENBQUMscUJBQXFCLENBQUMsVUFBVSxFQUFFLEVBQUUsT0FBTyxFQUFFLEVBQUUsVUFBVSxD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TSwwQkFBMEI7UUFDL0IsT0FBTyxHQUFHLEVBQUUsR0FBRSxDQUFDLENBQUM7SUFDbEIsQ0FBQzs7QUF6SWMsb0JBQUUsR0FBRyxDQUFDLENBQUM7QUFFRSxnQ0FBYyxHQUFnQixFQUFFLENBQUM7QUFFakMsb0NBQWtCLEdBQW9CLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIENvbnRlbnRUeXBlLFxuICBTdHJ1Y3R1cmVkQ29udGVudFR5cGUsXG4gIENvbnRlbnRVcGRhdGVVbnN1YnNjcmliZSxcbiAgUG9ydGFsQ29udGVudCxcbiAgQ29udGVudFR5cGVzLFxuICBDb250ZW50SXRlbSxcbiAgSW1hZ2VJdGVtLFxuICBEb2N1bWVudEl0ZW0sXG4gIFN0cnVjdHVyZWRDb250ZW50SXRlbSxcbiAgSW1hZ2VDb250ZW50SXRlbSxcbn0gZnJvbSAnQGJhY2tiYXNlL2xpYi1iYi1wYWdlLWJvb3RzdHJhcC1jZG4nO1xuXG5pbnRlcmZhY2UgQ29udGVudE1vY2sge1xuICBbY29udGVudFJlZjogc3RyaW5nXTogYW55O1xufVxuXG5pbnRlcmZhY2UgQ29udGVudEl0ZW1Nb2NrIHtcbiAgW2NvbnRlbnRSZWY6IHN0cmluZ106IENvbnRlbnRJdGVtPGFueT47XG59XG5cbi8qKlxuICogUG9ydGFsQ29udGVudE1vY2sgY2xhc3Mgd2hpY2ggZnVuY3Rpb25zIGFzIGEgbW9jayBjb250ZW50IHN0b3JlXG4gKlxuICogQHVzYWdlTm90ZXNcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIC8vIFN0b3JlIGNvbnRlbnQgaW4gbW9jayBjb250ZW50IHN0b3JlIGFuZCBnZXQgY29udGVudFJlZiBiYWNrXG4gKiBjb25zdCBjb250ZW50UmVmID0gUG9ydGFsQ29udGVudE1vY2suYWRkSW1hZ2VDb250ZW50KHsgdXJsOiAnL2ltYWdlLnBuZycgfSk7XG4gKlxuICogLy8gdXNlIFBvcnRhbENvbnRlbnRNb2NrIHRvIGdldCBjb250ZW50IGZyb20gdGhlIG1vY2sgY29udGVudCBzdG9yZVxuICogY29uc3QgcG9ydGFsQ29udGVudCA9IG5ldyBQb3J0YWxDb250ZW50TW9jaygpO1xuICogcG9ydGFsQ29udGVudC5nZXRDb250ZW50KGNvbnRlbnRSZWYpO1xuICogYGBgXG4gKi9cbmV4cG9ydCBjbGFzcyBQb3J0YWxDb250ZW50TW9jayBpbXBsZW1lbnRzIFBvcnRhbENvbnRlbnQge1xuICBwcml2YXRlIHN0YXRpYyBpZCA9IDA7XG5cbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgY29udGVudE1vY2tNYXA6IENvbnRlbnRNb2NrID0ge307XG5cbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgY29udGVudEl0ZW1Nb2NrTWFwOiBDb250ZW50SXRlbU1vY2sgPSB7fTtcblxuICAvKipcbiAgICogQWRkIGltYWdlIGl0ZW0gdG8gbW9jayBjb250ZW50IHN0b3JlXG4gICAqIEBwYXJhbSBjb250ZW50IGltYWdlIGl0ZW1cbiAgICogQHJldHVybiBjb250ZW50IHJlZlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBhZGRJbWFnZUNvbnRlbnQoY29udGVudDogUGFydGlhbDxJbWFnZUl0ZW0+LCBjb250ZW50UmVmPzogc3RyaW5nKSB7XG4gICAgcmV0dXJuIFBvcnRhbENvbnRlbnRNb2NrLmFkZENvbnRlbnRJdGVtKENvbnRlbnRUeXBlcy5JTUFHRSwgY29udGVudCwgdW5kZWZpbmVkLCBjb250ZW50UmVmKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgZG9jdW1lbnQgaXRlbSB0byBtb2NrIGNvbnRlbnQgc3RvcmVcbiAgICogQHBhcmFtIGNvbnRlbnQgZG9jdW1lbnQgaXRlbVxuICAgKiBAcmV0dXJuIGNvbnRlbnQgcmVmXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGFkZERvY3VtZW50Q29udGVudChjb250ZW50OiBQYXJ0aWFsPERvY3VtZW50SXRlbT4sIGNvbnRlbnRSZWY/OiBzdHJpbmcpIHtcbiAgICByZXR1cm4gUG9ydGFsQ29udGVudE1vY2suYWRkQ29udGVudEl0ZW0oQ29udGVudFR5cGVzLkRPQ1VNRU5ULCBjb250ZW50LCB1bmRlZmluZWQsIGNvbnRlbnRSZWYpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBzdHJ1Y3R1cmVkIGNvbnRlbnQgaXRlbSB0byBtb2NrIGNvbnRlbnQgc3RvcmVcbiAgICogQHBhcmFtIHR5cGVEZWZpbml0aW9uTmFtZSB0eXBlIGRlZmluaXRpb24gbmFtZSBvZiB0aGUgc3RydWN1dHJlZCBjb250ZW50IGl0ZW1cbiAgICogQHBhcmFtIGNvbnRlbnQgc3RydWN0dXJlZCBjb250ZW50IChKU09OKVxuICAgKiBAcmV0dXJuIGNvbnRlbnQgcmVmXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGFkZFN0cnVjdHVyZWRDb250ZW50PFQgPSB7IFtrZXk6IHN0cmluZ106IGFueSB9PihcbiAgICB0eXBlRGVmaW5pdGlvbk5hbWU6IHN0cmluZyxcbiAgICBjb250ZW50OiBULFxuICAgIGNvbnRlbnRSZWY/OiBzdHJpbmcsXG4gICkge1xuICAgIHJldHVybiBQb3J0YWxDb250ZW50TW9jay5hZGRDb250ZW50SXRlbShDb250ZW50VHlwZXMuU1RSVUNUVVJFRF9DT05URU5ULCBjb250ZW50LCB0eXBlRGVmaW5pdGlvbk5hbWUsIGNvbnRlbnRSZWYpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBwbGFpbiB0ZXh0IGNvbnRlbnQgaXRlbSB0byBtb2NrIGNvbnRlbnQgc3RvcmVcbiAgICogQHBhcmFtIGNvbnRlbnQgcGxhaW4gdGV4dFxuICAgKiBAcmV0dXJuIGNvbnRlbnQgcmVmXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGFkZFBsYWluVGV4dENvbnRlbnQoY29udGVudDogc3RyaW5nLCBjb250ZW50UmVmPzogc3RyaW5nKSB7XG4gICAgcmV0dXJuIFBvcnRhbENvbnRlbnRNb2NrLmFkZFN0cnVjdHVyZWRDb250ZW50KFN0cnVjdHVyZWRDb250ZW50VHlwZS5QTEFJTl9URVhULCB7IGNvbnRlbnQgfSwgY29udGVudFJlZik7XG4gIH1cblxuICAvKipcbiAgICogQWRkIHJpY2ggdGV4dCBjb250ZW50IGl0ZW0gdG8gbW9jayBjb250ZW50IHN0b3JlXG4gICAqIEBwYXJhbSBjb250ZW50IHJpY2ggdGV4dCAoSFRNTClcbiAgICogQHJldHVybiBjb250ZW50IHJlZlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBhZGRSaWNoVGV4dENvbnRlbnQoY29udGVudDogc3RyaW5nLCBjb250ZW50UmVmPzogc3RyaW5nKSB7XG4gICAgcmV0dXJuIFBvcnRhbENvbnRlbnRNb2NrLmFkZFN0cnVjdHVyZWRDb250ZW50KFN0cnVjdHVyZWRDb250ZW50VHlwZS5SSUNIX1RFWFQsIHsgY29udGVudCB9LCBjb250ZW50UmVmKTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGFkZENvbnRlbnRJdGVtKFxuICAgIHR5cGU6IENvbnRlbnRUeXBlcyxcbiAgICBjb250ZW50OiBhbnksXG4gICAgdHlwZURlZmluaXRpb25OYW1lPzogc3RyaW5nLFxuICAgIGNvbnRlbnRSZWYgPSBQb3J0YWxDb250ZW50TW9jay5nZXRDb250ZW50UmVmKCksXG4gICkge1xuICAgIGNvbnN0IGNvbnRlbnRJdGVtOiBDb250ZW50SXRlbTxhbnk+ID0ge1xuICAgICAgdHlwZSxcbiAgICAgIGNvbnRlbnQsXG4gICAgICBwcm9wZXJ0aWVzOiB7fSxcbiAgICB9O1xuXG4gICAgaWYgKHR5cGVEZWZpbml0aW9uTmFtZSkge1xuICAgICAgY29udGVudEl0ZW0udHlwZURlZmluaXRpb25OYW1lID0gdHlwZURlZmluaXRpb25OYW1lO1xuICAgIH1cblxuICAgIFBvcnRhbENvbnRlbnRNb2NrLmNvbnRlbnRNb2NrTWFwW2NvbnRlbnRSZWZdID0gY29udGVudDtcbiAgICBQb3J0YWxDb250ZW50TW9jay5jb250ZW50SXRlbU1vY2tNYXBbY29udGVudFJlZl0gPSBjb250ZW50SXRlbTtcblxuICAgIHJldHVybiBjb250ZW50UmVmO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZ2V0Q29udGVudFJlZigpIHtcbiAgICBQb3J0YWxDb250ZW50TW9jay5pZCArPSAxO1xuXG4gICAgcmV0dXJuIGBjczptb2NrUmVwb3NpdG9yeToke1BvcnRhbENvbnRlbnRNb2NrLmlkfWA7XG4gIH1cblxuICBwdWJsaWMgZ2V0KGNvbnRlbnRSZWY6IHN0cmluZyk6IFByb21pc2U8SW1hZ2VDb250ZW50SXRlbSB8IFN0cnVjdHVyZWRDb250ZW50SXRlbT4ge1xuICAgIGNvbnN0IGNvbnRlbnRJdGVtID0gUG9ydGFsQ29udGVudE1vY2suY29udGVudEl0ZW1Nb2NrTWFwW2NvbnRlbnRSZWZdO1xuXG4gICAgaWYgKCFjb250ZW50SXRlbSkge1xuICAgICAgLy8gUmV0dXJuIGVtcHR5IHRleHQgc28gZGVwcmVjYXRlZCBjb250ZW50IHdpZGdldCBsb2dpYyBkb2Vzbid0IGJyZWFrXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgICAgaWQ6IGNvbnRlbnRSZWYsXG4gICAgICAgIHR5cGU6IENvbnRlbnRUeXBlLlNUUlVDVFVSRURfQ09OVEVOVCxcbiAgICAgICAgY29udGVudDogJycsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoY29udGVudEl0ZW0udHlwZSA9PT0gQ29udGVudFR5cGVzLklNQUdFKSB7XG4gICAgICBjb25zdCBjb250ZW50OiBJbWFnZUl0ZW0gPSBjb250ZW50SXRlbS5jb250ZW50O1xuXG4gICAgICBjb25zdCBpbWFnZUNvbnRlbnRJdGVtOiBJbWFnZUNvbnRlbnRJdGVtID0ge1xuICAgICAgICBpZDogY29udGVudFJlZixcbiAgICAgICAgdHlwZTogQ29udGVudFR5cGUuSU1BR0UsXG4gICAgICAgIGNvbnRlbnRSZWY6IGNvbnRlbnQudXJsLFxuICAgICAgfTtcblxuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShpbWFnZUNvbnRlbnRJdGVtKTtcbiAgICB9XG5cbiAgICBpZiAoY29udGVudEl0ZW0udHlwZSA9PT0gQ29udGVudFR5cGVzLlNUUlVDVFVSRURfQ09OVEVOVCkge1xuICAgICAgY29uc3QgY29udGVudDogeyBjb250ZW50OiBzdHJpbmcgfSA9IGNvbnRlbnRJdGVtLmNvbnRlbnQ7XG5cbiAgICAgIGNvbnN0IHN0cnVjdHVyZWRDb250ZW50SXRlbTogU3RydWN0dXJlZENvbnRlbnRJdGVtID0ge1xuICAgICAgICBpZDogY29udGVudFJlZixcbiAgICAgICAgdHlwZTogQ29udGVudFR5cGUuU1RSVUNUVVJFRF9DT05URU5ULFxuICAgICAgICBjb250ZW50OiBjb250ZW50LmNvbnRlbnQsXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHN0cnVjdHVyZWRDb250ZW50SXRlbSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBDb3VsZG4ndCBtYXAgYSBjb250ZW50IGl0ZW0gb2YgdHlwZSAke2NvbnRlbnRJdGVtLnR5cGV9YCk7XG4gIH1cblxuICBwdWJsaWMgZ2V0Q29udGVudDxUPihjb250ZW50UmVmOiBzdHJpbmcpOiBQcm9taXNlPFQ+IHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFBvcnRhbENvbnRlbnRNb2NrLmNvbnRlbnRNb2NrTWFwW2NvbnRlbnRSZWZdKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRDb250ZW50SXRlbTxUIGV4dGVuZHMgQ29udGVudEl0ZW08YW55Pj4oY29udGVudFJlZjogc3RyaW5nKTogUHJvbWlzZTxUPiB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShQb3J0YWxDb250ZW50TW9jay5jb250ZW50SXRlbU1vY2tNYXBbY29udGVudFJlZl0gYXMgVCk7XG4gIH1cblxuICBwdWJsaWMgc3Vic2NyaWJlQ29udGVudFVwZGF0ZSgpOiBDb250ZW50VXBkYXRlVW5zdWJzY3JpYmUge1xuICAgIHJldHVybiAoKSA9PiB7fTtcbiAgfVxuXG4gIHB1YmxpYyBzdWJzY3JpYmVDb250ZW50SXRlbVVwZGF0ZSgpOiBDb250ZW50VXBkYXRlVW5zdWJzY3JpYmUge1xuICAgIHJldHVybiAoKSA9PiB7fTtcbiAgfVxufVxuIl19