import { DefaultContainerStrategy } from './default-container-strategy';
import { StaticRoutesStrategy } from './static-routes-strategy';
import { RouteComponent } from '../components/route.component';
/**
 * Symbol used to keep internal Backbase routing information
 * in an Angular component class
 */
export const routingStrategyField = Symbol('Î©RoutingStrategy');
/**
 * RoutingStrategyToken enum with routing strategy tokens
 */
export var RoutingStrategyToken;
(function (RoutingStrategyToken) {
    RoutingStrategyToken["STATIC"] = "StaticRoutesStrategy";
    RoutingStrategyToken["CONTAINERS"] = "DefaultContainerStrategy";
})(RoutingStrategyToken || (RoutingStrategyToken = {}));
/**
 * RoutableContainer decorator is used to mark an item as
 * routable. It makes the routing config service to use default
 * strategy for containers.
 */
export function RoutableContainer() {
    return function (constructor) {
        constructor[routingStrategyField] = {
            token: RoutingStrategyToken.CONTAINERS,
        };
        return constructor;
    };
}
/**
 * RoutableWidget decorator is used to define widget's internal routes.
 *
 * @usageNotes
 *
 * ### Example
 * ```
 * @Component({
 *   selector: 'bb-todo-widget',
 *   template: `
 *     <bb-router-outlet></bb-router-outlet>
 *   `,
 *   changeDetection: ChangeDetectionStrategy.OnPush,
 *   providers: [RouterService, TodoNavigationService],
 * })
 * @RoutableWidget({
 *   routes: [
 *     { path: '', component: TodoListContainerComponent },
 *     { path: ':id', component: TodoDetailContainerComponent },
 *     { path: 'edit/:id', component: TodoFormContainerComponent },
 *   ],
 * })
 * export class TodoWidgetComponent {}
 * ```
 *
 * @param config Configuration object of the RoutableWidget decorator
 */
export function RoutableWidget(config) {
    return function (constructor) {
        constructor[routingStrategyField] = {
            token: RoutingStrategyToken.STATIC,
            routes: config.routes,
        };
        return constructor;
    };
}
export const createRouteComponentStrategy = (component) => {
    const isItemInRoute = component === RouteComponent ? component.isItemInRoute : () => false;
    return {
        isItemInRoute,
    };
};
export const createRoutingStrategy = (componentClass) => {
    const strategy = componentClass[routingStrategyField];
    if (strategy === undefined) {
        return undefined;
    }
    switch (strategy.token) {
        case RoutingStrategyToken.CONTAINERS:
            return new DefaultContainerStrategy();
        case RoutingStrategyToken.STATIC:
            return new StaticRoutesStrategy(strategy.routes);
        default:
            return undefined;
    }
};
export const isRoutableItem = (componentClass) => {
    const strategy = componentClass[routingStrategyField];
    return (!!strategy &&
        strategy.token &&
        (strategy.token === RoutingStrategyToken.CONTAINERS || strategy.token === RoutingStrategyToken.STATIC));
};
/**
 * CopyRoutes decorator is used to re-use the internal routing configuration from an existing widget.
 *
 * @usageNotes
 *
 * ### Example
 * ```
 * @Component({
 *   selector: 'my-todo-widget',
 *   template: `
 *     <h1>My Custom Todo Widget</h1>
 *     <bb-router-outlet></bb-router-outlet>
 *   `,
 * })
 * @CopyRoutes(TodoWidgetComponent)
 * export class MyTodoWidgetComponent {}
 * ```
 *
 * @param from The Widget Component class from which to copy the routing configuration
 */
// Note: `from` should be `{ [routingStrategyField]: RoutingStrategyDefinition }` but the type checker
// can't resolve properties dynamically added by decorators.
export function CopyRoutes(componentClass, customize = routes => routes) {
    return function (constructor) {
        const definition = componentClass[routingStrategyField];
        if (definition === undefined || definition.token !== RoutingStrategyToken.STATIC) {
            return constructor;
        }
        constructor[routingStrategyField] = {
            token: RoutingStrategyToken.STATIC,
            routes: customize(definition.routes),
        };
        return constructor;
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGluZy1kZWNvcmF0b3JzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvYmFja2Jhc2UvZm91bmRhdGlvbi1hbmcvY29yZS9zcmMvYmFja2Jhc2UtY29yZS9yb3V0aW5nL3N0cmF0ZWdpZXMvcm91dGluZy1kZWNvcmF0b3JzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQ3hFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQztBQUkvRDs7O0dBR0c7QUFDSCxNQUFNLENBQUMsTUFBTSxvQkFBb0IsR0FBRyxNQUFNLENBQUMsa0JBQWtCLENBQUMsQ0FBQztBQUUvRDs7R0FFRztBQUNILE1BQU0sQ0FBTixJQUFZLG9CQUdYO0FBSEQsV0FBWSxvQkFBb0I7SUFDOUIsdURBQStCLENBQUE7SUFDL0IsK0RBQXVDLENBQUE7QUFDekMsQ0FBQyxFQUhXLG9CQUFvQixLQUFwQixvQkFBb0IsUUFHL0I7QUFvQkQ7Ozs7R0FJRztBQUNILE1BQU0sVUFBVSxpQkFBaUI7SUFDL0IsT0FBTyxVQUFxRCxXQUFjO1FBQ3ZFLFdBQW1CLENBQUMsb0JBQW9CLENBQUMsR0FBRztZQUMzQyxLQUFLLEVBQUUsb0JBQW9CLENBQUMsVUFBVTtTQUN2QyxDQUFDO1FBQ0YsT0FBTyxXQUFXLENBQUM7SUFDckIsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQTRCRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0EwQkc7QUFDSCxNQUFNLFVBQVUsY0FBYyxDQUFDLE1BQTRCO0lBQ3pELE9BQU8sVUFBcUQsV0FBYztRQUN2RSxXQUFtQixDQUFDLG9CQUFvQixDQUFDLEdBQUc7WUFDM0MsS0FBSyxFQUFFLG9CQUFvQixDQUFDLE1BQU07WUFDbEMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxNQUFNO1NBQ3RCLENBQUM7UUFDRixPQUFPLFdBQVcsQ0FBQztJQUNyQixDQUFDLENBQUM7QUFDSixDQUFDO0FBVUQsTUFBTSxDQUFDLE1BQU0sNEJBQTRCLEdBQUcsQ0FBQyxTQUFjLEVBQTBCLEVBQUU7SUFDckYsTUFBTSxhQUFhLEdBQUcsU0FBUyxLQUFLLGNBQWMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsS0FBSyxDQUFDO0lBQzNGLE9BQU87UUFDTCxhQUFhO0tBQ2QsQ0FBQztBQUNKLENBQUMsQ0FBQztBQUVGLE1BQU0sQ0FBQyxNQUFNLHFCQUFxQixHQUFHLENBQUMsY0FBc0MsRUFBK0IsRUFBRTtJQUMzRyxNQUFNLFFBQVEsR0FBRyxjQUFjLENBQUMsb0JBQW9CLENBQUMsQ0FBQztJQUN0RCxJQUFJLFFBQVEsS0FBSyxTQUFTLEVBQUU7UUFDMUIsT0FBTyxTQUFTLENBQUM7S0FDbEI7SUFDRCxRQUFRLFFBQVEsQ0FBQyxLQUFLLEVBQUU7UUFDdEIsS0FBSyxvQkFBb0IsQ0FBQyxVQUFVO1lBQ2xDLE9BQU8sSUFBSSx3QkFBd0IsRUFBRSxDQUFDO1FBQ3hDLEtBQUssb0JBQW9CLENBQUMsTUFBTTtZQUM5QixPQUFPLElBQUksb0JBQW9CLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ25EO1lBQ0UsT0FBTyxTQUFTLENBQUM7S0FDcEI7QUFDSCxDQUFDLENBQUM7QUFFRixNQUFNLENBQUMsTUFBTSxjQUFjLEdBQUcsQ0FBQyxjQUFzQyxFQUFXLEVBQUU7SUFDaEYsTUFBTSxRQUFRLEdBQUcsY0FBYyxDQUFDLG9CQUFvQixDQUFDLENBQUM7SUFDdEQsT0FBTyxDQUNMLENBQUMsQ0FBQyxRQUFRO1FBQ1YsUUFBUSxDQUFDLEtBQUs7UUFDZCxDQUFDLFFBQVEsQ0FBQyxLQUFLLEtBQUssb0JBQW9CLENBQUMsVUFBVSxJQUFJLFFBQVEsQ0FBQyxLQUFLLEtBQUssb0JBQW9CLENBQUMsTUFBTSxDQUFDLENBQ3ZHLENBQUM7QUFDSixDQUFDLENBQUM7QUFFRjs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQW1CRztBQUNILHNHQUFzRztBQUN0Ryw0REFBNEQ7QUFDNUQsTUFBTSxVQUFVLFVBQVUsQ0FDeEIsY0FBc0MsRUFDdEMsWUFBb0QsTUFBTSxDQUFDLEVBQUUsQ0FBQyxNQUFNO0lBRXBFLE9BQU8sVUFBNEMsV0FBYztRQUMvRCxNQUFNLFVBQVUsR0FBRyxjQUFjLENBQUMsb0JBQW9CLENBQUMsQ0FBQztRQUN4RCxJQUFJLFVBQVUsS0FBSyxTQUFTLElBQUksVUFBVSxDQUFDLEtBQUssS0FBSyxvQkFBb0IsQ0FBQyxNQUFNLEVBQUU7WUFDaEYsT0FBTyxXQUFXLENBQUM7U0FDcEI7UUFDQSxXQUFtQixDQUFDLG9CQUFvQixDQUFDLEdBQUc7WUFDM0MsS0FBSyxFQUFFLG9CQUFvQixDQUFDLE1BQU07WUFDbEMsTUFBTSxFQUFFLFNBQVMsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDO1NBQ3JDLENBQUM7UUFDRixPQUFPLFdBQVcsQ0FBQztJQUNyQixDQUFDLENBQUM7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUm91dGVzLCBSb3V0ZSB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQgeyBEZWZhdWx0Q29udGFpbmVyU3RyYXRlZ3kgfSBmcm9tICcuL2RlZmF1bHQtY29udGFpbmVyLXN0cmF0ZWd5JztcbmltcG9ydCB7IFN0YXRpY1JvdXRlc1N0cmF0ZWd5IH0gZnJvbSAnLi9zdGF0aWMtcm91dGVzLXN0cmF0ZWd5JztcbmltcG9ydCB7IFJvdXRlQ29tcG9uZW50IH0gZnJvbSAnLi4vY29tcG9uZW50cy9yb3V0ZS5jb21wb25lbnQnO1xuaW1wb3J0IHsgSXRlbVJvdXRlcyB9IGZyb20gJy4uL2NvbmZpZy9yb3V0aW5nLXRyZWUnO1xuaW1wb3J0IHsgUm91dGFibGVJdGVtIH0gZnJvbSAnLi4vY29uZmlnL3JvdXRhYmxlLWl0ZW0tdHJlZSc7XG5cbi8qKlxuICogU3ltYm9sIHVzZWQgdG8ga2VlcCBpbnRlcm5hbCBCYWNrYmFzZSByb3V0aW5nIGluZm9ybWF0aW9uXG4gKiBpbiBhbiBBbmd1bGFyIGNvbXBvbmVudCBjbGFzc1xuICovXG5leHBvcnQgY29uc3Qgcm91dGluZ1N0cmF0ZWd5RmllbGQgPSBTeW1ib2woJ86pUm91dGluZ1N0cmF0ZWd5Jyk7XG5cbi8qKlxuICogUm91dGluZ1N0cmF0ZWd5VG9rZW4gZW51bSB3aXRoIHJvdXRpbmcgc3RyYXRlZ3kgdG9rZW5zXG4gKi9cbmV4cG9ydCBlbnVtIFJvdXRpbmdTdHJhdGVneVRva2VuIHtcbiAgU1RBVElDID0gJ1N0YXRpY1JvdXRlc1N0cmF0ZWd5JyxcbiAgQ09OVEFJTkVSUyA9ICdEZWZhdWx0Q29udGFpbmVyU3RyYXRlZ3knLFxufVxuXG4vKipcbiAqIFJvdXRpbmdTdHJhdGVneURlZmluaXRpb24gcmVwcmVzZW50cyBhIHNldCBvZiBhdmFsaWFibGVcbiAqIHN0cmF0ZWdpZXMgZm9yIEJhY2tiYXNlIHJvdXRpbmdcbiAqL1xuZXhwb3J0IHR5cGUgUm91dGluZ1N0cmF0ZWd5RGVmaW5pdGlvbiA9XG4gIHwgeyB0b2tlbjogUm91dGluZ1N0cmF0ZWd5VG9rZW4uQ09OVEFJTkVSUyB9XG4gIHwgeyB0b2tlbjogUm91dGluZ1N0cmF0ZWd5VG9rZW4uU1RBVElDOyByb3V0ZXM6IFdpZGdldFJvdXRlcyB9O1xuXG4vKipcbiAqIFJvdXRhYmxlQ29tcG9uZW50Q2xhc3MgaW50ZXJmYWNlIHJlcHJlc2VudHMgY29tcG9uZW50cyB3aGljaCBhcmVcbiAqIGRlY29yYXRlZCB3aXRoIEBSb3V0YWJsZVdpZGdldCBhbmQgY2FuIGJlIHVzZWQgZm9yIEBDb3B5Um91dGUgaW4gYVxuICogd3JhcHBlciB3aWRnZXQgKGFzIGEgcGFydCBvZiBjdXN0b21pc2F0aW9uKS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBSb3V0YWJsZUNvbXBvbmVudENsYXNzIHtcbiAgbmV3ICguLi5hcmdzOiBBcnJheTxhbnk+KToge307XG4gIFtyb3V0aW5nU3RyYXRlZ3lGaWVsZF0/OiBSb3V0aW5nU3RyYXRlZ3lEZWZpbml0aW9uO1xufVxuXG4vKipcbiAqIFJvdXRhYmxlQ29udGFpbmVyIGRlY29yYXRvciBpcyB1c2VkIHRvIG1hcmsgYW4gaXRlbSBhc1xuICogcm91dGFibGUuIEl0IG1ha2VzIHRoZSByb3V0aW5nIGNvbmZpZyBzZXJ2aWNlIHRvIHVzZSBkZWZhdWx0XG4gKiBzdHJhdGVneSBmb3IgY29udGFpbmVycy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIFJvdXRhYmxlQ29udGFpbmVyKCkge1xuICByZXR1cm4gZnVuY3Rpb24gPFQgZXh0ZW5kcyBuZXcgKC4uLmFyZ3M6IEFycmF5PGFueT4pID0+IHt9Pihjb25zdHJ1Y3RvcjogVCkge1xuICAgIChjb25zdHJ1Y3RvciBhcyBhbnkpW3JvdXRpbmdTdHJhdGVneUZpZWxkXSA9IHtcbiAgICAgIHRva2VuOiBSb3V0aW5nU3RyYXRlZ3lUb2tlbi5DT05UQUlORVJTLFxuICAgIH07XG4gICAgcmV0dXJuIGNvbnN0cnVjdG9yO1xuICB9O1xufVxuXG4vKipcbiAqIFdpZGdldFJvdXRlIGlzIGEgc3Vic2V0IG9mIEFuZ3VsYXIncyBSb3V0ZSBpbnRlcmZhY2UgYnV0IHdlIG9ubHkgc3VwcG9ydCBhIGZldyBzZWxlY3QgcHJvcGVydGllcy5cbiAqXG4gKiBXZSBvbmx5IHN1cHBvcnQgYSBzZWxlY3Rpb24gb2YgdGhlc2UgcHJvcGVydGllcyBzbyB3ZSBjYW4gZ3VhcmFudGVlIHRoZXkgd29yay4gSWYgeW91IHdvdWxkIGxpa2VcbiAqIHRvIGhhdmUgc3VwcG9ydCBhZGRlZCBmb3IgYWRkaXRpb25hbCBSb3V0ZSBwcm9wZXJ0aWVzLCBwbGVhc2UgcmVxdWVzdCBpdCBhbmQgd2Ugd2lsbCBpbnZlc3RpZ2F0ZVxuICogYWRkaW5nIHN1cHBvcnQgZm9yIGl0LlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFdpZGdldFJvdXRlXG4gIGV4dGVuZHMgUGljazxSb3V0ZSwgJ3BhdGgnIHwgJ2NvbXBvbmVudCcgfCAncmVkaXJlY3RUbycgfCAncGF0aE1hdGNoJyB8ICdvdXRsZXQnIHwgJ2NhbkRlYWN0aXZhdGUnPiB7fVxuXG4vKipcbiAqIFBsZWFzZSBub3RlIHRoYXQgd2UgaGF2ZSBkZXByZWNhdGVkIHN1cHBvcnQgZm9yIFJvdXRlcy4gUGxlYXNlIHN0aWNrIHRvIHVzaW5nIG9ubHkgdGhlIHN1cHBvcnRlZFxuICogYFdpZGdldFJvdXRlYCBpbnRlcmZhY2UgaW5zdGVhZC5cbiAqL1xuZXhwb3J0IHR5cGUgV2lkZ2V0Um91dGVzID0gUm91dGVzIHwgQXJyYXk8V2lkZ2V0Um91dGU+O1xuXG4vKipcbiAqIENvbmZpZ3VyYXRpb24gaW50ZXJmYWNlIGZvciBSb3V0YWJsZVdpZGdldCBkZWNvcmF0b3JcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBSb3V0YWJsZVdpZGdldENvbmZpZyB7XG4gIC8qKlxuICAgKiBBbmd1bGFyIHJvdXRlciBjb25maWd1cmF0aW9uXG4gICAqL1xuICByb3V0ZXM6IFdpZGdldFJvdXRlcztcbn1cblxuLyoqXG4gKiBSb3V0YWJsZVdpZGdldCBkZWNvcmF0b3IgaXMgdXNlZCB0byBkZWZpbmUgd2lkZ2V0J3MgaW50ZXJuYWwgcm91dGVzLlxuICpcbiAqIEB1c2FnZU5vdGVzXG4gKlxuICogIyMjIEV4YW1wbGVcbiAqIGBgYFxuICogQENvbXBvbmVudCh7XG4gKiAgIHNlbGVjdG9yOiAnYmItdG9kby13aWRnZXQnLFxuICogICB0ZW1wbGF0ZTogYFxuICogICAgIDxiYi1yb3V0ZXItb3V0bGV0PjwvYmItcm91dGVyLW91dGxldD5cbiAqICAgYCxcbiAqICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gKiAgIHByb3ZpZGVyczogW1JvdXRlclNlcnZpY2UsIFRvZG9OYXZpZ2F0aW9uU2VydmljZV0sXG4gKiB9KVxuICogQFJvdXRhYmxlV2lkZ2V0KHtcbiAqICAgcm91dGVzOiBbXG4gKiAgICAgeyBwYXRoOiAnJywgY29tcG9uZW50OiBUb2RvTGlzdENvbnRhaW5lckNvbXBvbmVudCB9LFxuICogICAgIHsgcGF0aDogJzppZCcsIGNvbXBvbmVudDogVG9kb0RldGFpbENvbnRhaW5lckNvbXBvbmVudCB9LFxuICogICAgIHsgcGF0aDogJ2VkaXQvOmlkJywgY29tcG9uZW50OiBUb2RvRm9ybUNvbnRhaW5lckNvbXBvbmVudCB9LFxuICogICBdLFxuICogfSlcbiAqIGV4cG9ydCBjbGFzcyBUb2RvV2lkZ2V0Q29tcG9uZW50IHt9XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0gY29uZmlnIENvbmZpZ3VyYXRpb24gb2JqZWN0IG9mIHRoZSBSb3V0YWJsZVdpZGdldCBkZWNvcmF0b3JcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIFJvdXRhYmxlV2lkZ2V0KGNvbmZpZzogUm91dGFibGVXaWRnZXRDb25maWcpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIDxUIGV4dGVuZHMgbmV3ICguLi5hcmdzOiBBcnJheTxhbnk+KSA9PiB7fT4oY29uc3RydWN0b3I6IFQpIHtcbiAgICAoY29uc3RydWN0b3IgYXMgYW55KVtyb3V0aW5nU3RyYXRlZ3lGaWVsZF0gPSB7XG4gICAgICB0b2tlbjogUm91dGluZ1N0cmF0ZWd5VG9rZW4uU1RBVElDLFxuICAgICAgcm91dGVzOiBjb25maWcucm91dGVzLFxuICAgIH07XG4gICAgcmV0dXJuIGNvbnN0cnVjdG9yO1xuICB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJvdXRpbmdTdHJhdGVneSB7XG4gIGdldFJvdXRlcyhtb2RlbDogUm91dGFibGVJdGVtLCBjaGlsZHJlbjogQXJyYXk8Um91dGFibGVJdGVtPiwgY2hpbGRSb3V0ZXM6IEFycmF5PEl0ZW1Sb3V0ZXM+KTogUm91dGVzO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJvdXRlQ29tcG9uZW50U3RyYXRlZ3kge1xuICBpc0l0ZW1JblJvdXRlKGl0ZW1OYW1lOiBzdHJpbmcsIHJvdXRlOiBSb3V0ZSk6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVSb3V0ZUNvbXBvbmVudFN0cmF0ZWd5ID0gKGNvbXBvbmVudDogYW55KTogUm91dGVDb21wb25lbnRTdHJhdGVneSA9PiB7XG4gIGNvbnN0IGlzSXRlbUluUm91dGUgPSBjb21wb25lbnQgPT09IFJvdXRlQ29tcG9uZW50ID8gY29tcG9uZW50LmlzSXRlbUluUm91dGUgOiAoKSA9PiBmYWxzZTtcbiAgcmV0dXJuIHtcbiAgICBpc0l0ZW1JblJvdXRlLFxuICB9O1xufTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVJvdXRpbmdTdHJhdGVneSA9IChjb21wb25lbnRDbGFzczogUm91dGFibGVDb21wb25lbnRDbGFzcyk6IFJvdXRpbmdTdHJhdGVneSB8IHVuZGVmaW5lZCA9PiB7XG4gIGNvbnN0IHN0cmF0ZWd5ID0gY29tcG9uZW50Q2xhc3Nbcm91dGluZ1N0cmF0ZWd5RmllbGRdO1xuICBpZiAoc3RyYXRlZ3kgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgc3dpdGNoIChzdHJhdGVneS50b2tlbikge1xuICAgIGNhc2UgUm91dGluZ1N0cmF0ZWd5VG9rZW4uQ09OVEFJTkVSUzpcbiAgICAgIHJldHVybiBuZXcgRGVmYXVsdENvbnRhaW5lclN0cmF0ZWd5KCk7XG4gICAgY2FzZSBSb3V0aW5nU3RyYXRlZ3lUb2tlbi5TVEFUSUM6XG4gICAgICByZXR1cm4gbmV3IFN0YXRpY1JvdXRlc1N0cmF0ZWd5KHN0cmF0ZWd5LnJvdXRlcyk7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBpc1JvdXRhYmxlSXRlbSA9IChjb21wb25lbnRDbGFzczogUm91dGFibGVDb21wb25lbnRDbGFzcyk6IGJvb2xlYW4gPT4ge1xuICBjb25zdCBzdHJhdGVneSA9IGNvbXBvbmVudENsYXNzW3JvdXRpbmdTdHJhdGVneUZpZWxkXTtcbiAgcmV0dXJuIChcbiAgICAhIXN0cmF0ZWd5ICYmXG4gICAgc3RyYXRlZ3kudG9rZW4gJiZcbiAgICAoc3RyYXRlZ3kudG9rZW4gPT09IFJvdXRpbmdTdHJhdGVneVRva2VuLkNPTlRBSU5FUlMgfHwgc3RyYXRlZ3kudG9rZW4gPT09IFJvdXRpbmdTdHJhdGVneVRva2VuLlNUQVRJQylcbiAgKTtcbn07XG5cbi8qKlxuICogQ29weVJvdXRlcyBkZWNvcmF0b3IgaXMgdXNlZCB0byByZS11c2UgdGhlIGludGVybmFsIHJvdXRpbmcgY29uZmlndXJhdGlvbiBmcm9tIGFuIGV4aXN0aW5nIHdpZGdldC5cbiAqXG4gKiBAdXNhZ2VOb3Rlc1xuICpcbiAqICMjIyBFeGFtcGxlXG4gKiBgYGBcbiAqIEBDb21wb25lbnQoe1xuICogICBzZWxlY3RvcjogJ215LXRvZG8td2lkZ2V0JyxcbiAqICAgdGVtcGxhdGU6IGBcbiAqICAgICA8aDE+TXkgQ3VzdG9tIFRvZG8gV2lkZ2V0PC9oMT5cbiAqICAgICA8YmItcm91dGVyLW91dGxldD48L2JiLXJvdXRlci1vdXRsZXQ+XG4gKiAgIGAsXG4gKiB9KVxuICogQENvcHlSb3V0ZXMoVG9kb1dpZGdldENvbXBvbmVudClcbiAqIGV4cG9ydCBjbGFzcyBNeVRvZG9XaWRnZXRDb21wb25lbnQge31cbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBmcm9tIFRoZSBXaWRnZXQgQ29tcG9uZW50IGNsYXNzIGZyb20gd2hpY2ggdG8gY29weSB0aGUgcm91dGluZyBjb25maWd1cmF0aW9uXG4gKi9cbi8vIE5vdGU6IGBmcm9tYCBzaG91bGQgYmUgYHsgW3JvdXRpbmdTdHJhdGVneUZpZWxkXTogUm91dGluZ1N0cmF0ZWd5RGVmaW5pdGlvbiB9YCBidXQgdGhlIHR5cGUgY2hlY2tlclxuLy8gY2FuJ3QgcmVzb2x2ZSBwcm9wZXJ0aWVzIGR5bmFtaWNhbGx5IGFkZGVkIGJ5IGRlY29yYXRvcnMuXG5leHBvcnQgZnVuY3Rpb24gQ29weVJvdXRlcyhcbiAgY29tcG9uZW50Q2xhc3M6IFJvdXRhYmxlQ29tcG9uZW50Q2xhc3MsXG4gIGN1c3RvbWl6ZTogKHJvdXRlczogV2lkZ2V0Um91dGVzKSA9PiBXaWRnZXRSb3V0ZXMgPSByb3V0ZXMgPT4gcm91dGVzLFxuKSB7XG4gIHJldHVybiBmdW5jdGlvbiA8VCBleHRlbmRzIFJvdXRhYmxlQ29tcG9uZW50Q2xhc3M+KGNvbnN0cnVjdG9yOiBUKSB7XG4gICAgY29uc3QgZGVmaW5pdGlvbiA9IGNvbXBvbmVudENsYXNzW3JvdXRpbmdTdHJhdGVneUZpZWxkXTtcbiAgICBpZiAoZGVmaW5pdGlvbiA9PT0gdW5kZWZpbmVkIHx8IGRlZmluaXRpb24udG9rZW4gIT09IFJvdXRpbmdTdHJhdGVneVRva2VuLlNUQVRJQykge1xuICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yO1xuICAgIH1cbiAgICAoY29uc3RydWN0b3IgYXMgYW55KVtyb3V0aW5nU3RyYXRlZ3lGaWVsZF0gPSB7XG4gICAgICB0b2tlbjogUm91dGluZ1N0cmF0ZWd5VG9rZW4uU1RBVElDLFxuICAgICAgcm91dGVzOiBjdXN0b21pemUoZGVmaW5pdGlvbi5yb3V0ZXMpLFxuICAgIH07XG4gICAgcmV0dXJuIGNvbnN0cnVjdG9yO1xuICB9O1xufVxuIl19