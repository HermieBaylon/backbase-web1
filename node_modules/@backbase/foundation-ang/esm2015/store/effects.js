import { isActionForChannel, createChannelAction, toChannelAction } from './actions';
import { createEffect } from '@ngrx/effects';
import { map, filter } from 'rxjs/operators';
export const METADATA_KEY = '@backbase/store effect metadata';
const setEffectActionMetadata = (sourceProto, entries) => {
    const constructor = sourceProto.constructor;
    const meta = constructor.hasOwnProperty(METADATA_KEY)
        ? constructor[METADATA_KEY]
        : Object.defineProperty(constructor, METADATA_KEY, { value: [] })[METADATA_KEY];
    Array.prototype.push.apply(meta, entries);
};
const ɵ0 = setEffectActionMetadata;
const getEffectsMetadata = (sourceProto) => sourceProto.constructor.hasOwnProperty(METADATA_KEY) ? sourceProto.constructor[METADATA_KEY] : [];
const ɵ1 = getEffectsMetadata;
/**
 * @deprecated Will be removed in v7.0.0
 * Method decorator to mark a method as an effect. Effects can be registered with a `Store` to perform external
 * effects such as fetching data or navigating the browser.
 *
 * The decorated method must be `(actions: Observable<Action>, store?: Store) => Observable<Action>`.
 */
export const Effect = () => {
    return function (target, methodName) {
        const metadata = {
            propertyName: methodName,
        };
        setEffectActionMetadata(target, [metadata]);
    };
};
const hasEffectActionMetadata = (instance) => getEffectsMetadata(instance).length > 0;
const ɵ2 = hasEffectActionMetadata;
const outputChannel = (channel) => (source) => source.pipe(map((action) => createChannelAction(action, channel)));
const ɵ3 = outputChannel;
const ofChannel = (channels) => (source) => source.pipe(map(action => toChannelAction(action)), filter((action) => isActionForChannel(action, channels)), map(channelAction => channelAction.action));
const ɵ4 = ofChannel;
/**
 * @deprecated Will be removed in v7.0.0
 */
export const createMetaChannelEffects = (store, actions, effects, dispatchChannel, listenChannels) => {
    if (!hasEffectActionMetadata(effects)) {
        throw new Error('Effect class has no effects');
    }
    const proto = function () { };
    Object.defineProperty(proto, 'name', { value: `Effect${dispatchChannel}`, writable: false });
    const effectInstance = Object.create(proto);
    return getEffectsMetadata(effects).reduce((instance, effect) => {
        instance[effect.propertyName] = createEffect(() => effects[effect.propertyName](actions.pipe(ofChannel(listenChannels)), store).pipe(outputChannel(dispatchChannel)));
        return instance;
    }, effectInstance);
};
export { ɵ0, ɵ1, ɵ2, ɵ3, ɵ4 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWZmZWN0cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2JhY2tiYXNlL2ZvdW5kYXRpb24tYW5nL3N0b3JlL3NyYy9lZmZlY3RzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBa0Msa0JBQWtCLEVBQUUsbUJBQW1CLEVBQUUsZUFBZSxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBRXJILE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFN0MsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUk3QyxNQUFNLENBQUMsTUFBTSxZQUFZLEdBQUcsaUNBQWlDLENBQUM7QUErQjlELE1BQU0sdUJBQXVCLEdBQUcsQ0FBbUIsV0FBYyxFQUFFLE9BQWlDLEVBQUUsRUFBRTtJQUN0RyxNQUFNLFdBQVcsR0FBRyxXQUFXLENBQUMsV0FBVyxDQUFDO0lBQzVDLE1BQU0sSUFBSSxHQUE2QixXQUFXLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FBQztRQUM3RSxDQUFDLENBQUUsV0FBbUIsQ0FBQyxZQUFZLENBQUM7UUFDcEMsQ0FBQyxDQUFFLE1BQU0sQ0FBQyxjQUFjLENBQUMsV0FBVyxFQUFFLFlBQVksRUFBRSxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsQ0FBUyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQzNGLEtBQUssQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDNUMsQ0FBQyxDQUFDOztBQUVGLE1BQU0sa0JBQWtCLEdBQUcsQ0FBbUIsV0FBYyxFQUE0QixFQUFFLENBQ3hGLFdBQVcsQ0FBQyxXQUFXLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBRSxXQUFXLENBQUMsV0FBbUIsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDOztBQUU3Rzs7Ozs7O0dBTUc7QUFDSCxNQUFNLENBQUMsTUFBTSxNQUFNLEdBQUcsR0FBc0MsRUFBRTtJQUM1RCxPQUFPLFVBQVUsTUFBUyxFQUFFLFVBQWtCO1FBQzVDLE1BQU0sUUFBUSxHQUFHO1lBQ2YsWUFBWSxFQUFFLFVBQVU7U0FDekIsQ0FBQztRQUNGLHVCQUF1QixDQUFDLE1BQU0sRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7SUFDOUMsQ0FBd0QsQ0FBQztBQUMzRCxDQUFDLENBQUM7QUFFRixNQUFNLHVCQUF1QixHQUFHLENBQUMsUUFBYSxFQUFXLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDOztBQUVwRyxNQUFNLGFBQWEsR0FBRyxDQUFtQixPQUFlLEVBQUUsRUFBRSxDQUFDLENBQUMsTUFBcUIsRUFBZ0MsRUFBRSxDQUNuSCxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQVMsRUFBRSxFQUFFLENBQUMsbUJBQW1CLENBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQzs7QUFFeEUsTUFBTSxTQUFTLEdBQUcsQ0FBbUIsUUFBdUIsRUFBRSxFQUFFLENBQUMsQ0FBQyxNQUEwQixFQUFpQixFQUFFLENBQzdHLE1BQU0sQ0FBQyxJQUFJLENBQ1QsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQ3RDLE1BQU0sQ0FBMEMsQ0FBQyxNQUFNLEVBQThCLEVBQUUsQ0FDckYsa0JBQWtCLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxDQUNyQyxFQUNELEdBQUcsQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FDM0MsQ0FBQzs7QUFDSjs7R0FFRztBQUNILE1BQU0sQ0FBQyxNQUFNLHdCQUF3QixHQUFHLENBQ3RDLEtBQXdCLEVBQ3hCLE9BQTJCLEVBQzNCLE9BQXdCLEVBQ3hCLGVBQXdCLEVBQ3hCLGNBQThCLEVBQ2MsRUFBRTtJQUM5QyxJQUFJLENBQUMsdUJBQXVCLENBQUMsT0FBTyxDQUFDLEVBQUU7UUFDckMsTUFBTSxJQUFJLEtBQUssQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO0tBQ2hEO0lBQ0QsTUFBTSxLQUFLLEdBQUcsY0FBYSxDQUFDLENBQUM7SUFDN0IsTUFBTSxDQUFDLGNBQWMsQ0FBQyxLQUFLLEVBQUUsTUFBTSxFQUFFLEVBQUUsS0FBSyxFQUFFLFNBQVMsZUFBZSxFQUFFLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7SUFDN0YsTUFBTSxjQUFjLEdBQStDLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7SUFFeEYsT0FBTyxrQkFBa0IsQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQ3ZDLENBQUMsUUFBb0QsRUFBRSxNQUEyQixFQUFFLEVBQUU7UUFDcEYsUUFBUSxDQUFDLE1BQU0sQ0FBQyxZQUFZLENBQUMsR0FBRyxZQUFZLENBQUMsR0FBRyxFQUFFLENBQ2hELE9BQU8sQ0FBQyxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQy9FLGFBQWEsQ0FBQyxlQUFlLENBQUMsQ0FDL0IsQ0FDRixDQUFDO1FBQ0YsT0FBTyxRQUFRLENBQUM7SUFDbEIsQ0FBQyxFQUNELGNBQWMsQ0FDZixDQUFDO0FBQ0osQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWN0aW9uLCBDaGFubmVsQWN0aW9uLCBDaGFubmVsLCBpc0FjdGlvbkZvckNoYW5uZWwsIGNyZWF0ZUNoYW5uZWxBY3Rpb24sIHRvQ2hhbm5lbEFjdGlvbiB9IGZyb20gJy4vYWN0aW9ucyc7XG5cbmltcG9ydCB7IGNyZWF0ZUVmZmVjdCB9IGZyb20gJ0BuZ3J4L2VmZmVjdHMnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgbWFwLCBmaWx0ZXIgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBUeXBlLCBJbmplY3Rpb25Ub2tlbiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgU3RvcmUgfSBmcm9tICcuL3N0b3JlLWJyb2tlci5zZXJ2aWNlJztcblxuZXhwb3J0IGNvbnN0IE1FVEFEQVRBX0tFWSA9ICdAYmFja2Jhc2Uvc3RvcmUgZWZmZWN0IG1ldGFkYXRhJztcblxuLyoqXG4gKiBAZGVwcmVjYXRlZCBXaWxsIGJlIHJlbW92ZWQgaW4gdjcuMC4wXG4gKiBBbiBpbnN0YW5jZSBvZiBhIGNsYXNzIGNvbnRhaW5pbmcgb25lIG9yIG1vcmUgYEVmZmVjdGAgbWV0aG9kcy5cbiAqL1xuLy8gQHRvZG86IGRlZmluZSBlZmZlY3RzIGNsYXNzXG4vLyBAdHMtZXhwZWN0LWVycm9yOiBUaGUgZ2VuZXJpYyBoZXJlIGlzIHVuZGVmaW5lZCwgYnV0IGxlZnQgZm9yIGZ1dHVyZSB1c2UuXG5leHBvcnQgdHlwZSBFZmZlY3RzPFYgZXh0ZW5kcyBBY3Rpb24+ID0gYW55O1xuXG4vKipcbiAqIEBkZXByZWNhdGVkIFdpbGwgYmUgcmVtb3ZlZCBpbiB2Ny4wLjBcbiAqIEFuIGluamVjdGlvbiB0b2tlbiB1c2VkIHRvIGdldCBhbiBgRWZmZWN0YHMgaW5zdGFuY2UuXG4gKi9cbmV4cG9ydCB0eXBlIEVmZmVjdHNJbmplY3Rpb25Ub2tlbjxWIGV4dGVuZHMgQWN0aW9uPiA9IFR5cGU8RWZmZWN0czxWPj4gfCBJbmplY3Rpb25Ub2tlbjxFZmZlY3RzPFY+Pjtcbi8qKlxuICogQGRlcHJlY2F0ZWQgV2lsbCBiZSByZW1vdmVkIGluIHY3LjAuMFxuICovXG5leHBvcnQgaW50ZXJmYWNlIE5ncnhFZmZlY3RzSW5zdGFuY2U8ViBleHRlbmRzIEFjdGlvbj4ge1xuICBbcHJvcGVydHk6IHN0cmluZ106IE9ic2VydmFibGU8Vj47XG59XG4vKipcbiAqIEBkZXByZWNhdGVkIFdpbGwgYmUgcmVtb3ZlZCBpbiB2Ny4wLjBcbiAqL1xuLy8gQHRzLWV4cGVjdC1lcnJvcjogVGhlIGdlbmVyaWMgaGVyZSBpcyB1bmRlZmluZWQsIGJ1dCBsZWZ0IGZvciBmdXR1cmUgdXNlLlxuZXhwb3J0IGludGVyZmFjZSBFZmZlY3RNZXRhZGF0YTxUPiB7XG4gIC8vIE9uY2UgVFMgaXMgPj0gMi44IHJlcGxhY2Ugd2l0aCA8S2V5IGV4dGVuZHMgRXh0cmFjdDxrZXlvZiBULCBzdHJpbmc+PlxuICBwcm9wZXJ0eU5hbWU6IHN0cmluZztcbiAgLy8gQHRvZG86IGRpc3BhdGNoIG9wdGlvbmFsIChzYW1lIGFzIG5ncngpXG59XG5cbmNvbnN0IHNldEVmZmVjdEFjdGlvbk1ldGFkYXRhID0gPFQgZXh0ZW5kcyBvYmplY3Q+KHNvdXJjZVByb3RvOiBULCBlbnRyaWVzOiBBcnJheTxFZmZlY3RNZXRhZGF0YTxUPj4pID0+IHtcbiAgY29uc3QgY29uc3RydWN0b3IgPSBzb3VyY2VQcm90by5jb25zdHJ1Y3RvcjtcbiAgY29uc3QgbWV0YTogQXJyYXk8RWZmZWN0TWV0YWRhdGE8VD4+ID0gY29uc3RydWN0b3IuaGFzT3duUHJvcGVydHkoTUVUQURBVEFfS0VZKVxuICAgID8gKGNvbnN0cnVjdG9yIGFzIGFueSlbTUVUQURBVEFfS0VZXVxuICAgIDogKE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb25zdHJ1Y3RvciwgTUVUQURBVEFfS0VZLCB7IHZhbHVlOiBbXSB9KSBhcyBhbnkpW01FVEFEQVRBX0tFWV07XG4gIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KG1ldGEsIGVudHJpZXMpO1xufTtcblxuY29uc3QgZ2V0RWZmZWN0c01ldGFkYXRhID0gPFQgZXh0ZW5kcyBvYmplY3Q+KHNvdXJjZVByb3RvOiBUKTogQXJyYXk8RWZmZWN0TWV0YWRhdGE8VD4+ID0+XG4gIHNvdXJjZVByb3RvLmNvbnN0cnVjdG9yLmhhc093blByb3BlcnR5KE1FVEFEQVRBX0tFWSkgPyAoc291cmNlUHJvdG8uY29uc3RydWN0b3IgYXMgYW55KVtNRVRBREFUQV9LRVldIDogW107XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgV2lsbCBiZSByZW1vdmVkIGluIHY3LjAuMFxuICogTWV0aG9kIGRlY29yYXRvciB0byBtYXJrIGEgbWV0aG9kIGFzIGFuIGVmZmVjdC4gRWZmZWN0cyBjYW4gYmUgcmVnaXN0ZXJlZCB3aXRoIGEgYFN0b3JlYCB0byBwZXJmb3JtIGV4dGVybmFsXG4gKiBlZmZlY3RzIHN1Y2ggYXMgZmV0Y2hpbmcgZGF0YSBvciBuYXZpZ2F0aW5nIHRoZSBicm93c2VyLlxuICpcbiAqIFRoZSBkZWNvcmF0ZWQgbWV0aG9kIG11c3QgYmUgYChhY3Rpb25zOiBPYnNlcnZhYmxlPEFjdGlvbj4sIHN0b3JlPzogU3RvcmUpID0+IE9ic2VydmFibGU8QWN0aW9uPmAuXG4gKi9cbmV4cG9ydCBjb25zdCBFZmZlY3QgPSA8VCBleHRlbmRzIG9iamVjdD4oKTogTWV0aG9kRGVjb3JhdG9yID0+IHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQ6IFQsIG1ldGhvZE5hbWU6IHN0cmluZykge1xuICAgIGNvbnN0IG1ldGFkYXRhID0ge1xuICAgICAgcHJvcGVydHlOYW1lOiBtZXRob2ROYW1lLFxuICAgIH07XG4gICAgc2V0RWZmZWN0QWN0aW9uTWV0YWRhdGEodGFyZ2V0LCBbbWV0YWRhdGFdKTtcbiAgfSBhcyAodGFyZ2V0OiB7fSwgcHJvcGVydHlOYW1lOiBzdHJpbmcgfCBzeW1ib2wpID0+IHZvaWQ7XG59O1xuXG5jb25zdCBoYXNFZmZlY3RBY3Rpb25NZXRhZGF0YSA9IChpbnN0YW5jZTogYW55KTogYm9vbGVhbiA9PiBnZXRFZmZlY3RzTWV0YWRhdGEoaW5zdGFuY2UpLmxlbmd0aCA+IDA7XG5cbmNvbnN0IG91dHB1dENoYW5uZWwgPSA8VCBleHRlbmRzIEFjdGlvbj4oY2hhbm5lbDogc3RyaW5nKSA9PiAoc291cmNlOiBPYnNlcnZhYmxlPFQ+KTogT2JzZXJ2YWJsZTxDaGFubmVsQWN0aW9uPFQ+PiA9PlxuICBzb3VyY2UucGlwZShtYXAoKGFjdGlvbjogVCkgPT4gY3JlYXRlQ2hhbm5lbEFjdGlvbihhY3Rpb24sIGNoYW5uZWwpKSk7XG5cbmNvbnN0IG9mQ2hhbm5lbCA9IDxWIGV4dGVuZHMgQWN0aW9uPihjaGFubmVsczogQXJyYXk8c3RyaW5nPikgPT4gKHNvdXJjZTogT2JzZXJ2YWJsZTxBY3Rpb24+KTogT2JzZXJ2YWJsZTxWPiA9PlxuICBzb3VyY2UucGlwZShcbiAgICBtYXAoYWN0aW9uID0+IHRvQ2hhbm5lbEFjdGlvbihhY3Rpb24pKSxcbiAgICBmaWx0ZXI8Q2hhbm5lbEFjdGlvbjxBY3Rpb24+LCBDaGFubmVsQWN0aW9uPFY+PigoYWN0aW9uKTogYWN0aW9uIGlzIENoYW5uZWxBY3Rpb248Vj4gPT5cbiAgICAgIGlzQWN0aW9uRm9yQ2hhbm5lbChhY3Rpb24sIGNoYW5uZWxzKSxcbiAgICApLFxuICAgIG1hcChjaGFubmVsQWN0aW9uID0+IGNoYW5uZWxBY3Rpb24uYWN0aW9uKSxcbiAgKTtcbi8qKlxuICogQGRlcHJlY2F0ZWQgV2lsbCBiZSByZW1vdmVkIGluIHY3LjAuMFxuICovXG5leHBvcnQgY29uc3QgY3JlYXRlTWV0YUNoYW5uZWxFZmZlY3RzID0gPFYgZXh0ZW5kcyBBY3Rpb24+KFxuICBzdG9yZTogU3RvcmU8dW5rbm93biwgVj4sXG4gIGFjdGlvbnM6IE9ic2VydmFibGU8QWN0aW9uPixcbiAgZWZmZWN0czogRWZmZWN0czxBY3Rpb24+LFxuICBkaXNwYXRjaENoYW5uZWw6IENoYW5uZWwsXG4gIGxpc3RlbkNoYW5uZWxzOiBBcnJheTxDaGFubmVsPixcbik6IE5ncnhFZmZlY3RzSW5zdGFuY2U8Q2hhbm5lbEFjdGlvbjxBY3Rpb24+PiA9PiB7XG4gIGlmICghaGFzRWZmZWN0QWN0aW9uTWV0YWRhdGEoZWZmZWN0cykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0VmZmVjdCBjbGFzcyBoYXMgbm8gZWZmZWN0cycpO1xuICB9XG4gIGNvbnN0IHByb3RvID0gZnVuY3Rpb24gKCkge307XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwcm90bywgJ25hbWUnLCB7IHZhbHVlOiBgRWZmZWN0JHtkaXNwYXRjaENoYW5uZWx9YCwgd3JpdGFibGU6IGZhbHNlIH0pO1xuICBjb25zdCBlZmZlY3RJbnN0YW5jZTogTmdyeEVmZmVjdHNJbnN0YW5jZTxDaGFubmVsQWN0aW9uPEFjdGlvbj4+ID0gT2JqZWN0LmNyZWF0ZShwcm90byk7XG5cbiAgcmV0dXJuIGdldEVmZmVjdHNNZXRhZGF0YShlZmZlY3RzKS5yZWR1Y2UoXG4gICAgKGluc3RhbmNlOiBOZ3J4RWZmZWN0c0luc3RhbmNlPENoYW5uZWxBY3Rpb248QWN0aW9uPj4sIGVmZmVjdDogRWZmZWN0TWV0YWRhdGE8YW55PikgPT4ge1xuICAgICAgaW5zdGFuY2VbZWZmZWN0LnByb3BlcnR5TmFtZV0gPSBjcmVhdGVFZmZlY3QoKCkgPT5cbiAgICAgICAgZWZmZWN0c1tlZmZlY3QucHJvcGVydHlOYW1lXShhY3Rpb25zLnBpcGUob2ZDaGFubmVsKGxpc3RlbkNoYW5uZWxzKSksIHN0b3JlKS5waXBlKFxuICAgICAgICAgIG91dHB1dENoYW5uZWwoZGlzcGF0Y2hDaGFubmVsKSxcbiAgICAgICAgKSxcbiAgICAgICk7XG4gICAgICByZXR1cm4gaW5zdGFuY2U7XG4gICAgfSxcbiAgICBlZmZlY3RJbnN0YW5jZSxcbiAgKTtcbn07XG4iXX0=