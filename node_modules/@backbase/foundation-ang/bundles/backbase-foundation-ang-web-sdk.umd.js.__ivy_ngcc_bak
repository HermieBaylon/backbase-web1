(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('@backbase/foundation-ang/entitlements'), require('rxjs'), require('@backbase/foundation-ang/testing'), require('@backbase/lib-bb-page-bootstrap-cdn'), require('@angular/common')) :
    typeof define === 'function' && define.amd ? define('@backbase/foundation-ang/web-sdk', ['exports', '@angular/core', '@backbase/foundation-ang/entitlements', 'rxjs', '@backbase/foundation-ang/testing', '@backbase/lib-bb-page-bootstrap-cdn', '@angular/common'], factory) :
    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory((global.backbase = global.backbase || {}, global.backbase["foundation-ang"] = global.backbase["foundation-ang"] || {}, global.backbase["foundation-ang"]["web-sdk"] = {}), global.ng.core, global.backbase["foundation-ang"].entitlements, global.rxjs, global.backbase["foundation-ang"].testing, global.libBbPageBootstrapCdn, global.ng.common));
})(this, (function (exports, i0, entitlements, rxjs, testing, libBbPageBootstrapCdn, i1) { 'use strict';

    function _interopNamespace(e) {
        if (e && e.__esModule) return e;
        var n = Object.create(null);
        if (e) {
            Object.keys(e).forEach(function (k) {
                if (k !== 'default') {
                    var d = Object.getOwnPropertyDescriptor(e, k);
                    Object.defineProperty(n, k, d.get ? d : {
                        enumerable: true,
                        get: function () { return e[k]; }
                    });
                }
            });
        }
        n["default"] = e;
        return Object.freeze(n);
    }

    var i0__namespace = /*#__PURE__*/_interopNamespace(i0);
    var i1__namespace = /*#__PURE__*/_interopNamespace(i1);

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
    /* global Reflect, Promise */
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b)
                if (Object.prototype.hasOwnProperty.call(b, p))
                    d[p] = b[p]; };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function () {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s)
                    if (Object.prototype.hasOwnProperty.call(s, p))
                        t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __rest(s, e) {
        var t = {};
        for (var p in s)
            if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
                t[p] = s[p];
        if (s != null && typeof Object.getOwnPropertySymbols === "function")
            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
                if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                    t[p[i]] = s[p[i]];
            }
        return t;
    }
    function __decorate(decorators, target, key, desc) {
        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
        if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
            r = Reflect.decorate(decorators, target, key, desc);
        else
            for (var i = decorators.length - 1; i >= 0; i--)
                if (d = decorators[i])
                    r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
        return c > 3 && r && Object.defineProperty(target, key, r), r;
    }
    function __param(paramIndex, decorator) {
        return function (target, key) { decorator(target, key, paramIndex); };
    }
    function __metadata(metadataKey, metadataValue) {
        if (typeof Reflect === "object" && typeof Reflect.metadata === "function")
            return Reflect.metadata(metadataKey, metadataValue);
    }
    function __awaiter(thisArg, _arguments, P, generator) {
        function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
        return new (P || (P = Promise))(function (resolve, reject) {
            function fulfilled(value) { try {
                step(generator.next(value));
            }
            catch (e) {
                reject(e);
            } }
            function rejected(value) { try {
                step(generator["throw"](value));
            }
            catch (e) {
                reject(e);
            } }
            function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
            step((generator = generator.apply(thisArg, _arguments || [])).next());
        });
    }
    function __generator(thisArg, body) {
        var _ = { label: 0, sent: function () { if (t[0] & 1)
                throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
        return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function () { return this; }), g;
        function verb(n) { return function (v) { return step([n, v]); }; }
        function step(op) {
            if (f)
                throw new TypeError("Generator is already executing.");
            while (_)
                try {
                    if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done)
                        return t;
                    if (y = 0, t)
                        op = [op[0] & 2, t.value];
                    switch (op[0]) {
                        case 0:
                        case 1:
                            t = op;
                            break;
                        case 4:
                            _.label++;
                            return { value: op[1], done: false };
                        case 5:
                            _.label++;
                            y = op[1];
                            op = [0];
                            continue;
                        case 7:
                            op = _.ops.pop();
                            _.trys.pop();
                            continue;
                        default:
                            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                                _ = 0;
                                continue;
                            }
                            if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) {
                                _.label = op[1];
                                break;
                            }
                            if (op[0] === 6 && _.label < t[1]) {
                                _.label = t[1];
                                t = op;
                                break;
                            }
                            if (t && _.label < t[2]) {
                                _.label = t[2];
                                _.ops.push(op);
                                break;
                            }
                            if (t[2])
                                _.ops.pop();
                            _.trys.pop();
                            continue;
                    }
                    op = body.call(thisArg, _);
                }
                catch (e) {
                    op = [6, e];
                    y = 0;
                }
                finally {
                    f = t = 0;
                }
            if (op[0] & 5)
                throw op[1];
            return { value: op[0] ? op[1] : void 0, done: true };
        }
    }
    var __createBinding = Object.create ? (function (o, m, k, k2) {
        if (k2 === undefined)
            k2 = k;
        Object.defineProperty(o, k2, { enumerable: true, get: function () { return m[k]; } });
    }) : (function (o, m, k, k2) {
        if (k2 === undefined)
            k2 = k;
        o[k2] = m[k];
    });
    function __exportStar(m, o) {
        for (var p in m)
            if (p !== "default" && !Object.prototype.hasOwnProperty.call(o, p))
                __createBinding(o, m, p);
    }
    function __values(o) {
        var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
        if (m)
            return m.call(o);
        if (o && typeof o.length === "number")
            return {
                next: function () {
                    if (o && i >= o.length)
                        o = void 0;
                    return { value: o && o[i++], done: !o };
                }
            };
        throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m)
            return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done)
                ar.push(r.value);
        }
        catch (error) {
            e = { error: error };
        }
        finally {
            try {
                if (r && !r.done && (m = i["return"]))
                    m.call(i);
            }
            finally {
                if (e)
                    throw e.error;
            }
        }
        return ar;
    }
    /** @deprecated */
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++)
            ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    /** @deprecated */
    function __spreadArrays() {
        for (var s = 0, i = 0, il = arguments.length; i < il; i++)
            s += arguments[i].length;
        for (var r = Array(s), k = 0, i = 0; i < il; i++)
            for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
                r[k] = a[j];
        return r;
    }
    function __spreadArray(to, from, pack) {
        if (pack || arguments.length === 2)
            for (var i = 0, l = from.length, ar; i < l; i++) {
                if (ar || !(i in from)) {
                    if (!ar)
                        ar = Array.prototype.slice.call(from, 0, i);
                    ar[i] = from[i];
                }
            }
        return to.concat(ar || Array.prototype.slice.call(from));
    }
    function __await(v) {
        return this instanceof __await ? (this.v = v, this) : new __await(v);
    }
    function __asyncGenerator(thisArg, _arguments, generator) {
        if (!Symbol.asyncIterator)
            throw new TypeError("Symbol.asyncIterator is not defined.");
        var g = generator.apply(thisArg, _arguments || []), i, q = [];
        return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
        function verb(n) { if (g[n])
            i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
        function resume(n, v) { try {
            step(g[n](v));
        }
        catch (e) {
            settle(q[0][3], e);
        } }
        function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
        function fulfill(value) { resume("next", value); }
        function reject(value) { resume("throw", value); }
        function settle(f, v) { if (f(v), q.shift(), q.length)
            resume(q[0][0], q[0][1]); }
    }
    function __asyncDelegator(o) {
        var i, p;
        return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
        function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
    }
    function __asyncValues(o) {
        if (!Symbol.asyncIterator)
            throw new TypeError("Symbol.asyncIterator is not defined.");
        var m = o[Symbol.asyncIterator], i;
        return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
        function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
        function settle(resolve, reject, d, v) { Promise.resolve(v).then(function (v) { resolve({ value: v, done: d }); }, reject); }
    }
    function __makeTemplateObject(cooked, raw) {
        if (Object.defineProperty) {
            Object.defineProperty(cooked, "raw", { value: raw });
        }
        else {
            cooked.raw = raw;
        }
        return cooked;
    }
    ;
    var __setModuleDefault = Object.create ? (function (o, v) {
        Object.defineProperty(o, "default", { enumerable: true, value: v });
    }) : function (o, v) {
        o["default"] = v;
    };
    function __importStar(mod) {
        if (mod && mod.__esModule)
            return mod;
        var result = {};
        if (mod != null)
            for (var k in mod)
                if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k))
                    __createBinding(result, mod, k);
        __setModuleDefault(result, mod);
        return result;
    }
    function __importDefault(mod) {
        return (mod && mod.__esModule) ? mod : { default: mod };
    }
    function __classPrivateFieldGet(receiver, state, kind, f) {
        if (kind === "a" && !f)
            throw new TypeError("Private accessor was defined without a getter");
        if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver))
            throw new TypeError("Cannot read private member from an object whose class did not declare it");
        return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
    }
    function __classPrivateFieldSet(receiver, state, value, kind, f) {
        if (kind === "m")
            throw new TypeError("Private method is not writable");
        if (kind === "a" && !f)
            throw new TypeError("Private accessor was defined without a setter");
        if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver))
            throw new TypeError("Cannot write private member to an object whose class did not declare it");
        return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
    }

    /**
     * @deprecated Will be removed in v7.0.0
     */
    var PAGE_CONFIG = new i0.InjectionToken('web-sdk-page-config');
    var defaultPageConfig = {
        apiRoot: '/gateway/api/',
        staticResourcesRoot: '/',
        currentLink: '',
        pageName: '',
        portalName: '',
        version: '6',
        locale: 'en-US',
        locales: ['en-US'],
        currentLinkUUID: '',
        designmode: false,
        cspNonce: '',
        linkRoot: '/gateway',
        webSdkVersion: '',
        userId: '',
    };
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function getPageConfig(webSdkServiceMap) {
        if (webSdkServiceMap === void 0) { webSdkServiceMap = {}; }
        var pageConfig = webSdkServiceMap.pageConfig
            ? Object.assign(Object.assign({}, defaultPageConfig), webSdkServiceMap.pageConfig()) : defaultPageConfig;
        return pageConfig;
    }

    /**
     * @deprecated Will be removed in v7.0.0. Use the `PubSubService` class instead.
     */
    var PUBSUB = new i0.InjectionToken('web-sdk-pubsub');
    /**
     * @deprecated Will be removed in v7.0.0. Use the `SetLocaleService` class instead.
     */
    var SET_LOCALE = new i0.InjectionToken('web-sdk-set-locale');
    /**
     * @deprecated Will be removed in v7.0.0
     */
    var EMBEDDED_SERVICES = new i0.InjectionToken('embedded platform services');
    /**
     * @description
     * Service to reauthenticate a user.
     *
     * @example
     * export class SigningService {
     *   constructor(
     *     @Inject(REAUTHENTICATE) private reauthenticateService: ReauthenticateService,
     *   ) {
     *     this.reauthenticate(error);
     *   }
     *
     *   private reauthenticate(error: HttpErrorResponse) {
     *     const { acrValues, scope } = this.getChallenge(error);
     *     this.reauthenticateService.reauthenticate(scope, acrValues);
     *   }
     *
     *   private getReauthChallenge(error: HttpErrorResponse) {
     *     const challenges = error.error ? error.error.challenges : [];
     *     return challenges.find(c => c.scope !== undefined);
     *   }
     * }
     */
    /**
     * @deprecated Will be removed in v7.0.0
     */
    var EXTERNAL_SERVICES = new i0.InjectionToken('external platform services');
    /**
     * @deprecated Will be removed in v7.0.0
     */
    var WEBSDK_SERVICE_MAP = new i0.InjectionToken('Web SDK Service Map');
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function websdkServiceFactory(webSdkServiceMap, serviceKey) {
        if (!webSdkServiceMap) {
            return undefined;
        }
        var factory = webSdkServiceMap[serviceKey];
        if (!factory) {
            return undefined;
        }
        return factory(); // TS isn't smart enough to know that factory() is T.
    }
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function navigationFactory(webSdkServiceMap) {
        return websdkServiceFactory(webSdkServiceMap, 'navigation');
    }
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function pubsubFactory(webSdkServiceMap) {
        return websdkServiceFactory(webSdkServiceMap, 'eventBus');
    }
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function portalContentFactory(webSdkServiceMap) {
        return websdkServiceFactory(webSdkServiceMap, 'portalContent');
    }
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function setLocaleFactory$1(webSdkServiceMap) {
        return websdkServiceFactory(webSdkServiceMap, 'setLocale');
    }

    /**
     * Convert a pubsub event to a replay subject.
     */
    var fromPubsub = function (eventName, pubsub) {
        var pubsubObservable = rxjs.fromEventPattern(function (handler) {
            return pubsub.subscribe(eventName, handler);
        }, function (_, unsubscribe) {
            unsubscribe();
        });
        // Subscribe now, and cache with ReplaySubject
        var pubsubReplay = new rxjs.ReplaySubject(1);
        pubsubObservable.subscribe(pubsubReplay);
        return pubsubReplay;
    };
    var ɵ0$1 = fromPubsub;
    /**
     * We wrap the pubsub events from web-sdk in streams.
     *
     * The main reason to do this is to ensure that we are subscribing to these
     * events *before* they emit. We'll then ensure they replay
     */
    var wrapAuthEvents = function (auth, pubsub) { return ({
        init: rxjs.from(auth.initToken),
        success: fromPubsub('auth:success', pubsub),
        end: fromPubsub('auth:end', pubsub),
        error: fromPubsub('auth:error', pubsub),
    }); };

    /**
     * @deprecated Will be removed in v7.0.0
     */
    var HTTP_INTERCEPTORS = new i0.InjectionToken('web-sdk-http-interceptors');
    /**
     * @deprecated Will be removed in v7.0.0
     */
    var REFRESH = new i0.InjectionToken('web-sdk-refresh');
    /**
     * @deprecated Will be removed in v7.0.0
     */
    var NAVIGATION = new i0.InjectionToken('web-sdk-navigation');
    /**
     * @deprecated Will be removed in v7.0.0
     */
    var PORTAL_CONTENT = new i0.InjectionToken('web-sdk-portal-content');
    /**
     * @deprecated Will be removed in v7.0.0
     */
    var AUTH_EVENTS = new i0.InjectionToken('Web SDK auth event streams');
    /**
     *
     * @deprecated Will be removed in v7.0.0
     *
     * @description
     * Token to get instance of LoginService.
     * Example of the use case: to implement custom login widget.
     *
     * @example
     * constructor(@Inject(LOGIN) private loginService: LoginService) {}
     */
    var LOGIN = new i0.InjectionToken('web-sdk-login');
    /**
     *
     * @deprecated Will be removed in v7.0.0
     * @description
     * Token to get instance of LogoutService.
     * Examples of the use cases: to implement custom logout widget or to logout user based on some custom logic.
     *
     * @example
     * constructor(@Inject(LOGOUT) private logoutService: LogoutService) {}
     */
    var LOGOUT = new i0.InjectionToken('web-sdk-logout');
    /**
     * @deprecated Will be removed in v7.0.0
     * @description
     * Token to get instance of SessionService.
     * Examples of the use cases:
     * - to register custom countdown to show modal before session is over
     * - to refresh session.
     *
     * @example
     * constructor(@Inject(SESSION) private sessionService: SessionService) {}.
     */
    var SESSION = new i0.InjectionToken('web-sdk-session');
    /**
     * @deprecated Will be removed in v7.0.0
     * @description
     * Token to get instance of ReauthenticateService.
     * Examples of the use cases:
     * - to reauthenticate a user.
     *
     * @example
     * constructor(@Inject(REAUTHENTICATE) private reauthenticateService: ReauthenticateService) {}.
     */
    var REAUTHENTICATE = new i0.InjectionToken('web-sdk-reauthenticate');
    /**
     * This returns a BackbaseAuth, but with the `keysToCheck` as required, not optional.
     */
    function getAuth(serviceName, keysToCheck, externalServices, optionalKeys) {
        var auth = websdkServiceFactory(externalServices, 'auth');
        if (!auth) {
            throw new Error('Authentication Service is not available.');
        }
        keysToCheck.forEach(function (key) {
            if (!auth[key] && !(optionalKeys === null || optionalKeys === void 0 ? void 0 : optionalKeys.includes(key))) {
                throw new Error("'" + serviceName + "' Service cannot be injected because '" + key + "' is not available in authentication '" + auth.config.kind + "' strategy.");
            }
        });
        return auth; // this is guaranteed by the above checks
    }
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function loginFactory(webSdkServiceMap) {
        var auth = getAuth('Login', ['login'], webSdkServiceMap);
        return {
            login: auth.login,
        };
    }
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function logoutFactory(webSdkServiceMap) {
        var auth = getAuth('Logout', ['logout', 'goToLoginPage'], webSdkServiceMap);
        return {
            logout: auth.logout,
            goToLoginPage: auth.goToLoginPage,
        };
    }
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function sessionFactory(webSdkServiceMap) {
        var auth = getAuth('Session', ['register', 'refresh', 'timeToLive', 'isImpersonated'], webSdkServiceMap, [
            'isImpersonated',
        ]);
        return {
            registerCountdown: auth.register,
            refresh: auth.refresh,
            timeToLive: auth.timeToLive,
            isImpersonated: auth.isImpersonated ? auth.isImpersonated() : false,
        };
    }
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function reauthenticateFactory(webSdkServiceMap) {
        var auth = getAuth('Reauthenticate', ['reauthenticate'], webSdkServiceMap);
        return {
            reauthenticate: auth.reauthenticate,
        };
    }
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function getAuthEvents(webSdkServices) {
        if (!webSdkServices.auth || !webSdkServices.eventBus) {
            throw new Error('Unable to listen to auth events');
        }
        // @todo: remove 'as any' when web-sdk updates BackbaseAuth
        return wrapAuthEvents(webSdkServices.auth(), webSdkServices.eventBus());
    }
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function refreshFactory(webSdkServiceMap) {
        return websdkServiceFactory(webSdkServiceMap, 'refresh');
    }
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function httpInterceptorsFactory(webSdkServiceMap) {
        return websdkServiceFactory(webSdkServiceMap, 'httpInterceptors');
    }
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function setConditionsFactory(webSdkServiceMap) {
        return websdkServiceFactory(webSdkServiceMap, 'conditions');
    }

    function getWebSdkServiceMap(externalServices, embeddedServices) {
        return Object.assign(Object.assign({}, embeddedServices), externalServices);
    }
    var ɵ0 = getPageConfig, ɵ1 = navigationFactory, ɵ2 = pubsubFactory, ɵ3 = portalContentFactory, ɵ4 = loginFactory, ɵ5 = logoutFactory, ɵ6 = sessionFactory, ɵ7 = reauthenticateFactory, ɵ8 = httpInterceptorsFactory, ɵ9 = refreshFactory, ɵ10 = setLocaleFactory$1, ɵ11 = setConditionsFactory, ɵ12 = getAuthEvents;
    /**
     * Provides the following services:
     *
     * - `PageConfig`
     * - `Navigation`
     * - `Pubsub`
     * - `PortalConten`
     * - `LoginService`
     * - `LogoutService`
     * - `SessionService`
     * - `ReauthenticateService`
     * - `HttpInterceptors`
     * - `Refresh`
     * - `SetLocale`
     * - `Conditions`
     *
     * Notes:
     *  - The implementations of these services are provided via the Lean Page.
     *  - You must use the following injection tokens to any of inject these services.
     *
     * @usageNotes
     *
     * ```
     * constructor(
     *   @Inject(PAGE_CONFIG) pageConfig: PageConfig,
     *   @Inject(NAVIGATION) navigation: Navigation,
     *   @Inject(PUBSUB) pubsub: Pubsub,
     *   @Inject(PORTAL_CONTENT) portalContent: PortalContent
     *   @Inject(LOGIN) login: LoginService,
     *   @Inject(LOGOUT) logout: LogoutService,
     *   @Inject(SESSION) session: SessionService,
     *   @Inject(REAUTHENTICATE) reauthenticate: ReauthenticateService,
     *   @Inject(HTTP_INTERCEPTORS) httpInterceptors, HttpInterceptors,
     *   @Inject(REFRESH) refresh: Refresh,
     *   @Inject(SET_LOCALE) setLocale: SetLocale,
     *   @Inject(CONDITIONS) conditions: Conditions,
     * ) {}
     * ```
     */
    var WebSdkApiModule = /** @class */ (function () {
        function WebSdkApiModule() {
        }
        return WebSdkApiModule;
    }());
    WebSdkApiModule.decorators = [
        { type: i0.NgModule, args: [{
                    imports: [],
                    declarations: [],
                    providers: [
                        {
                            provide: WEBSDK_SERVICE_MAP,
                            useFactory: getWebSdkServiceMap,
                            deps: [
                                [new i0.Optional(), EXTERNAL_SERVICES],
                                [new i0.Optional(), EMBEDDED_SERVICES],
                            ],
                        },
                        {
                            provide: PAGE_CONFIG,
                            useFactory: ɵ0,
                            deps: [WEBSDK_SERVICE_MAP],
                        },
                        {
                            provide: NAVIGATION,
                            useFactory: ɵ1,
                            deps: [WEBSDK_SERVICE_MAP],
                        },
                        {
                            provide: PUBSUB,
                            useFactory: ɵ2,
                            deps: [WEBSDK_SERVICE_MAP],
                        },
                        {
                            provide: PORTAL_CONTENT,
                            useFactory: ɵ3,
                            deps: [WEBSDK_SERVICE_MAP],
                        },
                        {
                            provide: LOGIN,
                            useFactory: ɵ4,
                            deps: [WEBSDK_SERVICE_MAP],
                        },
                        {
                            provide: LOGOUT,
                            useFactory: ɵ5,
                            deps: [WEBSDK_SERVICE_MAP],
                        },
                        {
                            provide: SESSION,
                            useFactory: ɵ6,
                            deps: [WEBSDK_SERVICE_MAP],
                        },
                        {
                            provide: REAUTHENTICATE,
                            useFactory: ɵ7,
                            deps: [WEBSDK_SERVICE_MAP],
                        },
                        {
                            provide: HTTP_INTERCEPTORS,
                            useFactory: ɵ8,
                            deps: [WEBSDK_SERVICE_MAP],
                        },
                        {
                            provide: REFRESH,
                            useFactory: ɵ9,
                            deps: [WEBSDK_SERVICE_MAP],
                        },
                        {
                            provide: SET_LOCALE,
                            useFactory: ɵ10,
                            deps: [WEBSDK_SERVICE_MAP],
                        },
                        {
                            provide: entitlements.CONDITIONS,
                            useFactory: ɵ11,
                            deps: [WEBSDK_SERVICE_MAP],
                        },
                        {
                            provide: AUTH_EVENTS,
                            useFactory: ɵ12,
                            deps: [WEBSDK_SERVICE_MAP],
                        },
                    ],
                },] }
    ];

    var PubSubService = /** @class */ (function () {
        function PubSubService() {
            var _this = this;
            this.getListeners = function (string) { return _this.listenersMap.get(string) || []; };
            this.listenersMap = new Map();
        }
        PubSubService.prototype.publish = function (string, payload) {
            var listeners = this.getListeners(string);
            listeners.forEach(function (listener) {
                try {
                    listener(payload);
                }
                catch (error) {
                    console.error(error);
                }
            });
        };
        PubSubService.prototype.subscribe = function (string, listener) {
            var _this = this;
            var listeners = this.getListeners(string);
            var newListeners = __spreadArray(__spreadArray([], __read(listeners)), [listener]);
            this.listenersMap.set(string, newListeners);
            return function () {
                _this.unsubscribe(string, listener);
            };
        };
        PubSubService.prototype.unsubscribe = function (string, listener) {
            var listeners = this.getListeners(string);
            var newListeners = listeners.filter(function (currentListener) { return currentListener !== listener; });
            this.listenersMap.set(string, newListeners);
        };
        PubSubService.prototype.unsubscribeAll = function () {
            this.listenersMap.clear();
        };
        return PubSubService;
    }());
    PubSubService.ɵprov = i0__namespace.ɵɵdefineInjectable({ factory: function PubSubService_Factory() { return new PubSubService(); }, token: PubSubService, providedIn: "root" });
    PubSubService.decorators = [
        { type: i0.Injectable, args: [{
                    providedIn: 'root',
                },] }
    ];
    PubSubService.ctorParameters = function () { return []; };

    var COOKIE_NAME = 'bb-locale';
    //TODO: Remove dynamic when Ivy compilation is enabled
    //@dynamic
    var SetLocaleService = /** @class */ (function () {
        function SetLocaleService(document) {
            this.document = document;
        }
        SetLocaleService.prototype.getCookieName = function () {
            return COOKIE_NAME;
        };
        SetLocaleService.prototype.setLocale = function (locale) {
            this.document.cookie = COOKIE_NAME + "=" + locale + "; path=/";
        };
        /**
         * @deprecated Will be removed in v7.0.0
         */
        SetLocaleService.prototype.setLocaleLegacy = function (locale) {
            this.setLocale(locale);
            return Promise.resolve({
                status: 200,
                statusText: 'OK',
                headers: {},
                body: '',
            });
        };
        return SetLocaleService;
    }());
    SetLocaleService.ɵprov = i0__namespace.ɵɵdefineInjectable({ factory: function SetLocaleService_Factory() { return new SetLocaleService(i0__namespace.ɵɵinject(i1__namespace.DOCUMENT)); }, token: SetLocaleService, providedIn: "root" });
    SetLocaleService.decorators = [
        { type: i0.Injectable, args: [{
                    providedIn: 'root',
                },] }
    ];
    SetLocaleService.ctorParameters = function () { return [
        { type: Document, decorators: [{ type: i0.Inject, args: [i1.DOCUMENT,] }] }
    ]; };

    /**
     * @deprecated Will be removed in v7.0.0
     */
    var WEBSDK_CONFIG = new i0.InjectionToken('web sdk config');
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function setLocaleFactory(setLocale) {
        var setLocale$ = setLocale;
        return setLocale$.setLocaleLegacy;
    }
    /**
     * @deprecated Will be removed in v7.0.0
     */
    function bootstrapWebsdkService(config, locale) {
        var locales = config.locales || [locale];
        if (!locales.includes(locale)) {
            locales.push(locale);
        }
        var rawConfig = Object.assign(Object.assign({ apiRoot: config.apiRoot || '/api', locale: locale, staticResourcesRoot: '/' }, config), { locales: locales.join(','), auth: Object.assign(Object.assign({ authUrl: '/auth', clientId: 'bb-web-client', realm: 'backbase', scope: 'openid' }, config.auth), { kind: libBbPageBootstrapCdn.AuthKind.Hybrid, loginPageUrl: '', landingPageUrl: '' }) });
        var _a = libBbPageBootstrapCdn.initialise(rawConfig), pageConfig = _a.pageConfig, pubsub = _a.pubsub, navigation = _a.navigation, portalContent = _a.portalContent, auth = _a.auth, httpInterceptors = _a.httpInterceptors, itemRefresher = _a.itemRefresher, setLocale = _a.setLocale, conditions = _a.conditions;
        return {
            pageConfig: function () { return pageConfig; },
            navigation: function () { return navigation; },
            eventBus: function () { return pubsub; },
            portalContent: function () { return portalContent; },
            auth: function () { return auth; },
            httpInterceptors: function () { return httpInterceptors; },
            refresh: function () { return itemRefresher.refresh; },
            setLocale: function () { return setLocale; },
            conditions: function () { return conditions; },
        };
    }
    var WebSdkModule = /** @class */ (function () {
        function WebSdkModule(config, parentModule) {
            if (parentModule) {
                throw new TypeError("WebSdkModule is imported twice. It should only be imported in the AppModule");
            }
            if (!config) {
                throw new Error('WebSdkModule must be imported with WebSdkModule.forRoot(...)');
            }
        }
        /**
         * Add the `WebSdkModule` to your application's `AppModule` to embed the
         * web-sdk services into your application. This allows you to deploy your
         * application outside of an Experience, without the Lean Page.
         *
         * Note: Any services created via `environment.bootstrap.services` will
         * overwrite the services from this module.
         *
         * This module provides all the services from `WebSdkApiAng`.
         *
         * Importing this module will automatically enable the hybrid auth flow.
         *
         * @usageNotes
         *
         * ```
         * NgModule({
         *  declarations: [AppComponent],
         *  imports: [
         *    ...
         *    WebSdkModule.forRoot(),
         *  ],
         *  bootstrap: [AppComponent],
         * })
         * export class AppModule {}
         * ```
         */
        WebSdkModule.forRoot = function (config) {
            if (config === void 0) { config = {}; }
            return {
                ngModule: WebSdkModule,
                providers: [
                    {
                        provide: WEBSDK_CONFIG,
                        useValue: config,
                    },
                    {
                        provide: WEBSDK_SERVICE_MAP,
                        useFactory: bootstrapWebsdkService,
                        deps: [WEBSDK_CONFIG, i0.LOCALE_ID],
                    },
                    {
                        provide: PAGE_CONFIG,
                        useFactory: getPageConfig,
                        deps: [WEBSDK_SERVICE_MAP],
                    },
                    {
                        provide: NAVIGATION,
                        useFactory: navigationFactory,
                        deps: [WEBSDK_SERVICE_MAP],
                    },
                    {
                        provide: PORTAL_CONTENT,
                        useFactory: portalContentFactory,
                        deps: [WEBSDK_SERVICE_MAP],
                    },
                    {
                        provide: LOGIN,
                        useFactory: loginFactory,
                        deps: [WEBSDK_SERVICE_MAP],
                    },
                    {
                        provide: LOGOUT,
                        useFactory: logoutFactory,
                        deps: [WEBSDK_SERVICE_MAP],
                    },
                    {
                        provide: SESSION,
                        useFactory: sessionFactory,
                        deps: [WEBSDK_SERVICE_MAP],
                    },
                    {
                        provide: REAUTHENTICATE,
                        useFactory: reauthenticateFactory,
                        deps: [WEBSDK_SERVICE_MAP],
                    },
                    {
                        provide: HTTP_INTERCEPTORS,
                        useFactory: httpInterceptorsFactory,
                        deps: [WEBSDK_SERVICE_MAP],
                    },
                    {
                        provide: REFRESH,
                        useFactory: refreshFactory,
                        deps: [WEBSDK_SERVICE_MAP],
                    },
                    {
                        provide: AUTH_EVENTS,
                        useFactory: getAuthEvents,
                        deps: [WEBSDK_SERVICE_MAP],
                    },
                ],
            };
        };
        return WebSdkModule;
    }());
    WebSdkModule.decorators = [
        { type: i0.NgModule, args: [{
                    imports: [entitlements.EntitlementsModule],
                    providers: [
                        { provide: PUBSUB, useExisting: PubSubService },
                        {
                            provide: SET_LOCALE,
                            deps: [SetLocaleService],
                            useFactory: setLocaleFactory,
                        },
                    ],
                },] }
    ];
    WebSdkModule.ctorParameters = function () { return [
        { type: undefined, decorators: [{ type: i0.Optional }, { type: i0.Inject, args: [WEBSDK_CONFIG,] }] },
        { type: WebSdkModule, decorators: [{ type: i0.Optional }, { type: i0.SkipSelf }] }
    ]; };

    /**
     * @deprecated This entrypoint is deprecated use \'@backbase/foundation-ang/test\' for PortalContentMock
     */
    var PortalContentMock = /** @class */ (function (_super) {
        __extends(PortalContentMock, _super);
        function PortalContentMock() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return PortalContentMock;
    }(testing.PortalContentMock));

    /**
     * Generated bundle index. Do not edit.
     */

    Object.defineProperty(exports, 'CONDITIONS', {
        enumerable: true,
        get: function () { return entitlements.CONDITIONS; }
    });
    Object.defineProperty(exports, 'ConditionsService', {
        enumerable: true,
        get: function () { return entitlements.ConditionsService; }
    });
    Object.defineProperty(exports, 'DATA_ITEMS_PERMISSIONS_PATH', {
        enumerable: true,
        get: function () { return entitlements.DATA_ITEMS_PERMISSIONS_PATH; }
    });
    Object.defineProperty(exports, 'ENTITLEMENTS_CONFIG', {
        enumerable: true,
        get: function () { return entitlements.ENTITLEMENTS_CONFIG; }
    });
    Object.defineProperty(exports, 'SUMMARY_PERMISSIONS_PATH', {
        enumerable: true,
        get: function () { return entitlements.SUMMARY_PERMISSIONS_PATH; }
    });
    Object.defineProperty(exports, 'AuthKind', {
        enumerable: true,
        get: function () { return libBbPageBootstrapCdn.AuthKind; }
    });
    Object.defineProperty(exports, 'ContentType', {
        enumerable: true,
        get: function () { return libBbPageBootstrapCdn.ContentType; }
    });
    Object.defineProperty(exports, 'ContentTypes', {
        enumerable: true,
        get: function () { return libBbPageBootstrapCdn.ContentTypes; }
    });
    Object.defineProperty(exports, 'ReauthErrorCodes', {
        enumerable: true,
        get: function () { return libBbPageBootstrapCdn.ReauthErrorCodes; }
    });
    exports.HTTP_INTERCEPTORS = HTTP_INTERCEPTORS;
    exports.LOGIN = LOGIN;
    exports.LOGOUT = LOGOUT;
    exports.NAVIGATION = NAVIGATION;
    exports.PAGE_CONFIG = PAGE_CONFIG;
    exports.PORTAL_CONTENT = PORTAL_CONTENT;
    exports.PUBSUB = PUBSUB;
    exports.PortalContentMock = PortalContentMock;
    exports.PubSubService = PubSubService;
    exports.REAUTHENTICATE = REAUTHENTICATE;
    exports.REFRESH = REFRESH;
    exports.SESSION = SESSION;
    exports.SET_LOCALE = SET_LOCALE;
    exports.SetLocaleService = SetLocaleService;
    exports.WebSdkApiModule = WebSdkApiModule;
    exports.WebSdkModule = WebSdkModule;
    exports["ɵAUTH_EVENTS"] = AUTH_EVENTS;
    exports["ɵEXTERNAL_SERVICES"] = EXTERNAL_SERVICES;
    exports["ɵa"] = getWebSdkServiceMap;
    exports["ɵb"] = getPageConfig;
    exports["ɵc"] = EMBEDDED_SERVICES;
    exports["ɵd"] = WEBSDK_SERVICE_MAP;
    exports["ɵe"] = websdkServiceFactory;
    exports["ɵf"] = navigationFactory;
    exports["ɵg"] = pubsubFactory;
    exports["ɵh"] = portalContentFactory;
    exports["ɵi"] = setLocaleFactory$1;
    exports["ɵj"] = loginFactory;
    exports["ɵk"] = logoutFactory;
    exports["ɵl"] = sessionFactory;
    exports["ɵm"] = reauthenticateFactory;
    exports["ɵn"] = getAuthEvents;
    exports["ɵo"] = refreshFactory;
    exports["ɵp"] = httpInterceptorsFactory;
    exports["ɵq"] = setConditionsFactory;
    exports["ɵr"] = WEBSDK_CONFIG;
    exports["ɵs"] = setLocaleFactory;
    exports["ɵt"] = bootstrapWebsdkService;

    Object.defineProperty(exports, '__esModule', { value: true });

}));
//# sourceMappingURL=backbase-foundation-ang-web-sdk.umd.js.map
