import { __awaiter } from "tslib";
import { Component, ViewChild } from '@angular/core';
import { Observable, of, Subject } from 'rxjs';
import { skip, switchMap, take, takeUntil } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "../../services/manage-payees-navigation.service";
import * as i2 from "@angular/router";
import * as i3 from "../../services/manage-payees-journey-config.service";
import * as i4 from "@backbase/billpay-journeys-common";
import * as i5 from "@backbase/ui-ang/notification";
import * as i6 from "@backbase/ui-ang/header";
import * as i7 from "../../components/payee-list/billpay-payee-summary-list/billpay-payee-summary-list.component";
import * as i8 from "@backbase/ui-ang/amount";
import * as i9 from "@backbase/ui-ang/loading-indicator";
import * as i10 from "@backbase/ui-ang/empty-state";
import * as i11 from "@backbase/ui-ang/button";
import * as i12 from "@angular/common";
export class PayeeListViewComponent {
    /** @internal */
    constructor(routerService, route, config, payeeDataService, notificationService, cdRef, billpayNotificationRoutingService) {
        this.routerService = routerService;
        this.route = route;
        this.config = config;
        this.payeeDataService = payeeDataService;
        this.notificationService = notificationService;
        this.cdRef = cdRef;
        this.billpayNotificationRoutingService = billpayNotificationRoutingService;
        this.notificationMessageTemplate = '';
        this.notificationHeaderTemplate = '';
        this.payeeSummariesByEbillObservable = new Observable();
        this.destroy$ = new Subject();
        this.isDeleteModalOpened = false;
        this.isDeleteEbillsModalOpen = false;
        this.isNavigateModalOpened = false;
        this.notificationType = '';
        this.navigationExtras = { relativeTo: this.route };
    }
    ngOnInit() {
        this.payeeSummariesByEbillObservable = this.payeeDataService.getPayees();
        this.setupNavigationSubscriptions();
        this.payeeDataService.selectedDeletePayee
            .pipe(takeUntil(this.destroy$), skip(1))
            .subscribe(payee => (payee ? (this.isDeleteModalOpened = true) : (this.isNavigateModalOpened = true)));
        this.payeeDataService.selectedDeleteEbills
            .pipe(takeUntil(this.destroy$), skip(1))
            .subscribe(payee => (payee ? (this.isDeleteEbillsModalOpen = true) : (this.isNavigateModalOpened = true)));
    }
    ngOnDestroy() {
        this.destroy$.next();
        this.destroy$.complete();
    }
    deletePayee() {
        return this.payeeDataService.selectedDeletePayee.pipe(switchMap((payee) => payee ? this.payeeDataService.deletePayee(payee.id, payee.electronic) : of()));
    }
    deleteEbills() {
        return this.payeeDataService.selectedDeleteEbills.pipe(switchMap((payee) => (payee ? this.payeeDataService.deleteEbills(payee.id) : of())));
    }
    get dismissTimeout() {
        if (this.config.notificationDismissTime === undefined) {
            throw new Error('Dismiss timeout value not found');
        }
        return this.config.notificationDismissTime;
    }
    selectedDeletePayee() {
        return this.payeeDataService.selectedDeletePayee;
    }
    selectedDeleteEbills() {
        return this.payeeDataService.selectedDeleteEbills;
    }
    onNavigateToPayments(hasNavigated) {
        if (hasNavigated) {
            this.goToPaymentsList();
        }
        this.isNavigateModalOpened = false;
    }
    onDeletePayee(resolve) {
        this.isDeleteModalOpened = false;
        if (resolve) {
            this.deletePayee()
                .pipe(take(1))
                .subscribe(() => {
                this.deletionNotify('delete');
            });
        }
    }
    onDeleteEbills(resolve) {
        this.isDeleteEbillsModalOpen = false;
        if (resolve) {
            this.deleteEbills()
                .pipe(take(1))
                .subscribe(() => {
                this.deletionNotify('ebills');
            });
        }
    }
    deletionNotify(type) {
        this.payeeDataService.reloadPayees();
        this.cdRef.markForCheck();
        this.notificationType = type;
        this.notificationService.showNotification({
            header: this.notificationHeaderTemplate,
            message: this.notificationMessageTemplate,
            modifier: 'success',
            ttl: this.dismissTimeout,
        });
    }
    setupNavigationSubscriptions() {
        this.billpayNotificationRoutingService.managePayeesSubject$
            .pipe(takeUntil(this.destroy$))
            .subscribe(() => this.goToAddPayee());
        this.billpayNotificationRoutingService.managePaymentSubject$
            .pipe(takeUntil(this.destroy$))
            .subscribe((payeeId) => __awaiter(this, void 0, void 0, function* () { var _a; return this.gotoOneOffPayment(((_a = (yield this.payeeDataService.findPayeeSummaryById(payeeId))) === null || _a === void 0 ? void 0 : _a.id) || ''); }));
        this.billpayNotificationRoutingService.upcommingPaymentsSubject$
            .pipe(takeUntil(this.destroy$))
            .subscribe(() => this.goToPaymentsList());
    }
    areBothListsPresent(payeeSummariesByEbill) {
        return !!(payeeSummariesByEbill.ebillsEnabled &&
            payeeSummariesByEbill.ebillsEnabled.length &&
            payeeSummariesByEbill.ebillsNotEnabled &&
            payeeSummariesByEbill.ebillsNotEnabled.length);
    }
    // Get totals of the eBills, grouped by currency
    // Ideally there should only be one currency in use, but it doesn't hurt to check
    getEbillTotals(ebillPayeeSummaries = []) {
        const ebillTotalsByCurrency = ebillPayeeSummaries.reduce((currenciesTotalsObj, payeeSummary) => {
            if (!(payeeSummary.ebill && payeeSummary.ebill.latestBill && payeeSummary.ebill.latestBill.amount)) {
                return currenciesTotalsObj;
            }
            const thisCurrencyCode = payeeSummary.ebill.latestBill.amount.currencyCode;
            const thisAmount = parseFloat(payeeSummary.ebill.latestBill.amount.amount);
            if (!currenciesTotalsObj[thisCurrencyCode]) {
                currenciesTotalsObj[thisCurrencyCode] = 0;
            }
            currenciesTotalsObj[thisCurrencyCode] = currenciesTotalsObj[thisCurrencyCode] + thisAmount;
            return currenciesTotalsObj;
        }, {});
        return Object.keys(ebillTotalsByCurrency).map(currencyCode => {
            return {
                currencyCode,
                amount: ebillTotalsByCurrency[currencyCode].toString(),
            };
        });
    }
    ngForTrackByCurrencyFn(currencies) {
        return currencies.currencyCode;
    }
    get currentLoadingState() {
        return this.payeeDataService.payeesLoadingState;
    }
    get areButtonsDisabled() {
        return this.payeeDataService.areButtonsDisabled;
    }
    get numberOfPayees() {
        return this.payeeDataService.numberOfPayees;
    }
    goToAddPayee() {
        this.routerService.navigateToSearch(this.navigationExtras);
    }
    goToPaymentsList() {
        var _a;
        (_a = this.routerService) === null || _a === void 0 ? void 0 : _a.navigateToPendingPayments();
    }
    gotoOneOffPayment(id) {
        var _a;
        (_a = this.routerService) === null || _a === void 0 ? void 0 : _a.navigateToOneOffPayment(id);
    }
}
PayeeListViewComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: PayeeListViewComponent, deps: [{ token: i1.ManagePayeesNavigationService }, { token: i2.ActivatedRoute }, { token: i3.ManagePayeesJourneyConfigService }, { token: i4.BillpayPayeeDataService }, { token: i5.NotificationService }, { token: i0.ChangeDetectorRef }, { token: i4.BillpayNotificationRoutingService }], target: i0.ɵɵFactoryTarget.Component });
PayeeListViewComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.15", type: PayeeListViewComponent, selector: "bb-billpay-payee-list-view", viewQueries: [{ propertyName: "notificationMessageTemplate", first: true, predicate: ["notificationMessage"], descendants: true }, { propertyName: "notificationHeaderTemplate", first: true, predicate: ["notificationHeader"], descendants: true }], ngImport: i0, template: "<div class=\"bb-stack bb-block bb-block--lg\">\n  <bb-header-ui\n    class=\"bb-stack__item bb-stack__item--fill\"\n    headingType=\"h1\"\n    heading=\"Pay a bill\"\n    i18n-heading=\"@@billpay-payees-journey.payee-list-view\"\n  >\n  </bb-header-ui>\n  <button\n    bbButton\n    (click)=\"goToAddPayee()\"\n    color=\"secondary\"\n    i18n=\"button label|Add payee button@@billpay-payees-journey.payee-list\"\n  >\n    Add a payee\n  </button>\n</div>\n\n<ng-container>\n  <section>\n    <ng-container *ngIf=\"currentLoadingState !== 'error'; else errorState\">\n      <ng-container *ngIf=\"payeeSummariesByEbillObservable | async as ebillGroupedData; else loadingState\">\n        <ng-container *ngIf=\"currentLoadingState !== 'loading'; else loadingState\">\n          <ng-container\n            *ngIf=\"ebillGroupedData.ebillsEnabled.length || ebillGroupedData.ebillsNotEnabled.length; else emptyState\"\n          >\n            <div\n              class=\"bb-block bb-block--lg\"\n              *ngIf=\"ebillGroupedData.ebillsEnabled.length\"\n              data-role=\"payees-with-active-e-bills-list\"\n            >\n              <div class=\"card card-lg\">\n                <div class=\"card-body\">\n                  <div class=\"bb-block bb-block--md\">\n                    <bb-header-ui\n                      headingType=\"h2\"\n                      *ngIf=\"areBothListsPresent(ebillGroupedData)\"\n                      data-role=\"sub-header\"\n                      heading=\"Payees with active eBills\"\n                      i18n-heading=\"\n                        Payees with eBills title|Title for the list of payees with eBills\n                        enabled@@bb-billpay-payee-list-widget-ang.title.payees-with-ebills\"\n                    >\n                    </bb-header-ui>\n                  </div>\n                  <ul class=\"bb-list\">\n                    <li class=\"bb-list__item\">\n                      <bb-billpay-payee-summary-list [payeeSummaries]=\"ebillGroupedData.ebillsEnabled\">\n                      </bb-billpay-payee-summary-list>\n                    </li>\n                    <li class=\"bb-list__item\">\n                      <div\n                        data-role=\"outstanding-e-bill-total\"\n                        role=\"listitem\"\n                        *ngFor=\"\n                          let ebillCurrencyTotal of getEbillTotals(ebillGroupedData.ebillsEnabled);\n                          trackBy: ngForTrackByCurrencyFn\n                        \"\n                        class=\"bb-highlight\"\n                      >\n                        <span\n                          i18n=\"\n                            Outstanding eBills total text|Text for the total of outstanding\n                            eBills@@bb-billpay-payee-list-widget-ang.ebills.total\"\n                        >\n                          Outstanding eBill total:\n                        </span>\n                        <bb-amount-ui\n                          data-role=\"total-amount\"\n                          class=\"bb-highlight\"\n                          [amount]=\"ebillCurrencyTotal.amount\"\n                          [currency]=\"ebillCurrencyTotal.currencyCode\"\n                        >\n                        </bb-amount-ui>\n                      </div>\n                    </li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n\n            <div\n              class=\"card card-lg\"\n              data-role=\"all-other-payees-list\"\n              *ngIf=\"ebillGroupedData.ebillsNotEnabled.length\"\n            >\n              <div class=\"card-body\">\n                <div class=\"bb-block bb-block--md\">\n                  <bb-header-ui\n                    headingType=\"h2\"\n                    *ngIf=\"areBothListsPresent(ebillGroupedData)\"\n                    data-role=\"sub-header\"\n                    heading=\"All other payees\"\n                    i18n-heading=\"\n                      Payees without eBills title|Title for the list of payees that do not have eBills\n                      enabled@@bb-billpay-payee-list-widget-ang.title.other-payees\"\n                  >\n                  </bb-header-ui>\n                </div>\n                <div class=\"bb-list\">\n                  <bb-billpay-payee-summary-list [payeeSummaries]=\"ebillGroupedData.ebillsNotEnabled\">\n                  </bb-billpay-payee-summary-list>\n                </div>\n              </div>\n            </div>\n          </ng-container>\n        </ng-container>\n      </ng-container>\n    </ng-container>\n  </section>\n</ng-container>\n\n<ng-template #loadingState>\n  <div class=\"card card-lg\">\n    <div class=\"card-body\">\n      <bb-loading-indicator-ui loaderSize=\"lg\"> </bb-loading-indicator-ui>\n    </div>\n  </div>\n</ng-template>\n\n<ng-template #errorState>\n  <div class=\"card card-lg\">\n    <div class=\"card-body\">\n      <bb-empty-state-ui\n        data-role=\"error-state\"\n        iconSize=\"xxl\"\n        iconModifier=\"error-outline\"\n        subtitle=\"Try to reload the page or contact support\"\n        i18n-subtitle=\"\n          Try to reload the page or contact the support.|Payee List loading\n          subtitle@@bb-billpay-payee-list-widget-ang.loading.subtitle\"\n        title=\"Payee list is not loading\"\n        i18n-title=\"Payee list is not loading|Payee List loading title@@bb-billpay-payee-list-widget-ang.loading.title\"\n      >\n      </bb-empty-state-ui>\n    </div>\n  </div>\n</ng-template>\n\n<ng-template #emptyState>\n  <div class=\"card card-lg\">\n    <div class=\"card-body bb-state-container\">\n      <bb-empty-state-ui\n        data-role=\"empty-state\"\n        iconSize=\"xxl\"\n        iconModifier=\"assignment-ind\"\n        subtitle=\"Add a payee to make a bill payment\"\n        i18n-subtitle=\"\n          Add a payee to make a bill payment|Payee List no payees\n          subtitle@@bb-billpay-payee-list-widget-ang.bb-empty-state-ui.subtitle\"\n        title=\"No payees\"\n        i18n-title=\"\n          No payees state text|Payee List no payees title@@bb-billpay-payee-list-widget-ang.bb-empty-state-ui.title\"\n      >\n      </bb-empty-state-ui>\n      <div class=\"bb-state-container__footer\">\n        <button\n          bbButton\n          data-role=\"empty-state-add-payee-btn\"\n          (click)=\"addPayee()\"\n          [disabled]=\"areButtonsDisabled\"\n          i18n=\"\n            Add a payee|Payee List add payee button@@bb-billpay-payee-list-widget-ang.bb-empty-state-ui.button.add-payee\"\n        >\n          Add a payee\n        </button>\n      </div>\n    </div>\n  </div>\n</ng-template>\n\n<bb-billpay-payee-delete-modal\n  *ngIf=\"isDeleteModalOpened\"\n  (resolve)=\"onDeletePayee($event)\"\n></bb-billpay-payee-delete-modal>\n\n<bb-billpay-ebills-delete-modal\n  *ngIf=\"isDeleteEbillsModalOpen\"\n  (resolve)=\"onDeleteEbills($event)\"\n></bb-billpay-ebills-delete-modal>\n\n<bb-billpay-payee-navigate-modal\n  *ngIf=\"isNavigateModalOpened\"\n  (resolve)=\"onNavigateToPayments($event)\"\n></bb-billpay-payee-navigate-modal>\n\n<ng-template #notificationHeader>\n  <div [ngSwitch]=\"notificationType\">\n    <span\n      *ngSwitchCase=\"'ebills'\"\n      class=\"bb-text-bold\"\n      i18n=\"\n        eBills stopped notification header|eBills stopped confirmation success notification\n        header@@billpay-payee-list.confirm.notification.header\"\n      >eBills stopped</span\n    >\n    <span\n      *ngSwitchCase=\"'delete'\"\n      class=\"bb-text-bold\"\n      i18n=\"\n        delete payee notification header|Payee delete confirmation success notification\n        header@@billpay-payee-list.confirm.notification.header\"\n      >Payee deleted</span\n    >\n  </div>\n</ng-template>\n\n<ng-template #notificationMessage>\n  <div [ngSwitch]=\"notificationType\">\n    <ng-container *ngSwitchCase=\"'delete'\">\n      <span\n        *ngIf=\"selectedDeletePayee() | async as payee\"\n        i18n=\"\n          delete payee notification message|Payee delete confirmation success notification\n          message@@billpay-payee-list.delete-payee-confirm.notification.message\"\n        >The payee {{ payee.nickName ? payee.nickName + ' (' + payee.name + ')' : payee.name }} has been deleted\n        successfully</span\n      >\n    </ng-container>\n    <ng-container *ngSwitchCase=\"'ebills'\">\n      <span\n        *ngIf=\"selectedDeleteEbills() | async as payee\"\n        i18n=\"\n          stop ebill notification message|Payee stop ebill confirmation success notification\n          message@@billpay-payee-list.stop-ebill-confirm.notification.message\"\n        >eBills for {{ payee.nickName ? payee.nickName + ' (' + payee.name + ')' : payee.name }} has been stopped\n        successfully</span\n      >\n    </ng-container>\n  </div>\n</ng-template>\n", components: [{ type: i6.HeaderComponent, selector: "bb-header-ui", inputs: ["headingClasses", "headingType", "heading"] }, { type: i7.BillpayPayeeSummaryListComponent, selector: "bb-billpay-payee-summary-list", inputs: ["payeeSummaries"] }, { type: i8.AmountComponent, selector: "bb-amount-ui", inputs: ["currency", "showPlusSign", "mapCurrency", "showPercent", "abbreviate", "decimalPlaces", "trailingZeroes", "amount"] }, { type: i9.LoadingIndicatorComponent, selector: "bb-loading-indicator-ui", inputs: ["text", "loaderSize", "showDelay", "hasBackground", "inline"] }, { type: i10.EmptyStateComponent, selector: "bb-empty-state-ui", inputs: ["title", "subtitle", "showIcon", "iconClasses", "iconModifier", "iconSize", "iconColor"] }, { type: i4.ӨBillpayPayeeDeleteModalComponent, selector: "bb-billpay-payee-delete-modal", outputs: ["resolve"] }, { type: i4.ӨBillpayEbillsDeleteModalComponent, selector: "bb-billpay-ebills-delete-modal", outputs: ["resolve"] }, { type: i4.ӨBillpayPayeeNavigateModalComponent, selector: "bb-billpay-payee-navigate-modal", outputs: ["resolve"] }], directives: [{ type: i11.ButtonDirective, selector: "button[bbButton]", inputs: ["type", "color", "buttonSize", "block", "circle"] }, { type: i12.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i12.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i12.NgSwitch, selector: "[ngSwitch]", inputs: ["ngSwitch"] }, { type: i12.NgSwitchCase, selector: "[ngSwitchCase]", inputs: ["ngSwitchCase"] }], pipes: { "async": i12.AsyncPipe } });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: PayeeListViewComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'bb-billpay-payee-list-view',
                    templateUrl: './billpay-payee-list-view.component.html',
                }]
        }], ctorParameters: function () { return [{ type: i1.ManagePayeesNavigationService }, { type: i2.ActivatedRoute }, { type: i3.ManagePayeesJourneyConfigService }, { type: i4.BillpayPayeeDataService }, { type: i5.NotificationService }, { type: i0.ChangeDetectorRef }, { type: i4.BillpayNotificationRoutingService }]; }, propDecorators: { notificationMessageTemplate: [{
                type: ViewChild,
                args: ['notificationMessage']
            }], notificationHeaderTemplate: [{
                type: ViewChild,
                args: ['notificationHeader']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmlsbHBheS1wYXllZS1saXN0LXZpZXcuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vbGlicy9tYW5hZ2UtcGF5ZWVzLWpvdXJuZXkvc3JjL3ZpZXdzL2JpbGxwYXktcGF5ZWUtbGlzdC9iaWxscGF5LXBheWVlLWxpc3Qtdmlldy5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL21hbmFnZS1wYXllZXMtam91cm5leS9zcmMvdmlld3MvYmlsbHBheS1wYXllZS1saXN0L2JpbGxwYXktcGF5ZWUtbGlzdC12aWV3LmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQXFCLFNBQVMsRUFBa0MsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3hHLE9BQU8sRUFBRSxVQUFVLEVBQUUsRUFBRSxFQUFFLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUUvQyxPQUFPLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7Ozs7Ozs7Ozs7Ozs7O0FBYWxFLE1BQU0sT0FBTyxzQkFBc0I7SUFZakMsZ0JBQWdCO0lBQ2hCLFlBQ21CLGFBQTRDLEVBQzVDLEtBQXFCLEVBQzdCLE1BQXdDLEVBQ2hDLGdCQUF5QyxFQUN6QyxtQkFBd0MsRUFDeEMsS0FBd0IsRUFDeEIsaUNBQW9FO1FBTnBFLGtCQUFhLEdBQWIsYUFBYSxDQUErQjtRQUM1QyxVQUFLLEdBQUwsS0FBSyxDQUFnQjtRQUM3QixXQUFNLEdBQU4sTUFBTSxDQUFrQztRQUNoQyxxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQXlCO1FBQ3pDLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBcUI7UUFDeEMsVUFBSyxHQUFMLEtBQUssQ0FBbUI7UUFDeEIsc0NBQWlDLEdBQWpDLGlDQUFpQyxDQUFtQztRQWxCckQsZ0NBQTJCLEdBQThCLEVB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QUM7SUFFRCxJQUFJLG1CQUFtQjtRQUNyQixPQUFPLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsQ0FBQztJQUNsRCxDQUFDO0lBRUQsSUFBSSxrQkFBa0I7UUFDcEIsT0FBTyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsa0JBQWtCLENBQUM7SUFDbEQsQ0FBQztJQUVELElBQUksY0FBYztRQUNoQixPQUFPLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxjQUFjLENBQUM7SUFDOUMsQ0FBQztJQUVELFlBQVk7UUFDVixJQUFJLENBQUMsYUFBYSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0lBQzdELENBQUM7SUFDTyxnQkFBZ0I7O1FBQ3RCLE1BQUEsSUFBSSxDQUFDLGFBQWEsMENBQUUseUJBQXlCLEVBQUUsQ0FBQztJQUNsRCxDQUFDO0lBQ08saUJBQWlCLENBQUMsRUFBVTs7UUFDbEMsTUFBQSxJQUFJLENBQUMsYUFBYSwwQ0FBRSx1QkFBdUIsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUNsRCxDQUFDOztvSEFqTVUsc0JBQXNCO3dHQUF0QixzQkFBc0IseVRDaEJuQyw2dFJBdU9BOzRGRHZOYSxzQkFBc0I7a0JBSmxDLFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLDRCQUE0QjtvQkFDdEMsV0FBVyxFQUFFLDBDQUEwQztpQkFDeEQ7d1ZBR21DLDJCQUEyQjtzQkFBNUQsU0FBUzt1QkFBQyxxQkFBcUI7Z0JBQ0MsMEJBQTBCO3NCQUExRCxTQUFTO3VCQUFDLG9CQUFvQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoYW5nZURldGVjdG9yUmVmLCBDb21wb25lbnQsIE9uRGVzdHJveSwgT25Jbml0LCBUZW1wbGF0ZVJlZiwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiwgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgUGF5ZWVTdW1tYXJpZXNCeUViaWxsIH0gZnJvbSAnLi4vLi4vbW9kZWwnO1xuaW1wb3J0IHsgc2tpcCwgc3dpdGNoTWFwLCB0YWtlLCB0YWtlVW50aWwgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBIdHRwUmVzcG9uc2UgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQgeyBCaWxscGF5Tm90aWZpY2F0aW9uUm91dGluZ1NlcnZpY2UsIEJpbGxwYXlQYXllZURhdGFTZXJ2aWNlIH0gZnJvbSAnQGJhY2tiYXNlL2JpbGxwYXktam91cm5leXMtY29tbW9uJztcbmltcG9ydCB7IEFjdGl2YXRlZFJvdXRlLCBOYXZpZ2F0aW9uRXh0cmFzIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IEN1cnJlbmN5LCBQYXllZVN1bW1hcnkgfSBmcm9tICdAYmFja2Jhc2UvYmlsbHBheS1odHRwLWFuZyc7XG5pbXBvcnQgeyBNYW5hZ2VQYXllZXNKb3VybmV5Q29uZmlnU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL21hbmFnZS1wYXllZXMtam91cm5leS1jb25maWcuc2VydmljZSc7XG5pbXBvcnQgeyBNYW5hZ2VQYXllZXNOYXZpZ2F0aW9uU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL21hbmFnZS1wYXllZXMtbmF2aWdhdGlvbi5zZXJ2aWNlJztcbmltcG9ydCB7IE5vdGlmaWNhdGlvblNlcnZpY2UgfSBmcm9tICdAYmFja2Jhc2UvdWktYW5nL25vdGlmaWNhdGlvbic7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2JiLWJpbGxwYXktcGF5ZWUtbGlzdC12aWV3JyxcbiAgdGVtcGxhdGVVcmw6ICcuL2JpbGxwYXktcGF5ZWUtbGlzdC12aWV3LmNvbXBvbmVudC5odG1sJyxcbn0pXG5leHBvcnQgY2xhc3MgUGF5ZWVMaXN0Vmlld0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uRGVzdHJveSwgT25Jbml0IHtcbiAgcHJpdmF0ZSByZWFkb25seSBuYXZpZ2F0aW9uRXh0cmFzOiBOYXZpZ2F0aW9uRXh0cmFzO1xuICBAVmlld0NoaWxkKCdub3RpZmljYXRpb25NZXNzYWdlJykgbm90aWZpY2F0aW9uTWVzc2FnZVRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+IHwgc3RyaW5nID0gJyc7XG4gIEBWaWV3Q2hpbGQoJ25vdGlmaWNhdGlvbkhlYWRlcicpIG5vdGlmaWNhdGlvbkhlYWRlclRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+IHwgc3RyaW5nID0gJyc7XG4gIHBheWVlU3VtbWFyaWVzQnlFYmlsbE9ic2VydmFibGU6IE9ic2VydmFibGU8UGF5ZWVTdW1tYXJpZXNCeUViaWxsIHwgdW5kZWZpbmVkPiA9IG5ldyBPYnNlcnZhYmxlKCk7XG4gIHBheWVlU3VtbWFyaWVzQnlFYmlsbDogUGF5ZWVTdW1tYXJpZXNCeUViaWxsIHwgdW5kZWZpbmVkO1xuICBkZXN0cm95JCA9IG5ldyBTdWJqZWN0PGJvb2xlYW4+KCk7XG4gIGlzRGVsZXRlTW9kYWxPcGVuZWQgPSBmYWxzZTtcbiAgaXNEZWxldGVFYmlsbHNNb2RhbE9wZW4gPSBmYWxzZTtcbiAgaXNOYXZpZ2F0ZU1vZGFsT3BlbmVkID0gZmFsc2U7XG4gIG5vdGlmaWNhdGlvblR5cGUgPSAnJztcblxuICAvKiogQGludGVybmFsICovXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVhZG9ubHkgcm91dGVyU2VydmljZTogTWFuYWdlUGF5ZWVzTmF2aWdhdGlvblNlcnZpY2UsXG4gICAgcHJpdmF0ZSByZWFkb25seSByb3V0ZTogQWN0aXZhdGVkUm91dGUsXG4gICAgcmVhZG9ubHkgY29uZmlnOiBNYW5hZ2VQYXllZXNKb3VybmV5Q29uZmlnU2VydmljZSxcbiAgICBwcml2YXRlIHJlYWRvbmx5IHBheWVlRGF0YVNlcnZpY2U6IEJpbGxwYXlQYXllZURhdGFTZXJ2aWNlLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgbm90aWZpY2F0aW9uU2VydmljZTogTm90aWZpY2F0aW9uU2VydmljZSxcbiAgICBwcml2YXRlIHJlYWRvbmx5IGNkUmVmOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICBwcml2YXRlIHJlYWRvbmx5IGJpbGxwYXlOb3RpZmljYXRpb25Sb3V0aW5nU2VydmljZTogQmlsbHBheU5vdGlmaWNhdGlvblJvdXRpbmdTZXJ2aWNlLFxuICApIHtcbiAgICB0aGlzLm5hdmlnYXRpb25FeHRyYXMgPSB7IHJlbGF0aXZlVG86IHRoaXMucm91dGUgfTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMucGF5ZWVTdW1tYXJpZXNCeUViaWxsT2JzZXJ2YWJsZSA9IHRoaXMucGF5ZWVEYXRhU2VydmljZS5nZXRQYXllZXMoKTtcblxuICAgIHRoaXMuc2V0dXBOYXZpZ2F0aW9uU3Vic2NyaXB0aW9ucygpO1xuXG4gICAgdGhpcy5wYXllZURhdGFTZXJ2aWNlLnNlbGVjdGVkRGVsZXRlUGF5ZWVcbiAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKSwgc2tpcCgxKSlcbiAgICAgIC5zdWJzY3JpYmUocGF5ZWUgPT4gKHBheWVlID8gKHRoaXMuaXNEZWxldGVNb2RhbE9wZW5lZCA9IHRydWUpIDogKHRoaXMuaXNOYXZpZ2F0ZU1vZGFsT3BlbmVkID0gdHJ1ZSkpKTtcblxuICAgIHRoaXMucGF5ZWVEYXRhU2VydmljZS5zZWxlY3RlZERlbGV0ZUViaWxsc1xuICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMuZGVzdHJveSQpLCBza2lwKDEpKVxuICAgICAgLnN1YnNjcmliZShwYXllZSA9PiAocGF5ZWUgPyAodGhpcy5pc0RlbGV0ZUViaWxsc01vZGFsT3BlbiA9IHRydWUpIDogKHRoaXMuaXNOYXZpZ2F0ZU1vZGFsT3BlbmVkID0gdHJ1ZSkpKTtcbiAgfVxuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLmRlc3Ryb3kkLm5leHQoKTtcbiAgICB0aGlzLmRlc3Ryb3kkLmNvbXBsZXRlKCk7XG4gIH1cblxuICBwcml2YXRlIGRlbGV0ZVBheWVlKCk6IE9ic2VydmFibGU8SHR0cFJlc3BvbnNlPGFueT4gfCB7fT4ge1xuICAgIHJldHVybiB0aGlzLnBheWVlRGF0YVNlcnZpY2Uuc2VsZWN0ZWREZWxldGVQYXllZS5waXBlKFxuICAgICAgc3dpdGNoTWFwKChwYXllZTogYW55KSA9PlxuICAgICAgICBwYXllZSA/IHRoaXMucGF5ZWVEYXRhU2VydmljZS5kZWxldGVQYXllZShwYXllZS5pZCwgcGF5ZWUuZWxlY3Ryb25pYykgOiBvZjxPYnNlcnZhYmxlPGFueT4+KCksXG4gICAgICApLFxuICAgICk7XG4gIH1cbiAgcHJpdmF0ZSBkZWxldGVFYmlsbHMoKTogT2JzZXJ2YWJsZTxIdHRwUmVzcG9uc2U8UGF5ZWVTdW1tYXJ5PiB8IHt9PiB7XG4gICAgcmV0dXJuIHRoaXMucGF5ZWVEYXRhU2VydmljZS5zZWxlY3RlZERlbGV0ZUViaWxscy5waXBlKFxuICAgICAgc3dpdGNoTWFwKChwYXllZTogYW55KSA9PiAocGF5ZWUgPyB0aGlzLnBheWVlRGF0YVNlcnZpY2UuZGVsZXRlRWJpbGxzKHBheWVlLmlkKSA6IG9mPE9ic2VydmFibGU8YW55Pj4oKSkpLFxuICAgICk7XG4gIH1cblxuICBwcml2YXRlIGdldCBkaXNtaXNzVGltZW91dCgpOiBudW1iZXIge1xuICAgIGlmICh0aGlzLmNvbmZpZy5ub3RpZmljYXRpb25EaXNtaXNzVGltZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Rpc21pc3MgdGltZW91dCB2YWx1ZSBub3QgZm91bmQnKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnLm5vdGlmaWNhdGlvbkRpc21pc3NUaW1lO1xuICB9XG5cbiAgc2VsZWN0ZWREZWxldGVQYXllZSgpOiBPYnNlcnZhYmxlPFBheWVlU3VtbWFyeSB8IHVuZGVmaW5lZD4ge1xuICAgIHJldHVybiB0aGlzLnBheWVlRGF0YVNlcnZpY2Uuc2VsZWN0ZWREZWxldGVQYXllZTtcbiAgfVxuXG4gIHNlbGVjdGVkRGVsZXRlRWJpbGxzKCk6IE9ic2VydmFibGU8UGF5ZWVTdW1tYXJ5IHwgdW5kZWZpbmVkPiB7XG4gICAgcmV0dXJuIHRoaXMucGF5ZWVEYXRhU2VydmljZS5zZWxlY3RlZERlbGV0ZUViaWxscztcbiAgfVxuXG4gIG9uTmF2aWdhdGVUb1BheW1lbnRzKGhhc05hdmlnYXRlZDogYm9vbGVhbikge1xuICAgIGlmIChoYXNOYXZpZ2F0ZWQpIHtcbiAgICAgIHRoaXMuZ29Ub1BheW1lbnRzTGlzdCgpO1xuICAgIH1cbiAgICB0aGlzLmlzTmF2aWdhdGVNb2RhbE9wZW5lZCA9IGZhbHNlO1xuICB9XG5cbiAgb25EZWxldGVQYXllZShyZXNvbHZlOiBib29sZWFuKSB7XG4gICAgdGhpcy5pc0RlbGV0ZU1vZGFsT3BlbmVkID0gZmFsc2U7XG5cbiAgICBpZiAocmVzb2x2ZSkge1xuICAgICAgdGhpcy5kZWxldGVQYXllZSgpXG4gICAgICAgIC5waXBlKHRha2UoMSkpXG4gICAgICAgIC5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuZGVsZXRpb25Ob3RpZnkoJ2RlbGV0ZScpO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBvbkRlbGV0ZUViaWxscyhyZXNvbHZlOiBib29sZWFuKSB7XG4gICAgdGhpcy5pc0RlbGV0ZUViaWxsc01vZGFsT3BlbiA9IGZhbHNlO1xuXG4gICAgaWYgKHJlc29sdmUpIHtcbiAgICAgIHRoaXMuZGVsZXRlRWJpbGxzKClcbiAgICAgICAgLnBpcGUodGFrZSgxKSlcbiAgICAgICAgLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5kZWxldGlvbk5vdGlmeSgnZWJpbGxzJyk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZGVsZXRpb25Ob3RpZnkodHlwZTogc3RyaW5nKSB7XG4gICAgdGhpcy5wYXllZURhdGFTZXJ2aWNlLnJlbG9hZFBheWVlcygpO1xuICAgIHRoaXMuY2RSZWYubWFya0ZvckNoZWNrKCk7XG4gICAgdGhpcy5ub3RpZmljYXRpb25UeXBlID0gdHlwZTtcbiAgICB0aGlzLm5vdGlmaWNhdGlvblNlcnZpY2Uuc2hvd05vdGlmaWNhdGlvbih7XG4gICAgICBoZWFkZXI6IHRoaXMubm90aWZpY2F0aW9uSGVhZGVyVGVtcGxhdGUsXG4gICAgICBtZXNzYWdlOiB0aGlzLm5vdGlmaWNhdGlvbk1lc3NhZ2VUZW1wbGF0ZSxcbiAgICAgIG1vZGlmaWVyOiAnc3VjY2VzcycsXG4gICAgICB0dGw6IHRoaXMuZGlzbWlzc1RpbWVvdXQsXG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHNldHVwTmF2aWdhdGlvblN1YnNjcmlwdGlvbnMoKSB7XG4gICAgdGhpcy5iaWxscGF5Tm90aWZpY2F0aW9uUm91dGluZ1NlcnZpY2UubWFuYWdlUGF5ZWVzU3ViamVjdCRcbiAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKSlcbiAgICAgIC5zdWJzY3JpYmUoKCkgPT4gdGhpcy5nb1RvQWRkUGF5ZWUoKSk7XG5cbiAgICB0aGlzLmJpbGxwYXlOb3RpZmljYXRpb25Sb3V0aW5nU2VydmljZS5tYW5hZ2VQYXltZW50U3ViamVjdCRcbiAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKSlcbiAgICAgIC5zdWJzY3JpYmUoYXN5bmMgcGF5ZWVJZCA9PlxuICAgICAgICB0aGlzLmdvdG9PbmVPZmZQYXltZW50KChhd2FpdCB0aGlzLnBheWVlRGF0YVNlcnZpY2UuZmluZFBheWVlU3VtbWFyeUJ5SWQocGF5ZWVJZCkpPy5pZCB8fCAnJyksXG4gICAgICApO1xuXG4gICAgdGhpcy5iaWxscGF5Tm90aWZpY2F0aW9uUm91dGluZ1NlcnZpY2UudXBjb21taW5nUGF5bWVudHNTdWJqZWN0JFxuICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMuZGVzdHJveSQpKVxuICAgICAgLnN1YnNjcmliZSgoKSA9PiB0aGlzLmdvVG9QYXltZW50c0xpc3QoKSk7XG4gIH1cblxuICBhcmVCb3RoTGlzdHNQcmVzZW50KHBheWVlU3VtbWFyaWVzQnlFYmlsbDogUGF5ZWVTdW1tYXJpZXNCeUViaWxsKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhKFxuICAgICAgcGF5ZWVTdW1tYXJpZXNCeUViaWxsLmViaWxsc0VuYWJsZWQgJiZcbiAgICAgIHBheWVlU3VtbWFyaWVzQnlFYmlsbC5lYmlsbHNFbmFibGVkLmxlbmd0aCAmJlxuICAgICAgcGF5ZWVTdW1tYXJpZXNCeUViaWxsLmViaWxsc05vdEVuYWJsZWQgJiZcbiAgICAgIHBheWVlU3VtbWFyaWVzQnlFYmlsbC5lYmlsbHNOb3RFbmFibGVkLmxlbmd0aFxuICAgICk7XG4gIH1cblxuICAvLyBHZXQgdG90YWxzIG9mIHRoZSBlQmlsbHMsIGdyb3VwZWQgYnkgY3VycmVuY3lcbiAgLy8gSWRlYWxseSB0aGVyZSBzaG91bGQgb25seSBiZSBvbmUgY3VycmVuY3kgaW4gdXNlLCBidXQgaXQgZG9lc24ndCBodXJ0IHRvIGNoZWNrXG4gIGdldEViaWxsVG90YWxzKGViaWxsUGF5ZWVTdW1tYXJpZXM6IFBheWVlU3VtbWFyeVtdID0gW10pOiBDdXJyZW5jeVtdIHtcbiAgICBjb25zdCBlYmlsbFRvdGFsc0J5Q3VycmVuY3k6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSBlYmlsbFBheWVlU3VtbWFyaWVzLnJlZHVjZShcbiAgICAgIChjdXJyZW5jaWVzVG90YWxzT2JqOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+LCBwYXllZVN1bW1hcnk6IFBheWVlU3VtbWFyeSkgPT4ge1xuICAgICAgICBpZiAoIShwYXllZVN1bW1hcnkuZWJpbGwgJiYgcGF5ZWVTdW1tYXJ5LmViaWxsLmxhdGVzdEJpbGwgJiYgcGF5ZWVTdW1tYXJ5LmViaWxsLmxhdGVzdEJpbGwuYW1vdW50KSkge1xuICAgICAgICAgIHJldHVybiBjdXJyZW5jaWVzVG90YWxzT2JqO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdGhpc0N1cnJlbmN5Q29kZSA9IHBheWVlU3VtbWFyeS5lYmlsbC5sYXRlc3RCaWxsLmFtb3VudC5jdXJyZW5jeUNvZGU7XG4gICAgICAgIGNvbnN0IHRoaXNBbW91bnQgPSBwYXJzZUZsb2F0KHBheWVlU3VtbWFyeS5lYmlsbC5sYXRlc3RCaWxsLmFtb3VudC5hbW91bnQpO1xuXG4gICAgICAgIGlmICghY3VycmVuY2llc1RvdGFsc09ialt0aGlzQ3VycmVuY3lDb2RlXSkge1xuICAgICAgICAgIGN1cnJlbmNpZXNUb3RhbHNPYmpbdGhpc0N1cnJlbmN5Q29kZV0gPSAwO1xuICAgICAgICB9XG4gICAgICAgIGN1cnJlbmNpZXNUb3RhbHNPYmpbdGhpc0N1cnJlbmN5Q29kZV0gPSBjdXJyZW5jaWVzVG90YWxzT2JqW3RoaXNDdXJyZW5jeUNvZGVdICsgdGhpc0Ftb3VudDtcblxuICAgICAgICByZXR1cm4gY3VycmVuY2llc1RvdGFsc09iajtcbiAgICAgIH0sXG4gICAgICB7fSxcbiAgICApO1xuXG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKGViaWxsVG90YWxzQnlDdXJyZW5jeSkubWFwKGN1cnJlbmN5Q29kZSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjdXJyZW5jeUNvZGUsXG4gICAgICAgIGFtb3VudDogZWJpbGxUb3RhbHNCeUN1cnJlbmN5W2N1cnJlbmN5Q29kZV0udG9TdHJpbmcoKSxcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBuZ0ZvclRyYWNrQnlDdXJyZW5jeUZuKGN1cnJlbmNpZXM6IEN1cnJlbmN5KSB7XG4gICAgcmV0dXJuIGN1cnJlbmNpZXMuY3VycmVuY3lDb2RlO1xuICB9XG5cbiAgZ2V0IGN1cnJlbnRMb2FkaW5nU3RhdGUoKSB7XG4gICAgcmV0dXJuIHRoaXMucGF5ZWVEYXRhU2VydmljZS5wYXllZXNMb2FkaW5nU3RhdGU7XG4gIH1cblxuICBnZXQgYXJlQnV0dG9uc0Rpc2FibGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnBheWVlRGF0YVNlcnZpY2UuYXJlQnV0dG9uc0Rpc2FibGVkO1xuICB9XG5cbiAgZ2V0IG51bWJlck9mUGF5ZWVzKCk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMucGF5ZWVEYXRhU2VydmljZS5udW1iZXJPZlBheWVlcztcbiAgfVxuXG4gIGdvVG9BZGRQYXllZSgpIHtcbiAgICB0aGlzLnJvdXRlclNlcnZpY2UubmF2aWdhdGVUb1NlYXJjaCh0aGlzLm5hdmlnYXRpb25FeHRyYXMpO1xuICB9XG4gIHByaXZhdGUgZ29Ub1BheW1lbnRzTGlzdCgpIHtcbiAgICB0aGlzLnJvdXRlclNlcnZpY2U/Lm5hdmlnYXRlVG9QZW5kaW5nUGF5bWVudHMoKTtcbiAgfVxuICBwcml2YXRlIGdvdG9PbmVPZmZQYXltZW50KGlkOiBzdHJpbmcpIHtcbiAgICB0aGlzLnJvdXRlclNlcnZpY2U/Lm5hdmlnYXRlVG9PbmVPZmZQYXltZW50KGlkKTtcbiAgfVxufVxuIiwiPGRpdiBjbGFzcz1cImJiLXN0YWNrIGJiLWJsb2NrIGJiLWJsb2NrLS1sZ1wiPlxuICA8YmItaGVhZGVyLXVpXG4gICAgY2xhc3M9XCJiYi1zdGFja19faXRlbSBiYi1zdGFja19faXRlbS0tZmlsbFwiXG4gICAgaGVhZGluZ1R5cGU9XCJoMVwiXG4gICAgaGVhZGluZz1cIlBheSBhIGJpbGxcIlxuICAgIGkxOG4taGVhZGluZz1cIkBAYmlsbHBheS1wYXllZXMtam91cm5leS5wYXllZS1saXN0LXZpZXdcIlxuICA+XG4gIDwvYmItaGVhZGVyLXVpPlxuICA8YnV0dG9uXG4gICAgYmJCdXR0b25cbiAgICAoY2xpY2spPVwiZ29Ub0FkZFBheWVlKClcIlxuICAgIGNvbG9yPVwic2Vjb25kYXJ5XCJcbiAgICBpMThuPVwiYnV0dG9uIGxhYmVsfEFkZCBwYXllZSBidXR0b25AQGJpbGxwYXktcGF5ZWVzLWpvdXJuZXkucGF5ZWUtbGlzdFwiXG4gID5cbiAgICBBZGQgYSBwYXllZVxuICA8L2J1dHRvbj5cbjwvZGl2PlxuXG48bmctY29udGFpbmVyPlxuICA8c2VjdGlvbj5cbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiY3VycmVudExvYWRpbmdTdGF0ZSAhPT0gJ2Vycm9yJzsgZWxzZSBlcnJvclN0YXRlXCI+XG4gICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwicGF5ZWVTdW1tYXJpZXNCeUViaWxsT2JzZXJ2YWJsZSB8IGFzeW5jIGFzIGViaWxsR3JvdXBlZERhdGE7IGVsc2UgbG9hZGluZ1N0YXRlXCI+XG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJjdXJyZW50TG9hZGluZ1N0YXRlICE9PSAnbG9hZGluZyc7IGVsc2UgbG9hZGluZ1N0YXRlXCI+XG4gICAgICAgICAgPG5nLWNvbnRhaW5lclxuICAgICAgICAgICAgKm5nSWY9XCJlYmlsbEdyb3VwZWREYXRhLmViaWxsc0VuYWJsZWQubGVuZ3RoIHx8IGViaWxsR3JvdXBlZERhdGEuZWJpbGxzTm90RW5hYmxlZC5sZW5ndGg7IGVsc2UgZW1wdHlTdGF0ZVwiXG4gICAgICAgICAgPlxuICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICBjbGFzcz1cImJiLWJsb2NrIGJiLWJsb2NrLS1sZ1wiXG4gICAgICAgICAgICAgICpuZ0lmPVwiZWJpbGxHcm91cGVkRGF0YS5lYmlsbHNFbmFibGVkLmxlbmd0aFwiXG4gICAgICAgICAgICAgIGRhdGEtcm9sZT1cInBheWVlcy13aXRoLWFjdGl2ZS1lLWJpbGxzLWxpc3RcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2FyZCBjYXJkLWxnXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNhcmQtYm9keVwiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJiLWJsb2NrIGJiLWJsb2NrLS1tZFwiPlxuICAgICAgICAgICAgICAgICAgICA8YmItaGVhZGVyLXVpXG4gICAgICAgICAgICAgICAgICAgICAgaGVhZGluZ1R5cGU9XCJoMlwiXG4gICAgICAgICAgICAgICAgICAgICAgKm5nSWY9XCJhcmVCb3RoTGlzdHNQcmVzZW50KGViaWxsR3JvdXBlZERhdGEpXCJcbiAgICAgICAgICAgICAgICAgICAgICBkYXRhLXJvbGU9XCJzdWItaGVhZGVyXCJcbiAgICAgICAgICAgICAgICAgICAgICBoZWFkaW5nPVwiUGF5ZWVzIHdpdGggYWN0aXZlIGVCaWxsc1wiXG4gICAgICAgICAgICAgICAgICAgICAgaTE4bi1oZWFkaW5nPVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBQYXllZXMgd2l0aCBlQmlsbHMgdGl0bGV8VGl0bGUgZm9yIHRoZSBsaXN0IG9mIHBheWVlcyB3aXRoIGVCaWxsc1xuICAgICAgICAgICAgICAgICAgICAgICAgZW5hYmxlZEBAYmItYmlsbHBheS1wYXllZS1saXN0LXdpZGdldC1hbmcudGl0bGUucGF5ZWVzLXdpdGgtZWJpbGxzXCJcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8L2JiLWhlYWRlci11aT5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPHVsIGNsYXNzPVwiYmItbGlzdFwiPlxuICAgICAgICAgICAgICAgICAgICA8bGkgY2xhc3M9XCJiYi1saXN0X19pdGVtXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPGJiLWJpbGxwYXktcGF5ZWUtc3VtbWFyeS1saXN0IFtwYXllZVN1bW1hcmllc109XCJlYmlsbEdyb3VwZWREYXRhLmViaWxsc0VuYWJsZWRcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8L2JiLWJpbGxwYXktcGF5ZWUtc3VtbWFyeS1saXN0PlxuICAgICAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgICAgICA8bGkgY2xhc3M9XCJiYi1saXN0X19pdGVtXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS1yb2xlPVwib3V0c3RhbmRpbmctZS1iaWxsLXRvdGFsXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGU9XCJsaXN0aXRlbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAqbmdGb3I9XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGViaWxsQ3VycmVuY3lUb3RhbCBvZiBnZXRFYmlsbFRvdGFscyhlYmlsbEdyb3VwZWREYXRhLmViaWxsc0VuYWJsZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFja0J5OiBuZ0ZvclRyYWNrQnlDdXJyZW5jeUZuXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJiYi1oaWdobGlnaHRcIlxuICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGkxOG49XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPdXRzdGFuZGluZyBlQmlsbHMgdG90YWwgdGV4dHxUZXh0IGZvciB0aGUgdG90YWwgb2Ygb3V0c3RhbmRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlQmlsbHNAQGJiLWJpbGxwYXktcGF5ZWUtbGlzdC13aWRnZXQtYW5nLmViaWxscy50b3RhbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIE91dHN0YW5kaW5nIGVCaWxsIHRvdGFsOlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGJiLWFtb3VudC11aVxuICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLXJvbGU9XCJ0b3RhbC1hbW91bnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImJiLWhpZ2hsaWdodFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFthbW91bnRdPVwiZWJpbGxDdXJyZW5jeVRvdGFsLmFtb3VudFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFtjdXJyZW5jeV09XCJlYmlsbEN1cnJlbmN5VG90YWwuY3VycmVuY3lDb2RlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvYmItYW1vdW50LXVpPlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgICAgPC91bD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICBjbGFzcz1cImNhcmQgY2FyZC1sZ1wiXG4gICAgICAgICAgICAgIGRhdGEtcm9sZT1cImFsbC1vdGhlci1wYXllZXMtbGlzdFwiXG4gICAgICAgICAgICAgICpuZ0lmPVwiZWJpbGxHcm91cGVkRGF0YS5lYmlsbHNOb3RFbmFibGVkLmxlbmd0aFwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjYXJkLWJvZHlcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYmItYmxvY2sgYmItYmxvY2stLW1kXCI+XG4gICAgICAgICAgICAgICAgICA8YmItaGVhZGVyLXVpXG4gICAgICAgICAgICAgICAgICAgIGhlYWRpbmdUeXBlPVwiaDJcIlxuICAgICAgICAgICAgICAgICAgICAqbmdJZj1cImFyZUJvdGhMaXN0c1ByZXNlbnQoZWJpbGxHcm91cGVkRGF0YSlcIlxuICAgICAgICAgICAgICAgICAgICBkYXRhLXJvbGU9XCJzdWItaGVhZGVyXCJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGluZz1cIkFsbCBvdGhlciBwYXllZXNcIlxuICAgICAgICAgICAgICAgICAgICBpMThuLWhlYWRpbmc9XCJcbiAgICAgICAgICAgICAgICAgICAgICBQYXllZXMgd2l0aG91dCBlQmlsbHMgdGl0bGV8VGl0bGUgZm9yIHRoZSBsaXN0IG9mIHBheWVlcyB0aGF0IGRvIG5vdCBoYXZlIGVCaWxsc1xuICAgICAgICAgICAgICAgICAgICAgIGVuYWJsZWRAQGJiLWJpbGxwYXktcGF5ZWUtbGlzdC13aWRnZXQtYW5nLnRpdGxlLm90aGVyLXBheWVlc1wiXG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICA8L2JiLWhlYWRlci11aT5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYmItbGlzdFwiPlxuICAgICAgICAgICAgICAgICAgPGJiLWJpbGxwYXktcGF5ZWUtc3VtbWFyeS1saXN0IFtwYXllZVN1bW1hcmllc109XCJlYmlsbEdyb3VwZWREYXRhLmViaWxsc05vdEVuYWJsZWRcIj5cbiAgICAgICAgICAgICAgICAgIDwvYmItYmlsbHBheS1wYXllZS1zdW1tYXJ5LWxpc3Q+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgPC9uZy1jb250YWluZXI+XG4gIDwvc2VjdGlvbj5cbjwvbmctY29udGFpbmVyPlxuXG48bmctdGVtcGxhdGUgI2xvYWRpbmdTdGF0ZT5cbiAgPGRpdiBjbGFzcz1cImNhcmQgY2FyZC1sZ1wiPlxuICAgIDxkaXYgY2xhc3M9XCJjYXJkLWJvZHlcIj5cbiAgICAgIDxiYi1sb2FkaW5nLWluZGljYXRvci11aSBsb2FkZXJTaXplPVwibGdcIj4gPC9iYi1sb2FkaW5nLWluZGljYXRvci11aT5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG48L25nLXRlbXBsYXRlPlxuXG48bmctdGVtcGxhdGUgI2Vycm9yU3RhdGU+XG4gIDxkaXYgY2xhc3M9XCJjYXJkIGNhcmQtbGdcIj5cbiAgICA8ZGl2IGNsYXNzPVwiY2FyZC1ib2R5XCI+XG4gICAgICA8YmItZW1wdHktc3RhdGUtdWlcbiAgICAgICAgZGF0YS1yb2xlPVwiZXJyb3Itc3RhdGVcIlxuICAgICAgICBpY29uU2l6ZT1cInh4bFwiXG4gICAgICAgIGljb25Nb2RpZmllcj1cImVycm9yLW91dGxpbmVcIlxuICAgICAgICBzdWJ0aXRsZT1cIlRyeSB0byByZWxvYWQgdGhlIHBhZ2Ugb3IgY29udGFjdCBzdXBwb3J0XCJcbiAgICAgICAgaTE4bi1zdWJ0aXRsZT1cIlxuICAgICAgICAgIFRyeSB0byByZWxvYWQgdGhlIHBhZ2Ugb3IgY29udGFjdCB0aGUgc3VwcG9ydC58UGF5ZWUgTGlzdCBsb2FkaW5nXG4gICAgICAgICAgc3VidGl0bGVAQGJiLWJpbGxwYXktcGF5ZWUtbGlzdC13aWRnZXQtYW5nLmxvYWRpbmcuc3VidGl0bGVcIlxuICAgICAgICB0aXRsZT1cIlBheWVlIGxpc3QgaXMgbm90IGxvYWRpbmdcIlxuICAgICAgICBpMThuLXRpdGxlPVwiUGF5ZWUgbGlzdCBpcyBub3QgbG9hZGluZ3xQYXllZSBMaXN0IGxvYWRpbmcgdGl0bGVAQGJiLWJpbGxwYXktcGF5ZWUtbGlzdC13aWRnZXQtYW5nLmxvYWRpbmcudGl0bGVcIlxuICAgICAgPlxuICAgICAgPC9iYi1lbXB0eS1zdGF0ZS11aT5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG48L25nLXRlbXBsYXRlPlxuXG48bmctdGVtcGxhdGUgI2VtcHR5U3RhdGU+XG4gIDxkaXYgY2xhc3M9XCJjYXJkIGNhcmQtbGdcIj5cbiAgICA8ZGl2IGNsYXNzPVwiY2FyZC1ib2R5IGJiLXN0YXRlLWNvbnRhaW5lclwiPlxuICAgICAgPGJiLWVtcHR5LXN0YXRlLXVpXG4gICAgICAgIGRhdGEtcm9sZT1cImVtcHR5LXN0YXRlXCJcbiAgICAgICAgaWNvblNpemU9XCJ4eGxcIlxuICAgICAgICBpY29uTW9kaWZpZXI9XCJhc3NpZ25tZW50LWluZFwiXG4gICAgICAgIHN1YnRpdGxlPVwiQWRkIGEgcGF5ZWUgdG8gbWFrZSBhIGJpbGwgcGF5bWVudFwiXG4gICAgICAgIGkxOG4tc3VidGl0bGU9XCJcbiAgICAgICAgICBBZGQgYSBwYXllZSB0byBtYWtlIGEgYmlsbCBwYXltZW50fFBheWVlIExpc3Qgbm8gcGF5ZWVzXG4gICAgICAgICAgc3VidGl0bGVAQGJiLWJpbGxwYXktcGF5ZWUtbGlzdC13aWRnZXQtYW5nLmJiLWVtcHR5LXN0YXRlLXVpLnN1YnRpdGxlXCJcbiAgICAgICAgdGl0bGU9XCJObyBwYXllZXNcIlxuICAgICAgICBpMThuLXRpdGxlPVwiXG4gICAgICAgICAgTm8gcGF5ZWVzIHN0YXRlIHRleHR8UGF5ZWUgTGlzdCBubyBwYXllZXMgdGl0bGVAQGJiLWJpbGxwYXktcGF5ZWUtbGlzdC13aWRnZXQtYW5nLmJiLWVtcHR5LXN0YXRlLXVpLnRpdGxlXCJcbiAgICAgID5cbiAgICAgIDwvYmItZW1wdHktc3RhdGUtdWk+XG4gICAgICA8ZGl2IGNsYXNzPVwiYmItc3RhdGUtY29udGFpbmVyX19mb290ZXJcIj5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgIGJiQnV0dG9uXG4gICAgICAgICAgZGF0YS1yb2xlPVwiZW1wdHktc3RhdGUtYWRkLXBheWVlLWJ0blwiXG4gICAgICAgICAgKGNsaWNrKT1cImFkZFBheWVlKClcIlxuICAgICAgICAgIFtkaXNhYmxlZF09XCJhcmVCdXR0b25zRGlzYWJsZWRcIlxuICAgICAgICAgIGkxOG49XCJcbiAgICAgICAgICAgIEFkZCBhIHBheWVlfFBheWVlIExpc3QgYWRkIHBheWVlIGJ1dHRvbkBAYmItYmlsbHBheS1wYXllZS1saXN0LXdpZGdldC1hbmcuYmItZW1wdHktc3RhdGUtdWkuYnV0dG9uLmFkZC1wYXllZVwiXG4gICAgICAgID5cbiAgICAgICAgICBBZGQgYSBwYXllZVxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICA8L2Rpdj5cbjwvbmctdGVtcGxhdGU+XG5cbjxiYi1iaWxscGF5LXBheWVlLWRlbGV0ZS1tb2RhbFxuICAqbmdJZj1cImlzRGVsZXRlTW9kYWxPcGVuZWRcIlxuICAocmVzb2x2ZSk9XCJvbkRlbGV0ZVBheWVlKCRldmVudClcIlxuPjwvYmItYmlsbHBheS1wYXllZS1kZWxldGUtbW9kYWw+XG5cbjxiYi1iaWxscGF5LWViaWxscy1kZWxldGUtbW9kYWxcbiAgKm5nSWY9XCJpc0RlbGV0ZUViaWxsc01vZGFsT3BlblwiXG4gIChyZXNvbHZlKT1cIm9uRGVsZXRlRWJpbGxzKCRldmVudClcIlxuPjwvYmItYmlsbHBheS1lYmlsbHMtZGVsZXRlLW1vZGFsPlxuXG48YmItYmlsbHBheS1wYXllZS1uYXZpZ2F0ZS1tb2RhbFxuICAqbmdJZj1cImlzTmF2aWdhdGVNb2RhbE9wZW5lZFwiXG4gIChyZXNvbHZlKT1cIm9uTmF2aWdhdGVUb1BheW1lbnRzKCRldmVudClcIlxuPjwvYmItYmlsbHBheS1wYXllZS1uYXZpZ2F0ZS1tb2RhbD5cblxuPG5nLXRlbXBsYXRlICNub3RpZmljYXRpb25IZWFkZXI+XG4gIDxkaXYgW25nU3dpdGNoXT1cIm5vdGlmaWNhdGlvblR5cGVcIj5cbiAgICA8c3BhblxuICAgICAgKm5nU3dpdGNoQ2FzZT1cIidlYmlsbHMnXCJcbiAgICAgIGNsYXNzPVwiYmItdGV4dC1ib2xkXCJcbiAgICAgIGkxOG49XCJcbiAgICAgICAgZUJpbGxzIHN0b3BwZWQgbm90aWZpY2F0aW9uIGhlYWRlcnxlQmlsbHMgc3RvcHBlZCBjb25maXJtYXRpb24gc3VjY2VzcyBub3RpZmljYXRpb25cbiAgICAgICAgaGVhZGVyQEBiaWxscGF5LXBheWVlLWxpc3QuY29uZmlybS5ub3RpZmljYXRpb24uaGVhZGVyXCJcbiAgICAgID5lQmlsbHMgc3RvcHBlZDwvc3BhblxuICAgID5cbiAgICA8c3BhblxuICAgICAgKm5nU3dpdGNoQ2FzZT1cIidkZWxldGUnXCJcbiAgICAgIGNsYXNzPVwiYmItdGV4dC1ib2xkXCJcbiAgICAgIGkxOG49XCJcbiAgICAgICAgZGVsZXRlIHBheWVlIG5vdGlmaWNhdGlvbiBoZWFkZXJ8UGF5ZWUgZGVsZXRlIGNvbmZpcm1hdGlvbiBzdWNjZXNzIG5vdGlmaWNhdGlvblxuICAgICAgICBoZWFkZXJAQGJpbGxwYXktcGF5ZWUtbGlzdC5jb25maXJtLm5vdGlmaWNhdGlvbi5oZWFkZXJcIlxuICAgICAgPlBheWVlIGRlbGV0ZWQ8L3NwYW5cbiAgICA+XG4gIDwvZGl2PlxuPC9uZy10ZW1wbGF0ZT5cblxuPG5nLXRlbXBsYXRlICNub3RpZmljYXRpb25NZXNzYWdlPlxuICA8ZGl2IFtuZ1N3aXRjaF09XCJub3RpZmljYXRpb25UeXBlXCI+XG4gICAgPG5nLWNvbnRhaW5lciAqbmdTd2l0Y2hDYXNlPVwiJ2RlbGV0ZSdcIj5cbiAgICAgIDxzcGFuXG4gICAgICAgICpuZ0lmPVwic2VsZWN0ZWREZWxldGVQYXllZSgpIHwgYXN5bmMgYXMgcGF5ZWVcIlxuICAgICAgICBpMThuPVwiXG4gICAgICAgICAgZGVsZXRlIHBheWVlIG5vdGlmaWNhdGlvbiBtZXNzYWdlfFBheWVlIGRlbGV0ZSBjb25maXJtYXRpb24gc3VjY2VzcyBub3RpZmljYXRpb25cbiAgICAgICAgICBtZXNzYWdlQEBiaWxscGF5LXBheWVlLWxpc3QuZGVsZXRlLXBheWVlLWNvbmZpcm0ubm90aWZpY2F0aW9uLm1lc3NhZ2VcIlxuICAgICAgICA+VGhlIHBheWVlIHt7IHBheWVlLm5pY2tOYW1lID8gcGF5ZWUubmlja05hbWUgKyAnICgnICsgcGF5ZWUubmFtZSArICcpJyA6IHBheWVlLm5hbWUgfX0gaGFzIGJlZW4gZGVsZXRlZFxuICAgICAgICBzdWNjZXNzZnVsbHk8L3NwYW5cbiAgICAgID5cbiAgICA8L25nLWNvbnRhaW5lcj5cbiAgICA8bmctY29udGFpbmVyICpuZ1N3aXRjaENhc2U9XCInZWJpbGxzJ1wiPlxuICAgICAgPHNwYW5cbiAgICAgICAgKm5nSWY9XCJzZWxlY3RlZERlbGV0ZUViaWxscygpIHwgYXN5bmMgYXMgcGF5ZWVcIlxuICAgICAgICBpMThuPVwiXG4gICAgICAgICAgc3RvcCBlYmlsbCBub3RpZmljYXRpb24gbWVzc2FnZXxQYXllZSBzdG9wIGViaWxsIGNvbmZpcm1hdGlvbiBzdWNjZXNzIG5vdGlmaWNhdGlvblxuICAgICAgICAgIG1lc3NhZ2VAQGJpbGxwYXktcGF5ZWUtbGlzdC5zdG9wLWViaWxsLWNvbmZpcm0ubm90aWZpY2F0aW9uLm1lc3NhZ2VcIlxuICAgICAgICA+ZUJpbGxzIGZvciB7eyBwYXllZS5uaWNrTmFtZSA/IHBheWVlLm5pY2tOYW1lICsgJyAoJyArIHBheWVlLm5hbWUgKyAnKScgOiBwYXllZS5uYW1lIH19IGhhcyBiZWVuIHN0b3BwZWRcbiAgICAgICAgc3VjY2Vzc2Z1bGx5PC9zcGFuXG4gICAgICA+XG4gICAgPC9uZy1jb250YWluZXI+XG4gIDwvZGl2PlxuPC9uZy10ZW1wbGF0ZT5cbiJdfQ==