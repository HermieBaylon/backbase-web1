import { Inject, Injectable, Optional } from '@angular/core';
import { HttpHeaders, HttpParams } from '@angular/common/http';
import { CustomHttpParameterCodec } from '../encoder';
import { ACCESS_CONTROL_BASE_PATH } from '../variables';
import { AccessControlConfiguration } from '../configuration';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common/http";
import * as i2 from "../configuration";
export class ApprovalsHttpService {
    constructor(httpClient, basePath, configuration) {
        this.httpClient = httpClient;
        this.basePath = '/access-control';
        this.defaultHeaders = new HttpHeaders();
        this.configuration = new AccessControlConfiguration();
        if (configuration) {
            this.configuration = configuration;
        }
        if (typeof this.configuration.basePath !== 'string') {
            if (typeof basePath !== 'string') {
                basePath = this.basePath;
            }
            this.configuration.basePath = basePath;
        }
        this.encoder = this.configuration.encoder || new CustomHttpParameterCodec();
    }
    addToHttpParams(httpParams, value, key) {
        if (typeof value === "object" && value instanceof Date === false) {
            httpParams = this.addToHttpParamsRecursive(httpParams, value);
        }
        else {
            httpParams = this.addToHttpParamsRecursive(httpParams, value, key);
        }
        return httpParams;
    }
    addToHttpParamsRecursive(httpParams, value, key) {
        if (value == null) {
            return httpParams;
        }
        if (typeof value === "object") {
            if (Array.isArray(value)) {
                value.forEach(elem => httpParams = this.addToHttpParamsRecursive(httpParams, elem, key));
            }
            else if (value instanceof Date) {
                if (key != null) {
                    httpParams = httpParams.append(key, value.toISOString().substr(0, 10));
                }
                else {
                    throw Error("key may not be null if value is Date");
                }
            }
            else {
                Object.keys(value).forEach(k => httpParams = this.addToHttpParamsRecursive(httpParams, value[k], key != null ? `${key}.${k}` : k));
            }
        }
        else if (key != null) {
            httpParams = httpParams.append(key, value);
        }
        else {
            throw Error("key may not be null if value is not object or array");
        }
        return httpParams;
    }
    getApprovals(requestParameters, observe = 'body', reportProgress = false, options) {
        const _from = requestParameters["from"];
        const _cursor = requestParameters["cursor"];
        const _size = requestParameters["size"];
        let queryParameters = new HttpParams({ encoder: this.encoder });
        if (_from !== undefined && _from !== null) {
            queryParameters = this.addToHttpParams(queryParameters, _from, 'from');
        }
        if (_cursor !== undefined && _cursor !== null) {
            queryParameters = this.addToHttpParams(queryParameters, _cursor, 'cursor');
        }
        if (_size !== undefined && _size !== null) {
            queryParameters = this.addToHttpParams(queryParameters, _size, 'size');
        }
        let headers = this.defaultHeaders;
        let httpHeaderAcceptSelected = options && options.httpHeaderAccept;
        if (httpHeaderAcceptSelected === undefined) {
            const httpHeaderAccepts = [
                'application/json'
            ];
            httpHeaderAcceptSelected = this.configuration.selectHeaderAccept(httpHeaderAccepts);
        }
        if (httpHeaderAcceptSelected !== undefined) {
            headers = headers.set('Accept', httpHeaderAcceptSelected);
        }
        let responseType = 'json';
        if (httpHeaderAcceptSelected && httpHeaderAcceptSelected.startsWith('text')) {
            responseType = 'text';
        }
        return this.httpClient.get(`${this.configuration.basePath}/client-api/v2/accessgroups/approvals`, {
            params: queryParameters,
            responseType: responseType,
            withCredentials: this.configuration.withCredentials,
            headers: headers,
            observe: observe,
            reportProgress: reportProgress
        });
    }
    getApprovalsUrl(requestParameters) {
        const _from = requestParameters["from"];
        const _cursor = requestParameters["cursor"];
        const _size = requestParameters["size"];
        let queryParameters = new HttpParams({ encoder: this.encoder });
        if (_from !== undefined && _from !== null) {
            queryParameters = this.addToHttpParams(queryParameters, _from, 'from');
        }
        if (_cursor !== undefined && _cursor !== null) {
            queryParameters = this.addToHttpParams(queryParameters, _cursor, 'cursor');
        }
        if (_size !== undefined && _size !== null) {
            queryParameters = this.addToHttpParams(queryParameters, _size, 'size');
        }
        const queryString = queryParameters.toString();
        return `${this.configuration.basePath}/client-api/v2/accessgroups/approvals${queryString ? `?${queryString}` : ''}`;
    }
    getPresentationDataGroupApprovalDetailsItem(requestParameters, observe = 'body', reportProgress = false, options) {
        const _approvalId = requestParameters["approvalId"];
        if (_approvalId === null || _approvalId === undefined) {
            throw new Error('Required parameter approvalId was null or undefined when calling getPresentationDataGroupApprovalDetailsItem.');
        }
        let headers = this.defaultHeaders;
        let httpHeaderAcceptSelected = options && options.httpHeaderAccept;
        if (httpHeaderAcceptSelected === undefined) {
            const httpHeaderAccepts = [
                'application/json'
            ];
            httpHeaderAcceptSelected = this.configuration.selectHeaderAccept(httpHeaderAccepts);
        }
        if (httpHeaderAcceptSelected !== undefined) {
            headers = headers.set('Accept', httpHeaderAcceptSelected);
        }
        let responseType = 'json';
        if (httpHeaderAcceptSelected && httpHeaderAcceptSelected.startsWith('text')) {
            responseType = 'text';
        }
        return this.httpClient.get(`${this.configuration.basePath}/client-api/v2/accessgroups/approvals/${encodeURIComponent(String(_approvalId))}/data-group`, {
            responseType: responseType,
            withCredentials: this.configuration.withCredentials,
            headers: headers,
            observe: observe,
            reportProgress: reportProgress
        });
    }
    getPresentationDataGroupApprovalDetailsItemUrl(requestParameters) {
        const _approvalId = requestParameters["approvalId"];
        if (_approvalId === null || _approvalId === undefined) {
            throw new Error('Required parameter approvalId was null or undefined when calling getPresentationDataGroupApprovalDetailsItem.');
        }
        return `${this.configuration.basePath}/client-api/v2/accessgroups/approvals/${encodeURIComponent(String(_approvalId))}/data-group`;
    }
    getPresentationFunctionGroupApprovalDetailsItem(requestParameters, observe = 'body', reportProgress = false, options) {
        const _approvalId = requestParameters["approvalId"];
        if (_approvalId === null || _approvalId === undefined) {
            throw new Error('Required parameter approvalId was null or undefined when calling getPresentationFunctionGroupApprovalDetailsItem.');
        }
        let headers = this.defaultHeaders;
        let httpHeaderAcceptSelected = options && options.httpHeaderAccept;
        if (httpHeaderAcceptSelected === undefined) {
            const httpHeaderAccepts = [
                'application/json'
            ];
            httpHeaderAcceptSelected = this.configuration.selectHeaderAccept(httpHeaderAccepts);
        }
        if (httpHeaderAcceptSelected !== undefined) {
            headers = headers.set('Accept', httpHeaderAcceptSelected);
        }
        let responseType = 'json';
        if (httpHeaderAcceptSelected && httpHeaderAcceptSelected.startsWith('text')) {
            responseType = 'text';
        }
        return this.httpClient.get(`${this.configuration.basePath}/client-api/v2/accessgroups/approvals/${encodeURIComponent(String(_approvalId))}/function-group`, {
            responseType: responseType,
            withCredentials: this.configuration.withCredentials,
            headers: headers,
            observe: observe,
            reportProgress: reportProgress
        });
    }
    getPresentationFunctionGroupApprovalDetailsItemUrl(requestParameters) {
        const _approvalId = requestParameters["approvalId"];
        if (_approvalId === null || _approvalId === undefined) {
            throw new Error('Required parameter approvalId was null or undefined when calling getPresentationFunctionGroupApprovalDetailsItem.');
        }
        return `${this.configuration.basePath}/client-api/v2/accessgroups/approvals/${encodeURIComponent(String(_approvalId))}/function-group`;
    }
    getPresentationPermissionsApprovalDetailsItem(requestParameters, observe = 'body', reportProgress = false, options) {
        const _approvalId = requestParameters["approvalId"];
        if (_approvalId === null || _approvalId === undefined) {
            throw new Error('Required parameter approvalId was null or undefined when calling getPresentationPermissionsApprovalDetailsItem.');
        }
        let headers = this.defaultHeaders;
        let httpHeaderAcceptSelected = options && options.httpHeaderAccept;
        if (httpHeaderAcceptSelected === undefined) {
            const httpHeaderAccepts = [
                'application/json'
            ];
            httpHeaderAcceptSelected = this.configuration.selectHeaderAccept(httpHeaderAccepts);
        }
        if (httpHeaderAcceptSelected !== undefined) {
            headers = headers.set('Accept', httpHeaderAcceptSelected);
        }
        let responseType = 'json';
        if (httpHeaderAcceptSelected && httpHeaderAcceptSelected.startsWith('text')) {
            responseType = 'text';
        }
        return this.httpClient.get(`${this.configuration.basePath}/client-api/v2/accessgroups/approvals/${encodeURIComponent(String(_approvalId))}/permissions`, {
            responseType: responseType,
            withCredentials: this.configuration.withCredentials,
            headers: headers,
            observe: observe,
            reportProgress: reportProgress
        });
    }
    getPresentationPermissionsApprovalDetailsItemUrl(requestParameters) {
        const _approvalId = requestParameters["approvalId"];
        if (_approvalId === null || _approvalId === undefined) {
            throw new Error('Required parameter approvalId was null or undefined when calling getPresentationPermissionsApprovalDetailsItem.');
        }
        return `${this.configuration.basePath}/client-api/v2/accessgroups/approvals/${encodeURIComponent(String(_approvalId))}/permissions`;
    }
    getServiceAgreementApprovalDetailsItem(requestParameters, observe = 'body', reportProgress = false, options) {
        const _approvalId = requestParameters["approvalId"];
        if (_approvalId === null || _approvalId === undefined) {
            throw new Error('Required parameter approvalId was null or undefined when calling getServiceAgreementApprovalDetailsItem.');
        }
        let headers = this.defaultHeaders;
        let httpHeaderAcceptSelected = options && options.httpHeaderAccept;
        if (httpHeaderAcceptSelected === undefined) {
            const httpHeaderAccepts = [
                'application/json'
            ];
            httpHeaderAcceptSelected = this.configuration.selectHeaderAccept(httpHeaderAccepts);
        }
        if (httpHeaderAcceptSelected !== undefined) {
            headers = headers.set('Accept', httpHeaderAcceptSelected);
        }
        let responseType = 'json';
        if (httpHeaderAcceptSelected && httpHeaderAcceptSelected.startsWith('text')) {
            responseType = 'text';
        }
        return this.httpClient.get(`${this.configuration.basePath}/client-api/v2/accessgroups/approvals/${encodeURIComponent(String(_approvalId))}/service-agreement`, {
            responseType: responseType,
            withCredentials: this.configuration.withCredentials,
            headers: headers,
            observe: observe,
            reportProgress: reportProgress
        });
    }
    getServiceAgreementApprovalDetailsItemUrl(requestParameters) {
        const _approvalId = requestParameters["approvalId"];
        if (_approvalId === null || _approvalId === undefined) {
            throw new Error('Required parameter approvalId was null or undefined when calling getServiceAgreementApprovalDetailsItem.');
        }
        return `${this.configuration.basePath}/client-api/v2/accessgroups/approvals/${encodeURIComponent(String(_approvalId))}/service-agreement`;
    }
    getWizardApprovalDetails(requestParameters, observe = 'body', reportProgress = false, options) {
        const _approvalId = requestParameters["approvalId"];
        if (_approvalId === null || _approvalId === undefined) {
            throw new Error('Required parameter approvalId was null or undefined when calling getWizardApprovalDetails.');
        }
        let headers = this.defaultHeaders;
        let httpHeaderAcceptSelected = options && options.httpHeaderAccept;
        if (httpHeaderAcceptSelected === undefined) {
            const httpHeaderAccepts = [
                'application/json'
            ];
            httpHeaderAcceptSelected = this.configuration.selectHeaderAccept(httpHeaderAccepts);
        }
        if (httpHeaderAcceptSelected !== undefined) {
            headers = headers.set('Accept', httpHeaderAcceptSelected);
        }
        let responseType = 'json';
        if (httpHeaderAcceptSelected && httpHeaderAcceptSelected.startsWith('text')) {
            responseType = 'text';
        }
        return this.httpClient.get(`${this.configuration.basePath}/client-api/v2/accessgroups/approvals/${encodeURIComponent(String(_approvalId))}/wizard-setup`, {
            responseType: responseType,
            withCredentials: this.configuration.withCredentials,
            headers: headers,
            observe: observe,
            reportProgress: reportProgress
        });
    }
    getWizardApprovalDetailsUrl(requestParameters) {
        const _approvalId = requestParameters["approvalId"];
        if (_approvalId === null || _approvalId === undefined) {
            throw new Error('Required parameter approvalId was null or undefined when calling getWizardApprovalDetails.');
        }
        return `${this.configuration.basePath}/client-api/v2/accessgroups/approvals/${encodeURIComponent(String(_approvalId))}/wizard-setup`;
    }
    postApproveApprovalRequest(requestParameters, observe = 'body', reportProgress = false, options) {
        const _approvalId = requestParameters["approvalId"];
        if (_approvalId === null || _approvalId === undefined) {
            throw new Error('Required parameter approvalId was null or undefined when calling postApproveApprovalRequest.');
        }
        let headers = this.defaultHeaders;
        let httpHeaderAcceptSelected = options && options.httpHeaderAccept;
        if (httpHeaderAcceptSelected === undefined) {
            const httpHeaderAccepts = [
                'application/json'
            ];
            httpHeaderAcceptSelected = this.configuration.selectHeaderAccept(httpHeaderAccepts);
        }
        if (httpHeaderAcceptSelected !== undefined) {
            headers = headers.set('Accept', httpHeaderAcceptSelected);
        }
        let responseType = 'json';
        if (httpHeaderAcceptSelected && httpHeaderAcceptSelected.startsWith('text')) {
            responseType = 'text';
        }
        return this.httpClient.post(`${this.configuration.basePath}/client-api/v2/accessgroups/approvals/${encodeURIComponent(String(_approvalId))}/approve`, null, {
            responseType: responseType,
            withCredentials: this.configuration.withCredentials,
            headers: headers,
            observe: observe,
            reportProgress: reportProgress
        });
    }
    postApproveApprovalRequestUrl(requestParameters) {
        const _approvalId = requestParameters["approvalId"];
        if (_approvalId === null || _approvalId === undefined) {
            throw new Error('Required parameter approvalId was null or undefined when calling postApproveApprovalRequest.');
        }
        return `${this.configuration.basePath}/client-api/v2/accessgroups/approvals/${encodeURIComponent(String(_approvalId))}/approve`;
    }
    postRejectApprovalRequest(requestParameters, observe = 'body', reportProgress = false, options) {
        const _approvalId = requestParameters["approvalId"];
        if (_approvalId === null || _approvalId === undefined) {
            throw new Error('Required parameter approvalId was null or undefined when calling postRejectApprovalRequest.');
        }
        let headers = this.defaultHeaders;
        let httpHeaderAcceptSelected = options && options.httpHeaderAccept;
        if (httpHeaderAcceptSelected === undefined) {
            const httpHeaderAccepts = [
                'application/json'
            ];
            httpHeaderAcceptSelected = this.configuration.selectHeaderAccept(httpHeaderAccepts);
        }
        if (httpHeaderAcceptSelected !== undefined) {
            headers = headers.set('Accept', httpHeaderAcceptSelected);
        }
        let responseType = 'json';
        if (httpHeaderAcceptSelected && httpHeaderAcceptSelected.startsWith('text')) {
            responseType = 'text';
        }
        return this.httpClient.post(`${this.configuration.basePath}/client-api/v2/accessgroups/approvals/${encodeURIComponent(String(_approvalId))}/reject`, null, {
            responseType: responseType,
            withCredentials: this.configuration.withCredentials,
            headers: headers,
            observe: observe,
            reportProgress: reportProgress
        });
    }
    postRejectApprovalRequestUrl(requestParameters) {
        const _approvalId = requestParameters["approvalId"];
        if (_approvalId === null || _approvalId === undefined) {
            throw new Error('Required parameter approvalId was null or undefined when calling postRejectApprovalRequest.');
        }
        return `${this.configuration.basePath}/client-api/v2/accessgroups/approvals/${encodeURIComponent(String(_approvalId))}/reject`;
    }
}
ApprovalsHttpService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: ApprovalsHttpService, deps: [{ token: i1.HttpClient }, { token: ACCESS_CONTROL_BASE_PATH, optional: true }, { token: i2.AccessControlConfiguration, optional: true }], target: i0.ɵɵFactoryTarget.Injectable });
ApprovalsHttpService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: ApprovalsHttpService, providedIn: 'root' });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: ApprovalsHttpService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root'
                }]
        }], ctorParameters: function () { return [{ type: i1.HttpClient }, { type: undefined, decorators: [{
                    type: Optional
                }, {
                    type: Inject,
                    args: [ACCESS_CONTROL_BASE_PATH]
                }] }, { type: i2.AccessControlConfiguration, decorators: [{
                    type: Optional
                }] }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwcm92YWxzLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9hcGkvYXBwcm92YWxzLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBY0EsT0FBTyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLE1BQTJCLGVBQWUsQ0FBQztBQUNsRixPQUFPLEVBQWMsV0FBVyxFQUFFLFVBQVUsRUFDVSxNQUFZLHNCQUFzQixDQUFDO0FBQ3pGLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUErQixZQUFZLENBQUM7QUFjL0UsT0FBTyxFQUFFLHdCQUF3QixFQUFzQixNQUEwQixjQUFjLENBQUM7QUFDaEcsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQTBDLGtCQUFrQixDQUFDOzs7O0FBbURsRyxNQUFNLE9BQU8sb0JBQW9CO0lBTzdCLFlBQXNCLFVBQXNCLEVBQWdELFFBQWdCLEVBQWMsYUFBeUM7UUFBN0ksZUFBVSxHQUFWLFVBQVUsQ0FBWTtRQUxsQyxhQUFRLEdBQUcsaUJBQWlCLENBQUM7UUFDaEMsbUJBQWMsR0FBRyxJQUFJLFdBQVcsRUFBRSxDQUFDO1FBQ25DLGtCQUFhLEdBQUcsSUFBSSwwQkFBMEIsRUFBRSxDQUFDO1FBSXBELElBQUksYUFBYSxFQUFFO1lBQ2YsSUFBSSxDQUFDLGFBQWEsR0FBRyxhQUFhLENBQUM7U0FDdEM7UUFDRCxJQUFJLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxRQUFRLEtBQUssUUFBUSxFQUFFO1lBQ2pELElBQUksT0FBTyxRQUFRLEtBQUssUUFBUSxFQUFFO2dCQUM5QixRQUFRLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQzthQUM1QjtZQUNELElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztTQUMxQztRQUNELElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxPQUFPLElBQUksSUFBSSx3QkFBd0IsRUFBRSxDQUFD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QVEseUNBQXlDLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxTQUFTLEVBQzNLLElBQUksRUFDSjtZQUNJLFlBQVksRUFBTyxZQUFZO1lBQy9CLGVBQWUsRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFDLGVBQWU7WUFDbkQsT0FBTyxFQUFFLE9BQU87WUFDaEIsT0FBTyxFQUFFLE9BQU87WUFDaEIsY0FBYyxFQUFFLGNBQWM7U0FDakMsQ0FDSixDQUFDO0lBQ04sQ0FBQztJQUVNLDRCQUE0QixDQUFDLGlCQUF5RDtRQUN6RixNQUFNLFdBQVcsR0FBRyxpQkFBaUIsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUNwRCxJQUFJLFdBQVcsS0FBSyxJQUFJLElBQUksV0FBVyxLQUFLLFNBQVMsRUFBRTtZQUNuRCxNQUFNLElBQUksS0FBSyxDQUFDLDZGQUE2RixDQUFDLENBQUM7U0FDbEg7UUFDRCxPQUFPLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxRQUFRLHlDQUF5QyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsU0FBUyxDQUFDO0lBQ25JLENBQUM7O2tIQTVxQlEsb0JBQW9CLDRDQU9xQyx3QkFBd0I7c0hBUGpGLG9CQUFvQixjQUZuQixNQUFNOzRGQUVQLG9CQUFvQjtrQkFIaEMsVUFBVTttQkFBQztvQkFDVixVQUFVLEVBQUUsTUFBTTtpQkFDbkI7OzBCQVFrRCxRQUFROzswQkFBSSxNQUFNOzJCQUFDLHdCQUF3Qjs7MEJBQXFCLFFBQVEiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEFjY2VzcyBDb250cm9sIGNsaWVudCBBUElcbiAqIE1hbmFnZSB1c2VyIHBlcm1pc3Npb25zLCBkYXRhIGdyb3VwcywgZnVuY3Rpb24gZ3JvdXBzIGFuZCBzZXJ2aWNlIGFncmVlbWVudHMgZnJvbSBjbGllbnQgc2lkZVxuICpcbiAqIFRoZSB2ZXJzaW9uIG9mIHRoZSBPcGVuQVBJIGRvY3VtZW50OiAyLjEwLjBcbiAqIFxuICpcbiAqIE5PVEU6IFRoaXMgY2xhc3MgaXMgYXV0byBnZW5lcmF0ZWQgYnkgT3BlbkFQSSBHZW5lcmF0b3IgKGh0dHBzOi8vZ2l0aHViLmNvbS9CYWNrYmFzZS9iYWNrYmFzZS1vcGVuYXBpLXRvb2xzKS5cbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9CYWNrYmFzZS9iYWNrYmFzZS1vcGVuYXBpLXRvb2xzXG4gKiBEbyBub3QgZWRpdCB0aGUgY2xhc3MgbWFudWFsbHkuXG4gKi9cblxuLyogdHNsaW50OmRpc2FibGU6bm8tdW51c2VkLXZhcmlhYmxlIG1lbWJlci1vcmRlcmluZyAqL1xuXG5pbXBvcnQgeyBJbmplY3QsIEluamVjdGFibGUsIE9wdGlvbmFsIH0gICAgICAgICAgICAgICAgICAgICAgZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBIdHRwQ2xpZW50LCBIdHRwSGVhZGVycywgSHR0cFBhcmFtcyxcbiAgICAgICAgIEh0dHBSZXNwb25zZSwgSHR0cEV2ZW50LCBIdHRwUGFyYW1ldGVyQ29kZWMgfSAgICAgICBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQgeyBDdXN0b21IdHRwUGFyYW1ldGVyQ29kZWMgfSAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbSAnLi4vZW5jb2Rlcic7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbSAncnhqcyc7XG5cbmltcG9ydCB7IEJhZFJlcXVlc3RFcnJvciB9IGZyb20gJy4uL21vZGVsL21vZGVscyc7XG5pbXBvcnQgeyBGb3JiaWRkZW5FcnJvciB9IGZyb20gJy4uL21vZGVsL21vZGVscyc7XG5pbXBvcnQgeyBOb3RGb3VuZEVycm9yIH0gZnJvbSAnLi4vbW9kZWwvbW9kZWxzJztcbmltcG9ydCB7IFByZXNlbnRhdGlvbkFwcHJvdmFsSXRlbSB9IGZyb20gJy4uL21vZGVsL21vZGVscyc7XG5pbXBvcnQgeyBQcmVzZW50YXRpb25BcHByb3ZhbFN0YXR1cyB9IGZyb20gJy4uL21vZGVsL21vZGVscyc7XG5pbXBvcnQgeyBQcmVzZW50YXRpb25EYXRhR3JvdXBBcHByb3ZhbERldGFpbHNJdGVtIH0gZnJvbSAnLi4vbW9kZWwvbW9kZWxzJztcbmltcG9ydCB7IFByZXNlbnRhdGlvbkZ1bmN0aW9uR3JvdXBBcHByb3ZhbERldGFpbHNJdGVtIH0gZnJvbSAnLi4vbW9kZWwvbW9kZWxzJztcbmltcG9ydCB7IFByZXNlbnRhdGlvblBlcm1pc3Npb25zQXBwcm92YWxEZXRhaWxzSXRlbSB9IGZyb20gJy4uL21vZGVsL21vZGVscyc7XG5pbXBvcnQgeyBTZXJ2aWNlQWdyZWVlbWVudEFwcHJvdmFsRGV0YWlsc0l0ZW0gfSBmcm9tICcuLi9tb2RlbC9tb2RlbHMnO1xuaW1wb3J0IHsgV2l6YXJkQXBwcm92YWxEZXRhaWxzIH0gZnJvbSAnLi4vbW9kZWwvbW9kZWxzJztcblxuaW1wb3J0IHsgQUNDRVNTX0NPTlRST0xfQkFTRV9QQVRILCBDT0xMRUNUSU9OX0ZPUk1BVFMgfSAgICAgICAgICAgICAgICAgICAgIGZyb20gJy4uL3ZhcmlhYmxlcyc7XG5pbXBvcnQgeyBBY2Nlc3NDb250cm9sQ29uZmlndXJhdGlvbiB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb20gJy4uL2NvbmZpZ3VyYXRpb24nO1xuXG5cbmV4cG9ydCBpbnRlcmZhY2UgR2V0QXBwcm92YWxzUmVxdWVzdFBhcmFtcyB7XG4gICAgLyoqIFBhZ2UgTnVtYmVyLiBTa2lwIG92ZXIgcGFnZXMgb2YgZWxlbWVudHMgYnkgc3BlY2lmeWluZyBhIHN0YXJ0IHZhbHVlIGZvciB0aGUgcXVlcnkgKi9cbiAgICBbXCJmcm9tXCJdPzogbnVtYmVyO1xuICAgIC8qKiBSZWNvcmQgVVVJRC4gQXMgYW4gYWx0ZXJuYXRpdmUgZm9yIHNwZWNpZnlpbmcgXFwmIzM5O2Zyb21cXCYjMzk7IHRoaXMgYWxsb3dzIHRvIHBvaW50IHRvIHRoZSByZWNvcmQgdG8gc3RhcnQgdGhlIHNlbGVjdGlvbiBmcm9tLiAgKi9cbiAgICBbXCJjdXJzb3JcIl0/OiBzdHJpbmc7XG4gICAgLyoqIExpbWl0IHRoZSBudW1iZXIgb2YgZWxlbWVudHMgb24gdGhlIHJlc3BvbnNlLiBXaGVuIHVzZWQgaW4gY29tYmluYXRpb24gd2l0aCBjdXJzb3IsIHRoZSB2YWx1ZSBpcyBhbGxvd2VkIHRvIGJlIGEgbmVnYXRpdmUgbnVtYmVyIHRvIGluZGljYXRlIHJlcXVlc3RpbmcgcmVjb3JkcyB1cHdhcmRzIGZyb20gdGhlIHN0YXJ0aW5nIHBvaW50IGluZGljYXRlZCBieSB0aGUgY3Vyc29yLiAgKi9cbiAgICBbXCJzaXplXCJdPzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEdldFByZXNlbnRhdGlvbkRhdGFHcm91cEFwcHJvdmFsRGV0YWlsc0l0ZW1SZXF1ZXN0UGFyYW1zIHtcbiAgICAvKiogQXBwcm92YWwgSUQgKi9cbiAgICBbXCJhcHByb3ZhbElkXCJdOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2V0UHJlc2VudGF0aW9uRnVuY3Rpb25Hcm91cEFwcHJvdmFsRGV0YWlsc0l0ZW1SZXF1ZXN0UGFyYW1zIHtcbiAgICAvKiogQXBwcm92YWwgSUQgKi9cbiAgICBbXCJhcHByb3ZhbElkXCJdOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2V0UHJlc2VudGF0aW9uUGVybWlzc2lvbnNBcHByb3ZhbERldGFpbHNJdGVtUmVxdWVzdFBhcmFtcyB7XG4gICAgLyoqIEFwcHJvdmFsIElEICovXG4gICAgW1wiYXBwcm92YWxJZFwiXTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEdldFNlcnZpY2VBZ3JlZW1lbnRBcHByb3ZhbERldGFpbHNJdGVtUmVxdWVzdFBhcmFtcyB7XG4gICAgLyoqIE5vIGRlc2NyaXB0aW9uIGF2YWlsYWJsZSAqL1xuICAgIFtcImFwcHJvdmFsSWRcIl06IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBHZXRXaXphcmRBcHByb3ZhbERldGFpbHNSZXF1ZXN0UGFyYW1zIHtcbiAgICAvKiogQXBwcm92YWwgSUQgKi9cbiAgICBbXCJhcHByb3ZhbElkXCJdOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUG9zdEFwcHJvdmVBcHByb3ZhbFJlcXVlc3RSZXF1ZXN0UGFyYW1zIHtcbiAgICAvKiogQXBwcm92YWwgSUQgKi9cbiAgICBbXCJhcHByb3ZhbElkXCJdOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUG9zdFJlamVjdEFwcHJvdmFsUmVxdWVzdFJlcXVlc3RQYXJhbXMge1xuICAgIC8qKiBBcHByb3ZhbCBJRCAqL1xuICAgIFtcImFwcHJvdmFsSWRcIl06IHN0cmluZztcbn1cblxuXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46ICdyb290J1xufSlcbmV4cG9ydCBjbGFzcyBBcHByb3ZhbHNIdHRwU2VydmljZSB7XG5cbiAgICBwcm90ZWN0ZWQgYmFzZVBhdGggPSAnL2FjY2Vzcy1jb250cm9sJztcbiAgICBwdWJsaWMgZGVmYXVsdEhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoKTtcbiAgICBwdWJsaWMgY29uZmlndXJhdGlvbiA9IG5ldyBBY2Nlc3NDb250cm9sQ29uZmlndXJhdGlvbigpO1xuICAgIHB1YmxpYyBlbmNvZGVyOiBIdHRwUGFyYW1ldGVyQ29kZWM7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgaHR0cENsaWVudDogSHR0cENsaWVudCwgQE9wdGlvbmFsKCkgQEluamVjdChBQ0NFU1NfQ09OVFJPTF9CQVNFX1BBVEgpIGJhc2VQYXRoOiBzdHJpbmcsIEBPcHRpb25hbCgpIGNvbmZpZ3VyYXRpb246IEFjY2Vzc0NvbnRyb2xDb25maWd1cmF0aW9uKSB7XG4gICAgICAgIGlmIChjb25maWd1cmF0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZ3VyYXRpb24gPSBjb25maWd1cmF0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5jb25maWd1cmF0aW9uLmJhc2VQYXRoICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBiYXNlUGF0aCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBiYXNlUGF0aCA9IHRoaXMuYmFzZVBhdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmNvbmZpZ3VyYXRpb24uYmFzZVBhdGggPSBiYXNlUGF0aDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVuY29kZXIgPSB0aGlzLmNvbmZpZ3VyYXRpb24uZW5jb2RlciB8fCBuZXcgQ3VzdG9tSHR0cFBhcmFtZXRlckNvZGVjKCk7XG4gICAgfVxuXG5cbiAgICBwcml2YXRlIGFkZFRvSHR0cFBhcmFtcyhodHRwUGFyYW1zOiBIdHRwUGFyYW1zLCB2YWx1ZTogYW55LCBrZXk/OiBzdHJpbmcpOiBIdHRwUGFyYW1zIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJiB2YWx1ZSBpbnN0YW5jZW9mIERhdGUgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBodHRwUGFyYW1zID0gdGhpcy5hZGRUb0h0dHBQYXJhbXNSZWN1cnNpdmUoaHR0cFBhcmFtcywgdmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaHR0cFBhcmFtcyA9IHRoaXMuYWRkVG9IdHRwUGFyYW1zUmVjdXJzaXZlKGh0dHBQYXJhbXMsIHZhbHVlLCBrZXkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBodHRwUGFyYW1zO1xuICAgIH1cblxuICAgIHByaXZhdGUgYWRkVG9IdHRwUGFyYW1zUmVjdXJzaXZlKGh0dHBQYXJhbXM6IEh0dHBQYXJhbXMsIHZhbHVlPzogYW55LCBrZXk/OiBzdHJpbmcpOiBIdHRwUGFyYW1zIHtcbiAgICAgICAgaWYgKHZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybiBodHRwUGFyYW1zO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgKHZhbHVlIGFzIGFueVtdKS5mb3JFYWNoKCBlbGVtID0+IGh0dHBQYXJhbXMgPSB0aGlzLmFkZFRvSHR0cFBhcmFtc1JlY3Vyc2l2ZShodHRwUGFyYW1zLCBlbGVtLCBrZXkpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGtleSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGh0dHBQYXJhbXMgPSBodHRwUGFyYW1zLmFwcGVuZChrZXksXG4gICAgICAgICAgICAgICAgICAgICAgICAodmFsdWUgYXMgRGF0ZSkudG9JU09TdHJpbmcoKS5zdWJzdHIoMCwgMTApKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgIHRocm93IEVycm9yKFwia2V5IG1heSBub3QgYmUgbnVsbCBpZiB2YWx1ZSBpcyBEYXRlXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXModmFsdWUpLmZvckVhY2goIGsgPT4gaHR0cFBhcmFtcyA9IHRoaXMuYWRkVG9IdHRwUGFyYW1zUmVjdXJzaXZlKFxuICAgICAgICAgICAgICAgICAgICBodHRwUGFyYW1zLCB2YWx1ZVtrXSwga2V5ICE9IG51bGwgPyBgJHtrZXl9LiR7a31gIDogaykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGtleSAhPSBudWxsKSB7XG4gICAgICAgICAgICBodHRwUGFyYW1zID0gaHR0cFBhcmFtcy5hcHBlbmQoa2V5LCB2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcImtleSBtYXkgbm90IGJlIG51bGwgaWYgdmFsdWUgaXMgbm90IG9iamVjdCBvciBhcnJheVwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaHR0cFBhcmFtcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZSBsaXN0IG9mIGFwcHJvdmFscyBmb3IgbG9nZ2VkIGluIHVzZXIgLSAmI3g2MDtHRVQmI3g2MDsuXG4gICAgICogI1JldHJpZXZlIGxpc3Qgb2YgYXBwcm92YWxzIGZvciBsb2dnZWQgaW4gdXNlciAtICYjeDYwO0dFVCYjeDYwOyAgICAjIyNFeHRlbmRhYmlsaXR5ICAgIEV4dGVuZGFibGUgdXNpbmcgQXBhY2hlIENhbWVsOiAgICAqIFJvdXRlIENsYXNzOiBjb20uYmFja2Jhc2UucHJlc2VudGF0aW9uLnNlcnZpY2VzLmFjY2Vzc2dyb3Vwcy5yb3V0ZXMuYXBwcm92YWwuTGlzdFBlbmRpbmdBcHByb3ZhbHNSb3V0ZSAgKiBSb3V0ZSBJZDogTGlzdFBlbmRpbmdBcHByb3ZhbHNSb3V0ZSAgKiBSb3V0ZSBzb3VyY2UgZW5kcG9pbnQ6IGRpcmVjdDpidXNpbmVzcy5MaXN0UGVuZGluZ0FwcHJvdmFscyAgKiBSb3V0ZSBkZXN0aW5hdGlvbiBlbmRwb2ludDogZGlyZWN0Omxpc3RQZW5kaW5nQXBwcm92YWxzUmVxdWVzdGVkSW50ZXJuYWxcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFBhcmFtZXRlcnNcbiAgICAgKiBAcGFyYW0gb2JzZXJ2ZSBzZXQgd2hldGhlciBvciBub3QgdG8gcmV0dXJuIHRoZSBkYXRhIE9ic2VydmFibGUgYXMgdGhlIGJvZHksIHJlc3BvbnNlIG9yIGV2ZW50cy4gZGVmYXVsdHMgdG8gcmV0dXJuaW5nIHRoZSBib2R5LlxuICAgICAqIEBwYXJhbSByZXBvcnRQcm9ncmVzcyBmbGFnIHRvIHJlcG9ydCByZXF1ZXN0IGFuZCByZXNwb25zZSBwcm9ncmVzcy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0QXBwcm92YWxzKHJlcXVlc3RQYXJhbWV0ZXJzOiBHZXRBcHByb3ZhbHNSZXF1ZXN0UGFyYW1zLCBvYnNlcnZlPzogJ2JvZHknLCByZXBvcnRQcm9ncmVzcz86IGJvb2xlYW4sIG9wdGlvbnM/OiB7aHR0cEhlYWRlckFjY2VwdD86ICdhcHBsaWNhdGlvbi9qc29uJ30pOiBPYnNlcnZhYmxlPEFycmF5PFByZXNlbnRhdGlvbkFwcHJvdmFsSXRlbT4+O1xuICAgIC8qKlxuICAgICAqIFJldHJpZXZlIGxpc3Qgb2YgYXBwcm92YWxzIGZvciBsb2dnZWQgaW4gdXNlciAtICYjeDYwO0dFVCYjeDYwOy5cbiAgICAgKiAjUmV0cmlldmUgbGlzdCBvZiBhcHByb3ZhbHMgZm9yIGxvZ2dlZCBpbiB1c2VyIC0gJiN4NjA7R0VUJiN4NjA7ICAgICMjI0V4dGVuZGFiaWxpdHkgICAgRXh0ZW5kYWJsZSB1c2luZyBBcGFjaGUgQ2FtZWw6ICAgICogUm91dGUgQ2xhc3M6IGNvbS5iYWNrYmFzZS5wcmVzZW50YXRpb24uc2VydmljZXMuYWNjZXNzZ3JvdXBzLnJvdXRlcy5hcHByb3ZhbC5MaXN0UGVuZGluZ0FwcHJvdmFsc1JvdXRlICAqIFJvdXRlIElkOiBMaXN0UGVuZGluZ0FwcHJvdmFsc1JvdXRlICAqIFJvdXRlIHNvdXJjZSBlbmRwb2ludDogZGlyZWN0OmJ1c2luZXNzLkxpc3RQZW5kaW5nQXBwcm92YWxzICAqIFJvdXRlIGRlc3RpbmF0aW9uIGVuZHBvaW50OiBkaXJlY3Q6bGlzdFBlbmRpbmdBcHByb3ZhbHNSZXF1ZXN0ZWRJbnRlcm5hbFxuICAgICAqIEBwYXJhbSByZXF1ZXN0UGFyYW1ldGVyc1xuICAgICAqIEBwYXJhbSBvYnNlcnZlIHNldCB3aGV0aGVyIG9yIG5vdCB0byByZXR1cm4gdGhlIGRhdGEgT2JzZXJ2YWJsZSBhcyB0aGUgYm9keSwgcmVzcG9uc2Ugb3IgZXZlbnRzLiBkZWZhdWx0cyB0byByZXR1cm5pbmcgdGhlIGJvZHkuXG4gICAgICogQHBhcmFtIHJlcG9ydFByb2dyZXNzIGZsYWcgdG8gcmVwb3J0IHJlcXVlc3QgYW5kIHJlc3BvbnNlIHByb2dyZXNzLlxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRBcHByb3ZhbHMocmVxdWVzdFBhcmFtZXRlcnM6IEdldEFwcHJvdmFsc1JlcXVlc3RQYXJhbXMsIG9ic2VydmU/OiAncmVzcG9uc2UnLCByZXBvcnRQcm9ncmVzcz86IGJvb2xlYW4sIG9wdGlvbnM/OiB7aHR0cEhlYWRlckFjY2VwdD86ICdhcHBsaWNhdGlvbi9qc29uJ30pOiBPYnNlcnZhYmxlPEh0dHBSZXNwb25zZTxBcnJheTxQcmVzZW50YXRpb25BcHByb3ZhbEl0ZW0+Pj47XG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgbGlzdCBvZiBhcHByb3ZhbHMgZm9yIGxvZ2dlZCBpbiB1c2VyIC0gJiN4NjA7R0VUJiN4NjA7LlxuICAgICAqICNSZXRyaWV2ZSBsaXN0IG9mIGFwcHJvdmFscyBmb3IgbG9nZ2VkIGluIHVzZXIgLSAmI3g2MDtHRVQmI3g2MDsgICAgIyMjRXh0ZW5kYWJpbGl0eSAgICBFeHRlbmRhYmxlIHVzaW5nIEFwYWNoZSBDYW1lbDogICAgKiBSb3V0ZSBDbGFzczogY29tLmJhY2tiYXNlLnByZXNlbnRhdGlvbi5zZXJ2aWNlcy5hY2Nlc3Nncm91cHMucm91dGVzLmFwcHJvdmFsLkxpc3RQZW5kaW5nQXBwcm92YWxzUm91dGUgICogUm91dGUgSWQ6IExpc3RQZW5kaW5nQXBwcm92YWxzUm91dGUgICogUm91dGUgc291cmNlIGVuZHBvaW50OiBkaXJlY3Q6YnVzaW5lc3MuTGlzdFBlbmRpbmdBcHByb3ZhbHMgICogUm91dGUgZGVzdGluYXRpb24gZW5kcG9pbnQ6IGRpcmVjdDpsaXN0UGVuZGluZ0FwcHJvdmFsc1JlcXVlc3RlZEludGVybmFsXG4gICAgICogQHBhcmFtIHJlcXVlc3RQYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIG9ic2VydmUgc2V0IHdoZXRoZXIgb3Igbm90IHRvIHJldHVybiB0aGUgZGF0YSBPYnNlcnZhYmxlIGFzIHRoZSBib2R5LCByZXNwb25zZSBvciBldmVudHMuIGRlZmF1bHRzIHRvIHJldHVybmluZyB0aGUgYm9keS5cbiAgICAgKiBAcGFyYW0gcmVwb3J0UHJvZ3Jlc3MgZmxhZyB0byByZXBvcnQgcmVxdWVzdCBhbmQgcmVzcG9uc2UgcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHVibGljIGdldEFwcHJvdmFscyhyZXF1ZXN0UGFyYW1ldGVyczogR2V0QXBwcm92YWxzUmVxdWVzdFBhcmFtcywgb2JzZXJ2ZT86ICdldmVudHMnLCByZXBvcnRQcm9ncmVzcz86IGJvb2xlYW4sIG9wdGlvbnM/OiB7aHR0cEhlYWRlckFjY2VwdD86ICdhcHBsaWNhdGlvbi9qc29uJ30pOiBPYnNlcnZhYmxlPEh0dHBFdmVudDxBcnJheTxQcmVzZW50YXRpb25BcHByb3ZhbEl0ZW0+Pj47XG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgbGlzdCBvZiBhcHByb3ZhbHMgZm9yIGxvZ2dlZCBpbiB1c2VyIC0gJiN4NjA7R0VUJiN4NjA7LlxuICAgICAqICNSZXRyaWV2ZSBsaXN0IG9mIGFwcHJvdmFscyBmb3IgbG9nZ2VkIGluIHVzZXIgLSAmI3g2MDtHRVQmI3g2MDsgICAgIyMjRXh0ZW5kYWJpbGl0eSAgICBFeHRlbmRhYmxlIHVzaW5nIEFwYWNoZSBDYW1lbDogICAgKiBSb3V0ZSBDbGFzczogY29tLmJhY2tiYXNlLnByZXNlbnRhdGlvbi5zZXJ2aWNlcy5hY2Nlc3Nncm91cHMucm91dGVzLmFwcHJvdmFsLkxpc3RQZW5kaW5nQXBwcm92YWxzUm91dGUgICogUm91dGUgSWQ6IExpc3RQZW5kaW5nQXBwcm92YWxzUm91dGUgICogUm91dGUgc291cmNlIGVuZHBvaW50OiBkaXJlY3Q6YnVzaW5lc3MuTGlzdFBlbmRpbmdBcHByb3ZhbHMgICogUm91dGUgZGVzdGluYXRpb24gZW5kcG9pbnQ6IGRpcmVjdDpsaXN0UGVuZGluZ0FwcHJvdmFsc1JlcXVlc3RlZEludGVybmFsXG4gICAgICogQHBhcmFtIHJlcXVlc3RQYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIG9ic2VydmUgc2V0IHdoZXRoZXIgb3Igbm90IHRvIHJldHVybiB0aGUgZGF0YSBPYnNlcnZhYmxlIGFzIHRoZSBib2R5LCByZXNwb25zZSBvciBldmVudHMuIGRlZmF1bHRzIHRvIHJldHVybmluZyB0aGUgYm9keS5cbiAgICAgKiBAcGFyYW0gcmVwb3J0UHJvZ3Jlc3MgZmxhZyB0byByZXBvcnQgcmVxdWVzdCBhbmQgcmVzcG9uc2UgcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHVibGljIGdldEFwcHJvdmFscyhyZXF1ZXN0UGFyYW1ldGVyczogR2V0QXBwcm92YWxzUmVxdWVzdFBhcmFtcywgb2JzZXJ2ZTogYW55ID0gJ2JvZHknLCByZXBvcnRQcm9ncmVzczogYm9vbGVhbiA9IGZhbHNlLCBvcHRpb25zPzoge2h0dHBIZWFkZXJBY2NlcHQ/OiAnYXBwbGljYXRpb24vanNvbid9KTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICAgICAgY29uc3QgX2Zyb20gPSByZXF1ZXN0UGFyYW1ldGVyc1tcImZyb21cIl07XG4gICAgICAgIGNvbnN0IF9jdXJzb3IgPSByZXF1ZXN0UGFyYW1ldGVyc1tcImN1cnNvclwiXTtcbiAgICAgICAgY29uc3QgX3NpemUgPSByZXF1ZXN0UGFyYW1ldGVyc1tcInNpemVcIl07XG5cbiAgICAgICAgbGV0IHF1ZXJ5UGFyYW1ldGVycyA9IG5ldyBIdHRwUGFyYW1zKHtlbmNvZGVyOiB0aGlzLmVuY29kZXJ9KTtcbiAgICAgICAgaWYgKF9mcm9tICE9PSB1bmRlZmluZWQgJiYgX2Zyb20gIT09IG51bGwpIHtcbiAgICAgICAgICBxdWVyeVBhcmFtZXRlcnMgPSB0aGlzLmFkZFRvSHR0cFBhcmFtcyhxdWVyeVBhcmFtZXRlcnMsXG4gICAgICAgICAgICA8YW55Pl9mcm9tLCAnZnJvbScpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChfY3Vyc29yICE9PSB1bmRlZmluZWQgJiYgX2N1cnNvciAhPT0gbnVsbCkge1xuICAgICAgICAgIHF1ZXJ5UGFyYW1ldGVycyA9IHRoaXMuYWRkVG9IdHRwUGFyYW1zKHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgICAgICAgIDxhbnk+X2N1cnNvciwgJ2N1cnNvcicpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChfc2l6ZSAhPT0gdW5kZWZpbmVkICYmIF9zaXplICE9PSBudWxsKSB7XG4gICAgICAgICAgcXVlcnlQYXJhbWV0ZXJzID0gdGhpcy5hZGRUb0h0dHBQYXJhbXMocXVlcnlQYXJhbWV0ZXJzLFxuICAgICAgICAgICAgPGFueT5fc2l6ZSwgJ3NpemUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBoZWFkZXJzID0gdGhpcy5kZWZhdWx0SGVhZGVycztcblxuICAgICAgICBsZXQgaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkOiBzdHJpbmcgfCB1bmRlZmluZWQgPSBvcHRpb25zICYmIG9wdGlvbnMuaHR0cEhlYWRlckFjY2VwdDtcbiAgICAgICAgaWYgKGh0dHBIZWFkZXJBY2NlcHRTZWxlY3RlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyB0byBkZXRlcm1pbmUgdGhlIEFjY2VwdCBoZWFkZXJcbiAgICAgICAgICAgIGNvbnN0IGh0dHBIZWFkZXJBY2NlcHRzOiBzdHJpbmdbXSA9IFtcbiAgICAgICAgICAgICAgICAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQgPSB0aGlzLmNvbmZpZ3VyYXRpb24uc2VsZWN0SGVhZGVyQWNjZXB0KGh0dHBIZWFkZXJBY2NlcHRzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGhlYWRlcnMgPSBoZWFkZXJzLnNldCgnQWNjZXB0JywgaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkKTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgbGV0IHJlc3BvbnNlVHlwZTogJ3RleHQnIHwgJ2pzb24nID0gJ2pzb24nO1xuICAgICAgICBpZihodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQgJiYgaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkLnN0YXJ0c1dpdGgoJ3RleHQnKSkge1xuICAgICAgICAgICAgcmVzcG9uc2VUeXBlID0gJ3RleHQnO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5nZXQ8QXJyYXk8UHJlc2VudGF0aW9uQXBwcm92YWxJdGVtPj4oYCR7dGhpcy5jb25maWd1cmF0aW9uLmJhc2VQYXRofS9jbGllbnQtYXBpL3YyL2FjY2Vzc2dyb3Vwcy9hcHByb3ZhbHNgLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhcmFtczogcXVlcnlQYXJhbWV0ZXJzLFxuICAgICAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogPGFueT5yZXNwb25zZVR5cGUsXG4gICAgICAgICAgICAgICAgd2l0aENyZWRlbnRpYWxzOiB0aGlzLmNvbmZpZ3VyYXRpb24ud2l0aENyZWRlbnRpYWxzLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZTogb2JzZXJ2ZSxcbiAgICAgICAgICAgICAgICByZXBvcnRQcm9ncmVzczogcmVwb3J0UHJvZ3Jlc3NcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0QXBwcm92YWxzVXJsKHJlcXVlc3RQYXJhbWV0ZXJzOiBHZXRBcHByb3ZhbHNSZXF1ZXN0UGFyYW1zKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgX2Zyb20gPSByZXF1ZXN0UGFyYW1ldGVyc1tcImZyb21cIl07XG4gICAgICAgIGNvbnN0IF9jdXJzb3IgPSByZXF1ZXN0UGFyYW1ldGVyc1tcImN1cnNvclwiXTtcbiAgICAgICAgY29uc3QgX3NpemUgPSByZXF1ZXN0UGFyYW1ldGVyc1tcInNpemVcIl07XG4gICAgICAgIGxldCBxdWVyeVBhcmFtZXRlcnMgPSBuZXcgSHR0cFBhcmFtcyh7ZW5jb2RlcjogdGhpcy5lbmNvZGVyfSk7XG4gICAgICAgIGlmIChfZnJvbSAhPT0gdW5kZWZpbmVkICYmIF9mcm9tICE9PSBudWxsKSB7XG4gICAgICAgICAgcXVlcnlQYXJhbWV0ZXJzID0gdGhpcy5hZGRUb0h0dHBQYXJhbXMocXVlcnlQYXJhbWV0ZXJzLFxuICAgICAgICAgICAgPGFueT5fZnJvbSwgJ2Zyb20nKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoX2N1cnNvciAhPT0gdW5kZWZpbmVkICYmIF9jdXJzb3IgIT09IG51bGwpIHtcbiAgICAgICAgICBxdWVyeVBhcmFtZXRlcnMgPSB0aGlzLmFkZFRvSHR0cFBhcmFtcyhxdWVyeVBhcmFtZXRlcnMsXG4gICAgICAgICAgICA8YW55Pl9jdXJzb3IsICdjdXJzb3InKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoX3NpemUgIT09IHVuZGVmaW5lZCAmJiBfc2l6ZSAhPT0gbnVsbCkge1xuICAgICAgICAgIHF1ZXJ5UGFyYW1ldGVycyA9IHRoaXMuYWRkVG9IdHRwUGFyYW1zKHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgICAgICAgIDxhbnk+X3NpemUsICdzaXplJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcXVlcnlTdHJpbmcgPSBxdWVyeVBhcmFtZXRlcnMudG9TdHJpbmcoKTtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuY29uZmlndXJhdGlvbi5iYXNlUGF0aH0vY2xpZW50LWFwaS92Mi9hY2Nlc3Nncm91cHMvYXBwcm92YWxzJHtxdWVyeVN0cmluZyA/IGA/JHtxdWVyeVN0cmluZ31gIDogJyd9YDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZSBkZXRhaWxzIGZvciBhcHByb3ZhbCAtICYjeDYwO0dFVCYjeDYwOy5cbiAgICAgKiAjUmV0cmlldmUgZGV0YWlscyBmb3IgYXBwcm92YWwgLSAmI3g2MDtHRVQmI3g2MDsgICAgIyMjRXh0ZW5kYWJpbGl0eSAgICBFeHRlbmRhYmxlIHVzaW5nIFJFU1QgZW5kcG9pbnQgaGFuZGxlcjogICAgICogRXh0ZW5kaW5nIGhhbmRsZXIgY2xhc3M6IGNvbS5iYWNrYmFzZS5wcmVzZW50YXRpb24uc2VydmljZXMuYWNjZXNzZ3JvdXBzLmJ1c2luZXNzLmZsb3dzLkdldERhdGFHcm91cEFwcHJvdmFsRGV0YWlsc0J5SWRGbG93ICBcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFBhcmFtZXRlcnNcbiAgICAgKiBAcGFyYW0gb2JzZXJ2ZSBzZXQgd2hldGhlciBvciBub3QgdG8gcmV0dXJuIHRoZSBkYXRhIE9ic2VydmFibGUgYXMgdGhlIGJvZHksIHJlc3BvbnNlIG9yIGV2ZW50cy4gZGVmYXVsdHMgdG8gcmV0dXJuaW5nIHRoZSBib2R5LlxuICAgICAqIEBwYXJhbSByZXBvcnRQcm9ncmVzcyBmbGFnIHRvIHJlcG9ydCByZXF1ZXN0IGFuZCByZXNwb25zZSBwcm9ncmVzcy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0UHJlc2VudGF0aW9uRGF0YUdyb3VwQXBwcm92YWxEZXRhaWxzSXRlbShyZXF1ZXN0UGFyYW1ldGVyczogR2V0UHJlc2VudGF0aW9uRGF0YUdyb3VwQXBwcm92YWxEZXRhaWxzSXRlbVJlcXVlc3RQYXJhbXMsIG9ic2VydmU/OiAnYm9keScsIHJlcG9ydFByb2dyZXNzPzogYm9vbGVhbiwgb3B0aW9ucz86IHtodHRwSGVhZGVyQWNjZXB0PzogJ2FwcGxpY2F0aW9uL2pzb24nfSk6IE9ic2VydmFibGU8UHJlc2VudGF0aW9uRGF0YUdyb3VwQXBwcm92YWxEZXRhaWxzSXRlbT47XG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgZGV0YWlscyBmb3IgYXBwcm92YWwgLSAmI3g2MDtHRVQmI3g2MDsuXG4gICAgICogI1JldHJpZXZlIGRldGFpbHMgZm9yIGFwcHJvdmFsIC0gJiN4NjA7R0VUJiN4NjA7ICAgICMjI0V4dGVuZGFiaWxpdHkgICAgRXh0ZW5kYWJsZSB1c2luZyBSRVNUIGVuZHBvaW50IGhhbmRsZXI6ICAgICAqIEV4dGVuZGluZyBoYW5kbGVyIGNsYXNzOiBjb20uYmFja2Jhc2UucHJlc2VudGF0aW9uLnNlcnZpY2VzLmFjY2Vzc2dyb3Vwcy5idXNpbmVzcy5mbG93cy5HZXREYXRhR3JvdXBBcHByb3ZhbERldGFpbHNCeUlkRmxvdyAgXG4gICAgICogQHBhcmFtIHJlcXVlc3RQYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIG9ic2VydmUgc2V0IHdoZXRoZXIgb3Igbm90IHRvIHJldHVybiB0aGUgZGF0YSBPYnNlcnZhYmxlIGFzIHRoZSBib2R5LCByZXNwb25zZSBvciBldmVudHMuIGRlZmF1bHRzIHRvIHJldHVybmluZyB0aGUgYm9keS5cbiAgICAgKiBAcGFyYW0gcmVwb3J0UHJvZ3Jlc3MgZmxhZyB0byByZXBvcnQgcmVxdWVzdCBhbmQgcmVzcG9uc2UgcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHVibGljIGdldFByZXNlbnRhdGlvbkRhdGFHcm91cEFwcHJvdmFsRGV0YWlsc0l0ZW0ocmVxdWVzdFBhcmFtZXRlcnM6IEdldFByZXNlbnRhdGlvbkRhdGFHcm91cEFwcHJvdmFsRGV0YWlsc0l0ZW1SZXF1ZXN0UGFyYW1zLCBvYnNlcnZlPzogJ3Jlc3BvbnNlJywgcmVwb3J0UHJvZ3Jlc3M/OiBib29sZWFuLCBvcHRpb25zPzoge2h0dHBIZWFkZXJBY2NlcHQ/OiAnYXBwbGljYXRpb24vanNvbid9KTogT2JzZXJ2YWJsZTxIdHRwUmVzcG9uc2U8UHJlc2VudGF0aW9uRGF0YUdyb3VwQXBwcm92YWxEZXRhaWxzSXRlbT4+O1xuICAgIC8qKlxuICAgICAqIFJldHJpZXZlIGRldGFpbHMgZm9yIGFwcHJvdmFsIC0gJiN4NjA7R0VUJiN4NjA7LlxuICAgICAqICNSZXRyaWV2ZSBkZXRhaWxzIGZvciBhcHByb3ZhbCAtICYjeDYwO0dFVCYjeDYwOyAgICAjIyNFeHRlbmRhYmlsaXR5ICAgIEV4dGVuZGFibGUgdXNpbmcgUkVTVCBlbmRwb2ludCBoYW5kbGVyOiAgICAgKiBFeHRlbmRpbmcgaGFuZGxlciBjbGFzczogY29tLmJhY2tiYXNlLnByZXNlbnRhdGlvbi5zZXJ2aWNlcy5hY2Nlc3Nncm91cHMuYnVzaW5lc3MuZmxvd3MuR2V0RGF0YUdyb3VwQXBwcm92YWxEZXRhaWxzQnlJZEZsb3cgIFxuICAgICAqIEBwYXJhbSByZXF1ZXN0UGFyYW1ldGVyc1xuICAgICAqIEBwYXJhbSBvYnNlcnZlIHNldCB3aGV0aGVyIG9yIG5vdCB0byByZXR1cm4gdGhlIGRhdGEgT2JzZXJ2YWJsZSBhcyB0aGUgYm9keSwgcmVzcG9uc2Ugb3IgZXZlbnRzLiBkZWZhdWx0cyB0byByZXR1cm5pbmcgdGhlIGJvZHkuXG4gICAgICogQHBhcmFtIHJlcG9ydFByb2dyZXNzIGZsYWcgdG8gcmVwb3J0IHJlcXVlc3QgYW5kIHJlc3BvbnNlIHByb2dyZXNzLlxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRQcmVzZW50YXRpb25EYXRhR3JvdXBBcHByb3ZhbERldGFpbHNJdGVtKHJlcXVlc3RQYXJhbWV0ZXJzOiBHZXRQcmVzZW50YXRpb25EYXRhR3JvdXBBcHByb3ZhbERldGFpbHNJdGVtUmVxdWVzdFBhcmFtcywgb2JzZXJ2ZT86ICdldmVudHMnLCByZXBvcnRQcm9ncmVzcz86IGJvb2xlYW4sIG9wdGlvbnM/OiB7aHR0cEhlYWRlckFjY2VwdD86ICdhcHBsaWNhdGlvbi9qc29uJ30pOiBPYnNlcnZhYmxlPEh0dHBFdmVudDxQcmVzZW50YXRpb25EYXRhR3JvdXBBcHByb3ZhbERldGFpbHNJdGVtPj47XG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgZGV0YWlscyBmb3IgYXBwcm92YWwgLSAmI3g2MDtHRVQmI3g2MDsuXG4gICAgICogI1JldHJpZXZlIGRldGFpbHMgZm9yIGFwcHJvdmFsIC0gJiN4NjA7R0VUJiN4NjA7ICAgICMjI0V4dGVuZGFiaWxpdHkgICAgRXh0ZW5kYWJsZSB1c2luZyBSRVNUIGVuZHBvaW50IGhhbmRsZXI6ICAgICAqIEV4dGVuZGluZyBoYW5kbGVyIGNsYXNzOiBjb20uYmFja2Jhc2UucHJlc2VudGF0aW9uLnNlcnZpY2VzLmFjY2Vzc2dyb3Vwcy5idXNpbmVzcy5mbG93cy5HZXREYXRhR3JvdXBBcHByb3ZhbERldGFpbHNCeUlkRmxvdyAgXG4gICAgICogQHBhcmFtIHJlcXVlc3RQYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIG9ic2VydmUgc2V0IHdoZXRoZXIgb3Igbm90IHRvIHJldHVybiB0aGUgZGF0YSBPYnNlcnZhYmxlIGFzIHRoZSBib2R5LCByZXNwb25zZSBvciBldmVudHMuIGRlZmF1bHRzIHRvIHJldHVybmluZyB0aGUgYm9keS5cbiAgICAgKiBAcGFyYW0gcmVwb3J0UHJvZ3Jlc3MgZmxhZyB0byByZXBvcnQgcmVxdWVzdCBhbmQgcmVzcG9uc2UgcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHVibGljIGdldFByZXNlbnRhdGlvbkRhdGFHcm91cEFwcHJvdmFsRGV0YWlsc0l0ZW0ocmVxdWVzdFBhcmFtZXRlcnM6IEdldFByZXNlbnRhdGlvbkRhdGFHcm91cEFwcHJvdmFsRGV0YWlsc0l0ZW1SZXF1ZXN0UGFyYW1zLCBvYnNlcnZlOiBhbnkgPSAnYm9keScsIHJlcG9ydFByb2dyZXNzOiBib29sZWFuID0gZmFsc2UsIG9wdGlvbnM/OiB7aHR0cEhlYWRlckFjY2VwdD86ICdhcHBsaWNhdGlvbi9qc29uJ30pOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICBjb25zdCBfYXBwcm92YWxJZCA9IHJlcXVlc3RQYXJhbWV0ZXJzW1wiYXBwcm92YWxJZFwiXTtcbiAgICAgICAgaWYgKF9hcHByb3ZhbElkID09PSBudWxsIHx8IF9hcHByb3ZhbElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcHJvdmFsSWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRQcmVzZW50YXRpb25EYXRhR3JvdXBBcHByb3ZhbERldGFpbHNJdGVtLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGhlYWRlcnMgPSB0aGlzLmRlZmF1bHRIZWFkZXJzO1xuXG4gICAgICAgIGxldCBodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQ6IHN0cmluZyB8IHVuZGVmaW5lZCA9IG9wdGlvbnMgJiYgb3B0aW9ucy5odHRwSGVhZGVyQWNjZXB0O1xuICAgICAgICBpZiAoaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIC8vIHRvIGRldGVybWluZSB0aGUgQWNjZXB0IGhlYWRlclxuICAgICAgICAgICAgY29uc3QgaHR0cEhlYWRlckFjY2VwdHM6IHN0cmluZ1tdID0gW1xuICAgICAgICAgICAgICAgICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIGh0dHBIZWFkZXJBY2NlcHRTZWxlY3RlZCA9IHRoaXMuY29uZmlndXJhdGlvbi5zZWxlY3RIZWFkZXJBY2NlcHQoaHR0cEhlYWRlckFjY2VwdHMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaGVhZGVycyA9IGhlYWRlcnMuc2V0KCdBY2NlcHQnLCBodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQpO1xuICAgICAgICB9XG5cblxuICAgICAgICBsZXQgcmVzcG9uc2VUeXBlOiAndGV4dCcgfCAnanNvbicgPSAnanNvbic7XG4gICAgICAgIGlmKGh0dHBIZWFkZXJBY2NlcHRTZWxlY3RlZCAmJiBodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQuc3RhcnRzV2l0aCgndGV4dCcpKSB7XG4gICAgICAgICAgICByZXNwb25zZVR5cGUgPSAndGV4dCc7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5odHRwQ2xpZW50LmdldDxQcmVzZW50YXRpb25EYXRhR3JvdXBBcHByb3ZhbERldGFpbHNJdGVtPihgJHt0aGlzLmNvbmZpZ3VyYXRpb24uYmFzZVBhdGh9L2NsaWVudC1hcGkvdjIvYWNjZXNzZ3JvdXBzL2FwcHJvdmFscy8ke2VuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoX2FwcHJvdmFsSWQpKX0vZGF0YS1ncm91cGAsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiA8YW55PnJlc3BvbnNlVHlwZSxcbiAgICAgICAgICAgICAgICB3aXRoQ3JlZGVudGlhbHM6IHRoaXMuY29uZmlndXJhdGlvbi53aXRoQ3JlZGVudGlhbHMsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcbiAgICAgICAgICAgICAgICBvYnNlcnZlOiBvYnNlcnZlLFxuICAgICAgICAgICAgICAgIHJlcG9ydFByb2dyZXNzOiByZXBvcnRQcm9ncmVzc1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRQcmVzZW50YXRpb25EYXRhR3JvdXBBcHByb3ZhbERldGFpbHNJdGVtVXJsKHJlcXVlc3RQYXJhbWV0ZXJzOiBHZXRQcmVzZW50YXRpb25EYXRhR3JvdXBBcHByb3ZhbERldGFpbHNJdGVtUmVxdWVzdFBhcmFtcyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IF9hcHByb3ZhbElkID0gcmVxdWVzdFBhcmFtZXRlcnNbXCJhcHByb3ZhbElkXCJdO1xuICAgICAgICBpZiAoX2FwcHJvdmFsSWQgPT09IG51bGwgfHwgX2FwcHJvdmFsSWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwcm92YWxJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGdldFByZXNlbnRhdGlvbkRhdGFHcm91cEFwcHJvdmFsRGV0YWlsc0l0ZW0uJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGAke3RoaXMuY29uZmlndXJhdGlvbi5iYXNlUGF0aH0vY2xpZW50LWFwaS92Mi9hY2Nlc3Nncm91cHMvYXBwcm92YWxzLyR7ZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhfYXBwcm92YWxJZCkpfS9kYXRhLWdyb3VwYDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZSBqb2Igcm9sZSBkZXRhaWxzIGZvciBhcHByb3ZhbCAtICYjeDYwO0dFVCYjeDYwOy5cbiAgICAgKiAjUmV0cmlldmUgam9iIHJvbGUgZGV0YWlscyBmb3IgYXBwcm92YWwgLSAmI3g2MDtHRVQmI3g2MDsgICAgIyMjRXh0ZW5kYWJpbGl0eSAgICBFeHRlbmRhYmxlIHVzaW5nIFJFU1QgZW5kcG9pbnQgaGFuZGxlcjogICAgICogRXh0ZW5kaW5nIGhhbmRsZXIgY2xhc3M6IGNvbS5iYWNrYmFzZS5wcmVzZW50YXRpb24uc2VydmljZXMuYWNjZXNzZ3JvdXBzLmJ1c2luZXNzLmZsb3dzLkdldEZ1bmN0aW9uR3JvdXBBcHByb3ZhbERldGFpbHNCeUlkRmxvdyAgXG4gICAgICogQHBhcmFtIHJlcXVlc3RQYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIG9ic2VydmUgc2V0IHdoZXRoZXIgb3Igbm90IHRvIHJldHVybiB0aGUgZGF0YSBPYnNlcnZhYmxlIGFzIHRoZSBib2R5LCByZXNwb25zZSBvciBldmVudHMuIGRlZmF1bHRzIHRvIHJldHVybmluZyB0aGUgYm9keS5cbiAgICAgKiBAcGFyYW0gcmVwb3J0UHJvZ3Jlc3MgZmxhZyB0byByZXBvcnQgcmVxdWVzdCBhbmQgcmVzcG9uc2UgcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHVibGljIGdldFByZXNlbnRhdGlvbkZ1bmN0aW9uR3JvdXBBcHByb3ZhbERldGFpbHNJdGVtKHJlcXVlc3RQYXJhbWV0ZXJzOiBHZXRQcmVzZW50YXRpb25GdW5jdGlvbkdyb3VwQXBwcm92YWxEZXRhaWxzSXRlbVJlcXVlc3RQYXJhbXMsIG9ic2VydmU/OiAnYm9keScsIHJlcG9ydFByb2dyZXNzPzogYm9vbGVhbiwgb3B0aW9ucz86IHtodHRwSGVhZGVyQWNjZXB0PzogJ2FwcGxpY2F0aW9uL2pzb24nfSk6IE9ic2VydmFibGU8UHJlc2VudGF0aW9uRnVuY3Rpb25Hcm91cEFwcHJvdmFsRGV0YWlsc0l0ZW0+O1xuICAgIC8qKlxuICAgICAqIFJldHJpZXZlIGpvYiByb2xlIGRldGFpbHMgZm9yIGFwcHJvdmFsIC0gJiN4NjA7R0VUJiN4NjA7LlxuICAgICAqICNSZXRyaWV2ZSBqb2Igcm9sZSBkZXRhaWxzIGZvciBhcHByb3ZhbCAtICYjeDYwO0dFVCYjeDYwOyAgICAjIyNFeHRlbmRhYmlsaXR5ICAgIEV4dGVuZGFibGUgdXNpbmcgUkVTVCBlbmRwb2ludCBoYW5kbGVyOiAgICAgKiBFeHRlbmRpbmcgaGFuZGxlciBjbGFzczogY29tLmJhY2tiYXNlLnByZXNlbnRhdGlvbi5zZXJ2aWNlcy5hY2Nlc3Nncm91cHMuYnVzaW5lc3MuZmxvd3MuR2V0RnVuY3Rpb25Hcm91cEFwcHJvdmFsRGV0YWlsc0J5SWRGbG93ICBcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFBhcmFtZXRlcnNcbiAgICAgKiBAcGFyYW0gb2JzZXJ2ZSBzZXQgd2hldGhlciBvciBub3QgdG8gcmV0dXJuIHRoZSBkYXRhIE9ic2VydmFibGUgYXMgdGhlIGJvZHksIHJlc3BvbnNlIG9yIGV2ZW50cy4gZGVmYXVsdHMgdG8gcmV0dXJuaW5nIHRoZSBib2R5LlxuICAgICAqIEBwYXJhbSByZXBvcnRQcm9ncmVzcyBmbGFnIHRvIHJlcG9ydCByZXF1ZXN0IGFuZCByZXNwb25zZSBwcm9ncmVzcy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0UHJlc2VudGF0aW9uRnVuY3Rpb25Hcm91cEFwcHJvdmFsRGV0YWlsc0l0ZW0ocmVxdWVzdFBhcmFtZXRlcnM6IEdldFByZXNlbnRhdGlvbkZ1bmN0aW9uR3JvdXBBcHByb3ZhbERldGFpbHNJdGVtUmVxdWVzdFBhcmFtcywgb2JzZXJ2ZT86ICdyZXNwb25zZScsIHJlcG9ydFByb2dyZXNzPzogYm9vbGVhbiwgb3B0aW9ucz86IHtodHRwSGVhZGVyQWNjZXB0PzogJ2FwcGxpY2F0aW9uL2pzb24nfSk6IE9ic2VydmFibGU8SHR0cFJlc3BvbnNlPFByZXNlbnRhdGlvbkZ1bmN0aW9uR3JvdXBBcHByb3ZhbERldGFpbHNJdGVtPj47XG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgam9iIHJvbGUgZGV0YWlscyBmb3IgYXBwcm92YWwgLSAmI3g2MDtHRVQmI3g2MDsuXG4gICAgICogI1JldHJpZXZlIGpvYiByb2xlIGRldGFpbHMgZm9yIGFwcHJvdmFsIC0gJiN4NjA7R0VUJiN4NjA7ICAgICMjI0V4dGVuZGFiaWxpdHkgICAgRXh0ZW5kYWJsZSB1c2luZyBSRVNUIGVuZHBvaW50IGhhbmRsZXI6ICAgICAqIEV4dGVuZGluZyBoYW5kbGVyIGNsYXNzOiBjb20uYmFja2Jhc2UucHJlc2VudGF0aW9uLnNlcnZpY2VzLmFjY2Vzc2dyb3Vwcy5idXNpbmVzcy5mbG93cy5HZXRGdW5jdGlvbkdyb3VwQXBwcm92YWxEZXRhaWxzQnlJZEZsb3cgIFxuICAgICAqIEBwYXJhbSByZXF1ZXN0UGFyYW1ldGVyc1xuICAgICAqIEBwYXJhbSBvYnNlcnZlIHNldCB3aGV0aGVyIG9yIG5vdCB0byByZXR1cm4gdGhlIGRhdGEgT2JzZXJ2YWJsZSBhcyB0aGUgYm9keSwgcmVzcG9uc2Ugb3IgZXZlbnRzLiBkZWZhdWx0cyB0byByZXR1cm5pbmcgdGhlIGJvZHkuXG4gICAgICogQHBhcmFtIHJlcG9ydFByb2dyZXNzIGZsYWcgdG8gcmVwb3J0IHJlcXVlc3QgYW5kIHJlc3BvbnNlIHByb2dyZXNzLlxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRQcmVzZW50YXRpb25GdW5jdGlvbkdyb3VwQXBwcm92YWxEZXRhaWxzSXRlbShyZXF1ZXN0UGFyYW1ldGVyczogR2V0UHJlc2VudGF0aW9uRnVuY3Rpb25Hcm91cEFwcHJvdmFsRGV0YWlsc0l0ZW1SZXF1ZXN0UGFyYW1zLCBvYnNlcnZlPzogJ2V2ZW50cycsIHJlcG9ydFByb2dyZXNzPzogYm9vbGVhbiwgb3B0aW9ucz86IHtodHRwSGVhZGVyQWNjZXB0PzogJ2FwcGxpY2F0aW9uL2pzb24nfSk6IE9ic2VydmFibGU8SHR0cEV2ZW50PFByZXNlbnRhdGlvbkZ1bmN0aW9uR3JvdXBBcHByb3ZhbERldGFpbHNJdGVtPj47XG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgam9iIHJvbGUgZGV0YWlscyBmb3IgYXBwcm92YWwgLSAmI3g2MDtHRVQmI3g2MDsuXG4gICAgICogI1JldHJpZXZlIGpvYiByb2xlIGRldGFpbHMgZm9yIGFwcHJvdmFsIC0gJiN4NjA7R0VUJiN4NjA7ICAgICMjI0V4dGVuZGFiaWxpdHkgICAgRXh0ZW5kYWJsZSB1c2luZyBSRVNUIGVuZHBvaW50IGhhbmRsZXI6ICAgICAqIEV4dGVuZGluZyBoYW5kbGVyIGNsYXNzOiBjb20uYmFja2Jhc2UucHJlc2VudGF0aW9uLnNlcnZpY2VzLmFjY2Vzc2dyb3Vwcy5idXNpbmVzcy5mbG93cy5HZXRGdW5jdGlvbkdyb3VwQXBwcm92YWxEZXRhaWxzQnlJZEZsb3cgIFxuICAgICAqIEBwYXJhbSByZXF1ZXN0UGFyYW1ldGVyc1xuICAgICAqIEBwYXJhbSBvYnNlcnZlIHNldCB3aGV0aGVyIG9yIG5vdCB0byByZXR1cm4gdGhlIGRhdGEgT2JzZXJ2YWJsZSBhcyB0aGUgYm9keSwgcmVzcG9uc2Ugb3IgZXZlbnRzLiBkZWZhdWx0cyB0byByZXR1cm5pbmcgdGhlIGJvZHkuXG4gICAgICogQHBhcmFtIHJlcG9ydFByb2dyZXNzIGZsYWcgdG8gcmVwb3J0IHJlcXVlc3QgYW5kIHJlc3BvbnNlIHByb2dyZXNzLlxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRQcmVzZW50YXRpb25GdW5jdGlvbkdyb3VwQXBwcm92YWxEZXRhaWxzSXRlbShyZXF1ZXN0UGFyYW1ldGVyczogR2V0UHJlc2VudGF0aW9uRnVuY3Rpb25Hcm91cEFwcHJvdmFsRGV0YWlsc0l0ZW1SZXF1ZXN0UGFyYW1zLCBvYnNlcnZlOiBhbnkgPSAnYm9keScsIHJlcG9ydFByb2dyZXNzOiBib29sZWFuID0gZmFsc2UsIG9wdGlvbnM/OiB7aHR0cEhlYWRlckFjY2VwdD86ICdhcHBsaWNhdGlvbi9qc29uJ30pOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICBjb25zdCBfYXBwcm92YWxJZCA9IHJlcXVlc3RQYXJhbWV0ZXJzW1wiYXBwcm92YWxJZFwiXTtcbiAgICAgICAgaWYgKF9hcHByb3ZhbElkID09PSBudWxsIHx8IF9hcHByb3ZhbElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcHJvdmFsSWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRQcmVzZW50YXRpb25GdW5jdGlvbkdyb3VwQXBwcm92YWxEZXRhaWxzSXRlbS4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBoZWFkZXJzID0gdGhpcy5kZWZhdWx0SGVhZGVycztcblxuICAgICAgICBsZXQgaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkOiBzdHJpbmcgfCB1bmRlZmluZWQgPSBvcHRpb25zICYmIG9wdGlvbnMuaHR0cEhlYWRlckFjY2VwdDtcbiAgICAgICAgaWYgKGh0dHBIZWFkZXJBY2NlcHRTZWxlY3RlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyB0byBkZXRlcm1pbmUgdGhlIEFjY2VwdCBoZWFkZXJcbiAgICAgICAgICAgIGNvbnN0IGh0dHBIZWFkZXJBY2NlcHRzOiBzdHJpbmdbXSA9IFtcbiAgICAgICAgICAgICAgICAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQgPSB0aGlzLmNvbmZpZ3VyYXRpb24uc2VsZWN0SGVhZGVyQWNjZXB0KGh0dHBIZWFkZXJBY2NlcHRzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGhlYWRlcnMgPSBoZWFkZXJzLnNldCgnQWNjZXB0JywgaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkKTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgbGV0IHJlc3BvbnNlVHlwZTogJ3RleHQnIHwgJ2pzb24nID0gJ2pzb24nO1xuICAgICAgICBpZihodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQgJiYgaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkLnN0YXJ0c1dpdGgoJ3RleHQnKSkge1xuICAgICAgICAgICAgcmVzcG9uc2VUeXBlID0gJ3RleHQnO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5nZXQ8UHJlc2VudGF0aW9uRnVuY3Rpb25Hcm91cEFwcHJvdmFsRGV0YWlsc0l0ZW0+KGAke3RoaXMuY29uZmlndXJhdGlvbi5iYXNlUGF0aH0vY2xpZW50LWFwaS92Mi9hY2Nlc3Nncm91cHMvYXBwcm92YWxzLyR7ZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhfYXBwcm92YWxJZCkpfS9mdW5jdGlvbi1ncm91cGAsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiA8YW55PnJlc3BvbnNlVHlwZSxcbiAgICAgICAgICAgICAgICB3aXRoQ3JlZGVudGlhbHM6IHRoaXMuY29uZmlndXJhdGlvbi53aXRoQ3JlZGVudGlhbHMsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcbiAgICAgICAgICAgICAgICBvYnNlcnZlOiBvYnNlcnZlLFxuICAgICAgICAgICAgICAgIHJlcG9ydFByb2dyZXNzOiByZXBvcnRQcm9ncmVzc1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRQcmVzZW50YXRpb25GdW5jdGlvbkdyb3VwQXBwcm92YWxEZXRhaWxzSXRlbVVybChyZXF1ZXN0UGFyYW1ldGVyczogR2V0UHJlc2VudGF0aW9uRnVuY3Rpb25Hcm91cEFwcHJvdmFsRGV0YWlsc0l0ZW1SZXF1ZXN0UGFyYW1zKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgX2FwcHJvdmFsSWQgPSByZXF1ZXN0UGFyYW1ldGVyc1tcImFwcHJvdmFsSWRcIl07XG4gICAgICAgIGlmIChfYXBwcm92YWxJZCA9PT0gbnVsbCB8fCBfYXBwcm92YWxJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHByb3ZhbElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZ2V0UHJlc2VudGF0aW9uRnVuY3Rpb25Hcm91cEFwcHJvdmFsRGV0YWlsc0l0ZW0uJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGAke3RoaXMuY29uZmlndXJhdGlvbi5iYXNlUGF0aH0vY2xpZW50LWFwaS92Mi9hY2Nlc3Nncm91cHMvYXBwcm92YWxzLyR7ZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhfYXBwcm92YWxJZCkpfS9mdW5jdGlvbi1ncm91cGA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgZGV0YWlscyBmb3IgYXBwcm92YWwgLSAmI3g2MDtHRVQmI3g2MDsuXG4gICAgICogI1JldHJpZXZlIGRldGFpbHMgZm9yIGFwcHJvdmFsIC0gJiN4NjA7R0VUJiN4NjA7ICAgICMjI0V4dGVuZGFiaWxpdHkgICAgRXh0ZW5kYWJsZSB1c2luZyBBcGFjaGUgQ2FtZWw6ICAgICogUm91dGUgQ2xhc3M6IGNvbS5iYWNrYmFzZS5wcmVzZW50YXRpb24uc2VydmljZXMuYWNjZXNzZ3JvdXBzLnJvdXRlcy5hcHByb3ZhbC5HZXRQZXJtaXNzaW9uc0FwcHJvdmFsRGV0YWlsc0J5SWRSb3V0ZSAgKiBSb3V0ZSBJZDogR2V0UGVybWlzc2lvbnNBcHByb3ZhbERldGFpbHNCeUlkUm91dGUgICogUm91dGUgc291cmNlIGVuZHBvaW50OiBkaXJlY3Q6YnVzaW5lc3MuR2V0QXBwcm92YWxCeUlkICAqIFJvdXRlIGRlc3RpbmF0aW9uIGVuZHBvaW50OiBkaXJlY3Q6Z2V0QXBwcm92YWxCeUlkUmVxdWVzdGVkSW50ZXJuYWxcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFBhcmFtZXRlcnNcbiAgICAgKiBAcGFyYW0gb2JzZXJ2ZSBzZXQgd2hldGhlciBvciBub3QgdG8gcmV0dXJuIHRoZSBkYXRhIE9ic2VydmFibGUgYXMgdGhlIGJvZHksIHJlc3BvbnNlIG9yIGV2ZW50cy4gZGVmYXVsdHMgdG8gcmV0dXJuaW5nIHRoZSBib2R5LlxuICAgICAqIEBwYXJhbSByZXBvcnRQcm9ncmVzcyBmbGFnIHRvIHJlcG9ydCByZXF1ZXN0IGFuZCByZXNwb25zZSBwcm9ncmVzcy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0UHJlc2VudGF0aW9uUGVybWlzc2lvbnNBcHByb3ZhbERldGFpbHNJdGVtKHJlcXVlc3RQYXJhbWV0ZXJzOiBHZXRQcmVzZW50YXRpb25QZXJtaXNzaW9uc0FwcHJvdmFsRGV0YWlsc0l0ZW1SZXF1ZXN0UGFyYW1zLCBvYnNlcnZlPzogJ2JvZHknLCByZXBvcnRQcm9ncmVzcz86IGJvb2xlYW4sIG9wdGlvbnM/OiB7aHR0cEhlYWRlckFjY2VwdD86ICdhcHBsaWNhdGlvbi9qc29uJ30pOiBPYnNlcnZhYmxlPFByZXNlbnRhdGlvblBlcm1pc3Npb25zQXBwcm92YWxEZXRhaWxzSXRlbT47XG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgZGV0YWlscyBmb3IgYXBwcm92YWwgLSAmI3g2MDtHRVQmI3g2MDsuXG4gICAgICogI1JldHJpZXZlIGRldGFpbHMgZm9yIGFwcHJvdmFsIC0gJiN4NjA7R0VUJiN4NjA7ICAgICMjI0V4dGVuZGFiaWxpdHkgICAgRXh0ZW5kYWJsZSB1c2luZyBBcGFjaGUgQ2FtZWw6ICAgICogUm91dGUgQ2xhc3M6IGNvbS5iYWNrYmFzZS5wcmVzZW50YXRpb24uc2VydmljZXMuYWNjZXNzZ3JvdXBzLnJvdXRlcy5hcHByb3ZhbC5HZXRQZXJtaXNzaW9uc0FwcHJvdmFsRGV0YWlsc0J5SWRSb3V0ZSAgKiBSb3V0ZSBJZDogR2V0UGVybWlzc2lvbnNBcHByb3ZhbERldGFpbHNCeUlkUm91dGUgICogUm91dGUgc291cmNlIGVuZHBvaW50OiBkaXJlY3Q6YnVzaW5lc3MuR2V0QXBwcm92YWxCeUlkICAqIFJvdXRlIGRlc3RpbmF0aW9uIGVuZHBvaW50OiBkaXJlY3Q6Z2V0QXBwcm92YWxCeUlkUmVxdWVzdGVkSW50ZXJuYWxcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFBhcmFtZXRlcnNcbiAgICAgKiBAcGFyYW0gb2JzZXJ2ZSBzZXQgd2hldGhlciBvciBub3QgdG8gcmV0dXJuIHRoZSBkYXRhIE9ic2VydmFibGUgYXMgdGhlIGJvZHksIHJlc3BvbnNlIG9yIGV2ZW50cy4gZGVmYXVsdHMgdG8gcmV0dXJuaW5nIHRoZSBib2R5LlxuICAgICAqIEBwYXJhbSByZXBvcnRQcm9ncmVzcyBmbGFnIHRvIHJlcG9ydCByZXF1ZXN0IGFuZCByZXNwb25zZSBwcm9ncmVzcy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0UHJlc2VudGF0aW9uUGVybWlzc2lvbnNBcHByb3ZhbERldGFpbHNJdGVtKHJlcXVlc3RQYXJhbWV0ZXJzOiBHZXRQcmVzZW50YXRpb25QZXJtaXNzaW9uc0FwcHJvdmFsRGV0YWlsc0l0ZW1SZXF1ZXN0UGFyYW1zLCBvYnNlcnZlPzogJ3Jlc3BvbnNlJywgcmVwb3J0UHJvZ3Jlc3M/OiBib29sZWFuLCBvcHRpb25zPzoge2h0dHBIZWFkZXJBY2NlcHQ/OiAnYXBwbGljYXRpb24vanNvbid9KTogT2JzZXJ2YWJsZTxIdHRwUmVzcG9uc2U8UHJlc2VudGF0aW9uUGVybWlzc2lvbnNBcHByb3ZhbERldGFpbHNJdGVtPj47XG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgZGV0YWlscyBmb3IgYXBwcm92YWwgLSAmI3g2MDtHRVQmI3g2MDsuXG4gICAgICogI1JldHJpZXZlIGRldGFpbHMgZm9yIGFwcHJvdmFsIC0gJiN4NjA7R0VUJiN4NjA7ICAgICMjI0V4dGVuZGFiaWxpdHkgICAgRXh0ZW5kYWJsZSB1c2luZyBBcGFjaGUgQ2FtZWw6ICAgICogUm91dGUgQ2xhc3M6IGNvbS5iYWNrYmFzZS5wcmVzZW50YXRpb24uc2VydmljZXMuYWNjZXNzZ3JvdXBzLnJvdXRlcy5hcHByb3ZhbC5HZXRQZXJtaXNzaW9uc0FwcHJvdmFsRGV0YWlsc0J5SWRSb3V0ZSAgKiBSb3V0ZSBJZDogR2V0UGVybWlzc2lvbnNBcHByb3ZhbERldGFpbHNCeUlkUm91dGUgICogUm91dGUgc291cmNlIGVuZHBvaW50OiBkaXJlY3Q6YnVzaW5lc3MuR2V0QXBwcm92YWxCeUlkICAqIFJvdXRlIGRlc3RpbmF0aW9uIGVuZHBvaW50OiBkaXJlY3Q6Z2V0QXBwcm92YWxCeUlkUmVxdWVzdGVkSW50ZXJuYWxcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFBhcmFtZXRlcnNcbiAgICAgKiBAcGFyYW0gb2JzZXJ2ZSBzZXQgd2hldGhlciBvciBub3QgdG8gcmV0dXJuIHRoZSBkYXRhIE9ic2VydmFibGUgYXMgdGhlIGJvZHksIHJlc3BvbnNlIG9yIGV2ZW50cy4gZGVmYXVsdHMgdG8gcmV0dXJuaW5nIHRoZSBib2R5LlxuICAgICAqIEBwYXJhbSByZXBvcnRQcm9ncmVzcyBmbGFnIHRvIHJlcG9ydCByZXF1ZXN0IGFuZCByZXNwb25zZSBwcm9ncmVzcy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0UHJlc2VudGF0aW9uUGVybWlzc2lvbnNBcHByb3ZhbERldGFpbHNJdGVtKHJlcXVlc3RQYXJhbWV0ZXJzOiBHZXRQcmVzZW50YXRpb25QZXJtaXNzaW9uc0FwcHJvdmFsRGV0YWlsc0l0ZW1SZXF1ZXN0UGFyYW1zLCBvYnNlcnZlPzogJ2V2ZW50cycsIHJlcG9ydFByb2dyZXNzPzogYm9vbGVhbiwgb3B0aW9ucz86IHtodHRwSGVhZGVyQWNjZXB0PzogJ2FwcGxpY2F0aW9uL2pzb24nfSk6IE9ic2VydmFibGU8SHR0cEV2ZW50PFByZXNlbnRhdGlvblBlcm1pc3Npb25zQXBwcm92YWxEZXRhaWxzSXRlbT4+O1xuICAgIC8qKlxuICAgICAqIFJldHJpZXZlIGRldGFpbHMgZm9yIGFwcHJvdmFsIC0gJiN4NjA7R0VUJiN4NjA7LlxuICAgICAqICNSZXRyaWV2ZSBkZXRhaWxzIGZvciBhcHByb3ZhbCAtICYjeDYwO0dFVCYjeDYwOyAgICAjIyNFeHRlbmRhYmlsaXR5ICAgIEV4dGVuZGFibGUgdXNpbmcgQXBhY2hlIENhbWVsOiAgICAqIFJvdXRlIENsYXNzOiBjb20uYmFja2Jhc2UucHJlc2VudGF0aW9uLnNlcnZpY2VzLmFjY2Vzc2dyb3Vwcy5yb3V0ZXMuYXBwcm92YWwuR2V0UGVybWlzc2lvbnNBcHByb3ZhbERldGFpbHNCeUlkUm91dGUgICogUm91dGUgSWQ6IEdldFBlcm1pc3Npb25zQXBwcm92YWxEZXRhaWxzQnlJZFJvdXRlICAqIFJvdXRlIHNvdXJjZSBlbmRwb2ludDogZGlyZWN0OmJ1c2luZXNzLkdldEFwcHJvdmFsQnlJZCAgKiBSb3V0ZSBkZXN0aW5hdGlvbiBlbmRwb2ludDogZGlyZWN0OmdldEFwcHJvdmFsQnlJZFJlcXVlc3RlZEludGVybmFsXG4gICAgICogQHBhcmFtIHJlcXVlc3RQYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIG9ic2VydmUgc2V0IHdoZXRoZXIgb3Igbm90IHRvIHJldHVybiB0aGUgZGF0YSBPYnNlcnZhYmxlIGFzIHRoZSBib2R5LCByZXNwb25zZSBvciBldmVudHMuIGRlZmF1bHRzIHRvIHJldHVybmluZyB0aGUgYm9keS5cbiAgICAgKiBAcGFyYW0gcmVwb3J0UHJvZ3Jlc3MgZmxhZyB0byByZXBvcnQgcmVxdWVzdCBhbmQgcmVzcG9uc2UgcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHVibGljIGdldFByZXNlbnRhdGlvblBlcm1pc3Npb25zQXBwcm92YWxEZXRhaWxzSXRlbShyZXF1ZXN0UGFyYW1ldGVyczogR2V0UHJlc2VudGF0aW9uUGVybWlzc2lvbnNBcHByb3ZhbERldGFpbHNJdGVtUmVxdWVzdFBhcmFtcywgb2JzZXJ2ZTogYW55ID0gJ2JvZHknLCByZXBvcnRQcm9ncmVzczogYm9vbGVhbiA9IGZhbHNlLCBvcHRpb25zPzoge2h0dHBIZWFkZXJBY2NlcHQ/OiAnYXBwbGljYXRpb24vanNvbid9KTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICAgICAgY29uc3QgX2FwcHJvdmFsSWQgPSByZXF1ZXN0UGFyYW1ldGVyc1tcImFwcHJvdmFsSWRcIl07XG4gICAgICAgIGlmIChfYXBwcm92YWxJZCA9PT0gbnVsbCB8fCBfYXBwcm92YWxJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHByb3ZhbElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZ2V0UHJlc2VudGF0aW9uUGVybWlzc2lvbnNBcHByb3ZhbERldGFpbHNJdGVtLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGhlYWRlcnMgPSB0aGlzLmRlZmF1bHRIZWFkZXJzO1xuXG4gICAgICAgIGxldCBodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQ6IHN0cmluZyB8IHVuZGVmaW5lZCA9IG9wdGlvbnMgJiYgb3B0aW9ucy5odHRwSGVhZGVyQWNjZXB0O1xuICAgICAgICBpZiAoaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIC8vIHRvIGRldGVybWluZSB0aGUgQWNjZXB0IGhlYWRlclxuICAgICAgICAgICAgY29uc3QgaHR0cEhlYWRlckFjY2VwdHM6IHN0cmluZ1tdID0gW1xuICAgICAgICAgICAgICAgICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIGh0dHBIZWFkZXJBY2NlcHRTZWxlY3RlZCA9IHRoaXMuY29uZmlndXJhdGlvbi5zZWxlY3RIZWFkZXJBY2NlcHQoaHR0cEhlYWRlckFjY2VwdHMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaGVhZGVycyA9IGhlYWRlcnMuc2V0KCdBY2NlcHQnLCBodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQpO1xuICAgICAgICB9XG5cblxuICAgICAgICBsZXQgcmVzcG9uc2VUeXBlOiAndGV4dCcgfCAnanNvbicgPSAnanNvbic7XG4gICAgICAgIGlmKGh0dHBIZWFkZXJBY2NlcHRTZWxlY3RlZCAmJiBodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQuc3RhcnRzV2l0aCgndGV4dCcpKSB7XG4gICAgICAgICAgICByZXNwb25zZVR5cGUgPSAndGV4dCc7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5odHRwQ2xpZW50LmdldDxQcmVzZW50YXRpb25QZXJtaXNzaW9uc0FwcHJvdmFsRGV0YWlsc0l0ZW0+KGAke3RoaXMuY29uZmlndXJhdGlvbi5iYXNlUGF0aH0vY2xpZW50LWFwaS92Mi9hY2Nlc3Nncm91cHMvYXBwcm92YWxzLyR7ZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhfYXBwcm92YWxJZCkpfS9wZXJtaXNzaW9uc2AsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiA8YW55PnJlc3BvbnNlVHlwZSxcbiAgICAgICAgICAgICAgICB3aXRoQ3JlZGVudGlhbHM6IHRoaXMuY29uZmlndXJhdGlvbi53aXRoQ3JlZGVudGlhbHMsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcbiAgICAgICAgICAgICAgICBvYnNlcnZlOiBvYnNlcnZlLFxuICAgICAgICAgICAgICAgIHJlcG9ydFByb2dyZXNzOiByZXBvcnRQcm9ncmVzc1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRQcmVzZW50YXRpb25QZXJtaXNzaW9uc0FwcHJvdmFsRGV0YWlsc0l0ZW1VcmwocmVxdWVzdFBhcmFtZXRlcnM6IEdldFByZXNlbnRhdGlvblBlcm1pc3Npb25zQXBwcm92YWxEZXRhaWxzSXRlbVJlcXVlc3RQYXJhbXMpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBfYXBwcm92YWxJZCA9IHJlcXVlc3RQYXJhbWV0ZXJzW1wiYXBwcm92YWxJZFwiXTtcbiAgICAgICAgaWYgKF9hcHByb3ZhbElkID09PSBudWxsIHx8IF9hcHByb3ZhbElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcHJvdmFsSWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRQcmVzZW50YXRpb25QZXJtaXNzaW9uc0FwcHJvdmFsRGV0YWlsc0l0ZW0uJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGAke3RoaXMuY29uZmlndXJhdGlvbi5iYXNlUGF0aH0vY2xpZW50LWFwaS92Mi9hY2Nlc3Nncm91cHMvYXBwcm92YWxzLyR7ZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhfYXBwcm92YWxJZCkpfS9wZXJtaXNzaW9uc2A7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgc2VydmljZSBhZ3JlZW1lbnQgZm9yIGFwcHJvdmFsIC0gJiN4NjA7R0VUJiN4NjA7LlxuICAgICAqICNSZXRyaWV2ZSBzZXJ2aWNlIGFncmVlbWVudCBmb3IgYXBwcm92YWwgLSAmI3g2MDtHRVQmI3g2MDsgICAgIyMjRXh0ZW5kYWJpbGl0eSAgICBFeHRlbmRhYmxlIHVzaW5nIFJFU1QgZW5kcG9pbnQgaGFuZGxlcjogICAgICogRXh0ZW5kaW5nIGhhbmRsZXIgY2xhc3M6IGNvbS5iYWNrYmFzZS5wcmVzZW50YXRpb24uc2VydmljZXMuYWNjZXNzZ3JvdXBzLmJ1c2luZXNzLmZsb3dzLkdldFNlcnZpY2VBZ3JlZW1lbnRBcHByb3ZhbERldGFpbHNCeUlkRmxvdyAgXG4gICAgICogQHBhcmFtIHJlcXVlc3RQYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIG9ic2VydmUgc2V0IHdoZXRoZXIgb3Igbm90IHRvIHJldHVybiB0aGUgZGF0YSBPYnNlcnZhYmxlIGFzIHRoZSBib2R5LCByZXNwb25zZSBvciBldmVudHMuIGRlZmF1bHRzIHRvIHJldHVybmluZyB0aGUgYm9keS5cbiAgICAgKiBAcGFyYW0gcmVwb3J0UHJvZ3Jlc3MgZmxhZyB0byByZXBvcnQgcmVxdWVzdCBhbmQgcmVzcG9uc2UgcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHVibGljIGdldFNlcnZpY2VBZ3JlZW1lbnRBcHByb3ZhbERldGFpbHNJdGVtKHJlcXVlc3RQYXJhbWV0ZXJzOiBHZXRTZXJ2aWNlQWdyZWVtZW50QXBwcm92YWxEZXRhaWxzSXRlbVJlcXVlc3RQYXJhbXMsIG9ic2VydmU/OiAnYm9keScsIHJlcG9ydFByb2dyZXNzPzogYm9vbGVhbiwgb3B0aW9ucz86IHtodHRwSGVhZGVyQWNjZXB0PzogJ2FwcGxpY2F0aW9uL2pzb24nfSk6IE9ic2VydmFibGU8U2VydmljZUFncmVlZW1lbnRBcHByb3ZhbERldGFpbHNJdGVtPjtcbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZSBzZXJ2aWNlIGFncmVlbWVudCBmb3IgYXBwcm92YWwgLSAmI3g2MDtHRVQmI3g2MDsuXG4gICAgICogI1JldHJpZXZlIHNlcnZpY2UgYWdyZWVtZW50IGZvciBhcHByb3ZhbCAtICYjeDYwO0dFVCYjeDYwOyAgICAjIyNFeHRlbmRhYmlsaXR5ICAgIEV4dGVuZGFibGUgdXNpbmcgUkVTVCBlbmRwb2ludCBoYW5kbGVyOiAgICAgKiBFeHRlbmRpbmcgaGFuZGxlciBjbGFzczogY29tLmJhY2tiYXNlLnByZXNlbnRhdGlvbi5zZXJ2aWNlcy5hY2Nlc3Nncm91cHMuYnVzaW5lc3MuZmxvd3MuR2V0U2VydmljZUFncmVlbWVudEFwcHJvdmFsRGV0YWlsc0J5SWRGbG93ICBcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFBhcmFtZXRlcnNcbiAgICAgKiBAcGFyYW0gb2JzZXJ2ZSBzZXQgd2hldGhlciBvciBub3QgdG8gcmV0dXJuIHRoZSBkYXRhIE9ic2VydmFibGUgYXMgdGhlIGJvZHksIHJlc3BvbnNlIG9yIGV2ZW50cy4gZGVmYXVsdHMgdG8gcmV0dXJuaW5nIHRoZSBib2R5LlxuICAgICAqIEBwYXJhbSByZXBvcnRQcm9ncmVzcyBmbGFnIHRvIHJlcG9ydCByZXF1ZXN0IGFuZCByZXNwb25zZSBwcm9ncmVzcy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0U2VydmljZUFncmVlbWVudEFwcHJvdmFsRGV0YWlsc0l0ZW0ocmVxdWVzdFBhcmFtZXRlcnM6IEdldFNlcnZpY2VBZ3JlZW1lbnRBcHByb3ZhbERldGFpbHNJdGVtUmVxdWVzdFBhcmFtcywgb2JzZXJ2ZT86ICdyZXNwb25zZScsIHJlcG9ydFByb2dyZXNzPzogYm9vbGVhbiwgb3B0aW9ucz86IHtodHRwSGVhZGVyQWNjZXB0PzogJ2FwcGxpY2F0aW9uL2pzb24nfSk6IE9ic2VydmFibGU8SHR0cFJlc3BvbnNlPFNlcnZpY2VBZ3JlZWVtZW50QXBwcm92YWxEZXRhaWxzSXRlbT4+O1xuICAgIC8qKlxuICAgICAqIFJldHJpZXZlIHNlcnZpY2UgYWdyZWVtZW50IGZvciBhcHByb3ZhbCAtICYjeDYwO0dFVCYjeDYwOy5cbiAgICAgKiAjUmV0cmlldmUgc2VydmljZSBhZ3JlZW1lbnQgZm9yIGFwcHJvdmFsIC0gJiN4NjA7R0VUJiN4NjA7ICAgICMjI0V4dGVuZGFiaWxpdHkgICAgRXh0ZW5kYWJsZSB1c2luZyBSRVNUIGVuZHBvaW50IGhhbmRsZXI6ICAgICAqIEV4dGVuZGluZyBoYW5kbGVyIGNsYXNzOiBjb20uYmFja2Jhc2UucHJlc2VudGF0aW9uLnNlcnZpY2VzLmFjY2Vzc2dyb3Vwcy5idXNpbmVzcy5mbG93cy5HZXRTZXJ2aWNlQWdyZWVtZW50QXBwcm92YWxEZXRhaWxzQnlJZEZsb3cgIFxuICAgICAqIEBwYXJhbSByZXF1ZXN0UGFyYW1ldGVyc1xuICAgICAqIEBwYXJhbSBvYnNlcnZlIHNldCB3aGV0aGVyIG9yIG5vdCB0byByZXR1cm4gdGhlIGRhdGEgT2JzZXJ2YWJsZSBhcyB0aGUgYm9keSwgcmVzcG9uc2Ugb3IgZXZlbnRzLiBkZWZhdWx0cyB0byByZXR1cm5pbmcgdGhlIGJvZHkuXG4gICAgICogQHBhcmFtIHJlcG9ydFByb2dyZXNzIGZsYWcgdG8gcmVwb3J0IHJlcXVlc3QgYW5kIHJlc3BvbnNlIHByb2dyZXNzLlxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRTZXJ2aWNlQWdyZWVtZW50QXBwcm92YWxEZXRhaWxzSXRlbShyZXF1ZXN0UGFyYW1ldGVyczogR2V0U2VydmljZUFncmVlbWVudEFwcHJvdmFsRGV0YWlsc0l0ZW1SZXF1ZXN0UGFyYW1zLCBvYnNlcnZlPzogJ2V2ZW50cycsIHJlcG9ydFByb2dyZXNzPzogYm9vbGVhbiwgb3B0aW9ucz86IHtodHRwSGVhZGVyQWNjZXB0PzogJ2FwcGxpY2F0aW9uL2pzb24nfSk6IE9ic2VydmFibGU8SHR0cEV2ZW50PFNlcnZpY2VBZ3JlZWVtZW50QXBwcm92YWxEZXRhaWxzSXRlbT4+O1xuICAgIC8qKlxuICAgICAqIFJldHJpZXZlIHNlcnZpY2UgYWdyZWVtZW50IGZvciBhcHByb3ZhbCAtICYjeDYwO0dFVCYjeDYwOy5cbiAgICAgKiAjUmV0cmlldmUgc2VydmljZSBhZ3JlZW1lbnQgZm9yIGFwcHJvdmFsIC0gJiN4NjA7R0VUJiN4NjA7ICAgICMjI0V4dGVuZGFiaWxpdHkgICAgRXh0ZW5kYWJsZSB1c2luZyBSRVNUIGVuZHBvaW50IGhhbmRsZXI6ICAgICAqIEV4dGVuZGluZyBoYW5kbGVyIGNsYXNzOiBjb20uYmFja2Jhc2UucHJlc2VudGF0aW9uLnNlcnZpY2VzLmFjY2Vzc2dyb3Vwcy5idXNpbmVzcy5mbG93cy5HZXRTZXJ2aWNlQWdyZWVtZW50QXBwcm92YWxEZXRhaWxzQnlJZEZsb3cgIFxuICAgICAqIEBwYXJhbSByZXF1ZXN0UGFyYW1ldGVyc1xuICAgICAqIEBwYXJhbSBvYnNlcnZlIHNldCB3aGV0aGVyIG9yIG5vdCB0byByZXR1cm4gdGhlIGRhdGEgT2JzZXJ2YWJsZSBhcyB0aGUgYm9keSwgcmVzcG9uc2Ugb3IgZXZlbnRzLiBkZWZhdWx0cyB0byByZXR1cm5pbmcgdGhlIGJvZHkuXG4gICAgICogQHBhcmFtIHJlcG9ydFByb2dyZXNzIGZsYWcgdG8gcmVwb3J0IHJlcXVlc3QgYW5kIHJlc3BvbnNlIHByb2dyZXNzLlxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRTZXJ2aWNlQWdyZWVtZW50QXBwcm92YWxEZXRhaWxzSXRlbShyZXF1ZXN0UGFyYW1ldGVyczogR2V0U2VydmljZUFncmVlbWVudEFwcHJvdmFsRGV0YWlsc0l0ZW1SZXF1ZXN0UGFyYW1zLCBvYnNlcnZlOiBhbnkgPSAnYm9keScsIHJlcG9ydFByb2dyZXNzOiBib29sZWFuID0gZmFsc2UsIG9wdGlvbnM/OiB7aHR0cEhlYWRlckFjY2VwdD86ICdhcHBsaWNhdGlvbi9qc29uJ30pOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICBjb25zdCBfYXBwcm92YWxJZCA9IHJlcXVlc3RQYXJhbWV0ZXJzW1wiYXBwcm92YWxJZFwiXTtcbiAgICAgICAgaWYgKF9hcHByb3ZhbElkID09PSBudWxsIHx8IF9hcHByb3ZhbElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcHJvdmFsSWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRTZXJ2aWNlQWdyZWVtZW50QXBwcm92YWxEZXRhaWxzSXRlbS4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBoZWFkZXJzID0gdGhpcy5kZWZhdWx0SGVhZGVycztcblxuICAgICAgICBsZXQgaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkOiBzdHJpbmcgfCB1bmRlZmluZWQgPSBvcHRpb25zICYmIG9wdGlvbnMuaHR0cEhlYWRlckFjY2VwdDtcbiAgICAgICAgaWYgKGh0dHBIZWFkZXJBY2NlcHRTZWxlY3RlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyB0byBkZXRlcm1pbmUgdGhlIEFjY2VwdCBoZWFkZXJcbiAgICAgICAgICAgIGNvbnN0IGh0dHBIZWFkZXJBY2NlcHRzOiBzdHJpbmdbXSA9IFtcbiAgICAgICAgICAgICAgICAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQgPSB0aGlzLmNvbmZpZ3VyYXRpb24uc2VsZWN0SGVhZGVyQWNjZXB0KGh0dHBIZWFkZXJBY2NlcHRzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGhlYWRlcnMgPSBoZWFkZXJzLnNldCgnQWNjZXB0JywgaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkKTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgbGV0IHJlc3BvbnNlVHlwZTogJ3RleHQnIHwgJ2pzb24nID0gJ2pzb24nO1xuICAgICAgICBpZihodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQgJiYgaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkLnN0YXJ0c1dpdGgoJ3RleHQnKSkge1xuICAgICAgICAgICAgcmVzcG9uc2VUeXBlID0gJ3RleHQnO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5nZXQ8U2VydmljZUFncmVlZW1lbnRBcHByb3ZhbERldGFpbHNJdGVtPihgJHt0aGlzLmNvbmZpZ3VyYXRpb24uYmFzZVBhdGh9L2NsaWVudC1hcGkvdjIvYWNjZXNzZ3JvdXBzL2FwcHJvdmFscy8ke2VuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoX2FwcHJvdmFsSWQpKX0vc2VydmljZS1hZ3JlZW1lbnRgLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogPGFueT5yZXNwb25zZVR5cGUsXG4gICAgICAgICAgICAgICAgd2l0aENyZWRlbnRpYWxzOiB0aGlzLmNvbmZpZ3VyYXRpb24ud2l0aENyZWRlbnRpYWxzLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZTogb2JzZXJ2ZSxcbiAgICAgICAgICAgICAgICByZXBvcnRQcm9ncmVzczogcmVwb3J0UHJvZ3Jlc3NcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0U2VydmljZUFncmVlbWVudEFwcHJvdmFsRGV0YWlsc0l0ZW1VcmwocmVxdWVzdFBhcmFtZXRlcnM6IEdldFNlcnZpY2VBZ3JlZW1lbnRBcHByb3ZhbERldGFpbHNJdGVtUmVxdWVzdFBhcmFtcyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IF9hcHByb3ZhbElkID0gcmVxdWVzdFBhcmFtZXRlcnNbXCJhcHByb3ZhbElkXCJdO1xuICAgICAgICBpZiAoX2FwcHJvdmFsSWQgPT09IG51bGwgfHwgX2FwcHJvdmFsSWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwcm92YWxJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGdldFNlcnZpY2VBZ3JlZW1lbnRBcHByb3ZhbERldGFpbHNJdGVtLicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBgJHt0aGlzLmNvbmZpZ3VyYXRpb24uYmFzZVBhdGh9L2NsaWVudC1hcGkvdjIvYWNjZXNzZ3JvdXBzL2FwcHJvdmFscy8ke2VuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoX2FwcHJvdmFsSWQpKX0vc2VydmljZS1hZ3JlZW1lbnRgO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlIHdpemFyZCBzZXR1cCBhcHByb3ZhbCBkZXRhaWxzIGVuZHBvaW50IGZvciBFbnRpdGxlbWVudHMgV2l6YXJkXG4gICAgICogIyBSZXRyaWV2ZSB3aXphcmQgc2V0dXAgYXBwcm92YWwgZGV0YWlscyBlbmRwb2ludCBmb3IgRW50aXRsZW1lbnRzIFdpemFyZCAtICYjeDYwO0dFVCYjeDYwOy4gR2V0IHBlcm1pc3Npb25zLCBhY2NvdW50cyBhbmQgbGltaXRzIGZvciBzcGVjaWZpZWQgdXNlcnMgYnkgYXBwcm92YWwgaWQuIFxuICAgICAqIEBwYXJhbSByZXF1ZXN0UGFyYW1ldGVyc1xuICAgICAqIEBwYXJhbSBvYnNlcnZlIHNldCB3aGV0aGVyIG9yIG5vdCB0byByZXR1cm4gdGhlIGRhdGEgT2JzZXJ2YWJsZSBhcyB0aGUgYm9keSwgcmVzcG9uc2Ugb3IgZXZlbnRzLiBkZWZhdWx0cyB0byByZXR1cm5pbmcgdGhlIGJvZHkuXG4gICAgICogQHBhcmFtIHJlcG9ydFByb2dyZXNzIGZsYWcgdG8gcmVwb3J0IHJlcXVlc3QgYW5kIHJlc3BvbnNlIHByb2dyZXNzLlxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRXaXphcmRBcHByb3ZhbERldGFpbHMocmVxdWVzdFBhcmFtZXRlcnM6IEdldFdpemFyZEFwcHJvdmFsRGV0YWlsc1JlcXVlc3RQYXJhbXMsIG9ic2VydmU/OiAnYm9keScsIHJlcG9ydFByb2dyZXNzPzogYm9vbGVhbiwgb3B0aW9ucz86IHtodHRwSGVhZGVyQWNjZXB0PzogJ2FwcGxpY2F0aW9uL2pzb24nfSk6IE9ic2VydmFibGU8V2l6YXJkQXBwcm92YWxEZXRhaWxzPjtcbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZSB3aXphcmQgc2V0dXAgYXBwcm92YWwgZGV0YWlscyBlbmRwb2ludCBmb3IgRW50aXRsZW1lbnRzIFdpemFyZFxuICAgICAqICMgUmV0cmlldmUgd2l6YXJkIHNldHVwIGFwcHJvdmFsIGRldGFpbHMgZW5kcG9pbnQgZm9yIEVudGl0bGVtZW50cyBXaXphcmQgLSAmI3g2MDtHRVQmI3g2MDsuIEdldCBwZXJtaXNzaW9ucywgYWNjb3VudHMgYW5kIGxpbWl0cyBmb3Igc3BlY2lmaWVkIHVzZXJzIGJ5IGFwcHJvdmFsIGlkLiBcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFBhcmFtZXRlcnNcbiAgICAgKiBAcGFyYW0gb2JzZXJ2ZSBzZXQgd2hldGhlciBvciBub3QgdG8gcmV0dXJuIHRoZSBkYXRhIE9ic2VydmFibGUgYXMgdGhlIGJvZHksIHJlc3BvbnNlIG9yIGV2ZW50cy4gZGVmYXVsdHMgdG8gcmV0dXJuaW5nIHRoZSBib2R5LlxuICAgICAqIEBwYXJhbSByZXBvcnRQcm9ncmVzcyBmbGFnIHRvIHJlcG9ydCByZXF1ZXN0IGFuZCByZXNwb25zZSBwcm9ncmVzcy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0V2l6YXJkQXBwcm92YWxEZXRhaWxzKHJlcXVlc3RQYXJhbWV0ZXJzOiBHZXRXaXphcmRBcHByb3ZhbERldGFpbHNSZXF1ZXN0UGFyYW1zLCBvYnNlcnZlPzogJ3Jlc3BvbnNlJywgcmVwb3J0UHJvZ3Jlc3M/OiBib29sZWFuLCBvcHRpb25zPzoge2h0dHBIZWFkZXJBY2NlcHQ/OiAnYXBwbGljYXRpb24vanNvbid9KTogT2JzZXJ2YWJsZTxIdHRwUmVzcG9uc2U8V2l6YXJkQXBwcm92YWxEZXRhaWxzPj47XG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgd2l6YXJkIHNldHVwIGFwcHJvdmFsIGRldGFpbHMgZW5kcG9pbnQgZm9yIEVudGl0bGVtZW50cyBXaXphcmRcbiAgICAgKiAjIFJldHJpZXZlIHdpemFyZCBzZXR1cCBhcHByb3ZhbCBkZXRhaWxzIGVuZHBvaW50IGZvciBFbnRpdGxlbWVudHMgV2l6YXJkIC0gJiN4NjA7R0VUJiN4NjA7LiBHZXQgcGVybWlzc2lvbnMsIGFjY291bnRzIGFuZCBsaW1pdHMgZm9yIHNwZWNpZmllZCB1c2VycyBieSBhcHByb3ZhbCBpZC4gXG4gICAgICogQHBhcmFtIHJlcXVlc3RQYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIG9ic2VydmUgc2V0IHdoZXRoZXIgb3Igbm90IHRvIHJldHVybiB0aGUgZGF0YSBPYnNlcnZhYmxlIGFzIHRoZSBib2R5LCByZXNwb25zZSBvciBldmVudHMuIGRlZmF1bHRzIHRvIHJldHVybmluZyB0aGUgYm9keS5cbiAgICAgKiBAcGFyYW0gcmVwb3J0UHJvZ3Jlc3MgZmxhZyB0byByZXBvcnQgcmVxdWVzdCBhbmQgcmVzcG9uc2UgcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHVibGljIGdldFdpemFyZEFwcHJvdmFsRGV0YWlscyhyZXF1ZXN0UGFyYW1ldGVyczogR2V0V2l6YXJkQXBwcm92YWxEZXRhaWxzUmVxdWVzdFBhcmFtcywgb2JzZXJ2ZT86ICdldmVudHMnLCByZXBvcnRQcm9ncmVzcz86IGJvb2xlYW4sIG9wdGlvbnM/OiB7aHR0cEhlYWRlckFjY2VwdD86ICdhcHBsaWNhdGlvbi9qc29uJ30pOiBPYnNlcnZhYmxlPEh0dHBFdmVudDxXaXphcmRBcHByb3ZhbERldGFpbHM+PjtcbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZSB3aXphcmQgc2V0dXAgYXBwcm92YWwgZGV0YWlscyBlbmRwb2ludCBmb3IgRW50aXRsZW1lbnRzIFdpemFyZFxuICAgICAqICMgUmV0cmlldmUgd2l6YXJkIHNldHVwIGFwcHJvdmFsIGRldGFpbHMgZW5kcG9pbnQgZm9yIEVudGl0bGVtZW50cyBXaXphcmQgLSAmI3g2MDtHRVQmI3g2MDsuIEdldCBwZXJtaXNzaW9ucywgYWNjb3VudHMgYW5kIGxpbWl0cyBmb3Igc3BlY2lmaWVkIHVzZXJzIGJ5IGFwcHJvdmFsIGlkLiBcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFBhcmFtZXRlcnNcbiAgICAgKiBAcGFyYW0gb2JzZXJ2ZSBzZXQgd2hldGhlciBvciBub3QgdG8gcmV0dXJuIHRoZSBkYXRhIE9ic2VydmFibGUgYXMgdGhlIGJvZHksIHJlc3BvbnNlIG9yIGV2ZW50cy4gZGVmYXVsdHMgdG8gcmV0dXJuaW5nIHRoZSBib2R5LlxuICAgICAqIEBwYXJhbSByZXBvcnRQcm9ncmVzcyBmbGFnIHRvIHJlcG9ydCByZXF1ZXN0IGFuZCByZXNwb25zZSBwcm9ncmVzcy5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0V2l6YXJkQXBwcm92YWxEZXRhaWxzKHJlcXVlc3RQYXJhbWV0ZXJzOiBHZXRXaXphcmRBcHByb3ZhbERldGFpbHNSZXF1ZXN0UGFyYW1zLCBvYnNlcnZlOiBhbnkgPSAnYm9keScsIHJlcG9ydFByb2dyZXNzOiBib29sZWFuID0gZmFsc2UsIG9wdGlvbnM/OiB7aHR0cEhlYWRlckFjY2VwdD86ICdhcHBsaWNhdGlvbi9qc29uJ30pOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICBjb25zdCBfYXBwcm92YWxJZCA9IHJlcXVlc3RQYXJhbWV0ZXJzW1wiYXBwcm92YWxJZFwiXTtcbiAgICAgICAgaWYgKF9hcHByb3ZhbElkID09PSBudWxsIHx8IF9hcHByb3ZhbElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcHJvdmFsSWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRXaXphcmRBcHByb3ZhbERldGFpbHMuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgaGVhZGVycyA9IHRoaXMuZGVmYXVsdEhlYWRlcnM7XG5cbiAgICAgICAgbGV0IGh0dHBIZWFkZXJBY2NlcHRTZWxlY3RlZDogc3RyaW5nIHwgdW5kZWZpbmVkID0gb3B0aW9ucyAmJiBvcHRpb25zLmh0dHBIZWFkZXJBY2NlcHQ7XG4gICAgICAgIGlmIChodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy8gdG8gZGV0ZXJtaW5lIHRoZSBBY2NlcHQgaGVhZGVyXG4gICAgICAgICAgICBjb25zdCBodHRwSGVhZGVyQWNjZXB0czogc3RyaW5nW10gPSBbXG4gICAgICAgICAgICAgICAgJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkID0gdGhpcy5jb25maWd1cmF0aW9uLnNlbGVjdEhlYWRlckFjY2VwdChodHRwSGVhZGVyQWNjZXB0cyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGh0dHBIZWFkZXJBY2NlcHRTZWxlY3RlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBoZWFkZXJzID0gaGVhZGVycy5zZXQoJ0FjY2VwdCcsIGh0dHBIZWFkZXJBY2NlcHRTZWxlY3RlZCk7XG4gICAgICAgIH1cblxuXG4gICAgICAgIGxldCByZXNwb25zZVR5cGU6ICd0ZXh0JyB8ICdqc29uJyA9ICdqc29uJztcbiAgICAgICAgaWYoaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkICYmIGh0dHBIZWFkZXJBY2NlcHRTZWxlY3RlZC5zdGFydHNXaXRoKCd0ZXh0JykpIHtcbiAgICAgICAgICAgIHJlc3BvbnNlVHlwZSA9ICd0ZXh0JztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHBDbGllbnQuZ2V0PFdpemFyZEFwcHJvdmFsRGV0YWlscz4oYCR7dGhpcy5jb25maWd1cmF0aW9uLmJhc2VQYXRofS9jbGllbnQtYXBpL3YyL2FjY2Vzc2dyb3Vwcy9hcHByb3ZhbHMvJHtlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKF9hcHByb3ZhbElkKSl9L3dpemFyZC1zZXR1cGAsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiA8YW55PnJlc3BvbnNlVHlwZSxcbiAgICAgICAgICAgICAgICB3aXRoQ3JlZGVudGlhbHM6IHRoaXMuY29uZmlndXJhdGlvbi53aXRoQ3JlZGVudGlhbHMsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcbiAgICAgICAgICAgICAgICBvYnNlcnZlOiBvYnNlcnZlLFxuICAgICAgICAgICAgICAgIHJlcG9ydFByb2dyZXNzOiByZXBvcnRQcm9ncmVzc1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRXaXphcmRBcHByb3ZhbERldGFpbHNVcmwocmVxdWVzdFBhcmFtZXRlcnM6IEdldFdpemFyZEFwcHJvdmFsRGV0YWlsc1JlcXVlc3RQYXJhbXMpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBfYXBwcm92YWxJZCA9IHJlcXVlc3RQYXJhbWV0ZXJzW1wiYXBwcm92YWxJZFwiXTtcbiAgICAgICAgaWYgKF9hcHByb3ZhbElkID09PSBudWxsIHx8IF9hcHByb3ZhbElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcHJvdmFsSWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRXaXphcmRBcHByb3ZhbERldGFpbHMuJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGAke3RoaXMuY29uZmlndXJhdGlvbi5iYXNlUGF0aH0vY2xpZW50LWFwaS92Mi9hY2Nlc3Nncm91cHMvYXBwcm92YWxzLyR7ZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhfYXBwcm92YWxJZCkpfS93aXphcmQtc2V0dXBgO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVuZHBvaW50IGZvciBhcHByb3ZpbmcgYXBwcm92YWxcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFBhcmFtZXRlcnNcbiAgICAgKiBAcGFyYW0gb2JzZXJ2ZSBzZXQgd2hldGhlciBvciBub3QgdG8gcmV0dXJuIHRoZSBkYXRhIE9ic2VydmFibGUgYXMgdGhlIGJvZHksIHJlc3BvbnNlIG9yIGV2ZW50cy4gZGVmYXVsdHMgdG8gcmV0dXJuaW5nIHRoZSBib2R5LlxuICAgICAqIEBwYXJhbSByZXBvcnRQcm9ncmVzcyBmbGFnIHRvIHJlcG9ydCByZXF1ZXN0IGFuZCByZXNwb25zZSBwcm9ncmVzcy5cbiAgICAgKi9cbiAgICBwdWJsaWMgcG9zdEFwcHJvdmVBcHByb3ZhbFJlcXVlc3QocmVxdWVzdFBhcmFtZXRlcnM6IFBvc3RBcHByb3ZlQXBwcm92YWxSZXF1ZXN0UmVxdWVzdFBhcmFtcywgb2JzZXJ2ZT86ICdib2R5JywgcmVwb3J0UHJvZ3Jlc3M/OiBib29sZWFuLCBvcHRpb25zPzoge2h0dHBIZWFkZXJBY2NlcHQ/OiAnYXBwbGljYXRpb24vanNvbid9KTogT2JzZXJ2YWJsZTxQcmVzZW50YXRpb25BcHByb3ZhbFN0YXR1cz47XG4gICAgLyoqXG4gICAgICogRW5kcG9pbnQgZm9yIGFwcHJvdmluZyBhcHByb3ZhbFxuICAgICAqIEBwYXJhbSByZXF1ZXN0UGFyYW1ldGVyc1xuICAgICAqIEBwYXJhbSBvYnNlcnZlIHNldCB3aGV0aGVyIG9yIG5vdCB0byByZXR1cm4gdGhlIGRhdGEgT2JzZXJ2YWJsZSBhcyB0aGUgYm9keSwgcmVzcG9uc2Ugb3IgZXZlbnRzLiBkZWZhdWx0cyB0byByZXR1cm5pbmcgdGhlIGJvZHkuXG4gICAgICogQHBhcmFtIHJlcG9ydFByb2dyZXNzIGZsYWcgdG8gcmVwb3J0IHJlcXVlc3QgYW5kIHJlc3BvbnNlIHByb2dyZXNzLlxuICAgICAqL1xuICAgIHB1YmxpYyBwb3N0QXBwcm92ZUFwcHJvdmFsUmVxdWVzdChyZXF1ZXN0UGFyYW1ldGVyczogUG9zdEFwcHJvdmVBcHByb3ZhbFJlcXVlc3RSZXF1ZXN0UGFyYW1zLCBvYnNlcnZlPzogJ3Jlc3BvbnNlJywgcmVwb3J0UHJvZ3Jlc3M/OiBib29sZWFuLCBvcHRpb25zPzoge2h0dHBIZWFkZXJBY2NlcHQ/OiAnYXBwbGljYXRpb24vanNvbid9KTogT2JzZXJ2YWJsZTxIdHRwUmVzcG9uc2U8UHJlc2VudGF0aW9uQXBwcm92YWxTdGF0dXM+PjtcbiAgICAvKipcbiAgICAgKiBFbmRwb2ludCBmb3IgYXBwcm92aW5nIGFwcHJvdmFsXG4gICAgICogQHBhcmFtIHJlcXVlc3RQYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIG9ic2VydmUgc2V0IHdoZXRoZXIgb3Igbm90IHRvIHJldHVybiB0aGUgZGF0YSBPYnNlcnZhYmxlIGFzIHRoZSBib2R5LCByZXNwb25zZSBvciBldmVudHMuIGRlZmF1bHRzIHRvIHJldHVybmluZyB0aGUgYm9keS5cbiAgICAgKiBAcGFyYW0gcmVwb3J0UHJvZ3Jlc3MgZmxhZyB0byByZXBvcnQgcmVxdWVzdCBhbmQgcmVzcG9uc2UgcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHVibGljIHBvc3RBcHByb3ZlQXBwcm92YWxSZXF1ZXN0KHJlcXVlc3RQYXJhbWV0ZXJzOiBQb3N0QXBwcm92ZUFwcHJvdmFsUmVxdWVzdFJlcXVlc3RQYXJhbXMsIG9ic2VydmU/OiAnZXZlbnRzJywgcmVwb3J0UHJvZ3Jlc3M/OiBib29sZWFuLCBvcHRpb25zPzoge2h0dHBIZWFkZXJBY2NlcHQ/OiAnYXBwbGljYXRpb24vanNvbid9KTogT2JzZXJ2YWJsZTxIdHRwRXZlbnQ8UHJlc2VudGF0aW9uQXBwcm92YWxTdGF0dXM+PjtcbiAgICAvKipcbiAgICAgKiBFbmRwb2ludCBmb3IgYXBwcm92aW5nIGFwcHJvdmFsXG4gICAgICogQHBhcmFtIHJlcXVlc3RQYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIG9ic2VydmUgc2V0IHdoZXRoZXIgb3Igbm90IHRvIHJldHVybiB0aGUgZGF0YSBPYnNlcnZhYmxlIGFzIHRoZSBib2R5LCByZXNwb25zZSBvciBldmVudHMuIGRlZmF1bHRzIHRvIHJldHVybmluZyB0aGUgYm9keS5cbiAgICAgKiBAcGFyYW0gcmVwb3J0UHJvZ3Jlc3MgZmxhZyB0byByZXBvcnQgcmVxdWVzdCBhbmQgcmVzcG9uc2UgcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHVibGljIHBvc3RBcHByb3ZlQXBwcm92YWxSZXF1ZXN0KHJlcXVlc3RQYXJhbWV0ZXJzOiBQb3N0QXBwcm92ZUFwcHJvdmFsUmVxdWVzdFJlcXVlc3RQYXJhbXMsIG9ic2VydmU6IGFueSA9ICdib2R5JywgcmVwb3J0UHJvZ3Jlc3M6IGJvb2xlYW4gPSBmYWxzZSwgb3B0aW9ucz86IHtodHRwSGVhZGVyQWNjZXB0PzogJ2FwcGxpY2F0aW9uL2pzb24nfSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIGNvbnN0IF9hcHByb3ZhbElkID0gcmVxdWVzdFBhcmFtZXRlcnNbXCJhcHByb3ZhbElkXCJdO1xuICAgICAgICBpZiAoX2FwcHJvdmFsSWQgPT09IG51bGwgfHwgX2FwcHJvdmFsSWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwcm92YWxJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHBvc3RBcHByb3ZlQXBwcm92YWxSZXF1ZXN0LicpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGhlYWRlcnMgPSB0aGlzLmRlZmF1bHRIZWFkZXJzO1xuXG4gICAgICAgIGxldCBodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQ6IHN0cmluZyB8IHVuZGVmaW5lZCA9IG9wdGlvbnMgJiYgb3B0aW9ucy5odHRwSGVhZGVyQWNjZXB0O1xuICAgICAgICBpZiAoaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIC8vIHRvIGRldGVybWluZSB0aGUgQWNjZXB0IGhlYWRlclxuICAgICAgICAgICAgY29uc3QgaHR0cEhlYWRlckFjY2VwdHM6IHN0cmluZ1tdID0gW1xuICAgICAgICAgICAgICAgICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIGh0dHBIZWFkZXJBY2NlcHRTZWxlY3RlZCA9IHRoaXMuY29uZmlndXJhdGlvbi5zZWxlY3RIZWFkZXJBY2NlcHQoaHR0cEhlYWRlckFjY2VwdHMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaGVhZGVycyA9IGhlYWRlcnMuc2V0KCdBY2NlcHQnLCBodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQpO1xuICAgICAgICB9XG5cblxuICAgICAgICBsZXQgcmVzcG9uc2VUeXBlOiAndGV4dCcgfCAnanNvbicgPSAnanNvbic7XG4gICAgICAgIGlmKGh0dHBIZWFkZXJBY2NlcHRTZWxlY3RlZCAmJiBodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQuc3RhcnRzV2l0aCgndGV4dCcpKSB7XG4gICAgICAgICAgICByZXNwb25zZVR5cGUgPSAndGV4dCc7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5odHRwQ2xpZW50LnBvc3Q8UHJlc2VudGF0aW9uQXBwcm92YWxTdGF0dXM+KGAke3RoaXMuY29uZmlndXJhdGlvbi5iYXNlUGF0aH0vY2xpZW50LWFwaS92Mi9hY2Nlc3Nncm91cHMvYXBwcm92YWxzLyR7ZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhfYXBwcm92YWxJZCkpfS9hcHByb3ZlYCxcbiAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiA8YW55PnJlc3BvbnNlVHlwZSxcbiAgICAgICAgICAgICAgICB3aXRoQ3JlZGVudGlhbHM6IHRoaXMuY29uZmlndXJhdGlvbi53aXRoQ3JlZGVudGlhbHMsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcbiAgICAgICAgICAgICAgICBvYnNlcnZlOiBvYnNlcnZlLFxuICAgICAgICAgICAgICAgIHJlcG9ydFByb2dyZXNzOiByZXBvcnRQcm9ncmVzc1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHB1YmxpYyBwb3N0QXBwcm92ZUFwcHJvdmFsUmVxdWVzdFVybChyZXF1ZXN0UGFyYW1ldGVyczogUG9zdEFwcHJvdmVBcHByb3ZhbFJlcXVlc3RSZXF1ZXN0UGFyYW1zKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgX2FwcHJvdmFsSWQgPSByZXF1ZXN0UGFyYW1ldGVyc1tcImFwcHJvdmFsSWRcIl07XG4gICAgICAgIGlmIChfYXBwcm92YWxJZCA9PT0gbnVsbCB8fCBfYXBwcm92YWxJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHByb3ZhbElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgcG9zdEFwcHJvdmVBcHByb3ZhbFJlcXVlc3QuJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGAke3RoaXMuY29uZmlndXJhdGlvbi5iYXNlUGF0aH0vY2xpZW50LWFwaS92Mi9hY2Nlc3Nncm91cHMvYXBwcm92YWxzLyR7ZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhfYXBwcm92YWxJZCkpfS9hcHByb3ZlYDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFbmRwb2ludCBmb3IgcmVqZWN0aW5nIGFwcHJvdmFsXG4gICAgICogQHBhcmFtIHJlcXVlc3RQYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIG9ic2VydmUgc2V0IHdoZXRoZXIgb3Igbm90IHRvIHJldHVybiB0aGUgZGF0YSBPYnNlcnZhYmxlIGFzIHRoZSBib2R5LCByZXNwb25zZSBvciBldmVudHMuIGRlZmF1bHRzIHRvIHJldHVybmluZyB0aGUgYm9keS5cbiAgICAgKiBAcGFyYW0gcmVwb3J0UHJvZ3Jlc3MgZmxhZyB0byByZXBvcnQgcmVxdWVzdCBhbmQgcmVzcG9uc2UgcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHVibGljIHBvc3RSZWplY3RBcHByb3ZhbFJlcXVlc3QocmVxdWVzdFBhcmFtZXRlcnM6IFBvc3RSZWplY3RBcHByb3ZhbFJlcXVlc3RSZXF1ZXN0UGFyYW1zLCBvYnNlcnZlPzogJ2JvZHknLCByZXBvcnRQcm9ncmVzcz86IGJvb2xlYW4sIG9wdGlvbnM/OiB7aHR0cEhlYWRlckFjY2VwdD86ICdhcHBsaWNhdGlvbi9qc29uJ30pOiBPYnNlcnZhYmxlPFByZXNlbnRhdGlvbkFwcHJvdmFsU3RhdHVzPjtcbiAgICAvKipcbiAgICAgKiBFbmRwb2ludCBmb3IgcmVqZWN0aW5nIGFwcHJvdmFsXG4gICAgICogQHBhcmFtIHJlcXVlc3RQYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIG9ic2VydmUgc2V0IHdoZXRoZXIgb3Igbm90IHRvIHJldHVybiB0aGUgZGF0YSBPYnNlcnZhYmxlIGFzIHRoZSBib2R5LCByZXNwb25zZSBvciBldmVudHMuIGRlZmF1bHRzIHRvIHJldHVybmluZyB0aGUgYm9keS5cbiAgICAgKiBAcGFyYW0gcmVwb3J0UHJvZ3Jlc3MgZmxhZyB0byByZXBvcnQgcmVxdWVzdCBhbmQgcmVzcG9uc2UgcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHVibGljIHBvc3RSZWplY3RBcHByb3ZhbFJlcXVlc3QocmVxdWVzdFBhcmFtZXRlcnM6IFBvc3RSZWplY3RBcHByb3ZhbFJlcXVlc3RSZXF1ZXN0UGFyYW1zLCBvYnNlcnZlPzogJ3Jlc3BvbnNlJywgcmVwb3J0UHJvZ3Jlc3M/OiBib29sZWFuLCBvcHRpb25zPzoge2h0dHBIZWFkZXJBY2NlcHQ/OiAnYXBwbGljYXRpb24vanNvbid9KTogT2JzZXJ2YWJsZTxIdHRwUmVzcG9uc2U8UHJlc2VudGF0aW9uQXBwcm92YWxTdGF0dXM+PjtcbiAgICAvKipcbiAgICAgKiBFbmRwb2ludCBmb3IgcmVqZWN0aW5nIGFwcHJvdmFsXG4gICAgICogQHBhcmFtIHJlcXVlc3RQYXJhbWV0ZXJzXG4gICAgICogQHBhcmFtIG9ic2VydmUgc2V0IHdoZXRoZXIgb3Igbm90IHRvIHJldHVybiB0aGUgZGF0YSBPYnNlcnZhYmxlIGFzIHRoZSBib2R5LCByZXNwb25zZSBvciBldmVudHMuIGRlZmF1bHRzIHRvIHJldHVybmluZyB0aGUgYm9keS5cbiAgICAgKiBAcGFyYW0gcmVwb3J0UHJvZ3Jlc3MgZmxhZyB0byByZXBvcnQgcmVxdWVzdCBhbmQgcmVzcG9uc2UgcHJvZ3Jlc3MuXG4gICAgICovXG4gICAgcHVibGljIHBvc3RSZWplY3RBcHByb3ZhbFJlcXVlc3QocmVxdWVzdFBhcmFtZXRlcnM6IFBvc3RSZWplY3RBcHByb3ZhbFJlcXVlc3RSZXF1ZXN0UGFyYW1zLCBvYnNlcnZlPzogJ2V2ZW50cycsIHJlcG9ydFByb2dyZXNzPzogYm9vbGVhbiwgb3B0aW9ucz86IHtodHRwSGVhZGVyQWNjZXB0PzogJ2FwcGxpY2F0aW9uL2pzb24nfSk6IE9ic2VydmFibGU8SHR0cEV2ZW50PFByZXNlbnRhdGlvbkFwcHJvdmFsU3RhdHVzPj47XG4gICAgLyoqXG4gICAgICogRW5kcG9pbnQgZm9yIHJlamVjdGluZyBhcHByb3ZhbFxuICAgICAqIEBwYXJhbSByZXF1ZXN0UGFyYW1ldGVyc1xuICAgICAqIEBwYXJhbSBvYnNlcnZlIHNldCB3aGV0aGVyIG9yIG5vdCB0byByZXR1cm4gdGhlIGRhdGEgT2JzZXJ2YWJsZSBhcyB0aGUgYm9keSwgcmVzcG9uc2Ugb3IgZXZlbnRzLiBkZWZhdWx0cyB0byByZXR1cm5pbmcgdGhlIGJvZHkuXG4gICAgICogQHBhcmFtIHJlcG9ydFByb2dyZXNzIGZsYWcgdG8gcmVwb3J0IHJlcXVlc3QgYW5kIHJlc3BvbnNlIHByb2dyZXNzLlxuICAgICAqL1xuICAgIHB1YmxpYyBwb3N0UmVqZWN0QXBwcm92YWxSZXF1ZXN0KHJlcXVlc3RQYXJhbWV0ZXJzOiBQb3N0UmVqZWN0QXBwcm92YWxSZXF1ZXN0UmVxdWVzdFBhcmFtcywgb2JzZXJ2ZTogYW55ID0gJ2JvZHknLCByZXBvcnRQcm9ncmVzczogYm9vbGVhbiA9IGZhbHNlLCBvcHRpb25zPzoge2h0dHBIZWFkZXJBY2NlcHQ/OiAnYXBwbGljYXRpb24vanNvbid9KTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICAgICAgY29uc3QgX2FwcHJvdmFsSWQgPSByZXF1ZXN0UGFyYW1ldGVyc1tcImFwcHJvdmFsSWRcIl07XG4gICAgICAgIGlmIChfYXBwcm92YWxJZCA9PT0gbnVsbCB8fCBfYXBwcm92YWxJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHByb3ZhbElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgcG9zdFJlamVjdEFwcHJvdmFsUmVxdWVzdC4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBoZWFkZXJzID0gdGhpcy5kZWZhdWx0SGVhZGVycztcblxuICAgICAgICBsZXQgaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkOiBzdHJpbmcgfCB1bmRlZmluZWQgPSBvcHRpb25zICYmIG9wdGlvbnMuaHR0cEhlYWRlckFjY2VwdDtcbiAgICAgICAgaWYgKGh0dHBIZWFkZXJBY2NlcHRTZWxlY3RlZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyB0byBkZXRlcm1pbmUgdGhlIEFjY2VwdCBoZWFkZXJcbiAgICAgICAgICAgIGNvbnN0IGh0dHBIZWFkZXJBY2NlcHRzOiBzdHJpbmdbXSA9IFtcbiAgICAgICAgICAgICAgICAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQgPSB0aGlzLmNvbmZpZ3VyYXRpb24uc2VsZWN0SGVhZGVyQWNjZXB0KGh0dHBIZWFkZXJBY2NlcHRzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGhlYWRlcnMgPSBoZWFkZXJzLnNldCgnQWNjZXB0JywgaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkKTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgbGV0IHJlc3BvbnNlVHlwZTogJ3RleHQnIHwgJ2pzb24nID0gJ2pzb24nO1xuICAgICAgICBpZihodHRwSGVhZGVyQWNjZXB0U2VsZWN0ZWQgJiYgaHR0cEhlYWRlckFjY2VwdFNlbGVjdGVkLnN0YXJ0c1dpdGgoJ3RleHQnKSkge1xuICAgICAgICAgICAgcmVzcG9uc2VUeXBlID0gJ3RleHQnO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5wb3N0PFByZXNlbnRhdGlvbkFwcHJvdmFsU3RhdHVzPihgJHt0aGlzLmNvbmZpZ3VyYXRpb24uYmFzZVBhdGh9L2NsaWVudC1hcGkvdjIvYWNjZXNzZ3JvdXBzL2FwcHJvdmFscy8ke2VuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoX2FwcHJvdmFsSWQpKX0vcmVqZWN0YCxcbiAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiA8YW55PnJlc3BvbnNlVHlwZSxcbiAgICAgICAgICAgICAgICB3aXRoQ3JlZGVudGlhbHM6IHRoaXMuY29uZmlndXJhdGlvbi53aXRoQ3JlZGVudGlhbHMsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcbiAgICAgICAgICAgICAgICBvYnNlcnZlOiBvYnNlcnZlLFxuICAgICAgICAgICAgICAgIHJlcG9ydFByb2dyZXNzOiByZXBvcnRQcm9ncmVzc1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHB1YmxpYyBwb3N0UmVqZWN0QXBwcm92YWxSZXF1ZXN0VXJsKHJlcXVlc3RQYXJhbWV0ZXJzOiBQb3N0UmVqZWN0QXBwcm92YWxSZXF1ZXN0UmVxdWVzdFBhcmFtcyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IF9hcHByb3ZhbElkID0gcmVxdWVzdFBhcmFtZXRlcnNbXCJhcHByb3ZhbElkXCJdO1xuICAgICAgICBpZiAoX2FwcHJvdmFsSWQgPT09IG51bGwgfHwgX2FwcHJvdmFsSWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwcm92YWxJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHBvc3RSZWplY3RBcHByb3ZhbFJlcXVlc3QuJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGAke3RoaXMuY29uZmlndXJhdGlvbi5iYXNlUGF0aH0vY2xpZW50LWFwaS92Mi9hY2Nlc3Nncm91cHMvYXBwcm92YWxzLyR7ZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhfYXBwcm92YWxJZCkpfS9yZWplY3RgO1xuICAgIH1cblxufVxuIl19