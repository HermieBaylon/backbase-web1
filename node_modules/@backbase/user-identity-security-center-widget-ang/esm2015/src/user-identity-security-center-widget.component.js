import { Component, Directive, EventEmitter, Input, Output, ViewChild } from '@angular/core';
import { BbTemplate } from '@backbase/foundation-ang/core';
import { ManageProfilePreferencesService, UserDataService } from '@backbase/user-common';
import { first } from 'rxjs/operators';
import { UserIdentitySecurityCenterActionType, } from './types/user-identity-security-center-widget.type';
import * as i0 from "@angular/core";
import * as i1 from "@backbase/ui-ang/notification";
import * as i2 from "@backbase/user-common";
import * as i3 from "@backbase/ui-ang/header";
import * as i4 from "./change-password-form/change-password-form.component";
import * as i5 from "@angular/common";
import * as i6 from "@backbase/ui-ang/button";
export class UserIdentitySecurityCenterWidgetComponent {
    constructor(notificationService, manageProfilePreferencesService) {
        this.notificationService = notificationService;
        this.manageProfilePreferencesService = manageProfilePreferencesService;
        this.hostRef = this;
        this.openPassword = false;
        this.widgetStatus = new EventEmitter();
    }
    ngOnInit() {
        if (this.notificationDismissTime) {
            this.notificationDelay = this.notificationDismissTime * 1000;
        }
        else {
            this.manageProfilePreferencesService
                .getNotificationDismissTimePreference()
                .pipe(first())
                .subscribe((time) => (this.notificationDelay = time * 1000));
        }
    }
    toggleChangePassword() {
        this.openPassword = !this.openPassword;
    }
    emitPasswordChanged() {
        this.showNotification(this.notificationSuccessTemplate, 'success');
        this.widgetStatus.emit({
            type: UserIdentitySecurityCenterActionType.PasswordChanged,
        });
    }
    emitError(error) {
        if (error.status === 400) {
            this.showNotification(this.notificationFailureTemplateLogin, 'error');
        }
        else {
            this.showNotification(this.notificationFailureTemplate, 'error');
        }
        this.widgetStatus.emit({
            type: UserIdentitySecurityCenterActionType.PasswordChangeFailed,
        });
    }
    showNotification(template, type) {
        this.notificationService.showNotification({
            message: template,
            modifier: type,
            ttl: this.notificationDelay,
        });
    }
}
UserIdentitySecurityCenterWidgetComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: UserIdentitySecurityCenterWidgetComponent, deps: [{ token: i1.NotificationService }, { token: i2.ManageProfilePreferencesService }], target: i0.ɵɵFactoryTarget.Component });
UserIdentitySecurityCenterWidgetComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.15", type: UserIdentitySecurityCenterWidgetComponent, selector: "bb-user-identity-security-center-widget", inputs: { notificationDismissTime: "notificationDismissTime" }, outputs: { widgetStatus: "widgetStatus" }, providers: [ManageProfilePreferencesService, UserDataService], viewQueries: [{ propertyName: "notificationSuccessTemplate", first: true, predicate: ["notificationSuccess"], descendants: true, static: true }, { propertyName: "notificationFailureTemplate", first: true, predicate: ["notificationFailure"], descendants: true, static: true }, { propertyName: "notificationFailureTemplateLogin", first: true, predicate: ["notificationFailureLogin"], descendants: true }], ngImport: i0, template: "<ng-container bbUserIdentitySecurityCenterWidgetCustomizable\n  [bbHostRef]=\"hostRef\"></ng-container>\n\n<ng-template bbUserIdentitySecurityCenterWidgetCustomizable\n  let-hostRef>\n  <div class=\"card\">\n    <div class=\"card-header\">\n      <bb-header-ui\n        headingType=\"h2\"\n        heading=\"Security Settings\"\n        i18n-heading=\"Header for changing a users password@@bb-user-identity-security-center-widget.bb-header-ui\">\n      </bb-header-ui>\n    </div>\n    <ng-container *ngIf=\"!hostRef.openPassword; else passwordForm\">\n      <div class=\"card-section\">\n        <div class=\"bb-stack\">\n          <strong class=\"bb-stack__item bb-stack__item--fill\"\n            i18n=\"Password list item label text@@bb-user-identity-security-center-widget.home-password-label\">\n            Password\n          </strong>\n          <div class=\"bb-stack__item\">\n            <button bbButton\n              color=\"link\"\n              buttonSize=\"md\"\n              type=\"submit\"\n              data-role=\"identity-security-center-password-change-button\"\n              aria-label=\"Change My Password\"\n              i18n-aria-label=\"Password change button aria label@@bb-user-identity-security-center-widget.change-button-aria-label\"\n              i18n=\"Password change button text@@bb-user-identity-security-center-widget.change-button-text\"\n              (click)=\"hostRef.toggleChangePassword()\">\n              Change\n            </button>\n          </div>\n        </div>\n      </div>\n    </ng-container>\n  </div>\n\n  <ng-template #passwordForm>\n    <div class=\"card-section card-section--highlight\">\n      <bb-user-identity-security-center-widget-change-password-form\n        (close)=\"hostRef.toggleChangePassword()\"\n        (passwordChange)=\"hostRef.emitPasswordChanged()\"\n        (error)=\"hostRef.emitError($event)\">\n      </bb-user-identity-security-center-widget-change-password-form>\n    </div>\n  </ng-template>\n</ng-template>\n\n<ng-template #notificationSuccess>\n  <span \n    data-role=\"user-change-password-success-notification\"\n    i18n=\"Password Reset Success Notification|Notification text for when password reset request is successful@@bb-user-identity-security-center-widget.notification.success\">\n    Password update successful.\n  </span>\n</ng-template>\n\n<ng-template #notificationFailure>\n  <span \n    data-role=\"user-change-password-failure-notification\"\n    i18n=\"Password Reset Failure Notification|Notification text for when password reset request is unsuccessful@@bb-user-identity-security-center-widget.notification.failure\">\n    Could not update password.\n  </span>\n</ng-template>\n\n<ng-template #notificationFailureLogin>\n  <span \n    data-role=\"user-change-password-login-failure-notification\"\n    i18n=\"Password Reset Failure Notification|Notification text for when password reset request is unsuccessful@@bb-user-identity-security-center-widget.notification.failure\">\n    Could not update password. Incorrect login credentials or password policy not met.  \n  </span>\n</ng-template>\n", components: [{ type: i0.forwardRef(function () { return i3.HeaderComponent; }), selector: "bb-header-ui", inputs: ["headingClasses", "headingType", "heading"] }, { type: i0.forwardRef(function () { return i4.ChangePasswordFormComponent; }), selector: "bb-user-identity-security-center-widget-change-password-form", outputs: ["close", "passwordChange", "error"] }], directives: [{ type: i0.forwardRef(function () { return UserIdentitySecurityCenterCustomizableDirective; }), selector: "[bbUserIdentitySecurityCenterWidgetCustomizable]" }, { type: i0.forwardRef(function () { return i5.NgIf; }), selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i0.forwardRef(function () { return i6.ButtonDirective; }), selector: "button[bbButton]", inputs: ["type", "color", "buttonSize", "block", "circle"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: UserIdentitySecurityCenterWidgetComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'bb-user-identity-security-center-widget',
                    templateUrl: './user-identity-security-center-widget.component.html',
                    providers: [ManageProfilePreferencesService, UserDataService],
                }]
        }], ctorParameters: function () { return [{ type: i1.NotificationService }, { type: i2.ManageProfilePreferencesService }]; }, propDecorators: { notificationSuccessTemplate: [{
                type: ViewChild,
                args: ['notificationSuccess', { static: true }]
            }], notificationFailureTemplate: [{
                type: ViewChild,
                args: ['notificationFailure', { static: true }]
            }], notificationFailureTemplateLogin: [{
                type: ViewChild,
                args: ['notificationFailureLogin']
            }], widgetStatus: [{
                type: Output
            }], notificationDismissTime: [{
                type: Input
            }] } });
export class UserIdentitySecurityCenterCustomizableDirective extends BbTemplate {
}
UserIdentitySecurityCenterCustomizableDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: UserIdentitySecurityCenterCustomizableDirective, deps: null, target: i0.ɵɵFactoryTarget.Directive });
UserIdentitySecurityCenterCustomizableDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "12.0.0", version: "12.2.15", type: UserIdentitySecurityCenterCustomizableDirective, selector: "[bbUserIdentitySecurityCenterWidgetCustomizable]", usesInheritance: true, ngImport: i0 });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.15", ngImport: i0, type: UserIdentitySecurityCenterCustomizableDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[bbUserIdentitySecurityCenterWidgetCustomizable]',
                }]
        }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlci1pZGVudGl0eS1zZWN1cml0eS1jZW50ZXItd2lkZ2V0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL2xpYnMvdXNlci1pZGVudGl0eS1zZWN1cml0eS1jZW50ZXItd2lkZ2V0L3NyYy91c2VyLWlkZW50aXR5LXNlY3VyaXR5LWNlbnRlci13aWRnZXQuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vbGlicy91c2VyLWlkZW50aXR5LXNlY3VyaXR5LWNlbnRlci13aWRnZXQvc3JjL3VzZXItaWRlbnRpdHktc2VjdXJpdHktY2VudGVyLXdpZGdldC5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFVLE1BQU0sRUFBZSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDbEgsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBRTNELE9BQU8sRUFBRSwrQkFBK0IsRUFBRSxlQUFlLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUN6RixPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDdkMsT0FBTyxFQUNMLG9DQUFvQyxHQUVyQyxNQUFNLG1EQUFtRCxDQUFDOzs7Ozs7OztBQU8zRCxNQUFNLE9BQU8seUNBQXlDO0lBZ0JwRCxZQUNtQixtQkFBd0MsRUFDeEMsK0JBQWdFO1FBRGhFLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBcUI7UUFDeEMsb0NBQStCLEdBQS9CLCtCQUErQixDQUFpQztRQWIxRSxZQUFPLEdBQUcsSUFBSSxDQUFDO1FBQ3hCLGlCQUFZLEdBQUcsS0FBSyxDQUFDO1FBR0YsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBMEMsQ0FBQztJQVUxRixDQUFDO0lBRUosUUFBUTtRQUNOLElBQUksSUFBSSxDQUFDLHVCQUF1QixFQUFFO1lBQ2hDLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUMsdUJBQXVCLEdBQUcsSUFBSSxDQUFDO1NBQzlEO2FBQU07WUFDTCxJQUFJLENBQUMsK0JBQStCO2lCQUNqQyxvQ0FBb0MsRUFBRTtpQkFDdEMsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO2lCQUNiLFNBQVMsQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7U0FDaEU7SUFDSCxDQUFDO0lBRUQsb0JBQW9CO1FBQ2xCLElBQUksQ0FBQyxZQUFZLEdBQUcsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDO0lBQ3pDLENBQUM7SUFFRCxtQkFBbUI7UUFDakIsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQywyQkFBK0MsRUFBRSxTQUFTLENBQUMsQ0FBQztRQUN2RixJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQztZQUNyQixJQUFJLEVBQUUsb0NBQW9DLENBQUMsZUFBZTtTQUMzRCxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsU0FBUyxDQUFDLEtBQXdCO1FBQ2hDLElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxHQUFHLEVBQUU7WUFDeEIsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxnQ0FBb0QsRUFBRSxPQUFPLENBQUMsQ0FBQztTQUMzRjthQUFNO1lBQ0wsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQywyQkFBK0MsRUFBRSxPQUFPLENBQUMsQ0FBQztTQUN0RjtRQUNELElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDO1lBQ3JCLElBQUksRUFBRSxvQ0FBb0MsQ0FBQyxvQkFBb0I7U0FDaEUsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVPLGdCQUFnQixDQUFDLFFBQTBCLEVBQUUsSUFBeUI7UUFDNUUsSUFBSSxDQUFDLG1CQUFtQixDQUFDLGdCQUFnQixDQUFDO1lBQ3hDLE9BQU8sRUFBRSxRQUFRO1lBQ2pCLFFBQVEsRUFBRSxJQUFJO1lBQ2QsR0FBRyxFQUFFLElBQUksQ0FBQyxpQkFBaUI7U0FDNUIsQ0FBQyxDQUFDO0lBQ0wsQ0FBQzs7dUlBNURVLHlDQUF5QzsySEFBekMseUNBQXlDLDZLQUZ6QyxDQUFDLCtCQUErQixFQUFFLGVBQWUsQ0FBQyw4YUNkL0QsMmlHQXdFQSx1YURVYSwrQ0FBK0M7NEZBbEUvQyx5Q0FBeUM7a0JBTHJELFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLHlDQUF5QztvQkFDbkQsV0FBVyxFQUFFLHVEQUF1RDtvQkFDcEUsU0FBUyxFQUFFLENBQUMsK0JBQStCLEVBQUUsZUFBZSxDQUFDO2lCQUM5RDt3SkFFcUQsMkJBQTJCO3NCQUE5RSxTQUFTO3VCQUFDLHFCQUFxQixFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtnQkFDRSwyQkFBMkI7c0JBQTlFLFNBQVM7dUJBQUMscUJBQXFCLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO2dCQUNYLGdDQUFnQztzQkFBdEUsU0FBUzt1QkFBQywwQkFBMEI7Z0JBTWxCLFlBQVk7c0JBQTlCLE1BQU07Z0JBS0UsdUJBQXVCO3NCQUEvQixLQUFLOztBQW9EUixNQUFNLE9BQU8sK0NBQWdELFNBQVEsVUFHcEU7OzZJQUhZLCtDQUErQztpSUFBL0MsK0NBQStDOzRGQUEvQywrQ0FBK0M7a0JBSDNELFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLGtEQUFrRDtpQkFDN0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIdHRwRXJyb3JSZXNwb25zZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7IENvbXBvbmVudCwgRGlyZWN0aXZlLCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkluaXQsIE91dHB1dCwgVGVtcGxhdGVSZWYsIFZpZXdDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQmJUZW1wbGF0ZSB9IGZyb20gJ0BiYWNrYmFzZS9mb3VuZGF0aW9uLWFuZy9jb3JlJztcbmltcG9ydCB7IE5vdGlmaWNhdGlvblNlcnZpY2UgfSBmcm9tICdAYmFja2Jhc2UvdWktYW5nL25vdGlmaWNhdGlvbic7XG5pbXBvcnQgeyBNYW5hZ2VQcm9maWxlUHJlZmVyZW5jZXNTZXJ2aWNlLCBVc2VyRGF0YVNlcnZpY2UgfSBmcm9tICdAYmFja2Jhc2UvdXNlci1jb21tb24nO1xuaW1wb3J0IHsgZmlyc3QgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQge1xuICBVc2VySWRlbnRpdHlTZWN1cml0eUNlbnRlckFjdGlvblR5cGUsXG4gIFVzZXJJZGVudGl0eVNlY3VyaXR5Q2VudGVyV2lkZ2V0U3RhdHVzLFxufSBmcm9tICcuL3R5cGVzL3VzZXItaWRlbnRpdHktc2VjdXJpdHktY2VudGVyLXdpZGdldC50eXBlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYmItdXNlci1pZGVudGl0eS1zZWN1cml0eS1jZW50ZXItd2lkZ2V0JyxcbiAgdGVtcGxhdGVVcmw6ICcuL3VzZXItaWRlbnRpdHktc2VjdXJpdHktY2VudGVyLXdpZGdldC5jb21wb25lbnQuaHRtbCcsXG4gIHByb3ZpZGVyczogW01hbmFnZVByb2ZpbGVQcmVmZXJlbmNlc1NlcnZpY2UsIFVzZXJEYXRhU2VydmljZV0sXG59KVxuZXhwb3J0IGNsYXNzIFVzZXJJZGVudGl0eVNlY3VyaXR5Q2VudGVyV2lkZ2V0Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQFZpZXdDaGlsZCgnbm90aWZpY2F0aW9uU3VjY2VzcycsIHsgc3RhdGljOiB0cnVlIH0pIG5vdGlmaWNhdGlvblN1Y2Nlc3NUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PiB8IHVuZGVmaW5lZDtcbiAgQFZpZXdDaGlsZCgnbm90aWZpY2F0aW9uRmFpbHVyZScsIHsgc3RhdGljOiB0cnVlIH0pIG5vdGlmaWNhdGlvbkZhaWx1cmVUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PiB8IHVuZGVmaW5lZDtcbiAgQFZpZXdDaGlsZCgnbm90aWZpY2F0aW9uRmFpbHVyZUxvZ2luJykgbm90aWZpY2F0aW9uRmFpbHVyZVRlbXBsYXRlTG9naW46IFRlbXBsYXRlUmVmPGFueT4gfCB1bmRlZmluZWQ7XG5cbiAgcmVhZG9ubHkgaG9zdFJlZiA9IHRoaXM7XG4gIG9wZW5QYXNzd29yZCA9IGZhbHNlO1xuICBwcml2YXRlIG5vdGlmaWNhdGlvbkRlbGF5OiBudW1iZXIgfCB1bmRlZmluZWQ7XG5cbiAgQE91dHB1dCgpIHJlYWRvbmx5IHdpZGdldFN0YXR1cyA9IG5ldyBFdmVudEVtaXR0ZXI8VXNlcklkZW50aXR5U2VjdXJpdHlDZW50ZXJXaWRnZXRTdGF0dXM+KCk7XG5cbiAgLyoqXG4gICAqIFRpbWUgdG8gbGl2ZSBmb3IgdGhlIHN1Y2Nlc3Mgbm90aWZpY2F0aW9uIG1lc3NhZ2UgaW4gc2Vjb25kc1xuICAgKi9cbiAgQElucHV0KCkgbm90aWZpY2F0aW9uRGlzbWlzc1RpbWU6IG51bWJlciB8IHVuZGVmaW5lZDtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHJlYWRvbmx5IG5vdGlmaWNhdGlvblNlcnZpY2U6IE5vdGlmaWNhdGlvblNlcnZpY2UsXG4gICAgcHJpdmF0ZSByZWFkb25seSBtYW5hZ2VQcm9maWxlUHJlZmVyZW5jZXNTZXJ2aWNlOiBNYW5hZ2VQcm9maWxlUHJlZmVyZW5jZXNTZXJ2aWNlLFxuICApIHt9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgaWYgKHRoaXMubm90aWZpY2F0aW9uRGlzbWlzc1RpbWUpIHtcbiAgICAgIHRoaXMubm90aWZpY2F0aW9uRGVsYXkgPSB0aGlzLm5vdGlmaWNhdGlvbkRpc21pc3NUaW1lICogMTAwMDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5tYW5hZ2VQcm9maWxlUHJlZmVyZW5jZXNTZXJ2aWNlXG4gICAgICAgIC5nZXROb3RpZmljYXRpb25EaXNtaXNzVGltZVByZWZlcmVuY2UoKVxuICAgICAgICAucGlwZShmaXJzdCgpKVxuICAgICAgICAuc3Vic2NyaWJlKCh0aW1lKSA9PiAodGhpcy5ub3RpZmljYXRpb25EZWxheSA9IHRpbWUgKiAxMDAwKSk7XG4gICAgfVxuICB9XG5cbiAgdG9nZ2xlQ2hhbmdlUGFzc3dvcmQoKSB7XG4gICAgdGhpcy5vcGVuUGFzc3dvcmQgPSAhdGhpcy5vcGVuUGFzc3dvcmQ7XG4gIH1cblxuICBlbWl0UGFzc3dvcmRDaGFuZ2VkKCkge1xuICAgIHRoaXMuc2hvd05vdGlmaWNhdGlvbih0aGlzLm5vdGlmaWNhdGlvblN1Y2Nlc3NUZW1wbGF0ZSBhcyBUZW1wbGF0ZVJlZjxhbnk+LCAnc3VjY2VzcycpO1xuICAgIHRoaXMud2lkZ2V0U3RhdHVzLmVtaXQoe1xuICAgICAgdHlwZTogVXNlcklkZW50aXR5U2VjdXJpdHlDZW50ZXJBY3Rpb25UeXBlLlBhc3N3b3JkQ2hhbmdlZCxcbiAgICB9KTtcbiAgfVxuXG4gIGVtaXRFcnJvcihlcnJvcjogSHR0cEVycm9yUmVzcG9uc2UpIHtcbiAgICBpZiAoZXJyb3Iuc3RhdHVzID09PSA0MDApIHtcbiAgICAgIHRoaXMuc2hvd05vdGlmaWNhdGlvbih0aGlzLm5vdGlmaWNhdGlvbkZhaWx1cmVUZW1wbGF0ZUxvZ2luIGFzIFRlbXBsYXRlUmVmPGFueT4sICdlcnJvcicpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNob3dOb3RpZmljYXRpb24odGhpcy5ub3RpZmljYXRpb25GYWlsdXJlVGVtcGxhdGUgYXMgVGVtcGxhdGVSZWY8YW55PiwgJ2Vycm9yJyk7XG4gICAgfVxuICAgIHRoaXMud2lkZ2V0U3RhdHVzLmVtaXQoe1xuICAgICAgdHlwZTogVXNlcklkZW50aXR5U2VjdXJpdHlDZW50ZXJBY3Rpb25UeXBlLlBhc3N3b3JkQ2hhbmdlRmFpbGVkLFxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBzaG93Tm90aWZpY2F0aW9uKHRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+LCB0eXBlOiAnc3VjY2VzcycgfCAnZXJyb3InKTogdm9pZCB7XG4gICAgdGhpcy5ub3RpZmljYXRpb25TZXJ2aWNlLnNob3dOb3RpZmljYXRpb24oe1xuICAgICAgbWVzc2FnZTogdGVtcGxhdGUsXG4gICAgICBtb2RpZmllcjogdHlwZSxcbiAgICAgIHR0bDogdGhpcy5ub3RpZmljYXRpb25EZWxheSxcbiAgICB9KTtcbiAgfVxufVxuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICdbYmJVc2VySWRlbnRpdHlTZWN1cml0eUNlbnRlcldpZGdldEN1c3RvbWl6YWJsZV0nLFxufSlcbmV4cG9ydCBjbGFzcyBVc2VySWRlbnRpdHlTZWN1cml0eUNlbnRlckN1c3RvbWl6YWJsZURpcmVjdGl2ZSBleHRlbmRzIEJiVGVtcGxhdGU8XG4gIFVzZXJJZGVudGl0eVNlY3VyaXR5Q2VudGVyV2lkZ2V0Q29tcG9uZW50LFxuICB1bmRlZmluZWRcbj4ge31cbiIsIjxuZy1jb250YWluZXIgYmJVc2VySWRlbnRpdHlTZWN1cml0eUNlbnRlcldpZGdldEN1c3RvbWl6YWJsZVxuICBbYmJIb3N0UmVmXT1cImhvc3RSZWZcIj48L25nLWNvbnRhaW5lcj5cblxuPG5nLXRlbXBsYXRlIGJiVXNlcklkZW50aXR5U2VjdXJpdHlDZW50ZXJXaWRnZXRDdXN0b21pemFibGVcbiAgbGV0LWhvc3RSZWY+XG4gIDxkaXYgY2xhc3M9XCJjYXJkXCI+XG4gICAgPGRpdiBjbGFzcz1cImNhcmQtaGVhZGVyXCI+XG4gICAgICA8YmItaGVhZGVyLXVpXG4gICAgICAgIGhlYWRpbmdUeXBlPVwiaDJcIlxuICAgICAgICBoZWFkaW5nPVwiU2VjdXJpdHkgU2V0dGluZ3NcIlxuICAgICAgICBpMThuLWhlYWRpbmc9XCJIZWFkZXIgZm9yIGNoYW5naW5nIGEgdXNlcnMgcGFzc3dvcmRAQGJiLXVzZXItaWRlbnRpdHktc2VjdXJpdHktY2VudGVyLXdpZGdldC5iYi1oZWFkZXItdWlcIj5cbiAgICAgIDwvYmItaGVhZGVyLXVpPlxuICAgIDwvZGl2PlxuICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCIhaG9zdFJlZi5vcGVuUGFzc3dvcmQ7IGVsc2UgcGFzc3dvcmRGb3JtXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwiY2FyZC1zZWN0aW9uXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJiYi1zdGFja1wiPlxuICAgICAgICAgIDxzdHJvbmcgY2xhc3M9XCJiYi1zdGFja19faXRlbSBiYi1zdGFja19faXRlbS0tZmlsbFwiXG4gICAgICAgICAgICBpMThuPVwiUGFzc3dvcmQgbGlzdCBpdGVtIGxhYmVsIHRleHRAQGJiLXVzZXItaWRlbnRpdHktc2VjdXJpdHktY2VudGVyLXdpZGdldC5ob21lLXBhc3N3b3JkLWxhYmVsXCI+XG4gICAgICAgICAgICBQYXNzd29yZFxuICAgICAgICAgIDwvc3Ryb25nPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJiYi1zdGFja19faXRlbVwiPlxuICAgICAgICAgICAgPGJ1dHRvbiBiYkJ1dHRvblxuICAgICAgICAgICAgICBjb2xvcj1cImxpbmtcIlxuICAgICAgICAgICAgICBidXR0b25TaXplPVwibWRcIlxuICAgICAgICAgICAgICB0eXBlPVwic3VibWl0XCJcbiAgICAgICAgICAgICAgZGF0YS1yb2xlPVwiaWRlbnRpdHktc2VjdXJpdHktY2VudGVyLXBhc3N3b3JkLWNoYW5nZS1idXR0b25cIlxuICAgICAgICAgICAgICBhcmlhLWxhYmVsPVwiQ2hhbmdlIE15IFBhc3N3b3JkXCJcbiAgICAgICAgICAgICAgaTE4bi1hcmlhLWxhYmVsPVwiUGFzc3dvcmQgY2hhbmdlIGJ1dHRvbiBhcmlhIGxhYmVsQEBiYi11c2VyLWlkZW50aXR5LXNlY3VyaXR5LWNlbnRlci13aWRnZXQuY2hhbmdlLWJ1dHRvbi1hcmlhLWxhYmVsXCJcbiAgICAgICAgICAgICAgaTE4bj1cIlBhc3N3b3JkIGNoYW5nZSBidXR0b24gdGV4dEBAYmItdXNlci1pZGVudGl0eS1zZWN1cml0eS1jZW50ZXItd2lkZ2V0LmNoYW5nZS1idXR0b24tdGV4dFwiXG4gICAgICAgICAgICAgIChjbGljayk9XCJob3N0UmVmLnRvZ2dsZUNoYW5nZVBhc3N3b3JkKClcIj5cbiAgICAgICAgICAgICAgQ2hhbmdlXG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICA8L25nLWNvbnRhaW5lcj5cbiAgPC9kaXY+XG5cbiAgPG5nLXRlbXBsYXRlICNwYXNzd29yZEZvcm0+XG4gICAgPGRpdiBjbGFzcz1cImNhcmQtc2VjdGlvbiBjYXJkLXNlY3Rpb24tLWhpZ2hsaWdodFwiPlxuICAgICAgPGJiLXVzZXItaWRlbnRpdHktc2VjdXJpdHktY2VudGVyLXdpZGdldC1jaGFuZ2UtcGFzc3dvcmQtZm9ybVxuICAgICAgICAoY2xvc2UpPVwiaG9zdFJlZi50b2dnbGVDaGFuZ2VQYXNzd29yZCgpXCJcbiAgICAgICAgKHBhc3N3b3JkQ2hhbmdlKT1cImhvc3RSZWYuZW1pdFBhc3N3b3JkQ2hhbmdlZCgpXCJcbiAgICAgICAgKGVycm9yKT1cImhvc3RSZWYuZW1pdEVycm9yKCRldmVudClcIj5cbiAgICAgIDwvYmItdXNlci1pZGVudGl0eS1zZWN1cml0eS1jZW50ZXItd2lkZ2V0LWNoYW5nZS1wYXNzd29yZC1mb3JtPlxuICAgIDwvZGl2PlxuICA8L25nLXRlbXBsYXRlPlxuPC9uZy10ZW1wbGF0ZT5cblxuPG5nLXRlbXBsYXRlICNub3RpZmljYXRpb25TdWNjZXNzPlxuICA8c3BhbiBcbiAgICBkYXRhLXJvbGU9XCJ1c2VyLWNoYW5nZS1wYXNzd29yZC1zdWNjZXNzLW5vdGlmaWNhdGlvblwiXG4gICAgaTE4bj1cIlBhc3N3b3JkIFJlc2V0IFN1Y2Nlc3MgTm90aWZpY2F0aW9ufE5vdGlmaWNhdGlvbiB0ZXh0IGZvciB3aGVuIHBhc3N3b3JkIHJlc2V0IHJlcXVlc3QgaXMgc3VjY2Vzc2Z1bEBAYmItdXNlci1pZGVudGl0eS1zZWN1cml0eS1jZW50ZXItd2lkZ2V0Lm5vdGlmaWNhdGlvbi5zdWNjZXNzXCI+XG4gICAgUGFzc3dvcmQgdXBkYXRlIHN1Y2Nlc3NmdWwuXG4gIDwvc3Bhbj5cbjwvbmctdGVtcGxhdGU+XG5cbjxuZy10ZW1wbGF0ZSAjbm90aWZpY2F0aW9uRmFpbHVyZT5cbiAgPHNwYW4gXG4gICAgZGF0YS1yb2xlPVwidXNlci1jaGFuZ2UtcGFzc3dvcmQtZmFpbHVyZS1ub3RpZmljYXRpb25cIlxuICAgIGkxOG49XCJQYXNzd29yZCBSZXNldCBGYWlsdXJlIE5vdGlmaWNhdGlvbnxOb3RpZmljYXRpb24gdGV4dCBmb3Igd2hlbiBwYXNzd29yZCByZXNldCByZXF1ZXN0IGlzIHVuc3VjY2Vzc2Z1bEBAYmItdXNlci1pZGVudGl0eS1zZWN1cml0eS1jZW50ZXItd2lkZ2V0Lm5vdGlmaWNhdGlvbi5mYWlsdXJlXCI+XG4gICAgQ291bGQgbm90IHVwZGF0ZSBwYXNzd29yZC5cbiAgPC9zcGFuPlxuPC9uZy10ZW1wbGF0ZT5cblxuPG5nLXRlbXBsYXRlICNub3RpZmljYXRpb25GYWlsdXJlTG9naW4+XG4gIDxzcGFuIFxuICAgIGRhdGEtcm9sZT1cInVzZXItY2hhbmdlLXBhc3N3b3JkLWxvZ2luLWZhaWx1cmUtbm90aWZpY2F0aW9uXCJcbiAgICBpMThuPVwiUGFzc3dvcmQgUmVzZXQgRmFpbHVyZSBOb3RpZmljYXRpb258Tm90aWZpY2F0aW9uIHRleHQgZm9yIHdoZW4gcGFzc3dvcmQgcmVzZXQgcmVxdWVzdCBpcyB1bnN1Y2Nlc3NmdWxAQGJiLXVzZXItaWRlbnRpdHktc2VjdXJpdHktY2VudGVyLXdpZGdldC5ub3RpZmljYXRpb24uZmFpbHVyZVwiPlxuICAgIENvdWxkIG5vdCB1cGRhdGUgcGFzc3dvcmQuIEluY29ycmVjdCBsb2dpbiBjcmVkZW50aWFscyBvciBwYXNzd29yZCBwb2xpY3kgbm90IG1ldC4gIFxuICA8L3NwYW4+XG48L25nLXRlbXBsYXRlPlxuIl19