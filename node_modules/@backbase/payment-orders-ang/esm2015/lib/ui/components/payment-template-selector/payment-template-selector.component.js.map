{"version":3,"file":"payment-template-selector.component.js","sourceRoot":"","sources":["../../../../../../../../libs/payment-orders-ang/src/lib/ui/components/payment-template-selector/payment-template-selector.component.ts","../../../../../../../../libs/payment-orders-ang/src/lib/ui/components/payment-template-selector/payment-template-selector.component.html"],"names":[],"mappings":"AAAA,OAAO,EACL,SAAS,EACT,uBAAuB,EACvB,KAAK,EACL,MAAM,EACN,YAAY,GAEb,MAAM,eAAe,CAAC;AACvB,OAAO,EAAE,WAAW,EAAE,MAAM,gBAAgB,CAAC;AAC7C,OAAO,EAAE,UAAU,EAAE,eAAe,EAAE,MAAM,MAAM,CAAC;AAEnD,OAAO,EAAE,mBAAmB,EAAE,MAAM,+BAA+B,CAAC;AACpE,OAAO,EAAE,GAAG,EAAE,MAAM,gBAAgB,CAAC;;;;;;;;;;;;;AAQrC,MAAM,OAAO,gCAAgC;IA+E3C,YAAoB,mBAAwC;QAAxC,wBAAmB,GAAnB,mBAAmB,CAAqB;QA/D5D;;;WAGG;QACM,YAAO,GAAG,KAAK,CAAC;QAEzB;;;WAGG;QACM,iBAAY,GAAG,EAAE,CAAC;QAU3B;;WAEG;QACO,cAAS,GAAG,IAAI,YAAY,EAAmB,CAAC;QAE1D;;WAEG;QACO,sBAAiB,GAAG,IAAI,YAAY,EAAU,CAAC;QAEzD;;WAEG;QACO,oBAAe,GAAG,IAAI,YAAY,EAAU,CAAC;QAEvD;;WAEG;QACO,UAAK,GAAG,IAAI,YAAY,EAAU,CAAC;QAE7C,eAAU,GAAG,IAAI,eAAe,CAAS,EAAE,CAAC,CAAC;IAuBkB,CAAC;IAnDhE;;OAEG;IACH,IAAa,WAAW,CAAC,IAAY;QACnC,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,CAAC;QACpC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;IAC1B,CAAC;IA2BD,QAAQ,CAAC,IAAY;QACnB,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACpC,CAAC;IAED,WAAW,CAAC,GAAoB;QAC9B,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IAC3B,CAAC;IAED,wBAAwB,CAAC,KAAa;QACpC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACjC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC9B,CAAC;IAED,WAAW,CAAC,IAAY;QACtB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACtB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;IAC3B,CAAC;IAID,QAAQ;QACN,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,IAAI,CAAC,mBAAmB,CAAC,oBAAoB,CAC3C,2FAA2F,CAC5F,CAAC;SACH;QACD,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAC1B,GAAG,CACD,CAAC,aAAa,EAAE,EAAE;;YAChB,OAAA,CAAC,IAAI,CAAC,cAAc;gBAClB,MAAA,IAAI,CAAC,cAAc,mCAAI,aAAa,CAAC,UAAU,CAAC,CAAA;SAAA,CACrD,CACF,CAAC;IACJ,CAAC;;iJA9FU,gCAAgC;qIAAhC,gCAAgC,+XCpB7C,ksPAmLA;4FD/Ja,gCAAgC;kBAL5C,SAAS;mBAAC;oBACT,QAAQ,EAAE,8BAA8B;oBACxC,WAAW,EAAE,0CAA0C;oBACvD,eAAe,EAAE,uBAAuB,CAAC,MAAM;iBAChD;0GAKU,KAAK;sBAAb,KAAK;gBAKG,aAAa;sBAArB,KAAK;gBAKG,qBAAqB;sBAA7B,KAAK;gBAMG,OAAO;sBAAf,KAAK;gBAMG,YAAY;sBAApB,KAAK;gBAKO,WAAW;sBAAvB,KAAK;gBAQI,SAAS;sBAAlB,MAAM;gBAKG,iBAAiB;sBAA1B,MAAM;gBAKG,eAAe;sBAAxB,MAAM;gBAKG,KAAK;sBAAd,MAAM","sourcesContent":["import {\n  Component,\n  ChangeDetectionStrategy,\n  Input,\n  Output,\n  EventEmitter,\n  OnInit,\n} from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { Observable, BehaviorSubject } from 'rxjs';\nimport { PaymentTemplate } from '@backbase/data-ang/payment-template';\nimport { DeprecationsService } from '@backbase/foundation-ang/core';\nimport { tap } from 'rxjs/operators';\nimport { PaymentTemplatesData } from '../../models/types';\n\n@Component({\n  selector: 'bb-payment-template-selector',\n  templateUrl: 'payment-template-selector.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class PaymentTemplateSelectorComponent implements OnInit {\n  /**\n   * Items to display in the payment template selector.\n   */\n  @Input() items!: Observable<PaymentTemplatesData>;\n\n  /**\n   * @deprecated since version 3.9.1\n   */\n  @Input() templatesList?: PaymentTemplate[];\n\n  /**\n   * Payment template FormControl.\n   */\n  @Input() paymentTemplateSearch?: FormControl;\n\n  /**\n   * Flag indicates if the list is loading.\n   * Default value is `false`.\n   */\n  @Input() loading = false;\n\n  /**\n   * Name of the template selector.\n   * Default value is ``\n   */\n  @Input() templateName = '';\n\n  /**\n   * Term value on searching a template\n   */\n  @Input() set searchValue(term: string) {\n    this.onSearchPaymentTemplates(term);\n    this.searchModel = term;\n  }\n\n  /**\n   * Emits the values for the payment form.\n   */\n  @Output() setValues = new EventEmitter<PaymentTemplate>();\n\n  /**\n   * Event emmiter for loading payment templates.\n   */\n  @Output() loadMoreTemplates = new EventEmitter<number>();\n\n  /**\n   * Event emmiter for search payment templates.\n   */\n  @Output() searchTemplates = new EventEmitter<string>();\n\n  /**\n   * Event emmiter for clear the payment form.\n   */\n  @Output() clear = new EventEmitter<string>();\n\n  searchTerm = new BehaviorSubject<string>('');\n  templates$!: Observable<PaymentTemplatesData>;\n  searchModel?: string;\n  templatesCount!: number;\n\n  loadMore(page: number) {\n    this.loadMoreTemplates.emit(page);\n  }\n\n  onSetValues(acc: PaymentTemplate) {\n    this.setValues.emit(acc);\n  }\n\n  onSearchPaymentTemplates(value: string) {\n    this.searchTemplates.emit(value);\n    this.searchTerm.next(value);\n  }\n\n  onClearForm(name: string) {\n    this.clear.emit(name);\n    this.templateName = name;\n  }\n\n  constructor(private deprecationsService: DeprecationsService) {}\n\n  ngOnInit() {\n    if (this.templatesList) {\n      this.deprecationsService.logDeprecatedFeature(\n        `The templatesList property has been deprecated since 3.9.1 and will be removed in 3.10.0.`\n      );\n    }\n    this.items = this.items.pipe(\n      tap(\n        (templateItems) =>\n          (this.templatesCount =\n            this.templatesCount ?? templateItems.totalCount)\n      )\n    );\n  }\n}\n","<ng-container *ngIf=\"items | async as paymentTemplates\">\n  <div *ngIf=\"templatesCount\" class=\"bb-block bb-block--lg\">\n    <bb-dropdown-menu-ui\n      position=\"bottom-left\"\n      buttonSize=\"sm\"\n      btnColor=\"secondary\"\n      container=\"body\"\n      (click)=\"$event.stopPropagation()\"\n      (keyUp.enter)=\"$event.stopPropagation()\"\n      data-role=\"payment-template-selector-dropdown\"\n      ariaLabel=\"Payment template DropDown button\"\n      i18n-ariaLabel=\"@@omni-payment-template-selector.dropdown\"\n    >\n      <ng-template bbDropdownLabel>\n        <span\n          class=\"bb-payment-template-selector__placeholder bb-ellipsis bb-ellipsis--single-line\"\n        >\n          <ng-container *ngIf=\"templateName\">{{ templateName }}</ng-container>\n          <ng-container\n            *ngIf=\"!templateName\"\n            i18n=\"@@omni-payment-template-selector.label\"\n            >Select a template\n          </ng-container>\n        </span>\n        <bb-icon-ui name=\"caret-down\" size=\"md\"></bb-icon-ui>\n      </ng-template>\n      <ng-template bbDropdownMenuItem>\n        <div class=\"bb-payment-template-selector__list-container\">\n          <div class=\"bb-payment-template-selector__search-box-container\">\n            <div\n              class=\"bb-payment-template-selector__search-box\"\n              [ngClass]=\"{ 'bb-block--sm': (searchTerm | async) }\"\n            >\n              <bb-search-box-ui\n                data-role=\"search-template\"\n                #searchBox\n                aria-label=\"Search template name\"\n                i18n-aria-label=\"@@template-selector-search-template-label\"\n                [showSearch]=\"true\"\n                [showClear]=\"true\"\n                [ngModel]=\"searchModel\"\n                placeholder=\"Search template name\"\n                i18n-placeholder=\"\n                  @@template-selector-search-template-placeholder\"\n                (valueChange)=\"onSearchPaymentTemplates($event)\"\n                (clear)=\"onSearchPaymentTemplates('')\"\n              >\n              </bb-search-box-ui>\n            </div>\n            <ng-container *ngIf=\"(searchTerm | async) && !loading\">\n              <bb-payments-sr-search-result-info\n                [totalNumber]=\"paymentTemplates.totalCount\"\n              >\n              </bb-payments-sr-search-result-info>\n              <div class=\"bb-block bb-block--xs\"></div>\n              <div\n                *ngIf=\"paymentTemplates?.items?.length\"\n                data-role=\"results-found\"\n                i18n=\"@@omni-payment-template-selector.results-found\"\n              >\n                {paymentTemplates?.items?.length, plural, =1 {1 result found}\n                other\n                {{{paymentTemplates?.items?.length}} results found}}\n              </div>\n            </ng-container>\n          </div>\n          <div class=\"bb-infinite-scroll-container\">\n            <bb-infinite-scroll-ui\n              class=\"bb-infinite-scroll\"\n              [disableScrollEnd]=\"\n                loading ||\n                paymentTemplates?.items?.length === paymentTemplates?.totalCount\n              \"\n              [offset]=\"5\"\n              (scrollEnd)=\"loadMore(1)\"\n            >\n              <ng-container\n                *ngIf=\"paymentTemplates?.items?.length; else emptyState\"\n              >\n                <div class=\"bb-list\" *ngIf=\"!loading\">\n                  <div\n                    role=\"menuitem\"\n                    *ngFor=\"let temp of paymentTemplates?.items\"\n                    class=\"dropdown-item btn-link-dark bb-payment-template-selector__item\"\n                    (click)=\"onSetValues(temp)\"\n                    (keydown.enter)=\"onSetValues(temp)\"\n                  >\n                    <div\n                      class=\"bb-ellipsis bb-ellipsis--single-line bb-text-bold\"\n                      data-role=\"template-name\"\n                    >\n                      {{ temp.name }}\n                    </div>\n                    <ng-container\n                      *ngIf=\"\n                        temp.details\n                          .transferTransactionInformation as transactionInfo;\n                        else noBeneficiaryInfo\n                      \"\n                    >\n                      <div\n                        *ngIf=\"\n                          transactionInfo?.counterpartyAccount?.identification\n                            ?.identification ||\n                            transactionInfo?.counterparty?.name;\n                          else noBeneficiaryInfo\n                        \"\n                      >\n                        <div\n                          class=\"bb-subtitle bb-ellipsis bb-ellipsis--single-line\"\n                          data-role=\"template-counterparty-name\"\n                        >\n                          To: {{ transactionInfo.counterparty.name }}\n                        </div>\n                        <div\n                          class=\"bb-subtitle bb-text-support bb-ellipsis bb-ellipsis--single-line\"\n                          data-role=\"template-account\"\n                        >\n                          {{\n                            transactionInfo.counterpartyAccount.identification\n                              .identification\n                          }}\n                        </div>\n                        <div\n                          *ngIf=\"\n                            transactionInfo?.instructedAmount?.amount as amount\n                          \"\n                          class=\"bb-stack bb-subtitle\"\n                        >\n                          <bb-amount-ui\n                            class=\"bb-stack__item bb-stack__item--push-right\"\n                            [currency]=\"\n                              transactionInfo.instructedAmount.currencyCode\n                            \"\n                            [amount]=\"amount\"\n                            [mapCurrency]=\"false\"\n                          ></bb-amount-ui>\n                        </div>\n                      </div>\n                    </ng-container>\n                    <ng-template #noBeneficiaryInfo>\n                      <div\n                        data-role=\"no-beneficiary-info\"\n                        class=\"bb-subtitle bb-text-support\"\n                        i18n=\"\n                          @@omni-payment-template-selector.no-beneficiary-info\"\n                      >\n                        No beneficiary info\n                      </div>\n                    </ng-template>\n                  </div>\n                </div>\n                <p *ngIf=\"loading\">\n                  <bb-loading-indicator-ui></bb-loading-indicator-ui>\n                </p>\n              </ng-container>\n              <ng-template #emptyState>\n                <div class=\"card-body\">\n                  <bb-empty-state-ui\n                    data-role=\"no-templates-found\"\n                    title=\"No Results Found\"\n                    subtitle=\"We can’t find what you’re looking for. Please try a different criteria.\"\n                    iconSize=\"xxl\"\n                    i18n-subtitle=\"\n                      @@omni-payment-template-selector.empty-state-subtitle\"\n                    i18n-title=\"\n                      @@omni-payment-template-selector.empty-state-title\"\n                    iconModifier=\"search\"\n                    [showIcon]=\"true\"\n                  ></bb-empty-state-ui>\n                </div>\n              </ng-template>\n            </bb-infinite-scroll-ui>\n          </div>\n        </div>\n      </ng-template>\n    </bb-dropdown-menu-ui>\n  </div>\n</ng-container>\n"]}