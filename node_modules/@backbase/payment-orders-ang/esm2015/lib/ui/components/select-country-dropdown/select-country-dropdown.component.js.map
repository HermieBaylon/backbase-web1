{"version":3,"file":"select-country-dropdown.component.js","sourceRoot":"","sources":["../../../../../../../../libs/payment-orders-ang/src/lib/ui/components/select-country-dropdown/select-country-dropdown.component.ts","../../../../../../../../libs/payment-orders-ang/src/lib/ui/components/select-country-dropdown/select-country-dropdown.component.html"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component,\n  Input,\n  Output,\n  EventEmitter,\n  forwardRef,\n} from '@angular/core';\nimport {\n  FormControl,\n  ControlValueAccessor,\n  NG_VALUE_ACCESSOR,\n} from '@angular/forms';\nimport { CountriesMap } from '../../constants';\n\n@Component({\n  selector: 'bb-select-country-dropdown',\n  templateUrl: './select-country-dropdown.component.html',\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      multi: true,\n      useExisting: forwardRef(() => SelectCountryDropdownComponent),\n    },\n  ],\n})\nexport class SelectCountryDropdownComponent implements ControlValueAccessor {\n  _countries!: Array<string>;\n  _selectedCountry = '';\n  search = new FormControl();\n  countryEntries!: Array<[string, string]>;\n  filteredCountries: Array<string> = [];\n\n  /**\n   * Array of country iso codes\n   */\n  @Input() set countries(countries: Array<string>) {\n    this._countries = countries || [];\n    this.setupCountries();\n  }\n  /**\n   * Selected country iso code\n   */\n  @Input() selectedCountry = '';\n  /**\n   * Helper text for the component. Defaults to empty string.\n   */\n  @Input() helperText = '';\n  /**\n   * Placeholder text. Defaults to empty string.\n   */\n  @Input() placeholder = '';\n  /**\n   * Label of the component. Defaults to empty string.\n   */\n  @Input() label = '';\n  /**\n   * Placeholder fot search. Defaults to empty string.\n   */\n  @Input() searchPlaceholder = '';\n  /**\n   * Icon for the dropdown. Defaults to `toggle-down`\n   */\n  @Input() dropdownIcon = 'toggle-down';\n  /**\n   * Flag which indicates permission to create closed payment\n   * Default value is `false`\n   */\n  @Input() isClosedPayment = false;\n  /**\n   * Emits value when a country is selected\n   */\n  @Output() selectCountry = new EventEmitter<string>();\n\n  setupCountries() {\n    this.countryEntries = this._countries.map((country: string) => [\n      country,\n      CountriesMap[country],\n    ]);\n    this.filteredCountries = [...this._countries];\n  }\n\n  selectItem(country: string) {\n    this.selectedCountry = country;\n    this.selectCountry.emit(country);\n    if (this.search.value) {\n      this.search.reset();\n    }\n  }\n\n  handleSearch(query = '') {\n    if (query) {\n      this.filteredCountries = this.countryEntries.reduce(\n        (acc: Array<string>, [key, country]) => {\n          if (\n            key.toLocaleLowerCase().indexOf(query.toLocaleLowerCase()) > -1 ||\n            country.toLocaleLowerCase().indexOf(query.toLocaleLowerCase()) > -1\n          ) {\n            acc.push(key);\n          }\n          return acc;\n        },\n        []\n      );\n    } else {\n      this.filteredCountries = this._countries;\n    }\n  }\n\n  onChange() {}\n  onTouched() {}\n  writeValue(): void {}\n\n  registerOnChange(fn: any): void {\n    this.onChange = fn;\n  }\n\n  registerOnTouched(fn: any): void {\n    this.onTouched = fn;\n  }\n}\n","<div\n  class=\"bb-dynamic-input bb-select-country-dropdown\"\n  ngbDropdown\n  placement=\"bottom\"\n  #dropdown=\"ngbDropdown\"\n>\n  <div class=\"d-inline-block bb-label\" (click)=\"btn.focus()\" *ngIf=\"label\">\n    {{ label }}\n  </div>\n  <span\n    class=\"bb-dynamic-input__helper-text bb-text-support\"\n    *ngIf=\"helperText\"\n    [id]=\"searchElem?.id + '__helper-text'\"\n    [textContent]=\"helperText\"\n  >\n  </span>\n  <div>\n    <button\n      bbButton\n      ngbDropdownToggle\n      color=\"unstyled\"\n      (blur)=\"onTouched()\"\n      data-role=\"open-country-dropdown-list-button\"\n      [attr.aria-label]=\"label\"\n      [disabled]=\"isClosedPayment && selectedCountry\"\n      class=\"bb-select-country-dropdown__toggle form-control w-100 pr-5 d-flex justify-content-between bb-text-support\"\n      #btn\n    >\n      <ng-container *ngIf=\"selectedCountry\">\n        <ng-container\n          *ngTemplateOutlet=\"\n            countryTmpl;\n            context: { $implicit: selectedCountry }\n          \"\n        ></ng-container>\n      </ng-container>\n      <div *ngIf=\"!selectedCountry\">\n        <ng-container\n          *ngIf=\"placeholder; else defaultPlaceHolder\"\n        ></ng-container>\n        {{ placeholder }}\n      </div>\n      <bb-icon-ui [name]=\"dropdownIcon || 'toggle-down'\"></bb-icon-ui>\n    </button>\n  </div>\n\n  <div ngbDropdownMenu class=\"dropdown-menu dropdown-menu-right w-100\">\n    <div class=\"bb-block bb-block--md px-3\">\n      <bb-search-box-ui\n        (focus)=\"dropdown.open()\"\n        [formControl]=\"search\"\n        (clear)=\"handleSearch('')\"\n        data-role=\"country-search\"\n        (ngModelChange)=\"handleSearch(search.value)\"\n        [placeholder]=\"searchPlaceholder || 'Search'\"\n        [attr.aria-label]=\"searchPlaceholder || 'Search'\"\n        [showSearch]=\"true\"\n        [showClear]=\"true\"\n        [autocomplete]=\"'off'\"\n        #searchElem\n      >\n      </bb-search-box-ui>\n    </div>\n\n    <bb-payments-sr-search-result-info\n      [totalNumber]=\"filteredCountries?.length || 0\"\n    >\n    </bb-payments-sr-search-result-info>\n\n    <div *ngIf=\"filteredCountries?.length\" class=\"pre-scrollable\">\n      <button\n        *ngFor=\"let country of filteredCountries\"\n        role=\"menuitem\"\n        type=\"button\"\n        class=\"d-sm-flex px-3 py-2 d-flex-row align-items-center btn--unstyled\"\n        (bbKeyboardClick)=\"selectItem(country); dropdown.close()\"\n        ngbDropdownItem\n      >\n        <ng-container\n          *ngTemplateOutlet=\"countryTmpl; context: { $implicit: country }\"\n        ></ng-container>\n      </button>\n    </div>\n    <ng-container *ngIf=\"!filteredCountries?.length && search?.value\">\n      <ng-container *ngTemplateOutlet=\"emptySearch\"></ng-container>\n    </ng-container>\n  </div>\n</div>\n\n<ng-template let-code #countryTmpl>\n  <div class=\"d-flex justify-content-between align-items-center w-100\">\n    <div class=\"bb-stack\">\n      <bb-flag-icon\n        class=\"bb-stack__item\"\n        [countryCode]=\"code\"\n        [flagSize]=\"'md'\"\n      ></bb-flag-icon>\n      <bb-country-name\n        class=\"bb-stack__item bb-ellipsis bb-ellipsis--single-line\"\n        [countryCode]=\"code\"\n      ></bb-country-name>\n      <div class=\"bb-text-support bb-stack__item bb-stack__item--push-right\">\n        {{ code }}\n      </div>\n    </div>\n  </div>\n</ng-template>\n\n<ng-template #emptySearch>\n  <div class=\"card-body\">\n    <bb-empty-state-ui\n      data-role=\"no-templates-found\"\n      title=\"No Results Found\"\n      subtitle=\"We can’t find what you’re looking for. Please try a different criteria.\"\n      iconSize=\"xxl\"\n      i18n-subtitle=\"@@bb-select-country-dropdown.empty-state-subtitle\"\n      i18n-title=\"@@bb-select-country-dropdown.empty-state-title\"\n      iconModifier=\"search\"\n      [showIcon]=\"true\"\n    ></bb-empty-state-ui>\n  </div>\n</ng-template>\n\n<ng-template #defaultPlaceHolder>\n  <ng-container i18n=\"@@country-selector-default-placeholder\"\n    >- select a country -</ng-container\n  >\n</ng-template>\n"]}