{"version":3,"file":"currency-selector.component.js","sourceRoot":"","sources":["../../../../../../../../libs/payment-orders-ang/src/lib/ui/components/currency-selector/currency-selector.component.ts","../../../../../../../../libs/payment-orders-ang/src/lib/ui/components/currency-selector/currency-selector.component.html"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component,\n  EventEmitter,\n  forwardRef,\n  Input,\n  OnInit,\n  Output,\n} from '@angular/core';\nimport {\n  ControlValueAccessor,\n  FormControl,\n  NG_VALUE_ACCESSOR,\n} from '@angular/forms';\nimport { CurrenciesMap, CurrencyToCountryMap } from '../../constants';\nimport { CurrencySelectorConfig } from '../../models';\n\n@Component({\n  selector: 'bb-currency-selector',\n  templateUrl: './currency-selector.component.html',\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      multi: true,\n      useExisting: forwardRef(() => CurrencySelectorComponent),\n    },\n  ],\n})\nexport class CurrencySelectorComponent implements ControlValueAccessor, OnInit {\n  isDisabled = false;\n  _currencies!: Array<string>;\n  search = new FormControl();\n  currencyEntries!: Array<[string, string]>;\n  filteredCurrencies: Array<string> = [];\n  currencyToCountryMap = CurrencyToCountryMap;\n  currenciesMap = CurrenciesMap;\n  selectedCurrency?: string;\n  value?: string;\n  change = new EventEmitter();\n  showFlags?: boolean;\n  showName?: boolean;\n  isSearchable?: boolean;\n  dividerIndex?: number;\n  searchPlaceholder?: string;\n  dropdownIcon?: string;\n\n  /**\n   * List of currencies setter\n   */\n  @Input() set currencies(currencies: Array<string>) {\n    this._currencies = currencies || [];\n    this.setupCurrencies();\n  }\n\n  /**\n   * Flag to determine component config\n   */\n  @Input() config: CurrencySelectorConfig = {};\n\n  /**\n   * Input that can be used to specify the `aria-labelledby` attribute.\n   */\n  @Input('aria-labelledby') ariaLabelledby: string | undefined;\n\n  /**\n   * Selected currency output\n   */\n  @Output() selectCurrency = new EventEmitter<string>();\n\n  setupCurrencies() {\n    this.currencyEntries = this._currencies.map((currency: string) => [\n      currency,\n      this.currenciesMap[currency] ? this.currenciesMap[currency].name : '',\n    ]);\n    this.filteredCurrencies = [...this._currencies];\n    this.selectedCurrency = this.selectedCurrency || this._currencies[0];\n    if (this._currencies.length < 2) {\n      this.isDisabled = true;\n    }\n  }\n\n  selectItem(currency: string) {\n    this.selectedCurrency = currency;\n    this.selectCurrency.emit(currency);\n    this.onChange(currency);\n    this.value = currency;\n  }\n\n  handleSearch(query = '') {\n    if (query) {\n      this.filteredCurrencies = this.currencyEntries.reduce(\n        (acc: Array<string>, [currency, currName]) => {\n          if (\n            currency.toLocaleLowerCase().indexOf(query.toLocaleLowerCase()) >\n              -1 ||\n            currName.toLocaleLowerCase().indexOf(query.toLocaleLowerCase()) > -1\n          ) {\n            acc.push(currency);\n          }\n          return acc;\n        },\n        []\n      );\n    } else {\n      this.filteredCurrencies = this._currencies;\n    }\n  }\n\n  onChange(_value: string) {}\n\n  onTouched() {}\n\n  registerOnChange(fn: any): void {\n    this.onChange = fn;\n  }\n\n  registerOnTouched(fn: any): void {\n    this.onTouched = fn;\n  }\n\n  writeValue(value: string): void {\n    if (value) {\n      this.selectedCurrency = value;\n    }\n    this.value = value;\n  }\n\n  ngOnInit(): void {\n    this.showFlags = this.config.showFlags || false;\n    this.showName = this.config.showName || false;\n    this.isSearchable = this.config.isSearchable || false;\n    this.dividerIndex = this.config.dividerIndex;\n    this.searchPlaceholder = this.config.searchPlaceholder || '';\n    this.dropdownIcon = this.config.dropdownIcon || 'toggle-down';\n  }\n}\n","<div\n  class=\"d-inline-block\"\n  ngbDropdown\n  #dropdown=\"ngbDropdown\"\n  display=\"static\"\n>\n  <div>\n    <button\n      bbButton\n      ngbDropdownToggle\n      color=\"unstyled\"\n      (blur)=\"onTouched()\"\n      [disabled]=\"isDisabled\"\n      [attr.aria-labelledby]=\"ariaLabelledby\"\n      data-role=\"open-currency-dropdown-list-button\"\n      class=\"bb-currency-selector__toggle form-control d-flex justify-content-between bb-text-support\"\n    >\n      <ng-container *ngIf=\"selectedCurrency\">\n        <ng-container\n          *ngTemplateOutlet=\"\n            currencyTmpl;\n            context: { code: selectedCurrency, selected: true }\n          \"\n        ></ng-container>\n      </ng-container>\n      <bb-icon-ui [name]=\"dropdownIcon\"></bb-icon-ui>\n    </button>\n  </div>\n\n  <div\n    ngbDropdownMenu\n    class=\"dropdown-menu\"\n    [ngClass]=\"{ 'bb-currency-selector__dropdown': isSearchable }\"\n  >\n    <div *ngIf=\"isSearchable\" class=\"bb-block bb-block--md px-3\">\n      <bb-search-box-ui\n        (focus)=\"dropdown.open()\"\n        [formControl]=\"search\"\n        (clear)=\"handleSearch('')\"\n        data-role=\"currency-search\"\n        (ngModelChange)=\"handleSearch(search.value)\"\n        [placeholder]=\"searchPlaceholder || 'Search'\"\n        [attr.aria-label]=\"searchPlaceholder || 'Search'\"\n        [showSearch]=\"true\"\n        [showClear]=\"true\"\n        [autocomplete]=\"'off'\"\n      ></bb-search-box-ui>\n    </div>\n\n    <bb-payments-sr-search-result-info\n      [totalNumber]=\"filteredCurrencies?.length || 0\"\n    >\n    </bb-payments-sr-search-result-info>\n\n    <div *ngIf=\"filteredCurrencies?.length\" class=\"pre-scrollable\">\n      <ng-container *ngFor=\"let currency of filteredCurrencies; index as i\">\n        <button\n          role=\"menuitem\"\n          data-role=\"currency-item\"\n          type=\"button\"\n          class=\"d-sm-flex px-3 py-2 d-flex-row align-items-center btn--unstyled\"\n          (bbKeyboardClick)=\"selectItem(currency); dropdown.close()\"\n          ngbDropdownItem\n        >\n          <ng-container\n            *ngTemplateOutlet=\"currencyTmpl; context: { code: currency }\"\n          ></ng-container>\n        </button>\n        <hr *ngIf=\"dividerIndex === i\" />\n      </ng-container>\n    </div>\n    <ng-container *ngIf=\"!filteredCurrencies?.length && search?.value\">\n      <ng-container *ngTemplateOutlet=\"emptySearch\"></ng-container>\n    </ng-container>\n  </div>\n</div>\n\n<ng-template let-code=\"code\" let-selected=\"selected\" #currencyTmpl>\n  <div class=\"d-flex align-items-center\" data-role=\"selected-currency\">\n    <bb-flag-icon\n      *ngIf=\"showFlags\"\n      class=\"mr-2 d-flex\"\n      [countryCode]=\"currencyToCountryMap[code]\"\n      [flagSize]=\"'sm'\"\n      data-role=\"flag-icon\"\n    ></bb-flag-icon>\n    {{ code }}\n    <span\n      *ngIf=\"showName && !selected\"\n      class=\"d-inline-block ml-3 bb-text-support\"\n      >{{ currenciesMap[code] && currenciesMap[code].name }}</span\n    >\n  </div>\n</ng-template>\n\n<ng-template #emptySearch>\n  <div class=\"card-body\">\n    <bb-empty-state-ui\n      data-role=\"no-templates-found\"\n      title=\"No search results\"\n      iconSize=\"xl\"\n      i18n-title=\"@@bb-currency-selector.empty-state-title\"\n      iconModifier=\"search\"\n      [showIcon]=\"false\"\n    ></bb-empty-state-ui>\n  </div>\n</ng-template>\n"]}