{"version":3,"file":"base-widget-properties.service.js","sourceRoot":"","sources":["../../../../../../libs/notifications-common-ang/src/lib/services/base-widget-properties.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable, Optional } from '@angular/core';\nimport { ItemModel } from '@backbase/foundation-ang/core';\nimport { BehaviorSubject, defer, Observable, of } from 'rxjs';\nimport { first, publishReplay, refCount } from 'rxjs/operators';\nimport { getPropertyValue } from '../helpers/item-model-property';\nimport { propertiesListToArray } from '../helpers/rxjs-operators';\nimport { modelItemToArray } from '../helpers/type-helpers';\n\nexport interface BaseWidgetProperties {\n  allowedRoutes: string[];\n  origins: string[];\n  severityLevels: string[];\n}\n\nexport const DefaultBaseWidgetProperties: BaseWidgetProperties = {\n  allowedRoutes: [],\n  origins: [],\n  severityLevels: [],\n};\n\n@Injectable()\nexport class BaseWidgetPropertiesService {\n  constructor(@Optional() protected readonly itemModel?: ItemModel) {}\n\n  private readonly allowedRoutes$$ = new BehaviorSubject<string[] | undefined>(undefined);\n  private readonly origins$$ = new BehaviorSubject<string[] | undefined>(undefined);\n  private readonly severityLevels$$ = new BehaviorSubject<string[] | undefined>(undefined);\n\n  readonly allowedRoutes$ = getPropertyValue(this.allowedRoutes$$, this.allowedRoutes);\n  readonly origins$ = getPropertyValue(this.origins$$, this.origins);\n  readonly severityLevels$ = getPropertyValue(this.severityLevels$$, this.severityLevels);\n\n  private get allowedRoutes(): Observable<string[]> {\n    if (!this.itemModel) {\n      return this.defaultModelObservable(DefaultBaseWidgetProperties.allowedRoutes);\n    }\n\n    return this.itemModel.property('allowedRoutes', '').pipe(first(), propertiesListToArray());\n  }\n\n  private get origins(): Observable<string[]> {\n    if (!this.itemModel) {\n      return this.defaultModelObservable(DefaultBaseWidgetProperties.origins);\n    }\n\n    return this.itemModel.property('origins', '').pipe(propertiesListToArray());\n  }\n\n  private get severityLevels(): Observable<string[]> {\n    if (!this.itemModel) {\n      return this.defaultModelObservable(DefaultBaseWidgetProperties.severityLevels);\n    }\n\n    return this.itemModel.property('severityLevels', '').pipe(propertiesListToArray());\n  }\n\n  setAllowedRoutes(value: string): void {\n    this.allowedRoutes$$.next(modelItemToArray(value));\n  }\n\n  setOrigins(value: string): void {\n    this.origins$$.next(modelItemToArray(value));\n  }\n\n  setSeverityLevels(value: string): void {\n    this.severityLevels$$.next(modelItemToArray(value));\n  }\n\n  protected defaultModelObservable<T>(value: T): Observable<T> {\n    return defer(() => of(value)).pipe(publishReplay(1), refCount());\n  }\n}\n"]}