import { Component, EventEmitter, Input, Output } from '@angular/core';
import { Validators } from '@angular/forms';
import { ManagePocketsBaseStep } from '../../../manage-pockets-common/components/manage-pockets-base-step/manage-pockets-base-step';
import * as i0 from "@angular/core";
import * as i1 from "@angular/forms";
import * as i2 from "@backbase/ui-ang/account-selector";
import * as i3 from "@backbase/ui-ang/amount-input";
import * as i4 from "@backbase/ui-ang/amount";
import * as i5 from "@backbase/ui-ang/input-validation-message";
import * as i6 from "@angular/common";
import * as i7 from "@backbase/ui-ang/button";
export class ManagePocketsTransfersDetailsComponent extends ManagePocketsBaseStep {
    constructor(formBuilder) {
        super();
        this.formBuilder = formBuilder;
        this.accountChange = new EventEmitter();
        this.next = new EventEmitter();
    }
    ngOnInit() {
        var _a, _b;
        this.transferDetailsForm = this.formBuilder.group({
            amount: [
                ((_a = this.partialNewPayment) === null || _a === void 0 ? void 0 : _a.amount) || '',
                Validators.compose([
                    Validators.required,
                    Validators.min(0.01),
                    this.validatorsSelector((_b = this.partialNewPayment) === null || _b === void 0 ? void 0 : _b.account),
                ]),
            ],
        });
    }
    goNext() {
        if (this.transferDetailsForm.valid) {
            const paymentForm = Object.assign(Object.assign({}, this.partialNewPayment), { amount: this.transferDetailsForm.get('amount').value });
            this.next.emit(paymentForm);
        }
        else {
            this.transferDetailsForm.markAllAsTouched();
        }
    }
    onAccountSelection(account) {
        const control = this.transferDetailsForm.get('amount');
        control.setValidators([Validators.required, Validators.min(0.01), this.validatorsSelector(account)]);
        control.updateValueAndValidity();
        this.accountChange.emit(account);
    }
    validatorsSelector(account) {
        var _a, _b, _c, _d;
        const pocketBalance = ((_b = (_a = this.partialNewPayment) === null || _a === void 0 ? void 0 : _a.pocketInfo) === null || _b === void 0 ? void 0 : _b.pocket.balance.amount) || 0;
        return ((_d = (_c = this.partialNewPayment) === null || _c === void 0 ? void 0 : _c.pocketInfo) === null || _d === void 0 ? void 0 : _d.transferType) === this.transferTypesEnum.ADD
            ? Validators.max((account === null || account === void 0 ? void 0 : account.balance) || 0)
            : Validators.max(Number(pocketBalance));
    }
}
ManagePocketsTransfersDetailsComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: ManagePocketsTransfersDetailsComponent, deps: [{ token: i1.FormBuilder }], target: i0.ɵɵFactoryTarget.Component });
ManagePocketsTransfersDetailsComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.16", type: ManagePocketsTransfersDetailsComponent, selector: "bb-manage-pockets-transfers-details", inputs: { accountList: "accountList", journeyCurrency: "journeyCurrency" }, outputs: { accountChange: "accountChange", next: "next" }, usesInheritance: true, ngImport: i0, template: "<form [formGroup]=\"transferDetailsForm\" (submit)=\"goNext()\">\n  <div class=\"bb-block bb-block--xl\">\n\n    <label>\n      {{ partialNewPayment?.pocketInfo?.transferType === transferTypesEnum.ADD ? pocketLocalizations.transfers.details.addMoneyHeader : pocketLocalizations.transfers.details.withdrawMoneyHeader }}\n    </label>\n\n    <bb-account-selector-ui\n      [items]=\"accountList\"\n      [selectedItems]=\"partialNewPayment?.account ?? ''\"\n      [closeOnSelect]=\"true\"\n      [highlight]=\"false\"\n      [required]=\"true\"\n      dropdownPosition=\"bottom\"\n      placeholder=\"Select an Account\"\n      i18n-placeholder=\"Select an Account@@managePockets.transfers.details.accountSelector.placeholder\"\n      (change)=\"onAccountSelection($event)\"\n    ></bb-account-selector-ui>\n  </div>\n\n  <div class=\"bb-block bb-block--xl\">\n    <div class=\"bb-stack row\">\n      <div class=\"bb-stack__item col-6\">\n        <div class=\"bb-block bb-block--sm\">\n          <bb-amount-input-ui\n            formControlName=\"amount\"\n            label=\"Amount\"\n            i18n-label=\"Amount@@managePockets.transfers.details.amount.placeholder\"\n            [attr.aria-invalid]=\"!isFieldValid(transferDetailsForm, 'amount')\"\n            [currency]=\"journeyCurrency\"\n            placeholder=\"0.00\"\n            i18n-placeholder=\"0.00|Price example@@managePockets.transfers.details.amount.placeholder\"\n          ></bb-amount-input-ui>\n        </div>\n        <div class=\"bb-subtitle bb-text-support\" i18n=\"Available balance|Value includes a formatted currendy@@managePockets.transfers.details.availableBalance\" *ngIf=\"partialNewPayment?.pocketInfo?.transferType === transferTypesEnum.WITHDRAW\">\n          <span>Available Balance: </span>\n          <bb-amount-ui\n            [amount]=\"partialNewPayment?.pocketInfo?.pocket?.balance?.amount\"\n            [currency]=\"partialNewPayment?.pocketInfo?.pocket?.balance?.currencyCode\"\n          ></bb-amount-ui>\n        </div>\n        <bb-input-validation-message-ui [showErrors]=\"!isFieldValid(transferDetailsForm, 'amount')\" >\n          <ng-container *ngFor=\"let error of getFieldErrors(transferDetailsForm, 'amount') | keyvalue; last as last\">\n            <ng-container *ngIf=\"last\" [ngSwitch]=\"error.key\">\n              <span *ngSwitchCase=\"'max'\">\n                {{ partialNewPayment?.pocketInfo?.transferType === transferTypesEnum.ADD ? pocketLocalizations.transfers.details.addMoneyError : pocketLocalizations.transfers.details.withdrawMoneyError }}\n              </span>\n              <span i18n=\"Amount is required@@managePockets.transfers.details.amount.error.required\" *ngSwitchDefault>\n                Amount is required\n              </span>\n            </ng-container>\n          </ng-container>\n        </bb-input-validation-message-ui>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"bb-button-bar\">\n    <button \n      bbButton \n      class=\"bb-button-bar__button\" \n      type=\"submit\"\n    >\n      {{ partialNewPayment?.pocketInfo?.transferType === transferTypesEnum.ADD ? pocketLocalizations.transfers.details.addMoneyContinueButton : pocketLocalizations.transfers.details.withdrawMoneyContinueButton }}\n    </button>\n    <button \n      bbButton \n      color=\"link\"\n      class=\"bb-button-bar__button bb-button-bar__button--across\"\n      i18n=\"Cancel@@managePockets.transfers.details.button.cancel\"\n      (click)=\"abort()\"\n    >\n      Cancel\n    </button>\n  </div>\n</form>\n", components: [{ type: i2.AccountSelectorComponent, selector: "bb-account-selector-ui", inputs: ["items", "disabled", "notFoundText", "showError", "productNumberFormat", "selectedItems", "multiple", "closeOnSelect", "searchable", "clearable", "placeholder", "loading", "dropdownPosition", "disableScrollEnd", "highlight", "filterItems", "markFirst", "internalFiltering", "virtualScroll", "required", "typeahead", "minTermLength", "typeToSearchText", "aria-describedby", "aria-labelledby", "aria-invalid", "searchFunc", "showCurrencySymbol", "showBankBranchCode", "groupByFn", "groupValueFn", "size", "compareItemsWith"], outputs: ["search", "clearSearch", "scroll", "scrollToEnd", "remove", "change", "filterChange", "focus", "blur"] }, { type: i3.AmountInputComponent, selector: "bb-amount-input-ui", inputs: ["placeholder", "maxLength", "wrapperClasses", "mapCurrency", "currency", "autoDecimal"] }, { type: i4.AmountComponent, selector: "bb-amount-ui", inputs: ["currency", "showPlusSign", "mapCurrency", "showPercent", "abbreviate", "decimalPlaces", "trailingZeroes", "amount"] }, { type: i5.InputValidationMessageComponent, selector: "bb-input-validation-message-ui", inputs: ["showErrors", "messageId"] }], directives: [{ type: i1.ɵNgNoValidate, selector: "form:not([ngNoForm]):not([ngNativeValidate])" }, { type: i1.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { type: i1.FormGroupDirective, selector: "[formGroup]", inputs: ["formGroup"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { type: i1.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { type: i1.FormControlName, selector: "[formControlName]", inputs: ["disabled", "formControlName", "ngModel"], outputs: ["ngModelChange"] }, { type: i6.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i6.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i6.NgSwitch, selector: "[ngSwitch]", inputs: ["ngSwitch"] }, { type: i6.NgSwitchCase, selector: "[ngSwitchCase]", inputs: ["ngSwitchCase"] }, { type: i6.NgSwitchDefault, selector: "[ngSwitchDefault]" }, { type: i7.ButtonDirective, selector: "button[bbButton]", inputs: ["type", "color", "buttonSize", "block", "circle"] }], pipes: { "keyvalue": i6.KeyValuePipe } });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: ManagePocketsTransfersDetailsComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'bb-manage-pockets-transfers-details',
                    templateUrl: './manage-pockets-transfers-details.component.html',
                }]
        }], ctorParameters: function () { return [{ type: i1.FormBuilder }]; }, propDecorators: { accountList: [{
                type: Input
            }], journeyCurrency: [{
                type: Input
            }], accountChange: [{
                type: Output
            }], next: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFuYWdlLXBvY2tldHMtdHJhbnNmZXJzLWRldGFpbHMuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vbGlicy9tYW5hZ2UtcG9ja2V0cy1qb3VybmV5L3NyYy9tYW5hZ2UtcG9ja2V0cy10cmFuc2ZlcnMvY29tcG9uZW50cy9tYW5hZ2UtcG9ja2V0cy10cmFuc2ZlcnMtZGV0YWlscy9tYW5hZ2UtcG9ja2V0cy10cmFuc2ZlcnMtZGV0YWlscy5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL21hbmFnZS1wb2NrZXRzLWpvdXJuZXkvc3JjL21hbmFnZS1wb2NrZXRzLXRyYW5zZmVycy9jb21wb25lbnRzL21hbmFnZS1wb2NrZXRzLXRyYW5zZmVycy1kZXRhaWxzL21hbmFnZS1wb2NrZXRzLXRyYW5zZmVycy1kZXRhaWxzLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBVSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDL0UsT0FBTyxFQUF1QyxVQUFVLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUNqRixPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSw2RkFBNkYsQ0FBQzs7Ozs7Ozs7O0FBUXBJLE1BQU0sT0FBTyxzQ0FBdUMsU0FBUSxxQkFBcUI7SUErQy9FLFlBQW9CLFdBQXdCO1FBQzFDLEtBQUssRUFBRSxDQUFDO1FBRFUsZ0JBQVcsR0FBWCxXQUFXLENBQWE7UUE1Q2xDLGtCQUFhLEdBQUcsSUFBSSxZQUFZLEVBQWUsQ0FBQztRQUNoRCxTQUFJLEdBQUcsSUFBSSxZQUFZLEVBQW1CLENBQUM7SUE2Q3JELENBQUM7SUExQ0QsUUFBUTs7UUFDTixJQUFJLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUM7WUFDaEQsTUFBTSxFQUFFO2dCQUNOLENBQUEsTUFBQSxJQUFJLENBQUMsaUJBQWlCLDBDQUFFLE1BQU0sS0FBSSxFQUFFO2dCQUNwQyxVQUFVLENBQUMsT0FBTyxDQUFDO29CQUNqQixVQUFVLENBQUMsUUFBUTtvQkFDbkIsVUFBVSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUM7b0JBQ3BCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxNQUFBLElBQUksQ0FBQyxpQkFBaUIsMENBQUUsT0FBTyxDQUFDO2lCQUN6RCxDQUFDO2FBQ0g7U0FDRixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsTUFBTTtRQUNKLElBQUksSUFBSSxDQUFDLG1CQUFvQixDQUFDLEtBQUssRUFBRTtZQUNuQyxNQUFNLFdBQVcsbUNBQ1osSUFBSSxDQUFDLGlCQUFpQixLQUN6QixNQUFNLEVBQUUsSUFBSSxDQUFDLG1CQUFvQixDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUUsQ0FBQyxLQUFLLEdBQ3ZELENBQUM7WUFFRixJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztTQUM3QjthQUFNO1lBQ0wsSUFBSSxDQUFDLG1CQUFvQixDQUFDLGdCQUFnQixFQUFFLENBQUM7U0FDOUM7SUFDSCxDQUFDO0lBRUQsa0JBQWtCLENBQUMsT0FBb0I7UUFDckMsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLG1CQUFvQixDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUN4RCxPQUFRLENBQUMsYUFBYSxDQUFDLENBQUMsVUFBVSxDQUFDLFFBQVEsRUFBRSxVQUFVLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEcsT0FBUSxDQUFDLHNCQUFzQixFQUFFLENBQUM7UUFDbEMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDbkMsQ0FBQztJQUVPLGtCQUFrQixDQUFDLE9BQXFCOztRQUM5QyxNQUFNLGFBQWEsR0FBRyxDQUFBLE1BQUEsTUFBQSxJQUFJLENBQUMsaUJBQWlCLDBDQUFFLFVBQVUsMENBQUUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEtBQUksQ0FBQyxDQUFDO1FBQ3JGLE9BQU8sQ0FBQSxNQUFBLE1BQUEsSUFBSSxDQUFDLGlCQUFpQiwwQ0FBRSxVQUFVLDBDQUFFLFlBQVksTUFBSyxJQUFJLENBQUMsaUJBQWlCLENBQUMsR0FBRztZQUNwRixDQUFDLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFBLE9BQU8sYUFBUCxPQUFPLHVCQUFQLE9BQU8sQ0FBRSxPQUFPLEtBQUksQ0FBQyxDQUFDO1lBQ3ZDLENBQUMsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDO0lBQzVDLENBQUM7O29JQTdDVSxzQ0FBc0M7d0hBQXRDLHNDQUFzQyx5T0NWbkQsMjlHQTRFQTs0RkRsRWEsc0NBQXNDO2tCQUpsRCxTQUFTO21CQUFDO29CQUNULFFBQVEsRUFBRSxxQ0FBcUM7b0JBQy9DLFdBQVcsRUFBRSxtREFBbUQ7aUJBQ2pFO2tHQUVVLFdBQVc7c0JBQW5CLEtBQUs7Z0JBQ0csZUFBZTtzQkFBdkIsS0FBSztnQkFDSSxhQUFhO3NCQUF0QixNQUFNO2dCQUNHLElBQUk7c0JBQWIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgT25Jbml0LCBPdXRwdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEZvcm1CdWlsZGVyLCBGb3JtR3JvdXAsIFZhbGlkYXRvckZuLCBWYWxpZGF0b3JzIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgTWFuYWdlUG9ja2V0c0Jhc2VTdGVwIH0gZnJvbSAnLi4vLi4vLi4vbWFuYWdlLXBvY2tldHMtY29tbW9uL2NvbXBvbmVudHMvbWFuYWdlLXBvY2tldHMtYmFzZS1zdGVwL21hbmFnZS1wb2NrZXRzLWJhc2Utc3RlcCc7XG5pbXBvcnQgeyBBY2NvdW50SXRlbSB9IGZyb20gJy4uLy4uLy4uL21hbmFnZS1wb2NrZXRzLWNvbW1vbi9tb2RlbC9hY2NvdW50cy5tb2RlbCc7XG5pbXBvcnQgeyBQYXltZW50Rm9ybUl0ZW0gfSBmcm9tICcuLi8uLi8uLi9tYW5hZ2UtcG9ja2V0cy1jb21tb24vbW9kZWwvcGF5bWVudC5tb2RlbCc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2JiLW1hbmFnZS1wb2NrZXRzLXRyYW5zZmVycy1kZXRhaWxzJyxcbiAgdGVtcGxhdGVVcmw6ICcuL21hbmFnZS1wb2NrZXRzLXRyYW5zZmVycy1kZXRhaWxzLmNvbXBvbmVudC5odG1sJyxcbn0pXG5leHBvcnQgY2xhc3MgTWFuYWdlUG9ja2V0c1RyYW5zZmVyc0RldGFpbHNDb21wb25lbnQgZXh0ZW5kcyBNYW5hZ2VQb2NrZXRzQmFzZVN0ZXAgaW1wbGVtZW50cyBPbkluaXQge1xuICBASW5wdXQoKSBhY2NvdW50TGlzdD86IEFjY291bnRJdGVtW107XG4gIEBJbnB1dCgpIGpvdXJuZXlDdXJyZW5jeT86IHN0cmluZztcbiAgQE91dHB1dCgpIGFjY291bnRDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPEFjY291bnRJdGVtPigpO1xuICBAT3V0cHV0KCkgbmV4dCA9IG5ldyBFdmVudEVtaXR0ZXI8UGF5bWVudEZvcm1JdGVtPigpO1xuICB0cmFuc2ZlckRldGFpbHNGb3JtPzogRm9ybUdyb3VwO1xuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMudHJhbnNmZXJEZXRhaWxzRm9ybSA9IHRoaXMuZm9ybUJ1aWxkZXIuZ3JvdXAoe1xuICAgICAgYW1vdW50OiBbXG4gICAgICAgIHRoaXMucGFydGlhbE5ld1BheW1lbnQ/LmFtb3VudCB8fCAnJyxcbiAgICAgICAgVmFsaWRhdG9ycy5jb21wb3NlKFtcbiAgICAgICAgICBWYWxpZGF0b3JzLnJlcXVpcmVkLFxuICAgICAgICAgIFZhbGlkYXRvcnMubWluKDAuMDEpLFxuICAgICAgICAgIHRoaXMudmFsaWRhdG9yc1NlbGVjdG9yKHRoaXMucGFydGlhbE5ld1BheW1lbnQ/LmFjY291bnQpLFxuICAgICAgICBdKSxcbiAgICAgIF0sXG4gICAgfSk7XG4gIH1cblxuICBnb05leHQoKSB7XG4gICAgaWYgKHRoaXMudHJhbnNmZXJEZXRhaWxzRm9ybSEudmFsaWQpIHtcbiAgICAgIGNvbnN0IHBheW1lbnRGb3JtOiBQYXltZW50Rm9ybUl0ZW0gPSB7XG4gICAgICAgIC4uLnRoaXMucGFydGlhbE5ld1BheW1lbnQsXG4gICAgICAgIGFtb3VudDogdGhpcy50cmFuc2ZlckRldGFpbHNGb3JtIS5nZXQoJ2Ftb3VudCcpIS52YWx1ZSxcbiAgICAgIH07XG5cbiAgICAgIHRoaXMubmV4dC5lbWl0KHBheW1lbnRGb3JtKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50cmFuc2ZlckRldGFpbHNGb3JtIS5tYXJrQWxsQXNUb3VjaGVkKCk7XG4gICAgfVxuICB9XG5cbiAgb25BY2NvdW50U2VsZWN0aW9uKGFjY291bnQ6IEFjY291bnRJdGVtKSB7XG4gICAgY29uc3QgY29udHJvbCA9IHRoaXMudHJhbnNmZXJEZXRhaWxzRm9ybSEuZ2V0KCdhbW91bnQnKTtcbiAgICBjb250cm9sIS5zZXRWYWxpZGF0b3JzKFtWYWxpZGF0b3JzLnJlcXVpcmVkLCBWYWxpZGF0b3JzLm1pbigwLjAxKSwgdGhpcy52YWxpZGF0b3JzU2VsZWN0b3IoYWNjb3VudCldKTtcbiAgICBjb250cm9sIS51cGRhdGVWYWx1ZUFuZFZhbGlkaXR5KCk7XG4gICAgdGhpcy5hY2NvdW50Q2hhbmdlLmVtaXQoYWNjb3VudCk7XG4gIH1cblxuICBwcml2YXRlIHZhbGlkYXRvcnNTZWxlY3RvcihhY2NvdW50PzogQWNjb3VudEl0ZW0pOiBWYWxpZGF0b3JGbiB7XG4gICAgY29uc3QgcG9ja2V0QmFsYW5jZSA9IHRoaXMucGFydGlhbE5ld1BheW1lbnQ/LnBvY2tldEluZm8/LnBvY2tldC5iYWxhbmNlLmFtb3VudCB8fCAwO1xuICAgIHJldHVybiB0aGlzLnBhcnRpYWxOZXdQYXltZW50Py5wb2NrZXRJbmZvPy50cmFuc2ZlclR5cGUgPT09IHRoaXMudHJhbnNmZXJUeXBlc0VudW0uQUREXG4gICAgICA/IFZhbGlkYXRvcnMubWF4KGFjY291bnQ/LmJhbGFuY2UgfHwgMClcbiAgICAgIDogVmFsaWRhdG9ycy5tYXgoTnVtYmVyKHBvY2tldEJhbGFuY2UpKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgZm9ybUJ1aWxkZXI6IEZvcm1CdWlsZGVyKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxufVxuIiwiPGZvcm0gW2Zvcm1Hcm91cF09XCJ0cmFuc2ZlckRldGFpbHNGb3JtXCIgKHN1Ym1pdCk9XCJnb05leHQoKVwiPlxuICA8ZGl2IGNsYXNzPVwiYmItYmxvY2sgYmItYmxvY2stLXhsXCI+XG5cbiAgICA8bGFiZWw+XG4gICAgICB7eyBwYXJ0aWFsTmV3UGF5bWVudD8ucG9ja2V0SW5mbz8udHJhbnNmZXJUeXBlID09PSB0cmFuc2ZlclR5cGVzRW51bS5BREQgPyBwb2NrZXRMb2NhbGl6YXRpb25zLnRyYW5zZmVycy5kZXRhaWxzLmFkZE1vbmV5SGVhZGVyIDogcG9ja2V0TG9jYWxpemF0aW9ucy50cmFuc2ZlcnMuZGV0YWlscy53aXRoZHJhd01vbmV5SGVhZGVyIH19XG4gICAgPC9sYWJlbD5cblxuICAgIDxiYi1hY2NvdW50LXNlbGVjdG9yLXVpXG4gICAgICBbaXRlbXNdPVwiYWNjb3VudExpc3RcIlxuICAgICAgW3NlbGVjdGVkSXRlbXNdPVwicGFydGlhbE5ld1BheW1lbnQ/LmFjY291bnQgPz8gJydcIlxuICAgICAgW2Nsb3NlT25TZWxlY3RdPVwidHJ1ZVwiXG4gICAgICBbaGlnaGxpZ2h0XT1cImZhbHNlXCJcbiAgICAgIFtyZXF1aXJlZF09XCJ0cnVlXCJcbiAgICAgIGRyb3Bkb3duUG9zaXRpb249XCJib3R0b21cIlxuICAgICAgcGxhY2Vob2xkZXI9XCJTZWxlY3QgYW4gQWNjb3VudFwiXG4gICAgICBpMThuLXBsYWNlaG9sZGVyPVwiU2VsZWN0IGFuIEFjY291bnRAQG1hbmFnZVBvY2tldHMudHJhbnNmZXJzLmRldGFpbHMuYWNjb3VudFNlbGVjdG9yLnBsYWNlaG9sZGVyXCJcbiAgICAgIChjaGFuZ2UpPVwib25BY2NvdW50U2VsZWN0aW9uKCRldmVudClcIlxuICAgID48L2JiLWFjY291bnQtc2VsZWN0b3ItdWk+XG4gIDwvZGl2PlxuXG4gIDxkaXYgY2xhc3M9XCJiYi1ibG9jayBiYi1ibG9jay0teGxcIj5cbiAgICA8ZGl2IGNsYXNzPVwiYmItc3RhY2sgcm93XCI+XG4gICAgICA8ZGl2IGNsYXNzPVwiYmItc3RhY2tfX2l0ZW0gY29sLTZcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImJiLWJsb2NrIGJiLWJsb2NrLS1zbVwiPlxuICAgICAgICAgIDxiYi1hbW91bnQtaW5wdXQtdWlcbiAgICAgICAgICAgIGZvcm1Db250cm9sTmFtZT1cImFtb3VudFwiXG4gICAgICAgICAgICBsYWJlbD1cIkFtb3VudFwiXG4gICAgICAgICAgICBpMThuLWxhYmVsPVwiQW1vdW50QEBtYW5hZ2VQb2NrZXRzLnRyYW5zZmVycy5kZXRhaWxzLmFtb3VudC5wbGFjZWhvbGRlclwiXG4gICAgICAgICAgICBbYXR0ci5hcmlhLWludmFsaWRdPVwiIWlzRmllbGRWYWxpZCh0cmFuc2ZlckRldGFpbHNGb3JtLCAnYW1vdW50JylcIlxuICAgICAgICAgICAgW2N1cnJlbmN5XT1cImpvdXJuZXlDdXJyZW5jeVwiXG4gICAgICAgICAgICBwbGFjZWhvbGRlcj1cIjAuMDBcIlxuICAgICAgICAgICAgaTE4bi1wbGFjZWhvbGRlcj1cIjAuMDB8UHJpY2UgZXhhbXBsZUBAbWFuYWdlUG9ja2V0cy50cmFuc2ZlcnMuZGV0YWlscy5hbW91bnQucGxhY2Vob2xkZXJcIlxuICAgICAgICAgID48L2JiLWFtb3VudC1pbnB1dC11aT5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJiYi1zdWJ0aXRsZSBiYi10ZXh0LXN1cHBvcnRcIiBpMThuPVwiQXZhaWxhYmxlIGJhbGFuY2V8VmFsdWUgaW5jbHVkZXMgYSBmb3JtYXR0ZWQgY3VycmVuZHlAQG1hbmFnZVBvY2tldHMudHJhbnNmZXJzLmRldGFpbHMuYXZhaWxhYmxlQmFsYW5jZVwiICpuZ0lmPVwicGFydGlhbE5ld1BheW1lbnQ/LnBvY2tldEluZm8/LnRyYW5zZmVyVHlwZSA9PT0gdHJhbnNmZXJUeXBlc0VudW0uV0lUSERSQVdcIj5cbiAgICAgICAgICA8c3Bhbj5BdmFpbGFibGUgQmFsYW5jZTogPC9zcGFuPlxuICAgICAgICAgIDxiYi1hbW91bnQtdWlcbiAgICAgICAgICAgIFthbW91bnRdPVwicGFydGlhbE5ld1BheW1lbnQ/LnBvY2tldEluZm8/LnBvY2tldD8uYmFsYW5jZT8uYW1vdW50XCJcbiAgICAgICAgICAgIFtjdXJyZW5jeV09XCJwYXJ0aWFsTmV3UGF5bWVudD8ucG9ja2V0SW5mbz8ucG9ja2V0Py5iYWxhbmNlPy5jdXJyZW5jeUNvZGVcIlxuICAgICAgICAgID48L2JiLWFtb3VudC11aT5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxiYi1pbnB1dC12YWxpZGF0aW9uLW1lc3NhZ2UtdWkgW3Nob3dFcnJvcnNdPVwiIWlzRmllbGRWYWxpZCh0cmFuc2ZlckRldGFpbHNGb3JtLCAnYW1vdW50JylcIiA+XG4gICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgZXJyb3Igb2YgZ2V0RmllbGRFcnJvcnModHJhbnNmZXJEZXRhaWxzRm9ybSwgJ2Ftb3VudCcpIHwga2V5dmFsdWU7IGxhc3QgYXMgbGFzdFwiPlxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImxhc3RcIiBbbmdTd2l0Y2hdPVwiZXJyb3Iua2V5XCI+XG4gICAgICAgICAgICAgIDxzcGFuICpuZ1N3aXRjaENhc2U9XCInbWF4J1wiPlxuICAgICAgICAgICAgICAgIHt7IHBhcnRpYWxOZXdQYXltZW50Py5wb2NrZXRJbmZvPy50cmFuc2ZlclR5cGUgPT09IHRyYW5zZmVyVHlwZXNFbnVtLkFERCA/IHBvY2tldExvY2FsaXphdGlvbnMudHJhbnNmZXJzLmRldGFpbHMuYWRkTW9uZXlFcnJvciA6IHBvY2tldExvY2FsaXphdGlvbnMudHJhbnNmZXJzLmRldGFpbHMud2l0aGRyYXdNb25leUVycm9yIH19XG4gICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgPHNwYW4gaTE4bj1cIkFtb3VudCBpcyByZXF1aXJlZEBAbWFuYWdlUG9ja2V0cy50cmFuc2ZlcnMuZGV0YWlscy5hbW91bnQuZXJyb3IucmVxdWlyZWRcIiAqbmdTd2l0Y2hEZWZhdWx0PlxuICAgICAgICAgICAgICAgIEFtb3VudCBpcyByZXF1aXJlZFxuICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPC9iYi1pbnB1dC12YWxpZGF0aW9uLW1lc3NhZ2UtdWk+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG5cbiAgPGRpdiBjbGFzcz1cImJiLWJ1dHRvbi1iYXJcIj5cbiAgICA8YnV0dG9uIFxuICAgICAgYmJCdXR0b24gXG4gICAgICBjbGFzcz1cImJiLWJ1dHRvbi1iYXJfX2J1dHRvblwiIFxuICAgICAgdHlwZT1cInN1Ym1pdFwiXG4gICAgPlxuICAgICAge3sgcGFydGlhbE5ld1BheW1lbnQ/LnBvY2tldEluZm8/LnRyYW5zZmVyVHlwZSA9PT0gdHJhbnNmZXJUeXBlc0VudW0uQUREID8gcG9ja2V0TG9jYWxpemF0aW9ucy50cmFuc2ZlcnMuZGV0YWlscy5hZGRNb25leUNvbnRpbnVlQnV0dG9uIDogcG9ja2V0TG9jYWxpemF0aW9ucy50cmFuc2ZlcnMuZGV0YWlscy53aXRoZHJhd01vbmV5Q29udGludWVCdXR0b24gfX1cbiAgICA8L2J1dHRvbj5cbiAgICA8YnV0dG9uIFxuICAgICAgYmJCdXR0b24gXG4gICAgICBjb2xvcj1cImxpbmtcIlxuICAgICAgY2xhc3M9XCJiYi1idXR0b24tYmFyX19idXR0b24gYmItYnV0dG9uLWJhcl9fYnV0dG9uLS1hY3Jvc3NcIlxuICAgICAgaTE4bj1cIkNhbmNlbEBAbWFuYWdlUG9ja2V0cy50cmFuc2ZlcnMuZGV0YWlscy5idXR0b24uY2FuY2VsXCJcbiAgICAgIChjbGljayk9XCJhYm9ydCgpXCJcbiAgICA+XG4gICAgICBDYW5jZWxcbiAgICA8L2J1dHRvbj5cbiAgPC9kaXY+XG48L2Zvcm0+XG4iXX0=