import { ChangeDetectionStrategy, Component, Input, Output, EventEmitter, NgZone } from '@angular/core';
import { DocumentViewerType, downloadFile } from '../../../model/UI/document-viewer-commons';
import * as i0 from "@angular/core";
import * as i1 from "@backbase/ui-ang/icon";
import * as i2 from "@backbase/ui-ang/dropdown-menu";
import * as i3 from "@backbase/ui-ang/button";
export class DocumentViewerHeaderComponent {
    constructor(ngZone) {
        this.ngZone = ngZone;
        this.isLoading = false;
        //eslint-disable-next-line @angular-eslint/no-output-native
        this.close = new EventEmitter();
    }
    set source(src) {
        if (src) {
            this.revokeObjectURL();
            this.documentObjectURL = src;
        }
    }
    ngOnDestroy() {
        this.revokeObjectURL();
    }
    onOpenDocument() {
        if (!this.documentObjectURL) {
            return;
        }
        this.openImage(this.documentObjectURL);
    }
    onPrintDocument() {
        if (!this.documentObjectURL) {
            return;
        }
        this.printWindow(this.openImage(this.documentObjectURL));
    }
    onDownloadDocument() {
        if (!this.documentObjectURL) {
            return;
        }
        downloadFile(this.documentObjectURL, this.filename);
    }
    openImage(documentObjectURL) {
        const image = new Image();
        const newWindow = window.open('about:blank', '_new');
        image.src = documentObjectURL;
        newWindow.document.write(image.outerHTML);
        return newWindow;
    }
    printWindow(window) {
        this.ngZone.runOutsideAngular(() => {
            setTimeout(() => {
                window.focus();
                window.print();
            }, 0);
        });
    }
    revokeObjectURL() {
        if (this.documentObjectURL) {
            window.URL.revokeObjectURL(this.documentObjectURL);
        }
    }
}
DocumentViewerHeaderComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: DocumentViewerHeaderComponent, deps: [{ token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component });
DocumentViewerHeaderComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.16", type: DocumentViewerHeaderComponent, selector: "bb-document-viewer-header", inputs: { filename: "filename", filetype: "filetype", source: "source", isLoading: "isLoading" }, outputs: { close: "close" }, ngImport: i0, template: "<div class=\"bb-document-viewer-header\">\n  <span class=\"bb-document-viewer-header__title bb-stack\">\n    <bb-icon-ui\n      class=\"bb-stack__item bb-stack__item--spacing-sm\"\n      data-role=\"document-viewer-header-icon\"\n      name=\"description\"\n      size=\"md\"\n    ></bb-icon-ui>\n    <span class=\"bb-stack__item\" data-role=\"document-viewer-header-filename\">{{ filename }}</span>\n  </span>\n  <div class=\"bb-stack\">\n    <!-- web view -->\n    <div\n      class=\"\n        bb-stack__item bb-stack__item--spacing-none bb-stack__item--push-right\n        bb-document-viewer-header-controls__web-view\n      \"\n    >\n      <button\n        bbButton\n        data-role=\"print-document-btn\"\n        class=\"bb-document-viewer-interactor-controls__button bb-document-viewer-header__spacer\"\n        aria-label=\"print\"\n        i18n-aria-label=\"Print document button@@document-viewer-header.aria-label.print-document-btn\"\n        buttonSize=\"sm\"\n        (click)=\"!isLoading && onPrintDocument()\"\n      >\n        <bb-icon-ui name=\"local-printshop\" size=\"md\" color=\"light\"></bb-icon-ui>\n      </button>\n\n      <button\n        bbButton\n        data-role=\"download-document-btn\"\n        class=\"bb-document-viewer-interactor-controls__button bb-document-viewer-header__spacer\"\n        aria-label=\"download\"\n        i18n-aria-label=\"Download document button@document-viewer-header.aria-label.download-document-btn\"\n        buttonSize=\"sm\"\n        (click)=\"!isLoading && onDownloadDocument()\"\n      >\n        <bb-icon-ui name=\"save-alt\" size=\"md\" color=\"light\"></bb-icon-ui>\n      </button>\n\n      <button\n        bbButton\n        data-role=\"open-document-btn\"\n        class=\"bb-document-viewer-interactor-controls__button bb-document-viewer-header__spacer\"\n        aria-label=\"new tab\"\n        i18n-aria-label=\"Open document in new tab button@@document-viewer-header.aria-label.open-document-new-tab-btn\"\n        buttonSize=\"sm\"\n        (click)=\"!isLoading && onOpenDocument()\"\n      >\n        <bb-icon-ui name=\"open-in-new\" size=\"md\" color=\"light\"></bb-icon-ui>\n      </button>\n\n      <button\n        bbButton\n        data-role=\"close-document-btn\"\n        class=\"bb-document-viewer-interactor-controls__button bb-document-viewer-header__spacer\"\n        aria-label=\"close\"\n        i18n-aria-label=\"Close document button@@document-viewer-header.aria-label.close-btn\"\n        buttonSize=\"sm\"\n        (click)=\"close.emit()\"\n      >\n        <bb-icon-ui name=\"times\" size=\"md\" color=\"light\"></bb-icon-ui>\n      </button>\n    </div>\n\n    <!-- mobile view -->\n    <div\n      class=\"\n        bb-stack__item bb-stack__item--spacing-none bb-stack__item--push-right\n        bb-document-viewer-header-controls__mobile-view\n      \"\n    >\n      <div class=\"bb-stack\">\n        <bb-dropdown-menu-ui\n          container=\"body\"\n          data-role=\"options-menu-dropdown\"\n          class=\"bb-stack__item\"\n          icon=\"ellipsis-h\"\n          btnColor=\"muted\"\n          buttonSize=\"sm\"\n          [btnCircle]=\"true\"\n          iconSize=\"md\"\n          iconColor=\"light\"\n          ariaLabel=\"Check image export dropdown menu\"\n          i18n-ariaLabel=\"Check image export dropdown menu@@document-viewer-header.export-dropdown-menu.ariaLabel\"\n        >\n          <ng-template bbDropdownMenuItem>\n            <a\n              role=\"menuitem\"\n              class=\"dropdown-item\"\n              data-role=\"open-document-item\"\n              (click)=\"!isLoading && onOpenDocument()\"\n              href=\"javaScript:void(0);\"\n            >\n              <bb-icon-ui class=\"bb-document-viewer-header__dropdown-icon\" name=\"open-in-new\" size=\"md\"></bb-icon-ui>\n              <span i18n=\"Open image in new tab@@document-viewer-header.controlsList.open-in-new-tab\"\n                >Open in new tab</span\n              >\n            </a>\n            <a\n              role=\"menuitem\"\n              class=\"dropdown-item\"\n              data-role=\"download-document-item\"\n              (click)=\"!isLoading && onDownloadDocument()\"\n              href=\"javaScript:void(0);\"\n            >\n              <bb-icon-ui class=\"bb-document-viewer-header__dropdown-icon\" name=\"save-alt\" size=\"md\"></bb-icon-ui>\n              <span i18n=\"Download image@@document-viewer-header.controlsList.download-image\">Download</span>\n            </a>\n            <a\n              role=\"menuitem\"\n              class=\"dropdown-item\"\n              data-role=\"print-document-item\"\n              (click)=\"!isLoading && onPrintDocument()\"\n              href=\"javaScript:void(0);\"\n            >\n              <bb-icon-ui\n                class=\"bb-document-viewer-header__dropdown-icon\"\n                name=\"local-printshop\"\n                size=\"md\"\n              ></bb-icon-ui>\n              <span i18n=\"Print image@@document-viewer-header.controlsList.print-image\">Print</span>\n            </a>\n          </ng-template>\n        </bb-dropdown-menu-ui>\n        <button\n          bbButton\n          data-role=\"close-document-btn\"\n          class=\"bb-stack__item bb-document-viewer-interactor-controls__button bb-document-viewer-header__spacer\"\n          aria-label=\"close\"\n          i18n-aria-label=\"Close document button@@document-viewer-header.aria-label.close-btn\"\n          buttonSize=\"sm\"\n          (click)=\"close.emit()\"\n        >\n          <bb-icon-ui name=\"times\" size=\"md\" color=\"light\"></bb-icon-ui>\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n", components: [{ type: i1.IconComponent, selector: "bb-icon-ui", inputs: ["name", "inverse", "size", "color", "animate", "aria-label", "cropped", "backgroundType"] }, { type: i2.DropdownMenuComponent, selector: "bb-dropdown-menu-ui", inputs: ["label", "disabled", "options", "icon", "iconSize", "iconColor", "btnColor", "btnCircle", "optionLabelKey", "fullWidth", "autoClose", "container", "position", "ariaLabel", "dropDownMenuRole", "dropDownMenuId", "buttonSize", "dropDownButtonLabel", "visibleElementDependingOnViewport", "role"], outputs: ["select"] }], directives: [{ type: i3.ButtonDirective, selector: "button[bbButton]", inputs: ["type", "color", "buttonSize", "block", "circle"] }, { type: i2.DropdownMenuItemDirective, selector: "ng-template[bbDropdownMenuItem]" }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: DocumentViewerHeaderComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'bb-document-viewer-header',
                    templateUrl: './document-viewer-header.component.html',
                    changeDetection: ChangeDetectionStrategy.OnPush,
                }]
        }], ctorParameters: function () { return [{ type: i0.NgZone }]; }, propDecorators: { filename: [{
                type: Input
            }], filetype: [{
                type: Input
            }], source: [{
                type: Input
            }], isLoading: [{
                type: Input
            }], close: [{
                type: Output
            }] } });
//# sourceMappingURL=document-viewer-header.component.js.map