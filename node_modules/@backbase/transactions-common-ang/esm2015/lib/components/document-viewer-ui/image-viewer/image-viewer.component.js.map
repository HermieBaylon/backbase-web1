{"version":3,"file":"image-viewer.component.js","sourceRoot":"","sources":["../../../../../../../../../../libs/widgets/transactions/transactions-common-ang/src/lib/components/document-viewer-ui/image-viewer/image-viewer.component.ts","../../../../../../../../../../libs/widgets/transactions/transactions-common-ang/src/lib/components/document-viewer-ui/image-viewer/image-viewer.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,uBAAuB,EAAE,SAAS,EAAE,MAAM,EAAE,YAAY,EAAE,KAAK,EAAa,MAAM,eAAe,CAAC;AAC3G,OAAO,EAAE,YAAY,EAAsB,MAAM,2BAA2B,CAAC;;;;AAO7E,MAAM,WAAW,GAAG,GAAG,CAAC;AACxB,MAAM,iBAAiB,GAAG,CAAC,CAAC;AAC5B,MAAM,kBAAkB,GAAG,GAAG,CAAC;AAO/B,MAAM,OAAO,oBAAoB;IAmB/B,YAA6B,YAA0B;QAA1B,iBAAY,GAAZ,YAAY,CAAc;QAV9C,oBAAe,GAAoB,EAAE,OAAO,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC;QAC3D,aAAQ,GAAG,IAAI,YAAY,EAAU,CAAC;QAEhD,iBAAY,GAAiB,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC;IAOgB,CAAC;IAlB3D,IAAa,MAAM,CAAC,GAAuB;QACzC,IAAI,GAAG,EAAE;YACP,IAAI,CAAC,uBAAuB,EAAE,CAAC;YAC/B,IAAI,CAAC,cAAc,GAAG,GAAG,CAAC;YAE1B,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,YAAY,CAAC,8BAA8B,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;SACpG;IACH,CAAC;IAaD,IAAI,UAAU;QACZ,OAAO,IAAI,CAAC,YAAY,CAAC,KAAK,IAAI,kBAAkB,CAAC;IACvD,CAAC;IAED,IAAI,SAAS;QACX,OAAO,IAAI,CAAC,YAAY,CAAC,KAAK,IAAI,iBAAiB,CAAC;IACtD,CAAC;IAED,IAAI,KAAK;QACP,OAAO,IAAI,CAAC,YAAY,CAAC,wBAAwB,CAAC,SAAS,IAAI,CAAC,YAAY,CAAC,KAAK,GAAG,CAAC,CAAC;IACzF,CAAC;IAED,WAAW;QACT,IAAI,CAAC,uBAAuB,EAAE,CAAC;IACjC,CAAC;IAED,MAAM;QACJ,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,IAAI,CAAC,YAAY,CAAC,KAAK,IAAI,WAAW,CAAC;SACxC;IACH,CAAC;IAED,OAAO;QACL,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,YAAY,CAAC,KAAK,IAAI,WAAW,CAAC;SACxC;IACH,CAAC;IAEO,uBAAuB;QAC7B,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,MAAM,CAAC,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;SACjD;IACH,CAAC;;kHArDU,oBAAoB;sGAApB,oBAAoB,4JCjBjC,6iBAkBA;4FDDa,oBAAoB;kBALhC,SAAS;mBAAC;oBACT,QAAQ,EAAE,iBAAiB;oBAC3B,WAAW,EAAE,+BAA+B;oBAC5C,eAAe,EAAE,uBAAuB,CAAC,MAAM;iBAChD;mGAEc,MAAM;sBAAlB,KAAK;gBAQG,eAAe;sBAAvB,KAAK;gBACI,QAAQ;sBAAjB,MAAM","sourcesContent":["import { ChangeDetectionStrategy, Component, Output, EventEmitter, Input, OnDestroy } from '@angular/core';\nimport { DomSanitizer, SafeStyle, SafeUrl } from '@angular/platform-browser';\nimport { NavigationState } from '../../../model/UI/document-viewer-commons';\n\ninterface ImageUIState {\n  scale: number;\n}\n\nconst ZOOM_FACTOR = 1.1;\nconst ZOOM_IN_THRESHOLD = 4;\nconst ZOOM_OUT_THRESHOLD = 0.1;\n\n@Component({\n  selector: 'bb-image-viewer',\n  templateUrl: './image-viewer.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ImageViewerComponent implements OnDestroy {\n  @Input() set source(src: string | undefined) {\n    if (src) {\n      this.revokeObjectURLIfNeeded();\n      this.imageObjectUrl = src;\n\n      this.imageObjectTrustedUrl = this.domSanitizer.bypassSecurityTrustResourceUrl(this.imageObjectUrl);\n    }\n  }\n  @Input() navigationState: NavigationState = { currIdx: 0, total: 0 };\n  @Output() navigate = new EventEmitter<number>();\n  imageObjectTrustedUrl: SafeUrl | undefined;\n  imageUiState: ImageUIState = { scale: 1 };\n\n  /**\n   * Internal\n   */\n  private imageObjectUrl: string | undefined;\n\n  constructor(private readonly domSanitizer: DomSanitizer) {}\n\n  get canZoomOut(): boolean {\n    return this.imageUiState.scale >= ZOOM_OUT_THRESHOLD;\n  }\n\n  get canZoomIn(): boolean {\n    return this.imageUiState.scale <= ZOOM_IN_THRESHOLD;\n  }\n\n  get scale(): SafeStyle {\n    return this.domSanitizer.bypassSecurityTrustStyle(`scale(${this.imageUiState.scale})`);\n  }\n\n  ngOnDestroy() {\n    this.revokeObjectURLIfNeeded();\n  }\n\n  zoomIn(): void {\n    if (this.canZoomIn) {\n      this.imageUiState.scale *= ZOOM_FACTOR;\n    }\n  }\n\n  zoomOut(): void {\n    if (this.canZoomOut) {\n      this.imageUiState.scale /= ZOOM_FACTOR;\n    }\n  }\n\n  private revokeObjectURLIfNeeded(): void {\n    if (this.imageObjectUrl) {\n      window.URL.revokeObjectURL(this.imageObjectUrl);\n    }\n  }\n}\n","<div class=\"bb-img-viewer-container bb-stack bb-stack--center\">\n  <img\n    #imgRef\n    class=\"bb-img-viewer-container__img\"\n    [style.transform]=\"scale\"\n    [src]=\"imageObjectTrustedUrl\"\n    alt=\"Transaction check image\"\n    (click)=\"$event.stopPropagation()\"\n  />\n</div>\n<bb-document-viewer-interactor\n  [navigationState]=\"navigationState\"\n  [canZoomOut]=\"canZoomOut\"\n  [canZoomIn]=\"canZoomIn\"\n  (navigate)=\"navigate.emit($event)\"\n  (zoomIn)=\"zoomIn()\"\n  (zoomOut)=\"zoomOut()\"\n></bb-document-viewer-interactor>\n"]}