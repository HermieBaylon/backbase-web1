import { DecimalPipe, getLocaleNumberSymbol, getNumberOfCurrencyDigits, NumberSymbol } from '@angular/common';
import { Component, EventEmitter, Inject, Input, LOCALE_ID, Optional, Output, Self, ViewChild, } from '@angular/core';
import { FormControl } from '@angular/forms';
import BigNumber from 'bignumber.js';
import { getInputNextId } from '@backbase/ui-ang/base-classes';
import { idListAttr } from '@backbase/ui-ang/util';
import * as i0 from "@angular/core";
import * as i1 from "@backbase/ui-ang/services";
import * as i2 from "@angular/forms";
import * as i3 from "@backbase/ui-ang/dropdown-single-select";
import * as i4 from "@angular/common";
const defaultIntLength = 13;
const defaultDecimalPrecision = 2;
/**
 * @name CurrencyInputComponent
 *
 * @a11y Current component provide option to pass needed accessibility
 * attributes. You need to take care of properties that are required in your case :
 *  - aria-describedby
 *  - aria-invalid
 *  - aria-labelledby
 *  - integerLabelSrOnly
 *  - decimalLabelSrOnly
 * @description
 * Component for displaying and managing currency and it amount
 *
 */
export class CurrencyInputComponent {
    constructor(el, locale, domAttributeService, parentFormControl) {
        this.el = el;
        this.locale = locale;
        this.domAttributeService = domAttributeService;
        this.parentFormControl = parentFormControl;
        this.currencyList = [];
        this.currencyDisabledState = {
            currency: false,
            integer: false,
            decimal: false,
        };
        this.decimalSeparator = getLocaleNumberSymbol(this.locale, NumberSymbol.CurrencyDecimal);
        this.localeSeparatorSymbols = [
            this.decimalSeparator,
            getLocaleNumberSymbol(this.locale, NumberSymbol.CurrencyGroup),
        ];
        /**
         * Number of minimum currency precision. Defaults to 2.
         */
        this.decMinLen = defaultDecimalPrecision;
        this.currControl = new FormControl();
        this.intControl = new FormControl();
        this.decControl = new FormControl();
        /**
         * The placeholder for the input. Defaults to 0.
         */
        this.placeholder = '0';
        /**
         * For set output type string/number, by default 'number', when  need work with long number
         * ( bigger than MAX_SAFE_INTEGER = 9,007,199,254,740,993 ) need to use 'string'
         */
        this.resultType = 'number';
        /**
         * Whether there should be only the integer part.
         * You have to keep in mind, that if you have decimal part, even ".00"
         * you will not be able to remove it
         */
        this.integer = false;
        /**
         * Whether the input is required. Defaults to false.
         */
        this.required = false;
        /**
         * Whether the input is read only. Defaults to false.
         */
        this.readonly = false;
        /**
         * Whether integer label is only visible for screen readers.
         * By default is visible if it is needed to hide change this property
         * to "true" and it will have class "sr-only"
         */
        this.integerLabelSrOnly = false;
        /**
         * By default is visible if it is needed to hide change this property
         * to "true" and it will have class "sr-only"
         * By default is hidden and accessible only for screen reader
         */
        this.decimalLabelSrOnly = false;
        /**
         * Whether decimal text is aligned to the right.
         * By default is false
         */
        this.isRightAligned = false;
        this._integerId = getInputNextId();
        this._decimalId = getInputNextId();
        this.idListAttr = idListAttr;
        this.initialized = false;
        /**
         * The label for the integer input.
         */
        this.integerLabel = '';
        /**
         * The label for the decimal input.
         */
        this.decimalLabel = '';
        /**
         * The label for the currency input.
         */
        this.currencyLabel = '';
        /**
         * Flag is used to allow input negative value
         */
        this.allowNegativeValue = false;
        /**
         * Aria label for the currency dropdown.
         */
        this.currencyListAriaLabel = 'Currency List Dropdown';
        /**
         * Aria label for the currency list with one item.
         */
        this.currencyListWithOnItemAriaLabel = 'Currency';
        /**
         * An event emitter for on blur actions.
         */
        this.blur = new EventEmitter();
        this.onChange = (_) => { };
        this.onTouched = () => { };
        this.currencyInputId = this.domAttributeService.generateId();
        this.currencyLabelId = this.domAttributeService.generateId();
        this.decimalInputId = this.domAttributeService.generateId();
        this.decimalLabelId = this.domAttributeService.generateId();
        this.integerInputId = this.domAttributeService.generateId();
        this.integerLabelId = this.domAttributeService.generateId();
        this.validationMessagesId = this.domAttributeService.generateId();
        BigNumber.config({
            FORMAT: {
                // grouping separator of the integer part
                groupSeparator: getLocaleNumberSymbol(this.locale, NumberSymbol.Group),
                // primary grouping size of the integer part
                groupSize: 3,
            },
        });
        if (this.parentFormControl != null) {
            // Setting the value accessor directly (instead of using
            // the providers) to avoid running into a circular import.
            this.parentFormControl.valueAccessor = this;
        }
    }
    /**
     * Configure the maximum number of decimals.
     * When greater than the default number of decimals for the specified currency, this value will take precedence.
     * Configuring this value can affect the input placeholder.
     */
    get decMaxLen() {
        return typeof this._decMaxLen === 'number' ? this._decMaxLen : this.getDecimalDigits(this.currency || '');
    }
    set decMaxLen(value) {
        this._decMaxLen = value;
    }
    /**
     * Non-configurable placeholder for the decimal input.
     * Displays a zero digit for every digit that is allowed in the decimal field.
     */
    get decPlaceholder() {
        return '0'.repeat(this.decMaxLen || 0);
    }
    /**
     * Whether the input is disabled. Defaults to false.
     */
    set disabled(disabled) {
        if (typeof disabled === 'boolean') {
            this.currencyDisabledState = {
                currency: disabled,
                integer: disabled,
                decimal: disabled,
            };
        }
        else {
            this.currencyDisabledState = disabled;
        }
    }
    get disabled() {
        return this.currencyDisabledState;
    }
    /**
     * Currency list to be displayed in the dropdown.
     *
     * Note: Non-empty currency list is required for the currency symbol
     * field to be shown. Otherwise, only the amount fields will be shown.
     *
     * Additionally, If only a single currency provided, the dropdown of
     * the currency selection will be disabled and its value set to that single currency
     */
    set currencies(list) {
        this.currencyList = list;
        if (this.currencyList && this.currencyList.length > 1) {
            this.currControl.enable();
        }
        else {
            this.currControl.disable();
        }
        // if currency is not set, use first item from the list
        if (this.currencyList && (this.currency === undefined || this.currencyList.indexOf(this.currency) === -1)) {
            // [FIXME] Nothing guarantees that the currencyList isn't empty
            this.updateCurrency(this.currencyList[0]);
        }
    }
    /**
     * The id for the integer input. Defaults to unique string.
     * Used to map the label to the input.
     */
    set integerId(value) {
        this._integerId = value;
    }
    get integerId() {
        return this._integerId;
    }
    /**
     * The id for the decimal input. Defaults to unique string.
     * Used to map the label to the input.
     */
    set decimalId(value) {
        this._decimalId = value;
    }
    get decimalId() {
        return this._decimalId;
    }
    ngOnInit() {
        this.initialized = true;
        if (!this.integerLabel || !this.decimalLabel) {
            console.warn(`
          Found an input from '
          ${this.constructor.name}
          ' without 'label' or 'aria-label' attribute, please provide one of them
        `);
        }
        this.setDisabled(this.currencyDisabledState);
        this.formatInteger();
    }
    ngOnChanges(changes) {
        if (changes.disabled) {
            this.setDisabled(this.currencyDisabledState);
        }
    }
    decOnBlur($event) {
        this.markAsTouched($event);
        this.formatDecimal(this.decControl);
    }
    get cur() {
        return this.currency;
    }
    get curList() {
        return this.currencyList;
    }
    ngAfterViewInit() {
        const len = this.el.nativeElement.getAttribute('maxlength');
        this.intMaxLen = len ? parseInt(len, 10) : defaultIntLength;
    }
    onPress($event) {
        this.focusDecEl($event.key);
        const keyCode = $event.keyCode || $event.which;
        const key = String.fromCharCode(keyCode);
        // allow to enter 'minus' only at the first position and if correspondent flag is enabled
        const isLeadingMinusPosition = this.allowNegativeValue && this.intEl && this.intEl.nativeElement.selectionStart === 0 && key === '-';
        // regexp is used here to support both of regular keyboard's numbers and numpad's numbers
        if (!(isLeadingMinusPosition || /^\d$/.test(key)) && $event.keyCode !== 8 && $event.keyCode !== 9) {
            $event.preventDefault();
        }
    }
    onInput() {
        const isFormatted = this.formatInteger();
        if (isFormatted) {
            this.triggerChange();
        }
    }
    updateCurrency(currency) {
        this.currency = currency || this.currControl.value;
        this.triggerChange();
    }
    checkValues() {
        if (this.currency === undefined) {
            return true;
        }
        if (!this.decControl.value && !this.intControl.value) {
            this.onChange(null);
            return true;
        }
        return false;
    }
    formatDecimal(decControl) {
        const { value } = decControl;
        if (value && this.decMaxLen && value.lenght < this.decMaxLen) {
            const updatedValue = String(value).padEnd(this.decMaxLen, '0');
            decControl.patchValue(updatedValue);
        }
    }
    triggerChange() {
        if (this.checkValues()) {
            return;
        }
        const int = this.intControl.value || '0';
        if (this.resultType === 'string') {
            const currencyGroupSymbol = new RegExp(`\\${this.localeSeparatorSymbols[1]}`, 'g');
            const whole = int.replace(currencyGroupSymbol, '');
            const dec = this.decControl.value || '0';
            const newAmount = whole + (dec !== '0' ? '.' + dec : '');
            this.onChange({
                currency: this.currency,
                amount: newAmount,
            });
        }
        else {
            const whole = parseInt(int.replace(/[^-\d]/g, ''), 10);
            const dec = parseFloat('0.' + this.decControl.value) || 0;
            const sign = whole < 0 ? -1 : 1;
            const newAmount = (Math.abs(whole) + dec) * sign;
            this.onChange({
                currency: this.currency,
                amount: newAmount,
            });
        }
    }
    checkNumeric(numeric) {
        // removed all dashes except the first one
        if (numeric.length > 0) {
            numeric = numeric[0] + numeric.slice(1).replace(/-/g, '');
        }
        numeric = this.sanitizeNumericValue(numeric);
        return numeric === '' ? numeric : new BigNumber(numeric || 0).toFormat();
    }
    /**
     * Formats integer to user-friendly format
     *
     * @returns Returns true in case of successful formatting, otherwise - false.
     */
    formatInteger() {
        // The behavior of `formatInteger` is dependent on some component inputs,
        // so don't format anything until the configuration is available.
        if (!this.initialized || !this.intEl) {
            return false;
        }
        if (!this.intControl.value) {
            this.intControl.setValue('');
            return true;
        }
        const offset = this.intEl.nativeElement.selectionStart - this.intControl.value.length;
        const numeric = this.intControl.value.replace(this.allowNegativeValue ? /[^-\d]/g : /\D/g, '');
        if (numeric === '-') {
            this.intControl.setValue('-', { emitEvent: false });
            return false;
        }
        const newVal = this.checkNumeric(numeric);
        // extend maxlength (if set) with the amount of special chars
        if (this.intMaxLen) {
            const specialCount = newVal.replace(/\d/g, '').length;
            this.intEl.nativeElement.setAttribute('maxlength', '' + (this.intMaxLen + specialCount));
        }
        this.intControl.setValue(newVal);
        const newLen = this.intControl.value.length;
        const newPos = Math.max(offset + newLen, 0);
        if (newLen > 0 && document.activeElement === this.intEl.nativeElement) {
            this.intEl.nativeElement.selectionStart = newPos;
            this.intEl.nativeElement.selectionEnd = newPos;
        }
        return true;
    }
    /**
     * Event handler for backspace key press, and check if correct number is deleted
     */
    onBackspace(el) {
        if (el.selectionStart) {
            const selectionStartPosition = el.selectionStart - 1;
            const value = el.value[selectionStartPosition];
            if (this.localeSeparatorSymbols.includes(value)) {
                el.setSelectionRange(selectionStartPosition, selectionStartPosition);
            }
        }
    }
    // method is used to correct rendered input's value if user entered '-' and left the field
    correctInputValue($event) {
        this.markAsTouched($event);
        const numeric = this.intControl.value;
        if (numeric !== '-') {
            return;
        }
        this.intControl.setValue('', { emitEvent: false });
    }
    writeValue(model) {
        if (!model) {
            return;
        }
        // currency cannot be set to nothing
        if (model.currency) {
            this.currency = model.currency;
            this.currControl.setValue(model.currency);
        }
        if (typeof model.amount === 'string' || typeof model.amount === 'number') {
            const [whole, decimals] = ('' + model.amount).split('.');
            this.intControl.setValue(whole);
            this.decControl.setValue(decimals);
        }
        else {
            this.intControl.setValue('');
            this.decControl.setValue('');
        }
        this.formatInteger();
    }
    registerOnChange(fn) {
        this.onChange = fn;
    }
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
    markAsTouched($event) {
        this.blur.emit($event);
        this.onTouched();
    }
    setDisabled(disableState) {
        if (disableState.currency) {
            this.currControl.disable();
        }
        else {
            this.currControl.enable();
        }
        if (disableState.integer) {
            this.intControl.disable();
        }
        else {
            this.intControl.enable();
        }
        if (disableState.decimal) {
            this.decControl.disable();
        }
        else {
            this.decControl.enable();
        }
    }
    focusDecEl(key) {
        if (this.decEl && ['.', ','].indexOf(key) !== -1) {
            this.decEl.nativeElement.focus();
        }
    }
    /**
     * Make sure that numeric value doesn't exceed max length (if set)
     * this might happen in case value is pasted to input that has extended max length
     *
     * @param numeric
     */
    sanitizeNumericValue(numeric) {
        if (this.intMaxLen && numeric) {
            return numeric.slice(0, this.intMaxLen);
        }
        return numeric;
    }
    /**
     * If currency doesn't have decimal part, decimal placeholder
     * will be set to default decMinLen
     */
    getDecimalDigits(currency) {
        return getNumberOfCurrencyDigits(currency) === 0 ? this.decMinLen : getNumberOfCurrencyDigits(currency);
    }
}
CurrencyInputComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: CurrencyInputComponent, deps: [{ token: i0.ElementRef }, { token: LOCALE_ID }, { token: i1.DomAttributesService }, { token: i2.NgControl, optional: true, self: true }], target: i0.ɵɵFactoryTarget.Component });
CurrencyInputComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.16", type: CurrencyInputComponent, selector: "bb-currency-input-ui", inputs: { decMaxLen: "decMaxLen", decMinLen: "decMinLen", placeholder: "placeholder", resultType: "resultType", integer: "integer", required: "required", readonly: "readonly", disabled: "disabled", integerLabelSrOnly: "integerLabelSrOnly", decimalLabelSrOnly: "decimalLabelSrOnly", currencies: "currencies", isRightAligned: "isRightAligned", integerId: "integerId", decimalId: "decimalId", integerLabel: "integerLabel", decimalLabel: "decimalLabel", currencyLabel: "currencyLabel", allowNegativeValue: "allowNegativeValue", currencyListAriaLabel: "currencyListAriaLabel", currencyListWithOnItemAriaLabel: "currencyListWithOnItemAriaLabel", ariaDescribedby: ["aria-describedby", "ariaDescribedby"], ariaLabelledby: ["aria-labelledby", "ariaLabelledby"], ariaInvalid: ["aria-invalid", "ariaInvalid"] }, outputs: { blur: "blur" }, providers: [DecimalPipe], viewQueries: [{ propertyName: "intEl", first: true, predicate: ["integerInput"], descendants: true, static: true }, { propertyName: "decEl", first: true, predicate: ["decimalsInput"], descendants: true }], usesOnChanges: true, ngImport: i0, template: "<div class=\"bb-currency-input\">\n  <div class=\"bb-stack bb-stack--align-bottom\">\n    <div *ngIf=\"curList && curList.length\" class=\"bb-currency-input__currency-selector selector bb-stack__item\">\n      <label\n        class=\"sr-only\"\n        *ngIf=\"currencyListAriaLabel || currencyListWithOnItemAriaLabel\"\n        for=\"{{ currencyInputId }}\"\n        [attr.aria-label]=\"currencyListWithOnItemAriaLabel\"\n        id=\"{{ currencyLabelId }}\"\n        [attr.data-role]=\"'currency-input-label'\"\n      >\n        <ng-container [ngSwitch]=\"!!currencyListAriaLabel || !!currencyListWithOnItemAriaLabel\">\n          <ng-container *ngSwitchCase=\"true\">\n            {{ curList && curList.length > 1 ? currencyListAriaLabel : currencyListWithOnItemAriaLabel }}\n          </ng-container>\n          <ng-container\n            *ngSwitchDefault\n            i18n=\"\n              Currency label | Label for currency code dropdown of the Currency Input component\n              @@bb-currency-input-ui.currency-input-label\"\n            >Currency</ng-container\n          >\n        </ng-container>\n      </label>\n      <ng-container [ngSwitch]=\"readonly || (curList && curList.length === 1)\">\n        <input\n          *ngSwitchCase=\"true\"\n          type=\"text\"\n          (blur)=\"markAsTouched($event)\"\n          [id]=\"currencyInputId\"\n          [readonly]=\"true\"\n          [required]=\"required\"\n          [attr.aria-invalid]=\"ariaInvalid\"\n          [attr.aria-labelledby]=\"idListAttr(ariaLabelledby, currencyLabelId)\"\n          class=\"form-control bb-text-align-center\"\n          value=\"{{ cur }}\"\n          [attr.data-role]=\"'currency-input-currency-readonly'\"\n        />\n        <bb-dropdown-single-select-ui\n          *ngSwitchDefault\n          [id]=\"currencyInputId\"\n          class=\"bb-block\"\n          [placeholder]=\"curList[0]\"\n          [options]=\"curList\"\n          [readonly]=\"readonly\"\n          [required]=\"required\"\n          [aria-invalid]=\"ariaInvalid\"\n          [aria-labelledby]=\"idListAttr(ariaLabelledby, currencyLabelId)\"\n          (change)=\"updateCurrency(); markAsTouched($event)\"\n          [formControl]=\"currControl\"\n          [attr.data-role]=\"'currency-input-currency-selector'\"\n        ></bb-dropdown-single-select-ui>\n      </ng-container>\n    </div>\n\n    <div\n      class=\"bb-currency-input__integer bb-stack__item bb-stack__item--spacing-sm\"\n      [class.ng-touched]=\"intControl.touched || decControl.touched || parentFormControl?.touched\"\n      [class.ng-invalid]=\"intControl.invalid || parentFormControl?.invalid\"\n    >\n      <label\n        [class.sr-only]=\"!integerLabel || integerLabelSrOnly\"\n        for=\"{{ integerInputId }}\"\n        id=\"{{ integerLabelId }}\"\n        [attr.data-role]=\"'currency-input-integer-label'\"\n      >\n        <ng-container [ngSwitch]=\"!!integerLabel\">\n          <ng-container *ngSwitchCase=\"true\">\n            {{ integerLabel }}\n          </ng-container>\n          <ng-container\n            *ngSwitchDefault\n            i18n=\"\n              Integer label | Label for integer part of the monetary amount of the Currency Input component\n              @@bb-currency-input-ui.integer-input-label\"\n            >Integer</ng-container\n          >\n        </ng-container>\n      </label>\n      <input\n        id=\"{{ integerInputId }}\"\n        [attr.aria-describedby]=\"idListAttr(ariaDescribedby, validationMessagesId)\"\n        [attr.aria-invalid]=\"ariaInvalid\"\n        [attr.aria-labelledby]=\"idListAttr(ariaLabelledby, integerLabelId)\"\n        name=\"integer\"\n        type=\"text\"\n        size=\"5\"\n        role=\"textbox\"\n        [readOnly]=\"readonly\"\n        [required]=\"required\"\n        (keydown.backspace)=\"onBackspace(integerInput)\"\n        (keypress)=\"onPress($event)\"\n        (input)=\"onInput()\"\n        (blur)=\"correctInputValue($event)\"\n        [formControl]=\"intControl\"\n        class=\"form-control bb-text-align-right\"\n        placeholder=\"{{ placeholder }}\"\n        #integerInput\n        autocomplete=\"off\"\n        autocorrect=\"off\"\n        autocapitalize=\"off\"\n        spellcheck=\"false\"\n        [attr.data-role]=\"'currency-input-integer-input'\"\n      />\n    </div>\n\n    <span *ngIf=\"!integer && decMaxLen\" class=\"bb-stack__item bb-stack__item--spacing-sm\">{{ decimalSeparator }}</span>\n\n    <div\n      *ngIf=\"!integer && decMaxLen\"\n      class=\"bb-currency-input__decimal\"\n      [class.ng-touched]=\"intControl.touched || decControl.touched || parentFormControl?.touched\"\n      [class.ng-invalid]=\"intControl.invalid || parentFormControl?.invalid\"\n    >\n      <label\n        [class.sr-only]=\"!decimalLabel || decimalLabelSrOnly\"\n        for=\"{{ decimalInputId }}\"\n        id=\"{{ decimalLabelId }}\"\n        [attr.data-role]=\"'currency-input-decimal-label'\"\n      >\n        <ng-container [ngSwitch]=\"!!decimalLabel\">\n          <ng-container *ngSwitchCase=\"true\">\n            {{ decimalLabel }}\n          </ng-container>\n          <ng-container\n            *ngSwitchDefault\n            i18n=\"\n              Decimal label | Label for decimal part of the monetary amount of the Currency Input component\n              @@bb-currency-input-ui.decimal-input-label\"\n          >\n            Decimals\n          </ng-container>\n        </ng-container>\n      </label>\n      <input\n        id=\"{{ decimalInputId }}\"\n        [attr.aria-describedby]=\"idListAttr(ariaDescribedby, validationMessagesId)\"\n        [attr.aria-invalid]=\"ariaInvalid\"\n        [attr.aria-labelledby]=\"idListAttr(ariaLabelledby, decimalLabelId)\"\n        name=\"decimals\"\n        type=\"text\"\n        role=\"textbox\"\n        [readOnly]=\"readonly\"\n        [required]=\"required\"\n        (keypress)=\"onPress($event)\"\n        (input)=\"triggerChange()\"\n        (blur)=\"decOnBlur($event)\"\n        [formControl]=\"decControl\"\n        class=\"form-control\"\n        [ngClass]=\"{ 'bb-text-align-right': isRightAligned }\"\n        maxlength=\"{{ decMaxLen }}\"\n        placeholder=\"{{ decPlaceholder }}\"\n        #decimalsInput\n        autocomplete=\"off\"\n        autocorrect=\"off\"\n        autocapitalize=\"off\"\n        spellcheck=\"false\"\n        [attr.data-role]=\"'input-currency-decimals'\"\n      />\n    </div>\n  </div>\n  <div\n    class=\"bb-input-validation-message\"\n    aria-live=\"assertive\"\n    [id]=\"validationMessagesId\"\n    [attr.data-role]=\"'currency-input-validation-message'\"\n  >\n    <ng-content select=\"[bbValidationMessage]\"></ng-content>\n  </div>\n</div>\n", components: [{ type: i3.DropdownSingleSelectComponent, selector: "bb-dropdown-single-select-ui", inputs: ["placeholder", "defaultOptionAsPlaceholder", "options", "displayAttributePath", "iconName", "compareWithFn"] }], directives: [{ type: i4.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i4.NgSwitch, selector: "[ngSwitch]", inputs: ["ngSwitch"] }, { type: i4.NgSwitchCase, selector: "[ngSwitchCase]", inputs: ["ngSwitchCase"] }, { type: i4.NgSwitchDefault, selector: "[ngSwitchDefault]" }, { type: i2.RequiredValidator, selector: ":not([type=checkbox])[required][formControlName],:not([type=checkbox])[required][formControl],:not([type=checkbox])[required][ngModel]", inputs: ["required"] }, { type: i2.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { type: i2.FormControlDirective, selector: "[formControl]", inputs: ["disabled", "formControl", "ngModel"], outputs: ["ngModelChange"], exportAs: ["ngForm"] }, { type: i2.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { type: i4.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i2.MaxLengthValidator, selector: "[maxlength][formControlName],[maxlength][formControl],[maxlength][ngModel]", inputs: ["maxlength"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: CurrencyInputComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'bb-currency-input-ui',
                    templateUrl: './currency-input.component.html',
                    providers: [DecimalPipe],
                }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: undefined, decorators: [{
                    type: Inject,
                    args: [LOCALE_ID]
                }] }, { type: i1.DomAttributesService }, { type: i2.NgControl, decorators: [{
                    type: Optional
                }, {
                    type: Self
                }] }]; }, propDecorators: { decMaxLen: [{
                type: Input
            }], decMinLen: [{
                type: Input
            }], placeholder: [{
                type: Input
            }], resultType: [{
                type: Input
            }], integer: [{
                type: Input
            }], required: [{
                type: Input
            }], readonly: [{
                type: Input
            }], disabled: [{
                type: Input
            }], integerLabelSrOnly: [{
                type: Input
            }], decimalLabelSrOnly: [{
                type: Input
            }], currencies: [{
                type: Input
            }], isRightAligned: [{
                type: Input
            }], integerId: [{
                type: Input
            }], decimalId: [{
                type: Input
            }], integerLabel: [{
                type: Input
            }], decimalLabel: [{
                type: Input
            }], currencyLabel: [{
                type: Input
            }], allowNegativeValue: [{
                type: Input
            }], currencyListAriaLabel: [{
                type: Input
            }], currencyListWithOnItemAriaLabel: [{
                type: Input
            }], ariaDescribedby: [{
                type: Input,
                args: ['aria-describedby']
            }], ariaLabelledby: [{
                type: Input,
                args: ['aria-labelledby']
            }], ariaInvalid: [{
                type: Input,
                args: ['aria-invalid']
            }], intEl: [{
                type: ViewChild,
                args: ['integerInput', { static: true }]
            }], decEl: [{
                type: ViewChild,
                args: ['decimalsInput']
            }], blur: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3VycmVuY3ktaW5wdXQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vbGlicy91aS1hbmcvY3VycmVuY3ktaW5wdXQvY3VycmVuY3ktaW5wdXQuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vbGlicy91aS1hbmcvY3VycmVuY3ktaW5wdXQvY3VycmVuY3ktaW5wdXQuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFdBQVcsRUFBRSxxQkFBcUIsRUFBRSx5QkFBeUIsRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUM5RyxPQUFPLEVBRUwsU0FBUyxFQUVULFlBQVksRUFDWixNQUFNLEVBQ04sS0FBSyxFQUNMLFNBQVMsRUFHVCxRQUFRLEVBQ1IsTUFBTSxFQUNOLElBQUksRUFFSixTQUFTLEdBQ1YsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUF3QixXQUFXLEVBQWEsTUFBTSxnQkFBZ0IsQ0FBQztBQUM5RSxPQUFPLFNBQVMsTUFBTSxjQUFjLENBQUM7QUFDckMsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBRS9ELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQzs7Ozs7O0FBR25ELE1BQU0sZ0JBQWdCLEdBQUcsRUFBRSxDQUFDO0FBQzVCLE1BQU0sdUJBQXVCLEdBQUcsQ0FBQyxDQUFDO0FBUWxDOzs7Ozs7Ozs7Ozs7O0dBYUc7QUFNSCxNQUFNLE9BQU8sc0JBQXNCO0lBOE5qQyxZQUNtQixFQUFjLEVBQ0ssTUFBYyxFQUMxQyxtQkFBeUMsRUFDdEIsaUJBQTRCO1FBSHRDLE9BQUUsR0FBRixFQUFFLENBQVk7UUFDSyxXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQzFDLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBc0I7UUFDdEIsc0JBQWlCLEdBQWpCLGlCQUFpQixDQUFXO1FBak9qRCxpQkFB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QkFDZixLQUFLO3NCQUFoQyxTQUFTO3VCQUFDLGVBQWU7Z0JBS2hCLElBQUk7c0JBQWIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERlY2ltYWxQaXBlLCBnZXRMb2NhbGVOdW1iZXJTeW1ib2wsIGdldE51bWJlck9mQ3VycmVuY3lEaWdpdHMsIE51bWJlclN5bWJvbCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBDb21wb25lbnQsXG4gIEVsZW1lbnRSZWYsXG4gIEV2ZW50RW1pdHRlcixcbiAgSW5qZWN0LFxuICBJbnB1dCxcbiAgTE9DQUxFX0lELFxuICBPbkNoYW5nZXMsXG4gIE9uSW5pdCxcbiAgT3B0aW9uYWwsXG4gIE91dHB1dCxcbiAgU2VsZixcbiAgU2ltcGxlQ2hhbmdlcyxcbiAgVmlld0NoaWxkLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBGb3JtQ29udHJvbCwgTmdDb250cm9sIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IEJpZ051bWJlciBmcm9tICdiaWdudW1iZXIuanMnO1xuaW1wb3J0IHsgZ2V0SW5wdXROZXh0SWQgfSBmcm9tICdAYmFja2Jhc2UvdWktYW5nL2Jhc2UtY2xhc3Nlcyc7XG5pbXBvcnQgeyBEb21BdHRyaWJ1dGVzU2VydmljZSB9IGZyb20gJ0BiYWNrYmFzZS91aS1hbmcvc2VydmljZXMnO1xuaW1wb3J0IHsgaWRMaXN0QXR0ciB9IGZyb20gJ0BiYWNrYmFzZS91aS1hbmcvdXRpbCc7XG5cbmV4cG9ydCB0eXBlIFJlc3VsdFR5cGUgPSAnc3RyaW5nJyB8ICdudW1iZXInO1xuY29uc3QgZGVmYXVsdEludExlbmd0aCA9IDEzO1xuY29uc3QgZGVmYXVsdERlY2ltYWxQcmVjaXNpb24gPSAyO1xuXG5leHBvcnQgaW50ZXJmYWNlIEN1cnJlbmN5RmllbGRzU3RhdGUge1xuICBjdXJyZW5jeTogYm9vbGVhbjtcbiAgaW50ZWdlcjogYm9vbGVhbjtcbiAgZGVjaW1hbDogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBAbmFtZSBDdXJyZW5jeUlucHV0Q29tcG9uZW50XG4gKlxuICogQGExMXkgQ3VycmVudCBjb21wb25lbnQgcHJvdmlkZSBvcHRpb24gdG8gcGFzcyBuZWVkZWQgYWNjZXNzaWJpbGl0eVxuICogYXR0cmlidXRlcy4gWW91IG5lZWQgdG8gdGFrZSBjYXJlIG9mIHByb3BlcnRpZXMgdGhhdCBhcmUgcmVxdWlyZWQgaW4geW91ciBjYXNlIDpcbiAqICAtIGFyaWEtZGVzY3JpYmVkYnlcbiAqICAtIGFyaWEtaW52YWxpZFxuICogIC0gYXJpYS1sYWJlbGxlZGJ5XG4gKiAgLSBpbnRlZ2VyTGFiZWxTck9ubHlcbiAqICAtIGRlY2ltYWxMYWJlbFNyT25seVxuICogQGRlc2NyaXB0aW9uXG4gKiBDb21wb25lbnQgZm9yIGRpc3BsYXlpbmcgYW5kIG1hbmFnaW5nIGN1cnJlbmN5IGFuZCBpdCBhbW91bnRcbiAqXG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2JiLWN1cnJlbmN5LWlucHV0LXVpJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2N1cnJlbmN5LWlucHV0LmNvbXBvbmVudC5odG1sJyxcbiAgcHJvdmlkZXJzOiBbRGVjaW1hbFBpcGVdLFxufSlcbmV4cG9ydCBjbGFzcyBDdXJyZW5jeUlucHV0Q29tcG9uZW50IGltcGxlbWVudHMgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE9uSW5pdCwgT25DaGFuZ2VzLCBBZnRlclZpZXdJbml0IHtcbiAgcHJpdmF0ZSBjdXJyZW5jeUxpc3Q6IEFycmF5PHN0cmluZz4gPSBbXTtcbiAgcHJpdmF0ZSBjdXJyZW5jeURpc2FibGVkU3RhdGU6IEN1cnJlbmN5RmllbGRzU3RhdGUgPSB7XG4gICAgY3VycmVuY3k6IGZhbHNlLFxuICAgIGludGVnZXI6IGZhbHNlLFxuICAgIGRlY2ltYWw6IGZhbHNlLFxuICB9O1xuICBwcml2YXRlIGN1cnJlbmN5OiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gIHByaXZhdGUgaW50TWF4TGVuOiBudW1iZXIgfCB1bmRlZmluZWQ7XG4gIHJlYWRvbmx5IGRlY2ltYWxTZXBhcmF0b3I6IHN0cmluZyA9IGdldExvY2FsZU51bWJlclN5bWJvbCh0aGlzLmxvY2FsZSwgTnVtYmVyU3ltYm9sLkN1cnJlbmN5RGVjaW1hbCk7XG4gIHByaXZhdGUgcmVhZG9ubHkgbG9jYWxlU2VwYXJhdG9yU3ltYm9scyA9IFtcbiAgICB0aGlzLmRlY2ltYWxTZXBhcmF0b3IsXG4gICAgZ2V0TG9jYWxlTnVtYmVyU3ltYm9sKHRoaXMubG9jYWxlLCBOdW1iZXJTeW1ib2wuQ3VycmVuY3lHcm91cCksXG4gIF07XG5cbiAgcHJpdmF0ZSBfZGVjTWF4TGVuOiBudW1iZXIgfCB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIENvbmZpZ3VyZSB0aGUgbWF4aW11bSBudW1iZXIgb2YgZGVjaW1hbHMuXG4gICAqIFdoZW4gZ3JlYXRlciB0aGFuIHRoZSBkZWZhdWx0IG51bWJlciBvZiBkZWNpbWFscyBmb3IgdGhlIHNwZWNpZmllZCBjdXJyZW5jeSwgdGhpcyB2YWx1ZSB3aWxsIHRha2UgcHJlY2VkZW5jZS5cbiAgICogQ29uZmlndXJpbmcgdGhpcyB2YWx1ZSBjYW4gYWZmZWN0IHRoZSBpbnB1dCBwbGFjZWhvbGRlci5cbiAgICovXG4gIEBJbnB1dCgpXG4gIGdldCBkZWNNYXhMZW4oKTogbnVtYmVyIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdHlwZW9mIHRoaXMuX2RlY01heExlbiA9PT0gJ251bWJlcicgPyB0aGlzLl9kZWNNYXhMZW4gOiB0aGlzLmdldERlY2ltYWxEaWdpdHModGhpcy5jdXJyZW5jeSB8fCAnJyk7XG4gIH1cblxuICBzZXQgZGVjTWF4TGVuKHZhbHVlOiBudW1iZXIgfCB1bmRlZmluZWQpIHtcbiAgICB0aGlzLl9kZWNNYXhMZW4gPSB2YWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBOdW1iZXIgb2YgbWluaW11bSBjdXJyZW5jeSBwcmVjaXNpb24uIERlZmF1bHRzIHRvIDIuXG4gICAqL1xuICBASW5wdXQoKSBkZWNNaW5MZW4gPSBkZWZhdWx0RGVjaW1hbFByZWNpc2lvbjtcblxuICAvKipcbiAgICogTm9uLWNvbmZpZ3VyYWJsZSBwbGFjZWhvbGRlciBmb3IgdGhlIGRlY2ltYWwgaW5wdXQuXG4gICAqIERpc3BsYXlzIGEgemVybyBkaWdpdCBmb3IgZXZlcnkgZGlnaXQgdGhhdCBpcyBhbGxvd2VkIGluIHRoZSBkZWNpbWFsIGZpZWxkLlxuICAgKi9cbiAgZ2V0IGRlY1BsYWNlaG9sZGVyKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuICcwJy5yZXBlYXQodGhpcy5kZWNNYXhMZW4gfHwgMCk7XG4gIH1cblxuICByZWFkb25seSBjdXJyQ29udHJvbCA9IG5ldyBGb3JtQ29udHJvbCgpO1xuICByZWFkb25seSBpbnRDb250cm9sID0gbmV3IEZvcm1Db250cm9sKCk7XG4gIHJlYWRvbmx5IGRlY0NvbnRyb2wgPSBuZXcgRm9ybUNvbnRyb2woKTtcblxuICAvKipcbiAgICogVGhlIHBsYWNlaG9sZGVyIGZvciB0aGUgaW5wdXQuIERlZmF1bHRzIHRvIDAuXG4gICAqL1xuICBASW5wdXQoKSBwbGFjZWhvbGRlciA9ICcwJztcbiAgLyoqXG4gICAqIEZvciBzZXQgb3V0cHV0IHR5cGUgc3RyaW5nL251bWJlciwgYnkgZGVmYXVsdCAnbnVtYmVyJywgd2hlbiAgbmVlZCB3b3JrIHdpdGggbG9uZyBudW1iZXJcbiAgICogKCBiaWdnZXIgdGhhbiBNQVhfU0FGRV9JTlRFR0VSID0gOSwwMDcsMTk5LDI1NCw3NDAsOTkzICkgbmVlZCB0byB1c2UgJ3N0cmluZydcbiAgICovXG4gIEBJbnB1dCgpIHJlc3VsdFR5cGU6IFJlc3VsdFR5cGUgPSAnbnVtYmVyJztcbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhlcmUgc2hvdWxkIGJlIG9ubHkgdGhlIGludGVnZXIgcGFydC5cbiAgICogWW91IGhhdmUgdG8ga2VlcCBpbiBtaW5kLCB0aGF0IGlmIHlvdSBoYXZlIGRlY2ltYWwgcGFydCwgZXZlbiBcIi4wMFwiXG4gICAqIHlvdSB3aWxsIG5vdCBiZSBhYmxlIHRvIHJlbW92ZSBpdFxuICAgKi9cbiAgQElucHV0KCkgaW50ZWdlciA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoZSBpbnB1dCBpcyByZXF1aXJlZC4gRGVmYXVsdHMgdG8gZmFsc2UuXG4gICAqL1xuICBASW5wdXQoKSByZXF1aXJlZCA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoZSBpbnB1dCBpcyByZWFkIG9ubHkuIERlZmF1bHRzIHRvIGZhbHNlLlxuICAgKi9cbiAgQElucHV0KCkgcmVhZG9ubHkgPSBmYWxzZTtcblxuICAvKipcbiAgICogV2hldGhlciB0aGUgaW5wdXQgaXMgZGlzYWJsZWQuIERlZmF1bHRzIHRvIGZhbHNlLlxuICAgKi9cbiAgQElucHV0KClcbiAgc2V0IGRpc2FibGVkKGRpc2FibGVkOiBib29sZWFuIHwgQ3VycmVuY3lGaWVsZHNTdGF0ZSkge1xuICAgIGlmICh0eXBlb2YgZGlzYWJsZWQgPT09ICdib29sZWFuJykge1xuICAgICAgdGhpcy5jdXJyZW5jeURpc2FibGVkU3RhdGUgPSB7XG4gICAgICAgIGN1cnJlbmN5OiBkaXNhYmxlZCxcbiAgICAgICAgaW50ZWdlcjogZGlzYWJsZWQsXG4gICAgICAgIGRlY2ltYWw6IGRpc2FibGVkLFxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jdXJyZW5jeURpc2FibGVkU3RhdGUgPSBkaXNhYmxlZDtcbiAgICB9XG4gIH1cblxuICBnZXQgZGlzYWJsZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVuY3lEaXNhYmxlZFN0YXRlO1xuICB9XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgaW50ZWdlciBsYWJlbCBpcyBvbmx5IHZpc2libGUgZm9yIHNjcmVlbiByZWFkZXJzLlxuICAgKiBCeSBkZWZhdWx0IGlzIHZpc2libGUgaWYgaXQgaXMgbmVlZGVkIHRvIGhpZGUgY2hhbmdlIHRoaXMgcHJvcGVydHlcbiAgICogdG8gXCJ0cnVlXCIgYW5kIGl0IHdpbGwgaGF2ZSBjbGFzcyBcInNyLW9ubHlcIlxuICAgKi9cbiAgQElucHV0KCkgaW50ZWdlckxhYmVsU3JPbmx5ID0gZmFsc2U7XG4gIC8qKlxuICAgKiBCeSBkZWZhdWx0IGlzIHZpc2libGUgaWYgaXQgaXMgbmVlZGVkIHRvIGhpZGUgY2hhbmdlIHRoaXMgcHJvcGVydHlcbiAgICogdG8gXCJ0cnVlXCIgYW5kIGl0IHdpbGwgaGF2ZSBjbGFzcyBcInNyLW9ubHlcIlxuICAgKiBCeSBkZWZhdWx0IGlzIGhpZGRlbiBhbmQgYWNjZXNzaWJsZSBvbmx5IGZvciBzY3JlZW4gcmVhZGVyXG4gICAqL1xuICBASW5wdXQoKSBkZWNpbWFsTGFiZWxTck9ubHkgPSBmYWxzZTtcblxuICAvKipcbiAgICogQ3VycmVuY3kgbGlzdCB0byBiZSBkaXNwbGF5ZWQgaW4gdGhlIGRyb3Bkb3duLlxuICAgKlxuICAgKiBOb3RlOiBOb24tZW1wdHkgY3VycmVuY3kgbGlzdCBpcyByZXF1aXJlZCBmb3IgdGhlIGN1cnJlbmN5IHN5bWJvbFxuICAgKiBmaWVsZCB0byBiZSBzaG93bi4gT3RoZXJ3aXNlLCBvbmx5IHRoZSBhbW91bnQgZmllbGRzIHdpbGwgYmUgc2hvd24uXG4gICAqXG4gICAqIEFkZGl0aW9uYWxseSwgSWYgb25seSBhIHNpbmdsZSBjdXJyZW5jeSBwcm92aWRlZCwgdGhlIGRyb3Bkb3duIG9mXG4gICAqIHRoZSBjdXJyZW5jeSBzZWxlY3Rpb24gd2lsbCBiZSBkaXNhYmxlZCBhbmQgaXRzIHZhbHVlIHNldCB0byB0aGF0IHNpbmdsZSBjdXJyZW5jeVxuICAgKi9cblxuICBASW5wdXQoKVxuICBzZXQgY3VycmVuY2llcyhsaXN0OiBBcnJheTxzdHJpbmc+KSB7XG4gICAgdGhpcy5jdXJyZW5jeUxpc3QgPSBsaXN0O1xuICAgIGlmICh0aGlzLmN1cnJlbmN5TGlzdCAmJiB0aGlzLmN1cnJlbmN5TGlzdC5sZW5ndGggPiAxKSB7XG4gICAgICB0aGlzLmN1cnJDb250cm9sLmVuYWJsZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmN1cnJDb250cm9sLmRpc2FibGUoKTtcbiAgICB9XG4gICAgLy8gaWYgY3VycmVuY3kgaXMgbm90IHNldCwgdXNlIGZpcnN0IGl0ZW0gZnJvbSB0aGUgbGlzdFxuICAgIGlmICh0aGlzLmN1cnJlbmN5TGlzdCAmJiAodGhpcy5jdXJyZW5jeSA9PT0gdW5kZWZpbmVkIHx8IHRoaXMuY3VycmVuY3lMaXN0LmluZGV4T2YodGhpcy5jdXJyZW5jeSkgPT09IC0xKSkge1xuICAgICAgLy8gW0ZJWE1FXSBOb3RoaW5nIGd1YXJhbnRlZXMgdGhhdCB0aGUgY3VycmVuY3lMaXN0IGlzbid0IGVtcHR5XG4gICAgICB0aGlzLnVwZGF0ZUN1cnJlbmN5KHRoaXMuY3VycmVuY3lMaXN0WzBdKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciBkZWNpbWFsIHRleHQgaXMgYWxpZ25lZCB0byB0aGUgcmlnaHQuXG4gICAqIEJ5IGRlZmF1bHQgaXMgZmFsc2VcbiAgICovXG4gIEBJbnB1dCgpIGlzUmlnaHRBbGlnbmVkID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBfaW50ZWdlcklkID0gZ2V0SW5wdXROZXh0SWQoKTtcbiAgcHJpdmF0ZSBfZGVjaW1hbElkID0gZ2V0SW5wdXROZXh0SWQoKTtcbiAgcHJpdmF0ZSBfbGFiZWxDbGFzc2VzOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG5cbiAgcHVibGljIHJlYWRvbmx5IGN1cnJlbmN5SW5wdXRJZDogc3RyaW5nO1xuICBwdWJsaWMgcmVhZG9ubHkgY3VycmVuY3lMYWJlbElkOiBzdHJpbmc7XG4gIHB1YmxpYyByZWFkb25seSBkZWNpbWFsSW5wdXRJZDogc3RyaW5nO1xuICBwdWJsaWMgcmVhZG9ubHkgZGVjaW1hbExhYmVsSWQ6IHN0cmluZztcbiAgcHVibGljIHJlYWRvbmx5IGludGVnZXJJbnB1dElkOiBzdHJpbmc7XG4gIHB1YmxpYyByZWFkb25seSBpbnRlZ2VyTGFiZWxJZDogc3RyaW5nO1xuICBwdWJsaWMgcmVhZG9ubHkgdmFsaWRhdGlvbk1lc3NhZ2VzSWQ6IHN0cmluZztcbiAgcHVibGljIHJlYWRvbmx5IGlkTGlzdEF0dHIgPSBpZExpc3RBdHRyO1xuXG4gIHByb3RlY3RlZCBpbml0aWFsaXplZCA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBUaGUgaWQgZm9yIHRoZSBpbnRlZ2VyIGlucHV0LiBEZWZhdWx0cyB0byB1bmlxdWUgc3RyaW5nLlxuICAgKiBVc2VkIHRvIG1hcCB0aGUgbGFiZWwgdG8gdGhlIGlucHV0LlxuICAgKi9cbiAgQElucHV0KClcbiAgc2V0IGludGVnZXJJZCh2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5faW50ZWdlcklkID0gdmFsdWU7XG4gIH1cblxuICBnZXQgaW50ZWdlcklkKCkge1xuICAgIHJldHVybiB0aGlzLl9pbnRlZ2VySWQ7XG4gIH1cblxuICAvKipcbiAgICogVGhlIGlkIGZvciB0aGUgZGVjaW1hbCBpbnB1dC4gRGVmYXVsdHMgdG8gdW5pcXVlIHN0cmluZy5cbiAgICogVXNlZCB0byBtYXAgdGhlIGxhYmVsIHRvIHRoZSBpbnB1dC5cbiAgICovXG4gIEBJbnB1dCgpXG4gIHNldCBkZWNpbWFsSWQodmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMuX2RlY2ltYWxJZCA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IGRlY2ltYWxJZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fZGVjaW1hbElkO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBsYWJlbCBmb3IgdGhlIGludGVnZXIgaW5wdXQuXG4gICAqL1xuICBASW5wdXQoKSBpbnRlZ2VyTGFiZWwgPSAnJztcbiAgLyoqXG4gICAqIFRoZSBsYWJlbCBmb3IgdGhlIGRlY2ltYWwgaW5wdXQuXG4gICAqL1xuICBASW5wdXQoKSBkZWNpbWFsTGFiZWwgPSAnJztcbiAgLyoqXG4gICAqIFRoZSBsYWJlbCBmb3IgdGhlIGN1cnJlbmN5IGlucHV0LlxuICAgKi9cbiAgQElucHV0KCkgY3VycmVuY3lMYWJlbCA9ICcnO1xuXG4gIC8qKlxuICAgKiBGbGFnIGlzIHVzZWQgdG8gYWxsb3cgaW5wdXQgbmVnYXRpdmUgdmFsdWVcbiAgICovXG4gIEBJbnB1dCgpIGFsbG93TmVnYXRpdmVWYWx1ZSA9IGZhbHNlO1xuICAvKipcbiAgICogQXJpYSBsYWJlbCBmb3IgdGhlIGN1cnJlbmN5IGRyb3Bkb3duLlxuICAgKi9cbiAgQElucHV0KCkgY3VycmVuY3lMaXN0QXJpYUxhYmVsID0gJ0N1cnJlbmN5IExpc3QgRHJvcGRvd24nO1xuICAvKipcbiAgICogQXJpYSBsYWJlbCBmb3IgdGhlIGN1cnJlbmN5IGxpc3Qgd2l0aCBvbmUgaXRlbS5cbiAgICovXG4gIEBJbnB1dCgpIGN1cnJlbmN5TGlzdFdpdGhPbkl0ZW1BcmlhTGFiZWwgPSAnQ3VycmVuY3knO1xuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvbm8taW5wdXQtcmVuYW1lXG4gIEBJbnB1dCgnYXJpYS1kZXNjcmliZWRieScpIGFyaWFEZXNjcmliZWRieTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvbm8taW5wdXQtcmVuYW1lXG4gIEBJbnB1dCgnYXJpYS1sYWJlbGxlZGJ5JykgYXJpYUxhYmVsbGVkYnk6IHN0cmluZyB8IHVuZGVmaW5lZDtcblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQGFuZ3VsYXItZXNsaW50L25vLWlucHV0LXJlbmFtZVxuICBASW5wdXQoJ2FyaWEtaW52YWxpZCcpIGFyaWFJbnZhbGlkOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG5cbiAgQFZpZXdDaGlsZCgnaW50ZWdlcklucHV0JywgeyBzdGF0aWM6IHRydWUgfSkgaW50RWw6IEVsZW1lbnRSZWYgfCB1bmRlZmluZWQ7XG4gIEBWaWV3Q2hpbGQoJ2RlY2ltYWxzSW5wdXQnKSBkZWNFbDogRWxlbWVudFJlZiB8IHVuZGVmaW5lZDtcblxuICAvKipcbiAgICogQW4gZXZlbnQgZW1pdHRlciBmb3Igb24gYmx1ciBhY3Rpb25zLlxuICAgKi9cbiAgQE91dHB1dCgpIGJsdXIgPSBuZXcgRXZlbnRFbWl0dGVyPEZvY3VzRXZlbnQgfCB2b2lkPigpO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVhZG9ubHkgZWw6IEVsZW1lbnRSZWYsXG4gICAgQEluamVjdChMT0NBTEVfSUQpIHByaXZhdGUgcmVhZG9ubHkgbG9jYWxlOiBzdHJpbmcsXG4gICAgcHJpdmF0ZSBkb21BdHRyaWJ1dGVTZXJ2aWNlOiBEb21BdHRyaWJ1dGVzU2VydmljZSxcbiAgICBAT3B0aW9uYWwoKSBAU2VsZigpIHB1YmxpYyBwYXJlbnRGb3JtQ29udHJvbDogTmdDb250cm9sLFxuICApIHtcbiAgICB0aGlzLmN1cnJlbmN5SW5wdXRJZCA9IHRoaXMuZG9tQXR0cmlidXRlU2VydmljZS5nZW5lcmF0ZUlkKCk7XG4gICAgdGhpcy5jdXJyZW5jeUxhYmVsSWQgPSB0aGlzLmRvbUF0dHJpYnV0ZVNlcnZpY2UuZ2VuZXJhdGVJZCgpO1xuICAgIHRoaXMuZGVjaW1hbElucHV0SWQgPSB0aGlzLmRvbUF0dHJpYnV0ZVNlcnZpY2UuZ2VuZXJhdGVJZCgpO1xuICAgIHRoaXMuZGVjaW1hbExhYmVsSWQgPSB0aGlzLmRvbUF0dHJpYnV0ZVNlcnZpY2UuZ2VuZXJhdGVJZCgpO1xuICAgIHRoaXMuaW50ZWdlcklucHV0SWQgPSB0aGlzLmRvbUF0dHJpYnV0ZVNlcnZpY2UuZ2VuZXJhdGVJZCgpO1xuICAgIHRoaXMuaW50ZWdlckxhYmVsSWQgPSB0aGlzLmRvbUF0dHJpYnV0ZVNlcnZpY2UuZ2VuZXJhdGVJZCgpO1xuICAgIHRoaXMudmFsaWRhdGlvbk1lc3NhZ2VzSWQgPSB0aGlzLmRvbUF0dHJpYnV0ZVNlcnZpY2UuZ2VuZXJhdGVJZCgpO1xuXG4gICAgQmlnTnVtYmVyLmNvbmZpZyh7XG4gICAgICBGT1JNQVQ6IHtcbiAgICAgICAgLy8gZ3JvdXBpbmcgc2VwYXJhdG9yIG9mIHRoZSBpbnRlZ2VyIHBhcnRcbiAgICAgICAgZ3JvdXBTZXBhcmF0b3I6IGdldExvY2FsZU51bWJlclN5bWJvbCh0aGlzLmxvY2FsZSwgTnVtYmVyU3ltYm9sLkdyb3VwKSxcbiAgICAgICAgLy8gcHJpbWFyeSBncm91cGluZyBzaXplIG9mIHRoZSBpbnRlZ2VyIHBhcnRcbiAgICAgICAgZ3JvdXBTaXplOiAzLFxuICAgICAgfSxcbiAgICB9KTtcbiAgICBpZiAodGhpcy5wYXJlbnRGb3JtQ29udHJvbCAhPSBudWxsKSB7XG4gICAgICAvLyBTZXR0aW5nIHRoZSB2YWx1ZSBhY2Nlc3NvciBkaXJlY3RseSAoaW5zdGVhZCBvZiB1c2luZ1xuICAgICAgLy8gdGhlIHByb3ZpZGVycykgdG8gYXZvaWQgcnVubmluZyBpbnRvIGEgY2lyY3VsYXIgaW1wb3J0LlxuICAgICAgdGhpcy5wYXJlbnRGb3JtQ29udHJvbC52YWx1ZUFjY2Vzc29yID0gdGhpcztcbiAgICB9XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICBpZiAoIXRoaXMuaW50ZWdlckxhYmVsIHx8ICF0aGlzLmRlY2ltYWxMYWJlbCkge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICBgXG4gICAgICAgICAgRm91bmQgYW4gaW5wdXQgZnJvbSAnXG4gICAgICAgICAgJHt0aGlzLmNvbnN0cnVjdG9yLm5hbWV9XG4gICAgICAgICAgJyB3aXRob3V0ICdsYWJlbCcgb3IgJ2FyaWEtbGFiZWwnIGF0dHJpYnV0ZSwgcGxlYXNlIHByb3ZpZGUgb25lIG9mIHRoZW1cbiAgICAgICAgYCxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgdGhpcy5zZXREaXNhYmxlZCh0aGlzLmN1cnJlbmN5RGlzYWJsZWRTdGF0ZSk7XG5cbiAgICB0aGlzLmZvcm1hdEludGVnZXIoKTtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcbiAgICBpZiAoY2hhbmdlcy5kaXNhYmxlZCkge1xuICAgICAgdGhpcy5zZXREaXNhYmxlZCh0aGlzLmN1cnJlbmN5RGlzYWJsZWRTdGF0ZSk7XG4gICAgfVxuICB9XG5cbiAgZGVjT25CbHVyKCRldmVudDogRm9jdXNFdmVudCkge1xuICAgIHRoaXMubWFya0FzVG91Y2hlZCgkZXZlbnQpO1xuICAgIHRoaXMuZm9ybWF0RGVjaW1hbCh0aGlzLmRlY0NvbnRyb2wpO1xuICB9XG5cbiAgZ2V0IGN1cigpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW5jeTtcbiAgfVxuXG4gIGdldCBjdXJMaXN0KCkge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbmN5TGlzdDtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcbiAgICBjb25zdCBsZW4gPSB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQuZ2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnKTtcbiAgICB0aGlzLmludE1heExlbiA9IGxlbiA/IHBhcnNlSW50KGxlbiwgMTApIDogZGVmYXVsdEludExlbmd0aDtcbiAgfVxuXG4gIG9uQ2hhbmdlID0gKF86IGFueSkgPT4ge307XG4gIG9uVG91Y2hlZCA9ICgpID0+IHt9O1xuXG4gIG9uUHJlc3MoJGV2ZW50OiBhbnkpIHtcbiAgICB0aGlzLmZvY3VzRGVjRWwoJGV2ZW50LmtleSk7XG5cbiAgICBjb25zdCBrZXlDb2RlID0gJGV2ZW50LmtleUNvZGUgfHwgJGV2ZW50LndoaWNoO1xuICAgIGNvbnN0IGtleSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoa2V5Q29kZSk7XG5cbiAgICAvLyBhbGxvdyB0byBlbnRlciAnbWludXMnIG9ubHkgYXQgdGhlIGZpcnN0IHBvc2l0aW9uIGFuZCBpZiBjb3JyZXNwb25kZW50IGZsYWcgaXMgZW5hYmxlZFxuICAgIGNvbnN0IGlzTGVhZGluZ01pbnVzUG9zaXRpb24gPVxuICAgICAgdGhpcy5hbGxvd05lZ2F0aXZlVmFsdWUgJiYgdGhpcy5pbnRFbCAmJiB0aGlzLmludEVsLm5hdGl2ZUVsZW1lbnQuc2VsZWN0aW9uU3RhcnQgPT09IDAgJiYga2V5ID09PSAnLSc7XG5cbiAgICAvLyByZWdleHAgaXMgdXNlZCBoZXJlIHRvIHN1cHBvcnQgYm90aCBvZiByZWd1bGFyIGtleWJvYXJkJ3MgbnVtYmVycyBhbmQgbnVtcGFkJ3MgbnVtYmVyc1xuICAgIGlmICghKGlzTGVhZGluZ01pbnVzUG9zaXRpb24gfHwgL15cXGQkLy50ZXN0KGtleSkpICYmICRldmVudC5rZXlDb2RlICE9PSA4ICYmICRldmVudC5rZXlDb2RlICE9PSA5KSB7XG4gICAgICAkZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH1cblxuICBvbklucHV0KCkge1xuICAgIGNvbnN0IGlzRm9ybWF0dGVkID0gdGhpcy5mb3JtYXRJbnRlZ2VyKCk7XG4gICAgaWYgKGlzRm9ybWF0dGVkKSB7XG4gICAgICB0aGlzLnRyaWdnZXJDaGFuZ2UoKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGVDdXJyZW5jeShjdXJyZW5jeT86IHN0cmluZykge1xuICAgIHRoaXMuY3VycmVuY3kgPSBjdXJyZW5jeSB8fCB0aGlzLmN1cnJDb250cm9sLnZhbHVlO1xuICAgIHRoaXMudHJpZ2dlckNoYW5nZSgpO1xuICB9XG5cbiAgY2hlY2tWYWx1ZXMoKSB7XG4gICAgaWYgKHRoaXMuY3VycmVuY3kgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmICghdGhpcy5kZWNDb250cm9sLnZhbHVlICYmICF0aGlzLmludENvbnRyb2wudmFsdWUpIHtcbiAgICAgIHRoaXMub25DaGFuZ2UobnVsbCk7XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGZvcm1hdERlY2ltYWwoZGVjQ29udHJvbDogRm9ybUNvbnRyb2wpIHtcbiAgICBjb25zdCB7IHZhbHVlIH0gPSBkZWNDb250cm9sO1xuICAgIGlmICh2YWx1ZSAmJiB0aGlzLmRlY01heExlbiAmJiB2YWx1ZS5sZW5naHQgPCB0aGlzLmRlY01heExlbikge1xuICAgICAgY29uc3QgdXBkYXRlZFZhbHVlID0gU3RyaW5nKHZhbHVlKS5wYWRFbmQodGhpcy5kZWNNYXhMZW4sICcwJyk7XG4gICAgICBkZWNDb250cm9sLnBhdGNoVmFsdWUodXBkYXRlZFZhbHVlKTtcbiAgICB9XG4gIH1cblxuICB0cmlnZ2VyQ2hhbmdlKCkge1xuICAgIGlmICh0aGlzLmNoZWNrVmFsdWVzKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBpbnQ6IHN0cmluZyA9IHRoaXMuaW50Q29udHJvbC52YWx1ZSB8fCAnMCc7XG5cbiAgICBpZiAodGhpcy5yZXN1bHRUeXBlID09PSAnc3RyaW5nJykge1xuICAgICAgY29uc3QgY3VycmVuY3lHcm91cFN5bWJvbCA9IG5ldyBSZWdFeHAoYFxcXFwke3RoaXMubG9jYWxlU2VwYXJhdG9yU3ltYm9sc1sxXX1gLCAnZycpO1xuICAgICAgY29uc3Qgd2hvbGU6IHN0cmluZyA9IGludC5yZXBsYWNlKGN1cnJlbmN5R3JvdXBTeW1ib2wsICcnKTtcbiAgICAgIGNvbnN0IGRlYzogc3RyaW5nID0gdGhpcy5kZWNDb250cm9sLnZhbHVlIHx8ICcwJztcbiAgICAgIGNvbnN0IG5ld0Ftb3VudCA9IHdob2xlICsgKGRlYyAhPT0gJzAnID8gJy4nICsgZGVjIDogJycpO1xuICAgICAgdGhpcy5vbkNoYW5nZSh7XG4gICAgICAgIGN1cnJlbmN5OiB0aGlzLmN1cnJlbmN5LFxuICAgICAgICBhbW91bnQ6IG5ld0Ftb3VudCxcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB3aG9sZTogbnVtYmVyID0gcGFyc2VJbnQoaW50LnJlcGxhY2UoL1teLVxcZF0vZywgJycpLCAxMCk7XG4gICAgICBjb25zdCBkZWMgPSBwYXJzZUZsb2F0KCcwLicgKyB0aGlzLmRlY0NvbnRyb2wudmFsdWUpIHx8IDA7XG4gICAgICBjb25zdCBzaWduID0gd2hvbGUgPCAwID8gLTEgOiAxO1xuICAgICAgY29uc3QgbmV3QW1vdW50ID0gKE1hdGguYWJzKHdob2xlKSArIGRlYykgKiBzaWduO1xuICAgICAgdGhpcy5vbkNoYW5nZSh7XG4gICAgICAgIGN1cnJlbmN5OiB0aGlzLmN1cnJlbmN5LFxuICAgICAgICBhbW91bnQ6IG5ld0Ftb3VudCxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGNoZWNrTnVtZXJpYyhudW1lcmljOiBhbnkpOiBzdHJpbmcge1xuICAgIC8vIHJlbW92ZWQgYWxsIGRhc2hlcyBleGNlcHQgdGhlIGZpcnN0IG9uZVxuICAgIGlmIChudW1lcmljLmxlbmd0aCA+IDApIHtcbiAgICAgIG51bWVyaWMgPSBudW1lcmljWzBdICsgbnVtZXJpYy5zbGljZSgxKS5yZXBsYWNlKC8tL2csICcnKTtcbiAgICB9XG5cbiAgICBudW1lcmljID0gdGhpcy5zYW5pdGl6ZU51bWVyaWNWYWx1ZShudW1lcmljKTtcblxuICAgIHJldHVybiBudW1lcmljID09PSAnJyA/IG51bWVyaWMgOiBuZXcgQmlnTnVtYmVyKG51bWVyaWMgfHwgMCkudG9Gb3JtYXQoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JtYXRzIGludGVnZXIgdG8gdXNlci1mcmllbmRseSBmb3JtYXRcbiAgICpcbiAgICogQHJldHVybnMgUmV0dXJucyB0cnVlIGluIGNhc2Ugb2Ygc3VjY2Vzc2Z1bCBmb3JtYXR0aW5nLCBvdGhlcndpc2UgLSBmYWxzZS5cbiAgICovXG4gIGZvcm1hdEludGVnZXIoKTogYm9vbGVhbiB7XG4gICAgLy8gVGhlIGJlaGF2aW9yIG9mIGBmb3JtYXRJbnRlZ2VyYCBpcyBkZXBlbmRlbnQgb24gc29tZSBjb21wb25lbnQgaW5wdXRzLFxuICAgIC8vIHNvIGRvbid0IGZvcm1hdCBhbnl0aGluZyB1bnRpbCB0aGUgY29uZmlndXJhdGlvbiBpcyBhdmFpbGFibGUuXG5cbiAgICBpZiAoIXRoaXMuaW5pdGlhbGl6ZWQgfHwgIXRoaXMuaW50RWwpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKCF0aGlzLmludENvbnRyb2wudmFsdWUpIHtcbiAgICAgIHRoaXMuaW50Q29udHJvbC5zZXRWYWx1ZSgnJyk7XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBjb25zdCBvZmZzZXQgPSB0aGlzLmludEVsLm5hdGl2ZUVsZW1lbnQuc2VsZWN0aW9uU3RhcnQgLSB0aGlzLmludENvbnRyb2wudmFsdWUubGVuZ3RoO1xuXG4gICAgY29uc3QgbnVtZXJpYzogc3RyaW5nID0gdGhpcy5pbnRDb250cm9sLnZhbHVlLnJlcGxhY2UodGhpcy5hbGxvd05lZ2F0aXZlVmFsdWUgPyAvW14tXFxkXS9nIDogL1xcRC9nLCAnJyk7XG4gICAgaWYgKG51bWVyaWMgPT09ICctJykge1xuICAgICAgdGhpcy5pbnRDb250cm9sLnNldFZhbHVlKCctJywgeyBlbWl0RXZlbnQ6IGZhbHNlIH0pO1xuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IG5ld1ZhbCA9IHRoaXMuY2hlY2tOdW1lcmljKG51bWVyaWMpO1xuICAgIC8vIGV4dGVuZCBtYXhsZW5ndGggKGlmIHNldCkgd2l0aCB0aGUgYW1vdW50IG9mIHNwZWNpYWwgY2hhcnNcbiAgICBpZiAodGhpcy5pbnRNYXhMZW4pIHtcbiAgICAgIGNvbnN0IHNwZWNpYWxDb3VudCA9IG5ld1ZhbC5yZXBsYWNlKC9cXGQvZywgJycpLmxlbmd0aDtcbiAgICAgIHRoaXMuaW50RWwubmF0aXZlRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ21heGxlbmd0aCcsICcnICsgKHRoaXMuaW50TWF4TGVuICsgc3BlY2lhbENvdW50KSk7XG4gICAgfVxuXG4gICAgdGhpcy5pbnRDb250cm9sLnNldFZhbHVlKG5ld1ZhbCk7XG4gICAgY29uc3QgbmV3TGVuID0gdGhpcy5pbnRDb250cm9sLnZhbHVlLmxlbmd0aDtcbiAgICBjb25zdCBuZXdQb3MgPSBNYXRoLm1heChvZmZzZXQgKyBuZXdMZW4sIDApO1xuICAgIGlmIChuZXdMZW4gPiAwICYmIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IHRoaXMuaW50RWwubmF0aXZlRWxlbWVudCkge1xuICAgICAgdGhpcy5pbnRFbC5uYXRpdmVFbGVtZW50LnNlbGVjdGlvblN0YXJ0ID0gbmV3UG9zO1xuICAgICAgdGhpcy5pbnRFbC5uYXRpdmVFbGVtZW50LnNlbGVjdGlvbkVuZCA9IG5ld1BvcztcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFdmVudCBoYW5kbGVyIGZvciBiYWNrc3BhY2Uga2V5IHByZXNzLCBhbmQgY2hlY2sgaWYgY29ycmVjdCBudW1iZXIgaXMgZGVsZXRlZFxuICAgKi9cbiAgb25CYWNrc3BhY2UoZWw6IEhUTUxJbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoZWwuc2VsZWN0aW9uU3RhcnQpIHtcbiAgICAgIGNvbnN0IHNlbGVjdGlvblN0YXJ0UG9zaXRpb24gPSBlbC5zZWxlY3Rpb25TdGFydCAtIDE7XG4gICAgICBjb25zdCB2YWx1ZSA9IGVsLnZhbHVlW3NlbGVjdGlvblN0YXJ0UG9zaXRpb25dO1xuXG4gICAgICBpZiAodGhpcy5sb2NhbGVTZXBhcmF0b3JTeW1ib2xzLmluY2x1ZGVzKHZhbHVlKSkge1xuICAgICAgICBlbC5zZXRTZWxlY3Rpb25SYW5nZShzZWxlY3Rpb25TdGFydFBvc2l0aW9uLCBzZWxlY3Rpb25TdGFydFBvc2l0aW9uKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBtZXRob2QgaXMgdXNlZCB0byBjb3JyZWN0IHJlbmRlcmVkIGlucHV0J3MgdmFsdWUgaWYgdXNlciBlbnRlcmVkICctJyBhbmQgbGVmdCB0aGUgZmllbGRcbiAgY29ycmVjdElucHV0VmFsdWUoJGV2ZW50OiBGb2N1c0V2ZW50KSB7XG4gICAgdGhpcy5tYXJrQXNUb3VjaGVkKCRldmVudCk7XG4gICAgY29uc3QgbnVtZXJpYyA9IHRoaXMuaW50Q29udHJvbC52YWx1ZTtcbiAgICBpZiAobnVtZXJpYyAhPT0gJy0nKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaW50Q29udHJvbC5zZXRWYWx1ZSgnJywgeyBlbWl0RXZlbnQ6IGZhbHNlIH0pO1xuICB9XG5cbiAgd3JpdGVWYWx1ZShtb2RlbDogYW55IHwgbnVsbCk6IHZvaWQge1xuICAgIGlmICghbW9kZWwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gY3VycmVuY3kgY2Fubm90IGJlIHNldCB0byBub3RoaW5nXG4gICAgaWYgKG1vZGVsLmN1cnJlbmN5KSB7XG4gICAgICB0aGlzLmN1cnJlbmN5ID0gbW9kZWwuY3VycmVuY3k7XG4gICAgICB0aGlzLmN1cnJDb250cm9sLnNldFZhbHVlKG1vZGVsLmN1cnJlbmN5KTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIG1vZGVsLmFtb3VudCA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIG1vZGVsLmFtb3VudCA9PT0gJ251bWJlcicpIHtcbiAgICAgIGNvbnN0IFt3aG9sZSwgZGVjaW1hbHNdID0gKCcnICsgbW9kZWwuYW1vdW50KS5zcGxpdCgnLicpO1xuICAgICAgdGhpcy5pbnRDb250cm9sLnNldFZhbHVlKHdob2xlKTtcbiAgICAgIHRoaXMuZGVjQ29udHJvbC5zZXRWYWx1ZShkZWNpbWFscyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaW50Q29udHJvbC5zZXRWYWx1ZSgnJyk7XG4gICAgICB0aGlzLmRlY0NvbnRyb2wuc2V0VmFsdWUoJycpO1xuICAgIH1cblxuICAgIHRoaXMuZm9ybWF0SW50ZWdlcigpO1xuICB9XG5cbiAgcmVnaXN0ZXJPbkNoYW5nZShmbjogKCkgPT4gdm9pZCk6IHZvaWQge1xuICAgIHRoaXMub25DaGFuZ2UgPSBmbjtcbiAgfVxuXG4gIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiAoKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgdGhpcy5vblRvdWNoZWQgPSBmbjtcbiAgfVxuXG4gIG1hcmtBc1RvdWNoZWQoJGV2ZW50OiBGb2N1c0V2ZW50KSB7XG4gICAgdGhpcy5ibHVyLmVtaXQoJGV2ZW50KTtcbiAgICB0aGlzLm9uVG91Y2hlZCgpO1xuICB9XG5cbiAgcHJvdGVjdGVkIHNldERpc2FibGVkKGRpc2FibGVTdGF0ZTogQ3VycmVuY3lGaWVsZHNTdGF0ZSkge1xuICAgIGlmIChkaXNhYmxlU3RhdGUuY3VycmVuY3kpIHtcbiAgICAgIHRoaXMuY3VyckNvbnRyb2wuZGlzYWJsZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmN1cnJDb250cm9sLmVuYWJsZSgpO1xuICAgIH1cbiAgICBpZiAoZGlzYWJsZVN0YXRlLmludGVnZXIpIHtcbiAgICAgIHRoaXMuaW50Q29udHJvbC5kaXNhYmxlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaW50Q29udHJvbC5lbmFibGUoKTtcbiAgICB9XG4gICAgaWYgKGRpc2FibGVTdGF0ZS5kZWNpbWFsKSB7XG4gICAgICB0aGlzLmRlY0NvbnRyb2wuZGlzYWJsZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRlY0NvbnRyb2wuZW5hYmxlKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBmb2N1c0RlY0VsKGtleTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZGVjRWwgJiYgWycuJywgJywnXS5pbmRleE9mKGtleSkgIT09IC0xKSB7XG4gICAgICB0aGlzLmRlY0VsLm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTWFrZSBzdXJlIHRoYXQgbnVtZXJpYyB2YWx1ZSBkb2Vzbid0IGV4Y2VlZCBtYXggbGVuZ3RoIChpZiBzZXQpXG4gICAqIHRoaXMgbWlnaHQgaGFwcGVuIGluIGNhc2UgdmFsdWUgaXMgcGFzdGVkIHRvIGlucHV0IHRoYXQgaGFzIGV4dGVuZGVkIG1heCBsZW5ndGhcbiAgICpcbiAgICogQHBhcmFtIG51bWVyaWNcbiAgICovXG4gIHByaXZhdGUgc2FuaXRpemVOdW1lcmljVmFsdWUobnVtZXJpYzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBpZiAodGhpcy5pbnRNYXhMZW4gJiYgbnVtZXJpYykge1xuICAgICAgcmV0dXJuIG51bWVyaWMuc2xpY2UoMCwgdGhpcy5pbnRNYXhMZW4pO1xuICAgIH1cblxuICAgIHJldHVybiBudW1lcmljO1xuICB9XG5cbiAgLyoqXG4gICAqIElmIGN1cnJlbmN5IGRvZXNuJ3QgaGF2ZSBkZWNpbWFsIHBhcnQsIGRlY2ltYWwgcGxhY2Vob2xkZXJcbiAgICogd2lsbCBiZSBzZXQgdG8gZGVmYXVsdCBkZWNNaW5MZW5cbiAgICovXG4gIHByaXZhdGUgZ2V0RGVjaW1hbERpZ2l0cyhjdXJyZW5jeTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIGdldE51bWJlck9mQ3VycmVuY3lEaWdpdHMoY3VycmVuY3kpID09PSAwID8gdGhpcy5kZWNNaW5MZW4gOiBnZXROdW1iZXJPZkN1cnJlbmN5RGlnaXRzKGN1cnJlbmN5KTtcbiAgfVxufVxuIiwiPGRpdiBjbGFzcz1cImJiLWN1cnJlbmN5LWlucHV0XCI+XG4gIDxkaXYgY2xhc3M9XCJiYi1zdGFjayBiYi1zdGFjay0tYWxpZ24tYm90dG9tXCI+XG4gICAgPGRpdiAqbmdJZj1cImN1ckxpc3QgJiYgY3VyTGlzdC5sZW5ndGhcIiBjbGFzcz1cImJiLWN1cnJlbmN5LWlucHV0X19jdXJyZW5jeS1zZWxlY3RvciBzZWxlY3RvciBiYi1zdGFja19faXRlbVwiPlxuICAgICAgPGxhYmVsXG4gICAgICAgIGNsYXNzPVwic3Itb25seVwiXG4gICAgICAgICpuZ0lmPVwiY3VycmVuY3lMaXN0QXJpYUxhYmVsIHx8IGN1cnJlbmN5TGlzdFdpdGhPbkl0ZW1BcmlhTGFiZWxcIlxuICAgICAgICBmb3I9XCJ7eyBjdXJyZW5jeUlucHV0SWQgfX1cIlxuICAgICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cImN1cnJlbmN5TGlzdFdpdGhPbkl0ZW1BcmlhTGFiZWxcIlxuICAgICAgICBpZD1cInt7IGN1cnJlbmN5TGFiZWxJZCB9fVwiXG4gICAgICAgIFthdHRyLmRhdGEtcm9sZV09XCInY3VycmVuY3ktaW5wdXQtbGFiZWwnXCJcbiAgICAgID5cbiAgICAgICAgPG5nLWNvbnRhaW5lciBbbmdTd2l0Y2hdPVwiISFjdXJyZW5jeUxpc3RBcmlhTGFiZWwgfHwgISFjdXJyZW5jeUxpc3RXaXRoT25JdGVtQXJpYUxhYmVsXCI+XG4gICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdTd2l0Y2hDYXNlPVwidHJ1ZVwiPlxuICAgICAgICAgICAge3sgY3VyTGlzdCAmJiBjdXJMaXN0Lmxlbmd0aCA+IDEgPyBjdXJyZW5jeUxpc3RBcmlhTGFiZWwgOiBjdXJyZW5jeUxpc3RXaXRoT25JdGVtQXJpYUxhYmVsIH19XG4gICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgPG5nLWNvbnRhaW5lclxuICAgICAgICAgICAgKm5nU3dpdGNoRGVmYXVsdFxuICAgICAgICAgICAgaTE4bj1cIlxuICAgICAgICAgICAgICBDdXJyZW5jeSBsYWJlbCB8IExhYmVsIGZvciBjdXJyZW5jeSBjb2RlIGRyb3Bkb3duIG9mIHRoZSBDdXJyZW5jeSBJbnB1dCBjb21wb25lbnRcbiAgICAgICAgICAgICAgQEBiYi1jdXJyZW5jeS1pbnB1dC11aS5jdXJyZW5jeS1pbnB1dC1sYWJlbFwiXG4gICAgICAgICAgICA+Q3VycmVuY3k8L25nLWNvbnRhaW5lclxuICAgICAgICAgID5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICA8L2xhYmVsPlxuICAgICAgPG5nLWNvbnRhaW5lciBbbmdTd2l0Y2hdPVwicmVhZG9ubHkgfHwgKGN1ckxpc3QgJiYgY3VyTGlzdC5sZW5ndGggPT09IDEpXCI+XG4gICAgICAgIDxpbnB1dFxuICAgICAgICAgICpuZ1N3aXRjaENhc2U9XCJ0cnVlXCJcbiAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgKGJsdXIpPVwibWFya0FzVG91Y2hlZCgkZXZlbnQpXCJcbiAgICAgICAgICBbaWRdPVwiY3VycmVuY3lJbnB1dElkXCJcbiAgICAgICAgICBbcmVhZG9ubHldPVwidHJ1ZVwiXG4gICAgICAgICAgW3JlcXVpcmVkXT1cInJlcXVpcmVkXCJcbiAgICAgICAgICBbYXR0ci5hcmlhLWludmFsaWRdPVwiYXJpYUludmFsaWRcIlxuICAgICAgICAgIFthdHRyLmFyaWEtbGFiZWxsZWRieV09XCJpZExpc3RBdHRyKGFyaWFMYWJlbGxlZGJ5LCBjdXJyZW5jeUxhYmVsSWQpXCJcbiAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbCBiYi10ZXh0LWFsaWduLWNlbnRlclwiXG4gICAgICAgICAgdmFsdWU9XCJ7eyBjdXIgfX1cIlxuICAgICAgICAgIFthdHRyLmRhdGEtcm9sZV09XCInY3VycmVuY3ktaW5wdXQtY3VycmVuY3ktcmVhZG9ubHknXCJcbiAgICAgICAgLz5cbiAgICAgICAgPGJiLWRyb3Bkb3duLXNpbmdsZS1zZWxlY3QtdWlcbiAgICAgICAgICAqbmdTd2l0Y2hEZWZhdWx0XG4gICAgICAgICAgW2lkXT1cImN1cnJlbmN5SW5wdXRJZFwiXG4gICAgICAgICAgY2xhc3M9XCJiYi1ibG9ja1wiXG4gICAgICAgICAgW3BsYWNlaG9sZGVyXT1cImN1ckxpc3RbMF1cIlxuICAgICAgICAgIFtvcHRpb25zXT1cImN1ckxpc3RcIlxuICAgICAgICAgIFtyZWFkb25seV09XCJyZWFkb25seVwiXG4gICAgICAgICAgW3JlcXVpcmVkXT1cInJlcXVpcmVkXCJcbiAgICAgICAgICBbYXJpYS1pbnZhbGlkXT1cImFyaWFJbnZhbGlkXCJcbiAgICAgICAgICBbYXJpYS1sYWJlbGxlZGJ5XT1cImlkTGlzdEF0dHIoYXJpYUxhYmVsbGVkYnksIGN1cnJlbmN5TGFiZWxJZClcIlxuICAgICAgICAgIChjaGFuZ2UpPVwidXBkYXRlQ3VycmVuY3koKTsgbWFya0FzVG91Y2hlZCgkZXZlbnQpXCJcbiAgICAgICAgICBbZm9ybUNvbnRyb2xdPVwiY3VyckNvbnRyb2xcIlxuICAgICAgICAgIFthdHRyLmRhdGEtcm9sZV09XCInY3VycmVuY3ktaW5wdXQtY3VycmVuY3ktc2VsZWN0b3InXCJcbiAgICAgICAgPjwvYmItZHJvcGRvd24tc2luZ2xlLXNlbGVjdC11aT5cbiAgICAgIDwvbmctY29udGFpbmVyPlxuICAgIDwvZGl2PlxuXG4gICAgPGRpdlxuICAgICAgY2xhc3M9XCJiYi1jdXJyZW5jeS1pbnB1dF9faW50ZWdlciBiYi1zdGFja19faXRlbSBiYi1zdGFja19faXRlbS0tc3BhY2luZy1zbVwiXG4gICAgICBbY2xhc3MubmctdG91Y2hlZF09XCJpbnRDb250cm9sLnRvdWNoZWQgfHwgZGVjQ29udHJvbC50b3VjaGVkIHx8IHBhcmVudEZvcm1Db250cm9sPy50b3VjaGVkXCJcbiAgICAgIFtjbGFzcy5uZy1pbnZhbGlkXT1cImludENvbnRyb2wuaW52YWxpZCB8fCBwYXJlbnRGb3JtQ29udHJvbD8uaW52YWxpZFwiXG4gICAgPlxuICAgICAgPGxhYmVsXG4gICAgICAgIFtjbGFzcy5zci1vbmx5XT1cIiFpbnRlZ2VyTGFiZWwgfHwgaW50ZWdlckxhYmVsU3JPbmx5XCJcbiAgICAgICAgZm9yPVwie3sgaW50ZWdlcklucHV0SWQgfX1cIlxuICAgICAgICBpZD1cInt7IGludGVnZXJMYWJlbElkIH19XCJcbiAgICAgICAgW2F0dHIuZGF0YS1yb2xlXT1cIidjdXJyZW5jeS1pbnB1dC1pbnRlZ2VyLWxhYmVsJ1wiXG4gICAgICA+XG4gICAgICAgIDxuZy1jb250YWluZXIgW25nU3dpdGNoXT1cIiEhaW50ZWdlckxhYmVsXCI+XG4gICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdTd2l0Y2hDYXNlPVwidHJ1ZVwiPlxuICAgICAgICAgICAge3sgaW50ZWdlckxhYmVsIH19XG4gICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgPG5nLWNvbnRhaW5lclxuICAgICAgICAgICAgKm5nU3dpdGNoRGVmYXVsdFxuICAgICAgICAgICAgaTE4bj1cIlxuICAgICAgICAgICAgICBJbnRlZ2VyIGxhYmVsIHwgTGFiZWwgZm9yIGludGVnZXIgcGFydCBvZiB0aGUgbW9uZXRhcnkgYW1vdW50IG9mIHRoZSBDdXJyZW5jeSBJbnB1dCBjb21wb25lbnRcbiAgICAgICAgICAgICAgQEBiYi1jdXJyZW5jeS1pbnB1dC11aS5pbnRlZ2VyLWlucHV0LWxhYmVsXCJcbiAgICAgICAgICAgID5JbnRlZ2VyPC9uZy1jb250YWluZXJcbiAgICAgICAgICA+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgPC9sYWJlbD5cbiAgICAgIDxpbnB1dFxuICAgICAgICBpZD1cInt7IGludGVnZXJJbnB1dElkIH19XCJcbiAgICAgICAgW2F0dHIuYXJpYS1kZXNjcmliZWRieV09XCJpZExpc3RBdHRyKGFyaWFEZXNjcmliZWRieSwgdmFsaWRhdGlvbk1lc3NhZ2VzSWQpXCJcbiAgICAgICAgW2F0dHIuYXJpYS1pbnZhbGlkXT1cImFyaWFJbnZhbGlkXCJcbiAgICAgICAgW2F0dHIuYXJpYS1sYWJlbGxlZGJ5XT1cImlkTGlzdEF0dHIoYXJpYUxhYmVsbGVkYnksIGludGVnZXJMYWJlbElkKVwiXG4gICAgICAgIG5hbWU9XCJpbnRlZ2VyXCJcbiAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICBzaXplPVwiNVwiXG4gICAgICAgIHJvbGU9XCJ0ZXh0Ym94XCJcbiAgICAgICAgW3JlYWRPbmx5XT1cInJlYWRvbmx5XCJcbiAgICAgICAgW3JlcXVpcmVkXT1cInJlcXVpcmVkXCJcbiAgICAgICAgKGtleWRvd24uYmFja3NwYWNlKT1cIm9uQmFja3NwYWNlKGludGVnZXJJbnB1dClcIlxuICAgICAgICAoa2V5cHJlc3MpPVwib25QcmVzcygkZXZlbnQpXCJcbiAgICAgICAgKGlucHV0KT1cIm9uSW5wdXQoKVwiXG4gICAgICAgIChibHVyKT1cImNvcnJlY3RJbnB1dFZhbHVlKCRldmVudClcIlxuICAgICAgICBbZm9ybUNvbnRyb2xdPVwiaW50Q29udHJvbFwiXG4gICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sIGJiLXRleHQtYWxpZ24tcmlnaHRcIlxuICAgICAgICBwbGFjZWhvbGRlcj1cInt7IHBsYWNlaG9sZGVyIH19XCJcbiAgICAgICAgI2ludGVnZXJJbnB1dFxuICAgICAgICBhdXRvY29tcGxldGU9XCJvZmZcIlxuICAgICAgICBhdXRvY29ycmVjdD1cIm9mZlwiXG4gICAgICAgIGF1dG9jYXBpdGFsaXplPVwib2ZmXCJcbiAgICAgICAgc3BlbGxjaGVjaz1cImZhbHNlXCJcbiAgICAgICAgW2F0dHIuZGF0YS1yb2xlXT1cIidjdXJyZW5jeS1pbnB1dC1pbnRlZ2VyLWlucHV0J1wiXG4gICAgICAvPlxuICAgIDwvZGl2PlxuXG4gICAgPHNwYW4gKm5nSWY9XCIhaW50ZWdlciAmJiBkZWNNYXhMZW5cIiBjbGFzcz1cImJiLXN0YWNrX19pdGVtIGJiLXN0YWNrX19pdGVtLS1zcGFjaW5nLXNtXCI+e3sgZGVjaW1hbFNlcGFyYXRvciB9fTwvc3Bhbj5cblxuICAgIDxkaXZcbiAgICAgICpuZ0lmPVwiIWludGVnZXIgJiYgZGVjTWF4TGVuXCJcbiAgICAgIGNsYXNzPVwiYmItY3VycmVuY3ktaW5wdXRfX2RlY2ltYWxcIlxuICAgICAgW2NsYXNzLm5nLXRvdWNoZWRdPVwiaW50Q29udHJvbC50b3VjaGVkIHx8IGRlY0NvbnRyb2wudG91Y2hlZCB8fCBwYXJlbnRGb3JtQ29udHJvbD8udG91Y2hlZFwiXG4gICAgICBbY2xhc3MubmctaW52YWxpZF09XCJpbnRDb250cm9sLmludmFsaWQgfHwgcGFyZW50Rm9ybUNvbnRyb2w/LmludmFsaWRcIlxuICAgID5cbiAgICAgIDxsYWJlbFxuICAgICAgICBbY2xhc3Muc3Itb25seV09XCIhZGVjaW1hbExhYmVsIHx8IGRlY2ltYWxMYWJlbFNyT25seVwiXG4gICAgICAgIGZvcj1cInt7IGRlY2ltYWxJbnB1dElkIH19XCJcbiAgICAgICAgaWQ9XCJ7eyBkZWNpbWFsTGFiZWxJZCB9fVwiXG4gICAgICAgIFthdHRyLmRhdGEtcm9sZV09XCInY3VycmVuY3ktaW5wdXQtZGVjaW1hbC1sYWJlbCdcIlxuICAgICAgPlxuICAgICAgICA8bmctY29udGFpbmVyIFtuZ1N3aXRjaF09XCIhIWRlY2ltYWxMYWJlbFwiPlxuICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nU3dpdGNoQ2FzZT1cInRydWVcIj5cbiAgICAgICAgICAgIHt7IGRlY2ltYWxMYWJlbCB9fVxuICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgIDxuZy1jb250YWluZXJcbiAgICAgICAgICAgICpuZ1N3aXRjaERlZmF1bHRcbiAgICAgICAgICAgIGkxOG49XCJcbiAgICAgICAgICAgICAgRGVjaW1hbCBsYWJlbCB8IExhYmVsIGZvciBkZWNpbWFsIHBhcnQgb2YgdGhlIG1vbmV0YXJ5IGFtb3VudCBvZiB0aGUgQ3VycmVuY3kgSW5wdXQgY29tcG9uZW50XG4gICAgICAgICAgICAgIEBAYmItY3VycmVuY3ktaW5wdXQtdWkuZGVjaW1hbC1pbnB1dC1sYWJlbFwiXG4gICAgICAgICAgPlxuICAgICAgICAgICAgRGVjaW1hbHNcbiAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICA8L2xhYmVsPlxuICAgICAgPGlucHV0XG4gICAgICAgIGlkPVwie3sgZGVjaW1hbElucHV0SWQgfX1cIlxuICAgICAgICBbYXR0ci5hcmlhLWRlc2NyaWJlZGJ5XT1cImlkTGlzdEF0dHIoYXJpYURlc2NyaWJlZGJ5LCB2YWxpZGF0aW9uTWVzc2FnZXNJZClcIlxuICAgICAgICBbYXR0ci5hcmlhLWludmFsaWRdPVwiYXJpYUludmFsaWRcIlxuICAgICAgICBbYXR0ci5hcmlhLWxhYmVsbGVkYnldPVwiaWRMaXN0QXR0cihhcmlhTGFiZWxsZWRieSwgZGVjaW1hbExhYmVsSWQpXCJcbiAgICAgICAgbmFtZT1cImRlY2ltYWxzXCJcbiAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICByb2xlPVwidGV4dGJveFwiXG4gICAgICAgIFtyZWFkT25seV09XCJyZWFkb25seVwiXG4gICAgICAgIFtyZXF1aXJlZF09XCJyZXF1aXJlZFwiXG4gICAgICAgIChrZXlwcmVzcyk9XCJvblByZXNzKCRldmVudClcIlxuICAgICAgICAoaW5wdXQpPVwidHJpZ2dlckNoYW5nZSgpXCJcbiAgICAgICAgKGJsdXIpPVwiZGVjT25CbHVyKCRldmVudClcIlxuICAgICAgICBbZm9ybUNvbnRyb2xdPVwiZGVjQ29udHJvbFwiXG4gICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcbiAgICAgICAgW25nQ2xhc3NdPVwieyAnYmItdGV4dC1hbGlnbi1yaWdodCc6IGlzUmlnaHRBbGlnbmVkIH1cIlxuICAgICAgICBtYXhsZW5ndGg9XCJ7eyBkZWNNYXhMZW4gfX1cIlxuICAgICAgICBwbGFjZWhvbGRlcj1cInt7IGRlY1BsYWNlaG9sZGVyIH19XCJcbiAgICAgICAgI2RlY2ltYWxzSW5wdXRcbiAgICAgICAgYXV0b2NvbXBsZXRlPVwib2ZmXCJcbiAgICAgICAgYXV0b2NvcnJlY3Q9XCJvZmZcIlxuICAgICAgICBhdXRvY2FwaXRhbGl6ZT1cIm9mZlwiXG4gICAgICAgIHNwZWxsY2hlY2s9XCJmYWxzZVwiXG4gICAgICAgIFthdHRyLmRhdGEtcm9sZV09XCInaW5wdXQtY3VycmVuY3ktZGVjaW1hbHMnXCJcbiAgICAgIC8+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuICA8ZGl2XG4gICAgY2xhc3M9XCJiYi1pbnB1dC12YWxpZGF0aW9uLW1lc3NhZ2VcIlxuICAgIGFyaWEtbGl2ZT1cImFzc2VydGl2ZVwiXG4gICAgW2lkXT1cInZhbGlkYXRpb25NZXNzYWdlc0lkXCJcbiAgICBbYXR0ci5kYXRhLXJvbGVdPVwiJ2N1cnJlbmN5LWlucHV0LXZhbGlkYXRpb24tbWVzc2FnZSdcIlxuICA+XG4gICAgPG5nLWNvbnRlbnQgc2VsZWN0PVwiW2JiVmFsaWRhdGlvbk1lc3NhZ2VdXCI+PC9uZy1jb250ZW50PlxuICA8L2Rpdj5cbjwvZGl2PlxuIl19