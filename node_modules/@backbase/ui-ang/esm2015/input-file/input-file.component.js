import { ChangeDetectionStrategy, Component, forwardRef, Input } from '@angular/core';
import { NG_VALIDATORS, NG_VALUE_ACCESSOR } from '@angular/forms';
import { InputBaseComponent } from '@backbase/ui-ang/base-classes';
import * as i0 from "@angular/core";
import * as i1 from "@backbase/foundation-ang/future";
import * as i2 from "@backbase/ui-ang/icon";
import * as i3 from "@backbase/ui-ang/button";
import * as i4 from "@angular/common";
/**
 * @name InputFileComponent
 *
 * @description
 * Component that displays a file input button.
 *
 * @a11y Current component provide option to pass needed accessibility
 * attributes. You need to take care of properties that are required in your case :
 *  - role
 *  - aria-activedescendant
 *  - aria-describedby
 *  - aria-expanded
 *  - aria-label
 *  - aria-labelledby
 *  - aria-owns
 *
 */
export class InputFileComponent extends InputBaseComponent {
    constructor(cd, deprecationsService) {
        super(cd, deprecationsService);
        this.cd = cd;
        this.deprecationsService = deprecationsService;
        /**
         * Accepted file formats. Defaults to any ('*');
         */
        this.accept = '*';
        /**
         * Multiple/single file upload flag. Defaults to false;
         */
        this.multiple = false;
        /**
         * Button color. Defaults to 'link';
         */
        this.color = 'link';
        /**
         * This Boolean attribute lets you specify that the button should have input focus when the page
         * loads, unless the user overrides it, for example by typing in a different control. Only one
         * form-associated element in a document can have this attribute specified. Defaults to false.
         */
        this.autofocus = false;
        /**
         * Size of the button. Defaults to 'md'.
         */
        this.buttonSize = 'md';
        /**
         * Button icon name. Defaults to 'attachment';
         */
        this.iconName = 'attachment';
    }
    ngOnInit() {
        super.ngOnInit();
        if (this.maxSizeInMb && Math.sign(Number(this.maxSizeInMb)) !== 1) {
            this.maxSizeInMb = undefined;
            console.warn('[bb-input-file-ui]: invalid maximum file size, falling back to infinite');
        }
    }
    onValueChange(input) {
        var _a;
        const files = ((_a = input.files) === null || _a === void 0 ? void 0 : _a.length) && [...input.files];
        if (Array.isArray(files)) {
            this.value = { files };
            this.onChange(this.value);
        }
    }
    validate() {
        let isMaxSizeExceeded = false;
        const value = this.value && this.value.files;
        if (Array.isArray(value) && this.maxSizeInMb) {
            const maxSizeInBytes = Number(this.maxSizeInMb) * 1024 * 1024;
            isMaxSizeExceeded = value.some((file) => file.size > maxSizeInBytes);
        }
        return isMaxSizeExceeded ? { maxFileSizeExceeded: true } : null;
    }
}
InputFileComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: InputFileComponent, deps: [{ token: i0.ChangeDetectorRef }, { token: i1.DeprecationsService }], target: i0.ɵɵFactoryTarget.Component });
InputFileComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.16", type: InputFileComponent, selector: "bb-input-file-ui", inputs: { accept: "accept", maxSizeInMb: "maxSizeInMb", multiple: "multiple", color: "color", autofocus: "autofocus", buttonText: "buttonText", buttonSize: "buttonSize", iconName: "iconName" }, providers: [
        {
            provide: NG_VALUE_ACCESSOR,
            useExisting: forwardRef(() => InputFileComponent),
            multi: true,
        },
        {
            provide: NG_VALIDATORS,
            useExisting: forwardRef(() => InputFileComponent),
            multi: true,
        },
    ], usesInheritance: true, ngImport: i0, template: "<button\n  bbButton\n  data-role=\"file-input-button\"\n  class=\"bb-block bb-block--xs\"\n  [autofocus]=\"autofocus\"\n  [color]=\"color\"\n  [buttonSize]=\"buttonSize\"\n  (focus)=\"onFocus($event)\"\n  (click)=\"fileInput.click()\"\n  [disabled]=\"disabled\"\n  [attr.aria-describedby]=\"ariaDescribedby\"\n  [attr.aria-labelledby]=\"ariaLabelledby\"\n  [attr.role]=\"role\"\n  [attr.aria-owns]=\"ariaOwns\"\n  [attr.aria-activedescendant]=\"ariaActivedescendant\"\n  [attr.aria-label]=\"(!label && ariaLabel) || null\"\n>\n  <bb-icon-ui cropped=\"true\" [name]=\"iconName\"></bb-icon-ui>\n  <span *ngIf=\"buttonText; else attachFile\">{{ buttonText }}</span>\n  <ng-template #attachFile i18n=\"Attach file@@fileInputButton.text\">Attach file</ng-template>\n  <input\n    [accept]=\"accept\"\n    [multiple]=\"multiple\"\n    hidden\n    data-role=\"file-input\"\n    type=\"file\"\n    #fileInput\n    (change)=\"onValueChange(fileInput)\"\n    [disabled]=\"disabled\"\n    [required]=\"required\"\n  />\n</button>\n", components: [{ type: i2.IconComponent, selector: "bb-icon-ui", inputs: ["name", "inverse", "size", "color", "animate", "aria-label", "cropped", "backgroundType"] }], directives: [{ type: i3.ButtonDirective, selector: "button[bbButton]", inputs: ["type", "color", "buttonSize", "block", "circle"] }, { type: i4.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: InputFileComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'bb-input-file-ui',
                    templateUrl: './input-file.component.html',
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef(() => InputFileComponent),
                            multi: true,
                        },
                        {
                            provide: NG_VALIDATORS,
                            useExisting: forwardRef(() => InputFileComponent),
                            multi: true,
                        },
                    ],
                }]
        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }, { type: i1.DeprecationsService }]; }, propDecorators: { accept: [{
                type: Input
            }], maxSizeInMb: [{
                type: Input
            }], multiple: [{
                type: Input
            }], color: [{
                type: Input
            }], autofocus: [{
                type: Input
            }], buttonText: [{
                type: Input
            }], buttonSize: [{
                type: Input
            }], iconName: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXQtZmlsZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9saWJzL3VpLWFuZy9pbnB1dC1maWxlL2lucHV0LWZpbGUuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vbGlicy91aS1hbmcvaW5wdXQtZmlsZS9pbnB1dC1maWxlLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSx1QkFBdUIsRUFBcUIsU0FBUyxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQVUsTUFBTSxlQUFlLENBQUM7QUFDakgsT0FBTyxFQUFFLGFBQWEsRUFBRSxpQkFBaUIsRUFBK0IsTUFBTSxnQkFBZ0IsQ0FBQztBQUMvRixPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQzs7Ozs7O0FBSW5FOzs7Ozs7Ozs7Ozs7Ozs7O0dBZ0JHO0FBbUJILE1BQU0sT0FBTyxrQkFBbUIsU0FBUSxrQkFBa0I7SUEyQ3hELFlBQStCLEVBQXFCLEVBQXFCLG1CQUF3QztRQUMvRyxLQUFLLENBQUMsRUFBRSxFQUFFLG1CQUFtQixDQUFDLENBQUM7UUFERixPQUFFLEdBQUYsRUFBRSxDQUFtQjtRQUFxQix3QkFBbUIsR0FBbkIsbUJBQW1CLENBQXFCO1FBMUNqSDs7V0FFRztRQUNNLFdBQU0sR0FBRyxHQUFHLENBQUM7UUFPdEI7O1dBRUc7UUFDTSxhQUFRLEdBQUcsS0FBSyxDQUFDO1FBRTFCOztXQUVHO1FBQ00sVUFBSyxHQUF5QixNQUFNLENBQUM7UUFFOUM7Ozs7V0FJRztRQUNNLGNBQVMsR0FBRyxLQUFLLENBQUM7UUFPM0I7O1dBRUc7UUFDTSxlQUFVLEdBQWdCLElBQUksQ0FBQztRQUV4Qzs7V0FFRztRQUNNLGFBQVEsR0FBRyxZQUFZLENBQUM7SUFJakMsQ0FBQztJQUVELFFBQVE7UUFDTixLQUFLLENBQUMsUUFBUSxFQUFFLENBQUM7UUFFakIsSUFBSSxJQUFJLENBQUMsV0FBVyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUNqRSxJQUFJLENBQUMsV0FBVyxHQUFHLFNBQVMsQ0FBQztZQUM3QixPQUFPLENBQUMsSUFBSSxDQUFDLHlFQUF5RSxDQUFDLENBQUM7U0FDekY7SUFDSCxDQUFDO0lBRUQsYUFBYSxDQUFDLEtBQXVCOztRQUNuQyxNQUFNLEtBQUssR0FBRyxDQUFBLE1BQUEsS0FBSyxDQUFDLEtBQUssMENBQUUsTUFBTSxLQUFJLENBQUMsR0FBSSxLQUFLLENBQUMsS0FBdUIsQ0FBQyxDQUFDO1FBRXpFLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUN4QixJQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsS0FBSyxFQUFFLENBQUM7WUFDdkIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7U0FDM0I7SUFDSCxDQUFDO0lBRUQsUUFBUTtRQUNOLElBQUksaUJBQWlCLEdBQUcsS0FBSyxDQUFDO1FBQzlCLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLElBQUssSUFBSSxDQUFDLEtBQTJCLENBQUMsS0FBSyxDQUFDO1FBRXBFLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQzVDLE1BQU0sY0FBYyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsSUFBSSxHQUFHLElBQUksQ0FBQztZQUM5RCxpQkFBaUIsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBVSxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxHQUFHLGNBQWMsQ0FBQyxDQUFDO1NBQzVFO1FBRUQsT0FBTyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsRUFBRSxtQkFBbUIsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0lBQ2xFLENBQUM7O2dIQTNFVSxrQkFBa0I7b0dBQWxCLGtCQUFrQiw2T0FibEI7UUFDVDtZQUNFLE9BQU8sRUFBRSxpQkFBaUI7WUFDMUIsV0FBVyxFQUFFLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQztZQUNqRCxLQUFLLEVBQUUsSUFBSTtTQUNaO1FBQ0Q7WUFDRSxPQUFPLEVBQUUsYUFBYTtZQUN0QixXQUFXLEVBQUUsVUFBVSxDQUFDLEdBQUcsRUFBRSxDQUFDLGtCQUFrQixDQUFDO1lBQ2pELEtBQUssRUFBRSxJQUFJO1NBQ1o7S0FDRixpREN2Q0gsOC9CQWdDQTs0RkRTYSxrQkFBa0I7a0JBakI5QixTQUFTO21CQUFDO29CQUNULFFBQVEsRUFBRSxrQkFBa0I7b0JBQzVCLFdBQVcsRUFBRSw2QkFBNkI7b0JBQzFDLGVBQWUsRUFBRSx1QkFBdUIsQ0FBQyxNQUFNO29CQUMvQyxTQUFTLEVBQUU7d0JBQ1Q7NEJBQ0UsT0FBTyxFQUFFLGlCQUFpQjs0QkFDMUIsV0FBVyxFQUFFLFVBQVUsQ0FBQyxHQUFHLEVBQUUsbUJBQW1CLENBQUM7NEJBQ2pELEtBQUssRUFBRSxJQUFJO3lCQUNaO3dCQUNEOzRCQUNFLE9BQU8sRUFBRSxhQUFhOzRCQUN0QixXQUFXLEVBQUUsVUFBVSxDQUFDLEdBQUcsRUFBRSxtQkFBbUIsQ0FBQzs0QkFDakQsS0FBSyxFQUFFLElBQUk7eUJBQ1o7cUJBQ0Y7aUJBQ0Y7MElBS1UsTUFBTTtzQkFBZCxLQUFLO2dCQUtHLFdBQVc7c0JBQW5CLEtBQUs7Z0JBS0csUUFBUTtzQkFBaEIsS0FBSztnQkFLRyxLQUFLO3NCQUFiLEtBQUs7Z0JBT0csU0FBUztzQkFBakIsS0FBSztnQkFLRyxVQUFVO3NCQUFsQixLQUFLO2dCQUtHLFVBQVU7c0JBQWxCLEtBQUs7Z0JBS0csUUFBUTtzQkFBaEIsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBmb3J3YXJkUmVmLCBJbnB1dCwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBOR19WQUxJREFUT1JTLCBOR19WQUxVRV9BQ0NFU1NPUiwgVmFsaWRhdGlvbkVycm9ycywgVmFsaWRhdG9yIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgSW5wdXRCYXNlQ29tcG9uZW50IH0gZnJvbSAnQGJhY2tiYXNlL3VpLWFuZy9iYXNlLWNsYXNzZXMnO1xuaW1wb3J0IHsgQnV0dG9uQ29sb3IgfSBmcm9tICdAYmFja2Jhc2UvdWktYW5nL2J1dHRvbic7XG5pbXBvcnQgeyBEZXByZWNhdGlvbnNTZXJ2aWNlIH0gZnJvbSAnQGJhY2tiYXNlL2ZvdW5kYXRpb24tYW5nL2Z1dHVyZSc7XG5cbi8qKlxuICogQG5hbWUgSW5wdXRGaWxlQ29tcG9uZW50XG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBDb21wb25lbnQgdGhhdCBkaXNwbGF5cyBhIGZpbGUgaW5wdXQgYnV0dG9uLlxuICpcbiAqIEBhMTF5IEN1cnJlbnQgY29tcG9uZW50IHByb3ZpZGUgb3B0aW9uIHRvIHBhc3MgbmVlZGVkIGFjY2Vzc2liaWxpdHlcbiAqIGF0dHJpYnV0ZXMuIFlvdSBuZWVkIHRvIHRha2UgY2FyZSBvZiBwcm9wZXJ0aWVzIHRoYXQgYXJlIHJlcXVpcmVkIGluIHlvdXIgY2FzZSA6XG4gKiAgLSByb2xlXG4gKiAgLSBhcmlhLWFjdGl2ZWRlc2NlbmRhbnRcbiAqICAtIGFyaWEtZGVzY3JpYmVkYnlcbiAqICAtIGFyaWEtZXhwYW5kZWRcbiAqICAtIGFyaWEtbGFiZWxcbiAqICAtIGFyaWEtbGFiZWxsZWRieVxuICogIC0gYXJpYS1vd25zXG4gKlxuICovXG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2JiLWlucHV0LWZpbGUtdWknLFxuICB0ZW1wbGF0ZVVybDogJy4vaW5wdXQtZmlsZS5jb21wb25lbnQuaHRtbCcsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICBwcm92aWRlcnM6IFtcbiAgICB7XG4gICAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcbiAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IElucHV0RmlsZUNvbXBvbmVudCksXG4gICAgICBtdWx0aTogdHJ1ZSxcbiAgICB9LFxuICAgIHtcbiAgICAgIHByb3ZpZGU6IE5HX1ZBTElEQVRPUlMsXG4gICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBJbnB1dEZpbGVDb21wb25lbnQpLFxuICAgICAgbXVsdGk6IHRydWUsXG4gICAgfSxcbiAgXSxcbn0pXG5leHBvcnQgY2xhc3MgSW5wdXRGaWxlQ29tcG9uZW50IGV4dGVuZHMgSW5wdXRCYXNlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBWYWxpZGF0b3Ige1xuICAvKipcbiAgICogQWNjZXB0ZWQgZmlsZSBmb3JtYXRzLiBEZWZhdWx0cyB0byBhbnkgKCcqJyk7XG4gICAqL1xuICBASW5wdXQoKSBhY2NlcHQgPSAnKic7XG5cbiAgLyoqXG4gICAqIElmIHNldCwgdmFsaWRhdGUgYWNjb3JkaW5nIHRvIHRoZSBtYXhpbXVtIGZpbGUgc2l6ZSBpbiBNZWdhYnl0ZXMuXG4gICAqL1xuICBASW5wdXQoKSBtYXhTaXplSW5NYjogbnVtYmVyIHwgc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBNdWx0aXBsZS9zaW5nbGUgZmlsZSB1cGxvYWQgZmxhZy4gRGVmYXVsdHMgdG8gZmFsc2U7XG4gICAqL1xuICBASW5wdXQoKSBtdWx0aXBsZSA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBCdXR0b24gY29sb3IuIERlZmF1bHRzIHRvICdsaW5rJztcbiAgICovXG4gIEBJbnB1dCgpIGNvbG9yOiBCdXR0b25Db2xvciB8IHN0cmluZyA9ICdsaW5rJztcblxuICAvKipcbiAgICogVGhpcyBCb29sZWFuIGF0dHJpYnV0ZSBsZXRzIHlvdSBzcGVjaWZ5IHRoYXQgdGhlIGJ1dHRvbiBzaG91bGQgaGF2ZSBpbnB1dCBmb2N1cyB3aGVuIHRoZSBwYWdlXG4gICAqIGxvYWRzLCB1bmxlc3MgdGhlIHVzZXIgb3ZlcnJpZGVzIGl0LCBmb3IgZXhhbXBsZSBieSB0eXBpbmcgaW4gYSBkaWZmZXJlbnQgY29udHJvbC4gT25seSBvbmVcbiAgICogZm9ybS1hc3NvY2lhdGVkIGVsZW1lbnQgaW4gYSBkb2N1bWVudCBjYW4gaGF2ZSB0aGlzIGF0dHJpYnV0ZSBzcGVjaWZpZWQuIERlZmF1bHRzIHRvIGZhbHNlLlxuICAgKi9cbiAgQElucHV0KCkgYXV0b2ZvY3VzID0gZmFsc2U7XG5cbiAgLyoqXG4gICAqIEJ1dHRvbiB0ZXh0LiBJZiBzZXQsIGNoYW5nZSBidXR0b24gdGV4dCBmcm9tIGRlZmF1bHQgJ0F0dGFjaCBmaWxlJyB0byBhIGN1c3RvbSBvbmUuXG4gICAqL1xuICBASW5wdXQoKSBidXR0b25UZXh0OiBzdHJpbmcgfCB1bmRlZmluZWQ7XG5cbiAgLyoqXG4gICAqIFNpemUgb2YgdGhlIGJ1dHRvbi4gRGVmYXVsdHMgdG8gJ21kJy5cbiAgICovXG4gIEBJbnB1dCgpIGJ1dHRvblNpemU6ICdzbScgfCAnbWQnID0gJ21kJztcblxuICAvKipcbiAgICogQnV0dG9uIGljb24gbmFtZS4gRGVmYXVsdHMgdG8gJ2F0dGFjaG1lbnQnO1xuICAgKi9cbiAgQElucHV0KCkgaWNvbk5hbWUgPSAnYXR0YWNobWVudCc7XG5cbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIHJlYWRvbmx5IGNkOiBDaGFuZ2VEZXRlY3RvclJlZiwgcHJvdGVjdGVkIHJlYWRvbmx5IGRlcHJlY2F0aW9uc1NlcnZpY2U6IERlcHJlY2F0aW9uc1NlcnZpY2UpIHtcbiAgICBzdXBlcihjZCwgZGVwcmVjYXRpb25zU2VydmljZSk7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICBzdXBlci5uZ09uSW5pdCgpO1xuXG4gICAgaWYgKHRoaXMubWF4U2l6ZUluTWIgJiYgTWF0aC5zaWduKE51bWJlcih0aGlzLm1heFNpemVJbk1iKSkgIT09IDEpIHtcbiAgICAgIHRoaXMubWF4U2l6ZUluTWIgPSB1bmRlZmluZWQ7XG4gICAgICBjb25zb2xlLndhcm4oJ1tiYi1pbnB1dC1maWxlLXVpXTogaW52YWxpZCBtYXhpbXVtIGZpbGUgc2l6ZSwgZmFsbGluZyBiYWNrIHRvIGluZmluaXRlJyk7XG4gICAgfVxuICB9XG5cbiAgb25WYWx1ZUNoYW5nZShpbnB1dDogSFRNTElucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGZpbGVzID0gaW5wdXQuZmlsZXM/Lmxlbmd0aCAmJiBbLi4uKGlucHV0LmZpbGVzIGFzIGFueSBhcyBGaWxlW10pXTtcblxuICAgIGlmIChBcnJheS5pc0FycmF5KGZpbGVzKSkge1xuICAgICAgdGhpcy52YWx1ZSA9IHsgZmlsZXMgfTtcbiAgICAgIHRoaXMub25DaGFuZ2UodGhpcy52YWx1ZSk7XG4gICAgfVxuICB9XG5cbiAgdmFsaWRhdGUoKTogVmFsaWRhdGlvbkVycm9ycyB8IG51bGwge1xuICAgIGxldCBpc01heFNpemVFeGNlZWRlZCA9IGZhbHNlO1xuICAgIGNvbnN0IHZhbHVlID0gdGhpcy52YWx1ZSAmJiAodGhpcy52YWx1ZSBhcyB7IGZpbGVzOiBGaWxlW10gfSkuZmlsZXM7XG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgJiYgdGhpcy5tYXhTaXplSW5NYikge1xuICAgICAgY29uc3QgbWF4U2l6ZUluQnl0ZXMgPSBOdW1iZXIodGhpcy5tYXhTaXplSW5NYikgKiAxMDI0ICogMTAyNDtcbiAgICAgIGlzTWF4U2l6ZUV4Y2VlZGVkID0gdmFsdWUuc29tZSgoZmlsZTogRmlsZSkgPT4gZmlsZS5zaXplID4gbWF4U2l6ZUluQnl0ZXMpO1xuICAgIH1cblxuICAgIHJldHVybiBpc01heFNpemVFeGNlZWRlZCA/IHsgbWF4RmlsZVNpemVFeGNlZWRlZDogdHJ1ZSB9IDogbnVsbDtcbiAgfVxufVxuIiwiPGJ1dHRvblxuICBiYkJ1dHRvblxuICBkYXRhLXJvbGU9XCJmaWxlLWlucHV0LWJ1dHRvblwiXG4gIGNsYXNzPVwiYmItYmxvY2sgYmItYmxvY2stLXhzXCJcbiAgW2F1dG9mb2N1c109XCJhdXRvZm9jdXNcIlxuICBbY29sb3JdPVwiY29sb3JcIlxuICBbYnV0dG9uU2l6ZV09XCJidXR0b25TaXplXCJcbiAgKGZvY3VzKT1cIm9uRm9jdXMoJGV2ZW50KVwiXG4gIChjbGljayk9XCJmaWxlSW5wdXQuY2xpY2soKVwiXG4gIFtkaXNhYmxlZF09XCJkaXNhYmxlZFwiXG4gIFthdHRyLmFyaWEtZGVzY3JpYmVkYnldPVwiYXJpYURlc2NyaWJlZGJ5XCJcbiAgW2F0dHIuYXJpYS1sYWJlbGxlZGJ5XT1cImFyaWFMYWJlbGxlZGJ5XCJcbiAgW2F0dHIucm9sZV09XCJyb2xlXCJcbiAgW2F0dHIuYXJpYS1vd25zXT1cImFyaWFPd25zXCJcbiAgW2F0dHIuYXJpYS1hY3RpdmVkZXNjZW5kYW50XT1cImFyaWFBY3RpdmVkZXNjZW5kYW50XCJcbiAgW2F0dHIuYXJpYS1sYWJlbF09XCIoIWxhYmVsICYmIGFyaWFMYWJlbCkgfHwgbnVsbFwiXG4+XG4gIDxiYi1pY29uLXVpIGNyb3BwZWQ9XCJ0cnVlXCIgW25hbWVdPVwiaWNvbk5hbWVcIj48L2JiLWljb24tdWk+XG4gIDxzcGFuICpuZ0lmPVwiYnV0dG9uVGV4dDsgZWxzZSBhdHRhY2hGaWxlXCI+e3sgYnV0dG9uVGV4dCB9fTwvc3Bhbj5cbiAgPG5nLXRlbXBsYXRlICNhdHRhY2hGaWxlIGkxOG49XCJBdHRhY2ggZmlsZUBAZmlsZUlucHV0QnV0dG9uLnRleHRcIj5BdHRhY2ggZmlsZTwvbmctdGVtcGxhdGU+XG4gIDxpbnB1dFxuICAgIFthY2NlcHRdPVwiYWNjZXB0XCJcbiAgICBbbXVsdGlwbGVdPVwibXVsdGlwbGVcIlxuICAgIGhpZGRlblxuICAgIGRhdGEtcm9sZT1cImZpbGUtaW5wdXRcIlxuICAgIHR5cGU9XCJmaWxlXCJcbiAgICAjZmlsZUlucHV0XG4gICAgKGNoYW5nZSk9XCJvblZhbHVlQ2hhbmdlKGZpbGVJbnB1dClcIlxuICAgIFtkaXNhYmxlZF09XCJkaXNhYmxlZFwiXG4gICAgW3JlcXVpcmVkXT1cInJlcXVpcmVkXCJcbiAgLz5cbjwvYnV0dG9uPlxuIl19