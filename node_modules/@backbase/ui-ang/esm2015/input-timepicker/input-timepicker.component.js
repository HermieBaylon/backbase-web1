import { Component, forwardRef, HostBinding, Input, ViewChild, } from '@angular/core';
import { NG_VALIDATORS, NG_VALUE_ACCESSOR } from '@angular/forms';
import { NgbTimeAdapter } from '@ng-bootstrap/ng-bootstrap';
import { defaultSize, InputBaseComponent } from '@backbase/ui-ang/base-classes';
import { TimepickerStringAdapter } from './input-timepicker.service';
import * as i0 from "@angular/core";
import * as i1 from "@backbase/ui-ang/services";
import * as i2 from "@backbase/foundation-ang/future";
import * as i3 from "@ng-bootstrap/ng-bootstrap";
import * as i4 from "@angular/forms";
const SIZE_MEDIUM = defaultSize;
const SIZE_SMALL = SIZE_MEDIUM / 2;
const SIZE_LARGE = SIZE_MEDIUM * 2;
const KEYWORD_SMALL = 'small';
const KEYWORD_MEDIUM = 'medium';
const KEYWORD_LARGE = 'large';
/**
 * @name InputTimepickerComponent
 *
 * @a11y Current component provide option to pass needed accessibility
 * attributes. You need to take care of properties that are required in your case :
 *  - role
 *  - aria-activedescendant
 *  - aria-describedby
 *  - aria-expanded
 *  - aria-invalid
 *  - aria-label
 *  - aria-labelledby
 *  - aria-owns
 *
 * @description
 * Component that displays a timepicker.
 */
export class InputTimepickerComponent extends InputBaseComponent {
    /**
     * @deprecated since version 4
     */
    constructor(cd, domAttrService, elem, renderer2, deprecationsService) {
        super(cd, deprecationsService);
        this.cd = cd;
        this.domAttrService = domAttrService;
        this.elem = elem;
        this.renderer2 = renderer2;
        this.deprecationsService = deprecationsService;
        /**
         * The number of hours to add/subtract when clicking hour spinners.
         */
        this.hourStep = 1;
        /**
         * Whether to display 12H or 24H mode.
         */
        this.clock = '24h';
        /**
         * The number of minutes to add/subtract when clicking minute spinners.
         */
        this.minuteStep = 1;
        /**
         * If true, the timepicker is readonly and can't be changed.
         */
        this.readonly = false;
        /**
         * If true, it is possible to select seconds.
         */
        this.seconds = false;
        /**
         * The number of seconds to add/subtract when clicking second spinners.
         */
        this.secondStep = 1;
        this.cssClass = 'bb-input-timepicker';
    }
    get meridian() {
        return this.clock === '12h';
    }
    getKeywordBySize(size) {
        if (size <= SIZE_SMALL) {
            return KEYWORD_SMALL;
        }
        else if (size >= SIZE_LARGE) {
            return KEYWORD_LARGE;
        }
        else {
            return KEYWORD_MEDIUM;
        }
    }
    getSizeByKeyword(keyword) {
        const sizeKeywords = {
            [KEYWORD_SMALL]: SIZE_SMALL,
            [KEYWORD_MEDIUM]: SIZE_MEDIUM,
            [KEYWORD_LARGE]: SIZE_LARGE,
        };
        return typeof keyword === 'string' && sizeKeywords.hasOwnProperty(keyword) ? sizeKeywords[keyword] : undefined;
    }
    validate(control) {
        const value = control.value;
        if (!value) {
            /* eslint-disable-next-line  no-null/no-null */
            return null;
        }
        if (this.min && this.max) {
            const valid = this.min <= value && value <= this.max;
            return valid ? null : { minMaxTime: true };
        }
        else if (this.min) {
            return this.min <= value ? null : { minTime: true };
        }
        else if (this.max) {
            return value <= this.max ? null : { maxTime: true };
        }
        return null;
    }
    ngAfterViewInit() {
        if (!this.ariaLabel && this.inputEl) {
            this.domAttrService.moveAriaAttributes(this.elem.nativeElement, this.inputEl.nativeElement, this.renderer2);
        }
    }
}
InputTimepickerComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: InputTimepickerComponent, deps: [{ token: i0.ChangeDetectorRef }, { token: i1.DomAttributesService }, { token: i0.ElementRef }, { token: i0.Renderer2 }, { token: i2.DeprecationsService }], target: i0.ɵɵFactoryTarget.Component });
InputTimepickerComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.16", type: InputTimepickerComponent, selector: "bb-input-timepicker-ui", inputs: { hourStep: "hourStep", clock: "clock", minuteStep: "minuteStep", readonly: "readonly", seconds: "seconds", secondStep: "secondStep", min: "min", max: "max", autocomplete: "autocomplete" }, host: { properties: { "attr.class": "this.cssClass" } }, providers: [
        {
            provide: NG_VALUE_ACCESSOR,
            useExisting: forwardRef(() => InputTimepickerComponent),
            multi: true,
        },
        {
            provide: NG_VALIDATORS,
            useExisting: forwardRef(() => InputTimepickerComponent),
            multi: true,
        },
        { provide: NgbTimeAdapter, useClass: TimepickerStringAdapter },
    ], viewQueries: [{ propertyName: "inputEl", first: true, predicate: ["timepicker"], descendants: true }], usesInheritance: true, ngImport: i0, template: "<ngb-timepicker\n  #timepicker\n  id=\"{{ id }}\"\n  class=\"bb-input-timepicker\"\n  [attr.aria-labelledby]=\"ariaLabelledby\"\n  [attr.aria-describedby]=\"ariaDescribedby\"\n  [attr.aria-expanded]=\"ariaExpanded\"\n  [attr.role]=\"role\"\n  [attr.aria-invalid]=\"ariaInvalid\"\n  [attr.aria-owns]=\"ariaOwns\"\n  [readonlyInputs]=\"readonly\"\n  [disabled]=\"disabled\"\n  [spinners]=\"false\"\n  [hourStep]=\"hourStep\"\n  [meridian]=\"meridian\"\n  [minuteStep]=\"minuteStep\"\n  [seconds]=\"seconds\"\n  [secondStep]=\"secondStep\"\n  [size]=\"getKeywordBySize(size)\"\n  [attr.aria-label]=\"(!label && ariaLabel) || null\"\n  [ngModel]=\"value\"\n  (ngModelChange)=\"onValueChange($event)\"\n  data-role=\"timepicker\"\n  [attr.autcomplete]=\"autocomplete\"\n>\n</ngb-timepicker>\n", components: [{ type: i3.NgbTimepicker, selector: "ngb-timepicker", inputs: ["meridian", "spinners", "seconds", "hourStep", "minuteStep", "secondStep", "readonlyInputs", "size"] }], directives: [{ type: i4.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { type: i4.NgModel, selector: "[ngModel]:not([formControlName]):not([formControl])", inputs: ["name", "disabled", "ngModel", "ngModelOptions"], outputs: ["ngModelChange"], exportAs: ["ngModel"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: InputTimepickerComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'bb-input-timepicker-ui',
                    templateUrl: './input-timepicker.component.html',
                    providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef(() => InputTimepickerComponent),
                            multi: true,
                        },
                        {
                            provide: NG_VALIDATORS,
                            useExisting: forwardRef(() => InputTimepickerComponent),
                            multi: true,
                        },
                        { provide: NgbTimeAdapter, useClass: TimepickerStringAdapter },
                    ],
                }]
        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }, { type: i1.DomAttributesService }, { type: i0.ElementRef }, { type: i0.Renderer2 }, { type: i2.DeprecationsService }]; }, propDecorators: { hourStep: [{
                type: Input
            }], clock: [{
                type: Input
            }], minuteStep: [{
                type: Input
            }], readonly: [{
                type: Input
            }], seconds: [{
                type: Input
            }], secondStep: [{
                type: Input
            }], min: [{
                type: Input
            }], max: [{
                type: Input
            }], autocomplete: [{
                type: Input
            }], cssClass: [{
                type: HostBinding,
                args: ['attr.class']
            }], inputEl: [{
                type: ViewChild,
                args: ['timepicker']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXQtdGltZXBpY2tlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9saWJzL3VpLWFuZy9pbnB1dC10aW1lcGlja2VyL2lucHV0LXRpbWVwaWNrZXIuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vbGlicy91aS1hbmcvaW5wdXQtdGltZXBpY2tlci9pbnB1dC10aW1lcGlja2VyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFHTCxTQUFTLEVBRVQsVUFBVSxFQUNWLFdBQVcsRUFDWCxLQUFLLEVBRUwsU0FBUyxHQUNWLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBbUIsYUFBYSxFQUFFLGlCQUFpQixFQUErQixNQUFNLGdCQUFnQixDQUFDO0FBQ2hILE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUM1RCxPQUFPLEVBQUUsV0FBVyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFDaEYsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sNEJBQTRCLENBQUM7Ozs7OztBQUlyRSxNQUFNLFdBQVcsR0FBRyxXQUFXLENBQUM7QUFDaEMsTUFBTSxVQUFVLEdBQUcsV0FBVyxHQUFHLENBQUMsQ0FBQztBQUNuQyxNQUFNLFVBQVUsR0FBRyxXQUFXLEdBQUcsQ0FBQyxDQUFDO0FBRW5DLE1BQU0sYUFBYSxHQUFHLE9BQU8sQ0FBQztBQUM5QixNQUFNLGNBQWMsR0FBRyxRQUFRLENBQUM7QUFDaEMsTUFBTSxhQUFhLEdBQUcsT0FBTyxDQUFDO0FBRTlCOzs7Ozs7Ozs7Ozs7Ozs7O0dBZ0JHO0FBa0JILE1BQU0sT0FBTyx3QkFBeUIsU0FBUSxrQkFBa0I7SUErRjlEOztPQUVHO0lBQ0gsWUFDcUIsRUFBcUIsRUFDdkIsY0FBb0MsRUFDcEMsSUFBZ0IsRUFDaEIsU0FBb0IsRUFDbEIsbUJBQXdDO1FBRTNELEtBQUss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QkFBcEIsS0FBSztnQkFFcUIsUUFBUTtzQkFBbEMsV0FBVzt1QkFBQyxZQUFZO2dCQUVBLE9BQU87c0JBQS9CLFNBQVM7dUJBQUMsWUFBWSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEFmdGVyVmlld0luaXQsXG4gIENoYW5nZURldGVjdG9yUmVmLFxuICBDb21wb25lbnQsXG4gIEVsZW1lbnRSZWYsXG4gIGZvcndhcmRSZWYsXG4gIEhvc3RCaW5kaW5nLFxuICBJbnB1dCxcbiAgUmVuZGVyZXIyLFxuICBWaWV3Q2hpbGQsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQWJzdHJhY3RDb250cm9sLCBOR19WQUxJREFUT1JTLCBOR19WQUxVRV9BQ0NFU1NPUiwgVmFsaWRhdGlvbkVycm9ycywgVmFsaWRhdG9yIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgTmdiVGltZUFkYXB0ZXIgfSBmcm9tICdAbmctYm9vdHN0cmFwL25nLWJvb3RzdHJhcCc7XG5pbXBvcnQgeyBkZWZhdWx0U2l6ZSwgSW5wdXRCYXNlQ29tcG9uZW50IH0gZnJvbSAnQGJhY2tiYXNlL3VpLWFuZy9iYXNlLWNsYXNzZXMnO1xuaW1wb3J0IHsgVGltZXBpY2tlclN0cmluZ0FkYXB0ZXIgfSBmcm9tICcuL2lucHV0LXRpbWVwaWNrZXIuc2VydmljZSc7XG5pbXBvcnQgeyBEb21BdHRyaWJ1dGVzU2VydmljZSB9IGZyb20gJ0BiYWNrYmFzZS91aS1hbmcvc2VydmljZXMnO1xuaW1wb3J0IHsgRGVwcmVjYXRpb25zU2VydmljZSB9IGZyb20gJ0BiYWNrYmFzZS9mb3VuZGF0aW9uLWFuZy9mdXR1cmUnO1xuXG5jb25zdCBTSVpFX01FRElVTSA9IGRlZmF1bHRTaXplO1xuY29uc3QgU0laRV9TTUFMTCA9IFNJWkVfTUVESVVNIC8gMjtcbmNvbnN0IFNJWkVfTEFSR0UgPSBTSVpFX01FRElVTSAqIDI7XG5cbmNvbnN0IEtFWVdPUkRfU01BTEwgPSAnc21hbGwnO1xuY29uc3QgS0VZV09SRF9NRURJVU0gPSAnbWVkaXVtJztcbmNvbnN0IEtFWVdPUkRfTEFSR0UgPSAnbGFyZ2UnO1xuXG4vKipcbiAqIEBuYW1lIElucHV0VGltZXBpY2tlckNvbXBvbmVudFxuICpcbiAqIEBhMTF5IEN1cnJlbnQgY29tcG9uZW50IHByb3ZpZGUgb3B0aW9uIHRvIHBhc3MgbmVlZGVkIGFjY2Vzc2liaWxpdHlcbiAqIGF0dHJpYnV0ZXMuIFlvdSBuZWVkIHRvIHRha2UgY2FyZSBvZiBwcm9wZXJ0aWVzIHRoYXQgYXJlIHJlcXVpcmVkIGluIHlvdXIgY2FzZSA6XG4gKiAgLSByb2xlXG4gKiAgLSBhcmlhLWFjdGl2ZWRlc2NlbmRhbnRcbiAqICAtIGFyaWEtZGVzY3JpYmVkYnlcbiAqICAtIGFyaWEtZXhwYW5kZWRcbiAqICAtIGFyaWEtaW52YWxpZFxuICogIC0gYXJpYS1sYWJlbFxuICogIC0gYXJpYS1sYWJlbGxlZGJ5XG4gKiAgLSBhcmlhLW93bnNcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIENvbXBvbmVudCB0aGF0IGRpc3BsYXlzIGEgdGltZXBpY2tlci5cbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYmItaW5wdXQtdGltZXBpY2tlci11aScsXG4gIHRlbXBsYXRlVXJsOiAnLi9pbnB1dC10aW1lcGlja2VyLmNvbXBvbmVudC5odG1sJyxcbiAgcHJvdmlkZXJzOiBbXG4gICAge1xuICAgICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXG4gICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBJbnB1dFRpbWVwaWNrZXJDb21wb25lbnQpLFxuICAgICAgbXVsdGk6IHRydWUsXG4gICAgfSxcbiAgICB7XG4gICAgICBwcm92aWRlOiBOR19WQUxJREFUT1JTLFxuICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gSW5wdXRUaW1lcGlja2VyQ29tcG9uZW50KSxcbiAgICAgIG11bHRpOiB0cnVlLFxuICAgIH0sXG4gICAgeyBwcm92aWRlOiBOZ2JUaW1lQWRhcHRlciwgdXNlQ2xhc3M6IFRpbWVwaWNrZXJTdHJpbmdBZGFwdGVyIH0sXG4gIF0sXG59KVxuZXhwb3J0IGNsYXNzIElucHV0VGltZXBpY2tlckNvbXBvbmVudCBleHRlbmRzIElucHV0QmFzZUNvbXBvbmVudCBpbXBsZW1lbnRzIFZhbGlkYXRvciwgQWZ0ZXJWaWV3SW5pdCB7XG4gIC8qKlxuICAgKiBUaGUgbnVtYmVyIG9mIGhvdXJzIHRvIGFkZC9zdWJ0cmFjdCB3aGVuIGNsaWNraW5nIGhvdXIgc3Bpbm5lcnMuXG4gICAqL1xuICBASW5wdXQoKSBob3VyU3RlcCA9IDE7XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gZGlzcGxheSAxMkggb3IgMjRIIG1vZGUuXG4gICAqL1xuICBASW5wdXQoKSBjbG9jazogJzEyaCcgfCAnMjRoJyA9ICcyNGgnO1xuXG4gIC8qKlxuICAgKiBUaGUgbnVtYmVyIG9mIG1pbnV0ZXMgdG8gYWRkL3N1YnRyYWN0IHdoZW4gY2xpY2tpbmcgbWludXRlIHNwaW5uZXJzLlxuICAgKi9cbiAgQElucHV0KCkgbWludXRlU3RlcCA9IDE7XG5cbiAgLyoqXG4gICAqIElmIHRydWUsIHRoZSB0aW1lcGlja2VyIGlzIHJlYWRvbmx5IGFuZCBjYW4ndCBiZSBjaGFuZ2VkLlxuICAgKi9cbiAgQElucHV0KCkgcmVhZG9ubHkgPSBmYWxzZTtcblxuICAvKipcbiAgICogSWYgdHJ1ZSwgaXQgaXMgcG9zc2libGUgdG8gc2VsZWN0IHNlY29uZHMuXG4gICAqL1xuICBASW5wdXQoKSBzZWNvbmRzID0gZmFsc2U7XG5cbiAgLyoqXG4gICAqIFRoZSBudW1iZXIgb2Ygc2Vjb25kcyB0byBhZGQvc3VidHJhY3Qgd2hlbiBjbGlja2luZyBzZWNvbmQgc3Bpbm5lcnMuXG4gICAqL1xuICBASW5wdXQoKSBzZWNvbmRTdGVwID0gMTtcblxuICAvKipcbiAgICogSWYgc2V0LCB2YWxpZGF0ZSBhY2NvcmRpbmcgdG8gbWluIHRpbWVcbiAgICovXG4gIEBJbnB1dCgpIG1pbjogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBJZiBzZXQgLCB2YWxpZGF0ZSBhY2NvcmRpbmcgdG8gbWF4IHRpbWVcbiAgICovXG4gIEBJbnB1dCgpIG1heDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gIC8qKlxuICAgKiBUaGUgYXV0b2NvbXBsZXRlIHZhbHVlIG9mIGVuY2xvc2VkIGlucHV0IGNvbnRyb2wuXG4gICAqL1xuICBASW5wdXQoKSBhdXRvY29tcGxldGU6ICdzdHJpbmcnIHwgdW5kZWZpbmVkO1xuXG4gIEBIb3N0QmluZGluZygnYXR0ci5jbGFzcycpIGNzc0NsYXNzID0gJ2JiLWlucHV0LXRpbWVwaWNrZXInO1xuXG4gIEBWaWV3Q2hpbGQoJ3RpbWVwaWNrZXInKSBpbnB1dEVsOiBFbGVtZW50UmVmIHwgdW5kZWZpbmVkO1xuXG4gIGdldCBtZXJpZGlhbigpIHtcbiAgICByZXR1cm4gdGhpcy5jbG9jayA9PT0gJzEyaCc7XG4gIH1cblxuICBnZXRLZXl3b3JkQnlTaXplKHNpemU6IG51bWJlciB8IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKHNpemUgPD0gU0laRV9TTUFMTCkge1xuICAgICAgcmV0dXJuIEtFWVdPUkRfU01BTEw7XG4gICAgfSBlbHNlIGlmIChzaXplID49IFNJWkVfTEFSR0UpIHtcbiAgICAgIHJldHVybiBLRVlXT1JEX0xBUkdFO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gS0VZV09SRF9NRURJVU07XG4gICAgfVxuICB9XG5cbiAgZ2V0U2l6ZUJ5S2V5d29yZChrZXl3b3JkOiBhbnkpOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IHNpemVLZXl3b3JkczogeyBbaW5kZXg6IHN0cmluZ106IG51bWJlciB9ID0ge1xuICAgICAgW0tFWVdPUkRfU01BTExdOiBTSVpFX1NNQUxMLFxuICAgICAgW0tFWVdPUkRfTUVESVVNXTogU0laRV9NRURJVU0sXG4gICAgICBbS0VZV09SRF9MQVJHRV06IFNJWkVfTEFSR0UsXG4gICAgfTtcblxuICAgIHJldHVybiB0eXBlb2Yga2V5d29yZCA9PT0gJ3N0cmluZycgJiYgc2l6ZUtleXdvcmRzLmhhc093blByb3BlcnR5KGtleXdvcmQpID8gc2l6ZUtleXdvcmRzW2tleXdvcmRdIDogdW5kZWZpbmVkO1xuICB9XG5cbiAgdmFsaWRhdGUoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogVmFsaWRhdGlvbkVycm9ycyB8IG51bGwge1xuICAgIGNvbnN0IHZhbHVlID0gY29udHJvbC52YWx1ZTtcblxuICAgIGlmICghdmFsdWUpIHtcbiAgICAgIC8qIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSAgbm8tbnVsbC9uby1udWxsICovXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5taW4gJiYgdGhpcy5tYXgpIHtcbiAgICAgIGNvbnN0IHZhbGlkID0gdGhpcy5taW4gPD0gdmFsdWUgJiYgdmFsdWUgPD0gdGhpcy5tYXg7XG5cbiAgICAgIHJldHVybiB2YWxpZCA/IG51bGwgOiB7IG1pbk1heFRpbWU6IHRydWUgfTtcbiAgICB9IGVsc2UgaWYgKHRoaXMubWluKSB7XG4gICAgICByZXR1cm4gdGhpcy5taW4gPD0gdmFsdWUgPyBudWxsIDogeyBtaW5UaW1lOiB0cnVlIH07XG4gICAgfSBlbHNlIGlmICh0aGlzLm1heCkge1xuICAgICAgcmV0dXJuIHZhbHVlIDw9IHRoaXMubWF4ID8gbnVsbCA6IHsgbWF4VGltZTogdHJ1ZSB9O1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIEBkZXByZWNhdGVkIHNpbmNlIHZlcnNpb24gNFxuICAgKi9cbiAgY29uc3RydWN0b3IoXG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IGNkOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICBwcml2YXRlIHJlYWRvbmx5IGRvbUF0dHJTZXJ2aWNlOiBEb21BdHRyaWJ1dGVzU2VydmljZSxcbiAgICBwcml2YXRlIHJlYWRvbmx5IGVsZW06IEVsZW1lbnRSZWYsXG4gICAgcHJpdmF0ZSByZWFkb25seSByZW5kZXJlcjI6IFJlbmRlcmVyMixcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgZGVwcmVjYXRpb25zU2VydmljZTogRGVwcmVjYXRpb25zU2VydmljZSxcbiAgKSB7XG4gICAgc3VwZXIoY2QsIGRlcHJlY2F0aW9uc1NlcnZpY2UpO1xuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5hcmlhTGFiZWwgJiYgdGhpcy5pbnB1dEVsKSB7XG4gICAgICB0aGlzLmRvbUF0dHJTZXJ2aWNlLm1vdmVBcmlhQXR0cmlidXRlcyh0aGlzLmVsZW0ubmF0aXZlRWxlbWVudCwgdGhpcy5pbnB1dEVsLm5hdGl2ZUVsZW1lbnQsIHRoaXMucmVuZGVyZXIyKTtcbiAgICB9XG4gIH1cbn1cbiIsIjxuZ2ItdGltZXBpY2tlclxuICAjdGltZXBpY2tlclxuICBpZD1cInt7IGlkIH19XCJcbiAgY2xhc3M9XCJiYi1pbnB1dC10aW1lcGlja2VyXCJcbiAgW2F0dHIuYXJpYS1sYWJlbGxlZGJ5XT1cImFyaWFMYWJlbGxlZGJ5XCJcbiAgW2F0dHIuYXJpYS1kZXNjcmliZWRieV09XCJhcmlhRGVzY3JpYmVkYnlcIlxuICBbYXR0ci5hcmlhLWV4cGFuZGVkXT1cImFyaWFFeHBhbmRlZFwiXG4gIFthdHRyLnJvbGVdPVwicm9sZVwiXG4gIFthdHRyLmFyaWEtaW52YWxpZF09XCJhcmlhSW52YWxpZFwiXG4gIFthdHRyLmFyaWEtb3duc109XCJhcmlhT3duc1wiXG4gIFtyZWFkb25seUlucHV0c109XCJyZWFkb25seVwiXG4gIFtkaXNhYmxlZF09XCJkaXNhYmxlZFwiXG4gIFtzcGlubmVyc109XCJmYWxzZVwiXG4gIFtob3VyU3RlcF09XCJob3VyU3RlcFwiXG4gIFttZXJpZGlhbl09XCJtZXJpZGlhblwiXG4gIFttaW51dGVTdGVwXT1cIm1pbnV0ZVN0ZXBcIlxuICBbc2Vjb25kc109XCJzZWNvbmRzXCJcbiAgW3NlY29uZFN0ZXBdPVwic2Vjb25kU3RlcFwiXG4gIFtzaXplXT1cImdldEtleXdvcmRCeVNpemUoc2l6ZSlcIlxuICBbYXR0ci5hcmlhLWxhYmVsXT1cIighbGFiZWwgJiYgYXJpYUxhYmVsKSB8fCBudWxsXCJcbiAgW25nTW9kZWxdPVwidmFsdWVcIlxuICAobmdNb2RlbENoYW5nZSk9XCJvblZhbHVlQ2hhbmdlKCRldmVudClcIlxuICBkYXRhLXJvbGU9XCJ0aW1lcGlja2VyXCJcbiAgW2F0dHIuYXV0Y29tcGxldGVdPVwiYXV0b2NvbXBsZXRlXCJcbj5cbjwvbmdiLXRpbWVwaWNrZXI+XG4iXX0=