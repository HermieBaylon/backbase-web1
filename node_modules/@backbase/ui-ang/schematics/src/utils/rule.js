"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.tryRule = void 0;
const schematics_1 = require("@angular-devkit/schematics");
const rxjs_1 = require("rxjs");
const operators_1 = require("rxjs/operators");
const tryRule = (rule, manualProcess) => (...args) => {
    const wrapErr = (error) => new schematics_1.SchematicsException('An error occurred while automatically updating. You will need to migrate manually.' +
        `${manualProcess}\r\n${error}`);
    try {
        const result = rule(...args);
        if (result instanceof rxjs_1.Observable) {
            // The `Observable` object expected by `@angular-devkit`
            // is from a different package version to the one installed in the project
            return result.pipe(operators_1.catchError((err) => {
                throw wrapErr(err);
            }));
        }
        return result;
    }
    catch (err) {
        throw wrapErr(err);
    }
};
exports.tryRule = tryRule;
//# sourceMappingURL=rule.js.map