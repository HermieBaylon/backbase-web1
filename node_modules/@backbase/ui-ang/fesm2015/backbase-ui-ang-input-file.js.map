{"version":3,"file":"backbase-ui-ang-input-file.js","sources":["../../../../libs/ui-ang/input-file/input-file.component.ts","../../../../libs/ui-ang/input-file/input-file.component.html","../../../../libs/ui-ang/input-file/input-file.module.ts","../../../../libs/ui-ang/input-file/backbase-ui-ang-input-file.ts"],"sourcesContent":["import { ChangeDetectionStrategy, ChangeDetectorRef, Component, forwardRef, Input, OnInit } from '@angular/core';\nimport { NG_VALIDATORS, NG_VALUE_ACCESSOR, ValidationErrors, Validator } from '@angular/forms';\nimport { InputBaseComponent } from '@backbase/ui-ang/base-classes';\nimport { ButtonColor } from '@backbase/ui-ang/button';\nimport { DeprecationsService } from '@backbase/foundation-ang/future';\n\n/**\n * @name InputFileComponent\n *\n * @description\n * Component that displays a file input button.\n *\n * @a11y Current component provide option to pass needed accessibility\n * attributes. You need to take care of properties that are required in your case :\n *  - role\n *  - aria-activedescendant\n *  - aria-describedby\n *  - aria-expanded\n *  - aria-label\n *  - aria-labelledby\n *  - aria-owns\n *\n */\n\n@Component({\n  selector: 'bb-input-file-ui',\n  templateUrl: './input-file.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => InputFileComponent),\n      multi: true,\n    },\n    {\n      provide: NG_VALIDATORS,\n      useExisting: forwardRef(() => InputFileComponent),\n      multi: true,\n    },\n  ],\n})\nexport class InputFileComponent extends InputBaseComponent implements OnInit, Validator {\n  /**\n   * Accepted file formats. Defaults to any ('*');\n   */\n  @Input() accept = '*';\n\n  /**\n   * If set, validate according to the maximum file size in Megabytes.\n   */\n  @Input() maxSizeInMb: number | string | undefined;\n\n  /**\n   * Multiple/single file upload flag. Defaults to false;\n   */\n  @Input() multiple = false;\n\n  /**\n   * Button color. Defaults to 'link';\n   */\n  @Input() color: ButtonColor | string = 'link';\n\n  /**\n   * This Boolean attribute lets you specify that the button should have input focus when the page\n   * loads, unless the user overrides it, for example by typing in a different control. Only one\n   * form-associated element in a document can have this attribute specified. Defaults to false.\n   */\n  @Input() autofocus = false;\n\n  /**\n   * Button text. If set, change button text from default 'Attach file' to a custom one.\n   */\n  @Input() buttonText: string | undefined;\n\n  /**\n   * Size of the button. Defaults to 'md'.\n   */\n  @Input() buttonSize: 'sm' | 'md' = 'md';\n\n  /**\n   * Button icon name. Defaults to 'attachment';\n   */\n  @Input() iconName = 'attachment';\n\n  constructor(protected readonly cd: ChangeDetectorRef, protected readonly deprecationsService: DeprecationsService) {\n    super(cd, deprecationsService);\n  }\n\n  ngOnInit() {\n    super.ngOnInit();\n\n    if (this.maxSizeInMb && Math.sign(Number(this.maxSizeInMb)) !== 1) {\n      this.maxSizeInMb = undefined;\n      console.warn('[bb-input-file-ui]: invalid maximum file size, falling back to infinite');\n    }\n  }\n\n  onValueChange(input: HTMLInputElement) {\n    const files = input.files?.length && [...(input.files as any as File[])];\n\n    if (Array.isArray(files)) {\n      this.value = { files };\n      this.onChange(this.value);\n    }\n  }\n\n  validate(): ValidationErrors | null {\n    let isMaxSizeExceeded = false;\n    const value = this.value && (this.value as { files: File[] }).files;\n\n    if (Array.isArray(value) && this.maxSizeInMb) {\n      const maxSizeInBytes = Number(this.maxSizeInMb) * 1024 * 1024;\n      isMaxSizeExceeded = value.some((file: File) => file.size > maxSizeInBytes);\n    }\n\n    return isMaxSizeExceeded ? { maxFileSizeExceeded: true } : null;\n  }\n}\n","<button\n  bbButton\n  data-role=\"file-input-button\"\n  class=\"bb-block bb-block--xs\"\n  [autofocus]=\"autofocus\"\n  [color]=\"color\"\n  [buttonSize]=\"buttonSize\"\n  (focus)=\"onFocus($event)\"\n  (click)=\"fileInput.click()\"\n  [disabled]=\"disabled\"\n  [attr.aria-describedby]=\"ariaDescribedby\"\n  [attr.aria-labelledby]=\"ariaLabelledby\"\n  [attr.role]=\"role\"\n  [attr.aria-owns]=\"ariaOwns\"\n  [attr.aria-activedescendant]=\"ariaActivedescendant\"\n  [attr.aria-label]=\"(!label && ariaLabel) || null\"\n>\n  <bb-icon-ui cropped=\"true\" [name]=\"iconName\"></bb-icon-ui>\n  <span *ngIf=\"buttonText; else attachFile\">{{ buttonText }}</span>\n  <ng-template #attachFile i18n=\"Attach file@@fileInputButton.text\">Attach file</ng-template>\n  <input\n    [accept]=\"accept\"\n    [multiple]=\"multiple\"\n    hidden\n    data-role=\"file-input\"\n    type=\"file\"\n    #fileInput\n    (change)=\"onValueChange(fileInput)\"\n    [disabled]=\"disabled\"\n    [required]=\"required\"\n  />\n</button>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { InputFileComponent } from './input-file.component';\nimport { ButtonModule } from '@backbase/ui-ang/button';\nimport { IconModule } from '@backbase/ui-ang/icon';\n\nconst uiModules = [ButtonModule, IconModule];\n\n@NgModule({\n  imports: [CommonModule, ...uiModules],\n  declarations: [InputFileComponent],\n  exports: [InputFileComponent],\n})\nexport class InputFileModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}