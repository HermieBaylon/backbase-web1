{"version":3,"file":"backbase-ui-ang-select-list.js","sources":["../../../../libs/ui-ang/select-list/select-list.component.ts","../../../../libs/ui-ang/select-list/select-list.component.html","../../../../libs/ui-ang/select-list/select-list.module.ts","../../../../libs/ui-ang/select-list/backbase-ui-ang-select-list.ts"],"sourcesContent":["import { Component, EventEmitter, forwardRef, Input, OnChanges, Output, SimpleChanges, ViewChild } from '@angular/core';\nimport { NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { NgSelectComponent } from '@ng-select/ng-select';\nimport { Observable, Subject } from 'rxjs';\nimport { filter, distinctUntilChanged, debounceTime, map } from 'rxjs/operators';\nimport { InputBaseComponent } from '@backbase/ui-ang/base-classes';\n\nexport interface SelectListItemBase {\n  name: string;\n}\n\nexport interface SearchPayload {\n  term: string;\n  items: Array<any>;\n}\n\n@Component({\n  selector: 'bb-select-list-ui',\n  templateUrl: './select-list.component.html',\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      multi: true,\n      useExisting: forwardRef(() => SelectListComponent),\n    },\n  ],\n})\n// TODO: set a generic that extends to SelectListItemBase once Ivy check types step supports correctly types\nexport class SelectListComponent<T extends { name: string }> extends InputBaseComponent implements OnChanges {\n  @ViewChild('select') ngSelect: NgSelectComponent | undefined;\n\n  /**\n   * Flag to determine if the data in the list is loading\n   */\n  @Input() loading = false;\n\n  /**\n   * Placeholder text to display in the input\n   * */\n  @Input() placeholder = '';\n\n  /**\n   * Minimum number of characters required before searching for items\n   * */\n  @Input() minTermLength = 2;\n\n  /**\n   * Maximum number of selected items, 'none' means unlimited\n   */\n  @Input() maxSelectedItems = 'none';\n\n  /**\n   * Flag to determine if the list allows multiple selection.\n   * */\n  @Input() multiple = false;\n\n  /**\n   * A list of items to select from based on the input text.\n   * */\n  @Input() items: T[] = [];\n\n  /**\n   * Flag to determine if typeahead should be used to filter the items list.\n   * If enabled the items list can not be updated asynchonously as the filtering\n   * and the underlying data will get out of sync.\n   */\n  @Input() filterEnabled = true;\n\n  /**\n   * Output to capture value change event.\n   */\n  @Output() valueChange = this._valueChange;\n\n  /**\n   * Emitter when search is performed. Outputs search term\n   */\n  @Output() search: EventEmitter<string> = new EventEmitter<string>();\n\n  /**\n   * Emitter when clear is performed.\n   */\n  @Output() clear = new EventEmitter<void>();\n\n  /**\n   * Delay in ms between autocomplete updates.\n   * */\n  private readonly DEBOUNCE_TIME_MS = 500;\n\n  /**\n   * Observable of the typeahead input\n   */\n  readonly typeaheadInput$ = new Subject<string>();\n  /**\n   * Observable of the filtered items\n   */\n  readonly filteredItems$: Observable<T[]> = this.typeaheadInput$.pipe(\n    filter((term) => term !== null && term.length >= this.minTermLength),\n    distinctUntilChanged(),\n    debounceTime(this.DEBOUNCE_TIME_MS),\n    map((term) => this.items.filter(({ name }: any) => name.toLowerCase().includes(term.toLowerCase()))),\n  );\n\n  writeValue(inputValue: Object | string | null): void {\n    if (inputValue !== null) {\n      super.writeValue(inputValue);\n    } else {\n      this.value = inputValue;\n      this.cd.markForCheck();\n    }\n  }\n\n  onSearch(event: string | SearchPayload) {\n    const searchTerm = typeof event === 'string' ? event : event.term;\n\n    if (searchTerm.length >= this.minTermLength) {\n      this.search.emit(searchTerm);\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes?.items?.currentValue?.length > 0 && this.ngSelect?.isOpen === false && this.ngSelect?.searchTerm) {\n      this.ngSelect.isOpen = true;\n    }\n  }\n}\n","<label *ngIf=\"label\" [attr.for]=\"id\" [attr.data-role]=\"'select-list-ui-label'\">{{ label }}</label>\n<ng-container *ngIf=\"filterEnabled; else filterDisabled\">\n  <ng-select\n    class=\"bb-select-list\"\n    bindLabel=\"name\"\n    [items]=\"filteredItems$ | async\"\n    [hideSelected]=\"true\"\n    [maxSelectedItems]=\"maxSelectedItems\"\n    [multiple]=\"multiple\"\n    [minTermLength]=\"minTermLength\"\n    [typeahead]=\"typeaheadInput$\"\n    [virtualScroll]=\"true\"\n    [placeholder]=\"placeholder\"\n    [attr.data-role]=\"id\"\n    [ngModel]=\"value\"\n    [loading]=\"loading\"\n    (ngModelChange)=\"onValueChange($event)\"\n    (search)=\"onSearch($event)\"\n    [labelForId]=\"id\"\n    [attr.aria-label]=\"ariaLabel\"\n    [attr.aria-labelledby]=\"ariaLabelledby\"\n    (blur)=\"onBlur($event)\"\n    (focus)=\"onFocus($event)\"\n    (clear)=\"clear.emit()\"\n  >\n  </ng-select>\n</ng-container>\n\n<ng-template #filterDisabled>\n  <ng-select\n    #select\n    class=\"bb-select-list\"\n    bindLabel=\"name\"\n    [items]=\"items\"\n    [hideSelected]=\"true\"\n    [maxSelectedItems]=\"maxSelectedItems\"\n    [multiple]=\"multiple\"\n    [minTermLength]=\"minTermLength\"\n    [virtualScroll]=\"true\"\n    [placeholder]=\"placeholder\"\n    [attr.data-role]=\"id\"\n    [ngModel]=\"value\"\n    [loading]=\"loading\"\n    (ngModelChange)=\"onValueChange($event)\"\n    (search)=\"onSearch($event)\"\n    [labelForId]=\"id\"\n    [attr.aria-label]=\"ariaLabel\"\n    [attr.aria-labelledby]=\"ariaLabelledby\"\n    (blur)=\"onBlur($event)\"\n    (focus)=\"onFocus($event)\"\n    (clear)=\"clear.emit()\"\n  >\n  </ng-select>\n</ng-template>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { NgSelectModule } from '@ng-select/ng-select';\nimport { SelectListComponent } from './select-list.component';\nimport { BaseClassesModule } from '@backbase/ui-ang/base-classes';\n\n@NgModule({\n  imports: [CommonModule, NgSelectModule, FormsModule, ReactiveFormsModule, BaseClassesModule],\n  declarations: [SelectListComponent],\n  exports: [SelectListComponent],\n})\nexport class SelectListModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}