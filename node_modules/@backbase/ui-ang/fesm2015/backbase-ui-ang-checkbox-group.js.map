{"version":3,"file":"backbase-ui-ang-checkbox-group.js","sources":["../../../../libs/ui-ang/checkbox-group/checkbox-group.component.ts","../../../../libs/ui-ang/checkbox-group/checkbox-group.component.html","../../../../libs/ui-ang/checkbox-group/checkbox-group.module.ts","../../../../libs/ui-ang/checkbox-group/backbase-ui-ang-checkbox-group.ts"],"sourcesContent":["import {\n  Component,\n  ChangeDetectionStrategy,\n  forwardRef,\n  ChangeDetectorRef,\n  AfterContentChecked,\n  OnDestroy,\n} from '@angular/core';\nimport { ControlContainer, FormGroup, NG_VALUE_ACCESSOR } from '@angular/forms';\nimport { filter, takeUntil } from 'rxjs/operators';\nimport { InputBaseComponent } from '@backbase/ui-ang/base-classes';\nimport { BehaviorSubject, combineLatest, Subject } from 'rxjs';\nimport { DeprecationsService } from '@backbase/foundation-ang/future';\n\n/**\n * @name CheckboxGroupComponent\n *\n * @description\n * Stores a state, determines it and displays a parent checkbox for a checkboxes group.\n * Required module(s): FormsModule\n */\n@Component({\n  selector: 'bb-checkbox-group-ui',\n  templateUrl: './checkbox-group.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => CheckboxGroupComponent),\n      multi: true,\n    },\n  ],\n})\nexport class CheckboxGroupComponent extends InputBaseComponent implements AfterContentChecked, OnDestroy {\n  indeterminate = false;\n  private control?: FormGroup;\n  private readonly skip$ = new BehaviorSubject<boolean>(false);\n  private readonly unsubscribe$ = new Subject<void>();\n\n  constructor(\n    protected readonly cd: ChangeDetectorRef,\n    protected readonly deprecationsService: DeprecationsService,\n    private readonly controlContainer: ControlContainer,\n  ) {\n    super(cd, deprecationsService);\n  }\n\n  ngAfterContentChecked() {\n    if (this.controlContainer.control && this.control !== this.controlContainer.control) {\n      this.control = this.controlContainer.control as FormGroup;\n      this.checkState(this.control.value);\n      combineLatest(this.control.valueChanges, this.skip$)\n        .pipe(\n          filter(([state, skip]) => !skip),\n          takeUntil(this.unsubscribe$),\n        )\n        .subscribe(([state]) => this.checkState(state));\n    }\n  }\n\n  ngOnDestroy() {\n    this.unsubscribe$.next();\n    this.unsubscribe$.complete();\n  }\n\n  onValueChange() {\n    const setValue = (control: FormGroup) => {\n      Object.keys(control.value).forEach((key) =>\n        control.controls[key] instanceof FormGroup\n          ? setValue(control.controls[key] as FormGroup)\n          : control.controls[key].setValue(this.value),\n      );\n    };\n\n    if (this.control) {\n      this.skip$.next(true);\n      setValue(this.control);\n      this.skip$.next(false);\n    }\n    super.onValueChange();\n  }\n\n  isDisabled(): boolean {\n    return (\n      !!this.control &&\n      Object.keys(this.control.controls).every(\n        (key) =>\n          (this.control &&\n            this.control.controls &&\n            this.control.controls[key] &&\n            this.control.controls[key].disabled) ||\n          false,\n      )\n    );\n  }\n\n  private checkState(state: { [s: string]: boolean | undefined }) {\n    /**\n     * @param arrayHandler - a function to iterate over a tree\n     * @description iterates over a tree using an arrayHandler function\n     * @return a function which recursively calls arrayHandler over a tree\n     */\n    const checkGroup = (arrayHandler: Function) => {\n      /**\n       * @param value - primitive or tree data structure\n       * @return\n       * if input value is a primitive - returns value, casted to boolean,\n       * if input value is a tree - returns result of recursively calling arrayHandler function over a tree\n       */\n      const checkValue = (value?: { [s: string]: boolean | undefined } | boolean): boolean =>\n        typeof value === 'object' && value !== null\n          ? arrayHandler.call(\n              Object.keys(value).map((key) => value[key]),\n              checkValue,\n            )\n          : !!value;\n\n      return (value: { [s: string]: boolean | undefined }) =>\n        arrayHandler.call(\n          Object.keys(value).map((key) => value[key]),\n          checkValue,\n        );\n    };\n\n    const isAllChecked = checkGroup(Array.prototype.every)(state);\n    const isSomeChecked = checkGroup(Array.prototype.some)(state);\n    this.indeterminate = isSomeChecked && !isAllChecked;\n    this.writeValue(isAllChecked);\n  }\n}\n","<bb-input-checkbox-ui\n  [label]=\"label\"\n  [aria-label]=\"(!label && ariaLabel) || null\"\n  [(indeterminate)]=\"indeterminate\"\n  [(ngModel)]=\"value\"\n  [disabled]=\"isDisabled()\"\n  (change)=\"onValueChange()\"\n>\n  <ng-content *ngIf=\"!label\"></ng-content>\n</bb-input-checkbox-ui>\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { InputCheckboxModule } from '@backbase/ui-ang/input-checkbox';\nimport { FormsModule } from '@angular/forms';\nimport { BaseClassesModule } from '@backbase/ui-ang/base-classes';\n\nimport { CheckboxGroupComponent } from './checkbox-group.component';\n\n@NgModule({\n  imports: [CommonModule, InputCheckboxModule, FormsModule, BaseClassesModule],\n  declarations: [CheckboxGroupComponent],\n  exports: [CheckboxGroupComponent],\n})\nexport class CheckboxGroupModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}