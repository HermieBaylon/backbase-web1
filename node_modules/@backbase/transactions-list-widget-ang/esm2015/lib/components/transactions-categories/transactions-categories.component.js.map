{"version":3,"file":"transactions-categories.component.js","sourceRoot":"","sources":["../../../../../../../../../libs/widgets/transactions/transactions-list-widget/src/lib/components/transactions-categories/transactions-categories.component.ts","../../../../../../../../../libs/widgets/transactions/transactions-list-widget/src/lib/components/transactions-categories/transactions-categories.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,WAAW,EAAE,MAAM,gBAAgB,CAAC;AAE7C,OAAO,EAAE,SAAS,EAAE,SAAS,EAAE,MAAM,EAAE,YAAY,EAAE,KAAK,EAAU,MAAM,eAAe,CAAC;AAC1F,OAAO,EACL,iBAAiB,EAEjB,wBAAwB,GAEzB,MAAM,mCAAmC,CAAC;AAC3C,OAAO,EAAE,UAAU,EAAE,MAAM,+BAA+B,CAAC;;;;;;;;AAM3D,MAAM,OAAO,+BAA+B;IAW1C,YACmB,EAAe,EACf,iBAAoC,EACpC,wBAAkD;QAFlD,OAAE,GAAF,EAAE,CAAa;QACf,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,6BAAwB,GAAxB,wBAAwB,CAA0B;QAZlD,mBAAc,GAAG,IAAI,YAAY,EAAU,CAAC;QAEtD,mCAA8B,GAAG,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC;YACtD,YAAY,EAAE,EAAE;SACjB,CAAC,CAAC;QAEM,YAAO,GAAG,IAAI,CAAC;QACf,mBAAc,GAA+B,IAAI,CAAC,iBAAiB,CAAC,aAAa,EAAE,CAAC;IAM1F,CAAC;IAEJ,kBAAkB;QAChB,IAAI,CAAC,8BAA8B,CAAC,KAAK,CAAC;YACxC,YAAY,EAAE,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,QAAQ;SAC5D,CAAC,CAAC;QACH,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;IAC7B,CAAC;IAED,cAAc;QACZ,MAAM,kBAAkB,GAAG,IAAI,CAAC,8BAA8B,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;QAEnF,IAAI,IAAI,CAAC,WAAW,IAAI,kBAAkB,EAAE;YAC1C,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,QAAQ,EAAE,kBAAkB,CAAC,KAAK,EAAE,CAAC,CAAC,SAAS,CACtG,GAAG,EAAE;gBACH,IAAI,IAAI,CAAC,WAAW,EAAE;oBACpB,IAAI,CAAC,WAAW,CAAC,QAAQ,GAAG,kBAAkB,CAAC,KAAK,CAAC;oBACrD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;iBACrC;qBAAM;oBACL,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;iBACnC;YACH,CAAC,EACD,GAAG,EAAE,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,CACxC,CAAC;SACH;IACH,CAAC;IAED,oBAAoB,CAAC,mBAA2B;QAC9C,OAAO,GAAG,mBAAmB,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,IAAI,eAAe,EAAE,CAAC;IAC9G,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,8BAA8B,CAAC,KAAK,CAAC;YACxC,YAAY,EAAE,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,QAAQ;SAC5D,CAAC,CAAC;IACL,CAAC;;6HAlDU,+BAA+B;iHAA/B,+BAA+B,yJCf5C,goFAuEA,4ZDAa,2CAA2C;4FAxD3C,+BAA+B;kBAJ3C,SAAS;mBAAC;oBACT,QAAQ,EAAE,4BAA4B;oBACtC,WAAW,EAAE,wCAAwC;iBACtD;yKAEU,WAAW;sBAAnB,KAAK;gBACa,cAAc;sBAAhC,MAAM;;AAsDT,MAAM,OAAO,2CAA4C,SAAQ,UAGhE;;yIAHY,2CAA2C;6HAA3C,2CAA2C;4FAA3C,2CAA2C;kBAHvD,SAAS;mBAAC;oBACT,QAAQ,EAAE,sCAAsC;iBACjD","sourcesContent":["import { FormBuilder } from '@angular/forms';\nimport { Observable } from 'rxjs';\nimport { Component, Directive, Output, EventEmitter, Input, OnInit } from '@angular/core';\nimport {\n  CategoriesService,\n  CategoryItem,\n  TransactionUpdateService,\n  Transaction,\n} from '@backbase/transactions-common-ang';\nimport { BbTemplate } from '@backbase/foundation-ang/core';\n\n@Component({\n  selector: 'bb-transactions-categories',\n  templateUrl: 'transactions-categories.component.html',\n})\nexport class TransactionsCategoriesComponent implements OnInit {\n  @Input() transaction: Transaction | undefined;\n  @Output() readonly categoryChange = new EventEmitter<string>();\n\n  readonly changeTransactionsCategoryForm = this.fb.group({\n    categoryName: [],\n  });\n\n  readonly hostRef = this;\n  readonly categoriesList: Observable<CategoryItem[]> = this.categoriesService.getCategories();\n\n  constructor(\n    private readonly fb: FormBuilder,\n    private readonly categoriesService: CategoriesService,\n    private readonly transactionUpdateService: TransactionUpdateService,\n  ) {}\n\n  cancelSaveCategory() {\n    this.changeTransactionsCategoryForm.reset({\n      categoryName: this.transaction && this.transaction.category,\n    });\n    this.categoryChange.emit();\n  }\n\n  changeCategory() {\n    const newCategoryControl = this.changeTransactionsCategoryForm.get('categoryName');\n\n    if (this.transaction && newCategoryControl) {\n      this.transactionUpdateService.update(this.transaction, { category: newCategoryControl.value }).subscribe(\n        () => {\n          if (this.transaction) {\n            this.transaction.category = newCategoryControl.value;\n            this.categoryChange.emit('success');\n          } else {\n            this.categoryChange.emit('error');\n          }\n        },\n        () => this.categoryChange.emit('error'),\n      );\n    }\n  }\n\n  getCategoryIconClass(transactionCategory: string): string {\n    return `${transactionCategory.toLowerCase().replace(/\\W/g, '-').replace(/-{2,}/g, '-') || 'uncategorized'}`;\n  }\n\n  ngOnInit() {\n    this.changeTransactionsCategoryForm.reset({\n      categoryName: this.transaction && this.transaction.category,\n    });\n  }\n}\n\n@Directive({\n  selector: '[bbTransactionsCategoryCustomizable]',\n})\nexport class TransactionsCategoriesCustomizableDirective extends BbTemplate<\n  TransactionsCategoriesComponent,\n  undefined\n> {}\n","<ng-container bbTransactionsCategoryCustomizable [bbHostRef]=\"hostRef\"></ng-container>\n\n<ng-template bbTransactionsCategoryCustomizable let-hostRef>\n  <form [formGroup]=\"hostRef.changeTransactionsCategoryForm\" (ngSubmit)=\"hostRef.changeCategory()\">\n    <div class=\"modal-header\">\n      <div class=\"form-group col-12 col-md-9\">\n        <bb-header-ui\n          headingType=\"h3\"\n          heading=\"Change Category\"\n          i18n-heading=\"Change Category|Change Category in change transactions category form@@transactions.form.name\"\n        ></bb-header-ui>\n      </div>\n      <button\n        type=\"button\"\n        class=\"close\"\n        color=\"muted\"\n        aria-label=\"Close\"\n        i18n-aria-label=\"Close button@@transactions.form.close\"\n        (click)=\"hostRef.cancelSaveCategory()\"\n      >\n        <span aria-hidden=\"true\">&times;</span>\n      </button>\n    </div>\n    <div class=\"modal-body modal-body-scrollable\">\n      <div class=\"bb-list\">\n        <div class=\"bb-list__item--no-separator\" *ngFor=\"let category of categoriesList | async\">\n          <label class=\"bb-stack\" [for]=\"hostRef.getCategoryIconClass(category.categoryName)\">\n            <bb-icon-ui\n              class=\"bb-stack__item\"\n              name=\"category-{{ hostRef.getCategoryIconClass(category.categoryName) }}\"\n              backgroundType=\"circle\"\n              size=\"sm\"\n            ></bb-icon-ui>\n            <span class=\"font-weight-bold bb-stack__item\">{{ category.categoryName }}</span>\n            <div class=\"bb-stack__item bb-stack__item--fill bb-text-align-right\">\n              <input\n                [id]=\"hostRef.getCategoryIconClass(category.categoryName)\"\n                type=\"radio\"\n                name=\"categoryName\"\n                formControlName=\"categoryName\"\n                [value]=\"category.categoryName\"\n              />\n            </div>\n          </label>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"modal-footer\">\n      <button\n        bbButton\n        data-role=\"cancel\"\n        color=\"secondary\"\n        (click)=\"hostRef.cancelSaveCategory()\"\n        i18n=\"Cancel|Cancel button label@@transactions.category.modal.cancel.button\"\n      >\n        Cancel\n      </button>\n\n      <button\n        bbButton\n        type=\"submit\"\n        color=\"primary\"\n        [disabled]=\"hostRef.transaction.category === hostRef.changeTransactionsCategoryForm.value.categoryName\"\n        i18n=\"Save|Save button label@@transactions.category.modal.save.button\"\n      >\n        Save\n      </button>\n    </div>\n  </form>\n</ng-template>\n"]}