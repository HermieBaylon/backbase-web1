import { __rest } from "tslib";
export var AuthorizedPermissionLevel;
(function (AuthorizedPermissionLevel) {
    AuthorizedPermissionLevel["VIEW_ONLY"] = "viewOnly";
    AuthorizedPermissionLevel["MONEY_MOVEMENT"] = "moneyMovement";
    AuthorizedPermissionLevel["FULL_ACCESS"] = "fullAccess";
})(AuthorizedPermissionLevel || (AuthorizedPermissionLevel = {}));
export var AuthorizedUserStatus;
(function (AuthorizedUserStatus) {
    AuthorizedUserStatus["PAUSED"] = "PAUSED";
    AuthorizedUserStatus["AWAITING_REGISTRATION"] = "AWAITING_REGISTRATION";
    AuthorizedUserStatus["ACTIVE"] = "ACTIVE";
})(AuthorizedUserStatus || (AuthorizedUserStatus = {}));
export var AuthorizedUsersList;
(function (AuthorizedUsersList) {
    function buildHttpResponse(levelMappignConfig) {
        return (response) => {
            if (response) {
                const data = Array.isArray(response) ? response : [response];
                return data.map((_a) => {
                    var { id, said, firstName, lastName, email, mobileNumber, username, status, permissions } = _a, others = __rest(_a, ["id", "said", "firstName", "lastName", "email", "mobileNumber", "username", "status", "permissions"]);
                    return Object.assign({ id,
                        said,
                        firstName,
                        lastName,
                        email,
                        mobileNumber,
                        username, status: status, permissions: permissions.map((_a) => {
                            var { accountId, level } = _a, otherPermissionsProps = __rest(_a, ["accountId", "level"]);
                            return (Object.assign({ accountId, level: levelMappignConfig.fromStringToPermissionLevel(level || '') }, otherPermissionsProps));
                        }) }, others);
                });
            }
            return [];
        };
    }
    AuthorizedUsersList.buildHttpResponse = buildHttpResponse;
    function mapData(authorizedUsers, accounts) {
        const items = authorizedUsers.map((authorizedUser) => {
            const { permissions } = authorizedUser, others = __rest(authorizedUser, ["permissions"]);
            return Object.assign({ permissions: setAccountToPermissions(permissions, accounts) }, others);
        });
        return {
            items,
        };
    }
    AuthorizedUsersList.mapData = mapData;
    function setAccountToPermissions(permissions, accounts) {
        return permissions
            .map((permission) => {
            const { accountId } = permission, others = __rest(permission, ["accountId"]);
            return Object.assign({ account: accounts.items.find((account) => account.id === accountId) }, others);
        })
            .filter((permission) => !!permission.account);
    }
})(AuthorizedUsersList || (AuthorizedUsersList = {}));
export var AuthorizedUser;
(function (AuthorizedUser) {
    function buildHttpRequest(levelMappignConfig) {
        const formatAuthorizedPermission = (_a) => {
            var { account, level } = _a, othersPropsPermissions = __rest(_a, ["account", "level"]);
            return (Object.assign({ accountId: account.id, level: levelMappignConfig.fromPermissionLevelToString(level) }, othersPropsPermissions));
        };
        return {
            post(user) {
                const { email = '', firstName = '', lastName = '', mobileNumber = '', permissions = [] } = user, others = __rest(user, ["email", "firstName", "lastName", "mobileNumber", "permissions"]);
                return Object.assign({ email,
                    firstName,
                    lastName,
                    mobileNumber, permissions: permissions.map(formatAuthorizedPermission) }, others);
            },
            put(permissions) {
                return {
                    permissions: permissions.map(formatAuthorizedPermission),
                };
            },
        };
    }
    AuthorizedUser.buildHttpRequest = buildHttpRequest;
})(AuthorizedUser || (AuthorizedUser = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aG9yaXplZC11c2Vycy5tb2RlbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2xpYnMvYXV0aG9yaXplZC11c2Vycy1qb3VybmV5L3NyYy9jb21tb24vbW9kZWwvYXV0aG9yaXplZC11c2Vycy5tb2RlbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBMENBLE1BQU0sQ0FBTixJQUFZLHlCQUlYO0FBSkQsV0FBWSx5QkFBeUI7SUFDbkMsbURBQXNCLENBQUE7SUFDdEIsNkRBQWdDLENBQUE7SUFDaEMsdURBQTBCLENBQUE7QUFDNUIsQ0FBQyxFQUpXLHlCQUF5QixLQUF6Qix5QkFBeUIsUUFJcEM7QUFFRCxNQUFNLENBQU4sSUFBWSxvQkFJWDtBQUpELFdBQVksb0JBQW9CO0lBQzlCLHlDQUFpQixDQUFBO0lBQ2pCLHVFQUErQyxDQUFBO0lBQy9DLHlDQUFpQixDQUFBO0FBQ25CLENBQUMsRUFKVyxvQkFBb0IsS0FBcEIsb0JBQW9CLFFBSS9CO0FBbUNELE1BQU0sS0FBVyxtQkFBbUIsQ0EyRG5DO0FBM0RELFdBQWlCLG1CQUFtQjtJQUNsQyxTQUFnQixpQkFBaUIsQ0FBQyxrQkFBdUM7UUFDdkUsT0FBTyxDQUFDLFFBQXNDLEVBQXVCLEVBQUU7WUFDckUsSUFBSSxRQUFRLEVBQUU7Z0JBQ1osTUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUM3RCxPQUFPLElBQUksQ0FBQyxHQUFHLENBQ2IsQ0FBQyxFQUFnRyxFQUFFLEVBQUU7d0JBQXBHLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxZQUFZLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxXQUFXLE9BQWEsRUFBUixNQUFNLGNBQTlGLHFHQUFnRyxDQUFGO29C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QUcsQ0FBQywwQkFBMEIsQ0FBQyxJQUNyRCxNQUFNLEVBQ1Q7WUFDSixDQUFDO1lBRUQsR0FBRyxDQUFDLFdBQW1DO2dCQUNyQyxPQUFPO29CQUNMLFdBQVcsRUFBRSxXQUFXLENBQUMsR0FBRyxDQUFDLDBCQUEwQixDQUFDO2lCQUN6RCxDQUFDO1lBQ0osQ0FBQztTQUNGLENBQUM7SUFDSixDQUFDO0lBMUJlLCtCQUFnQixtQkEwQi9CLENBQUE7QUFDSCxDQUFDLEVBNUJnQixjQUFjLEtBQWQsY0FBYyxRQTRCOUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBHZXRBdXRob3JpemVkVXNlckl0ZW0sXG4gIFBvc3RBdXRob3JpemVkVXNlcixcbiAgUHV0QXV0aG9yaXplZFVzZXJQZXJtaXNzaW9ucyxcbn0gZnJvbSAnQGJhY2tiYXNlL2RhdGEtYW5nL2F1dGhvcml6ZWQtdXNlcnMnO1xuaW1wb3J0IHsgQWNjb3VudExpc3QgfSBmcm9tICcuL2FjY291bnQtbGlzdC5tb2RlbCc7XG5pbXBvcnQgeyBBY2NvdW50IH0gZnJvbSAnLi9hY2NvdW50Lm1vZGVsJztcblxuZXhwb3J0IGludGVyZmFjZSBCYXNlQXV0aG9yaXplZFVzZXIge1xuICBpZD86IHN0cmluZztcbiAgc2FpZDogc3RyaW5nO1xuICBmaXJzdE5hbWU6IHN0cmluZztcbiAgbGFzdE5hbWU6IHN0cmluZztcbiAgZW1haWw6IHN0cmluZztcbiAgbW9iaWxlTnVtYmVyOiBzdHJpbmc7XG4gIHVzZXJuYW1lOiBzdHJpbmc7XG4gIHN0YXR1cz86IEF1dGhvcml6ZWRVc2VyU3RhdHVzO1xuICBhZGRpdGlvbnM/OiB7IFtrZXk6IHN0cmluZ106IGFueSB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEF1dGhvcml6ZWRVc2VyIGV4dGVuZHMgQmFzZUF1dGhvcml6ZWRVc2VyIHtcbiAgcGVybWlzc2lvbnM6IEFycmF5PEF1dGhvcml6ZWRQZXJtaXNzaW9uPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSYXdBdXRob3JpemVkVXNlciBleHRlbmRzIEJhc2VBdXRob3JpemVkVXNlciB7XG4gIHBlcm1pc3Npb25zOiBBcnJheTxSYXdBdXRob3JpemVkUGVybWlzc2lvbj47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXV0aG9yaXplZFVzZXJzTGlzdCB7XG4gIGl0ZW1zOiBBdXRob3JpemVkVXNlcltdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEF1dGhvcml6ZWRQZXJtaXNzaW9uIHtcbiAgYWNjb3VudDogQWNjb3VudDtcbiAgbGV2ZWw/OiBBdXRob3JpemVkUGVybWlzc2lvbkxldmVsO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJhd0F1dGhvcml6ZWRQZXJtaXNzaW9uIHtcbiAgYWNjb3VudElkPzogc3RyaW5nO1xuICBsZXZlbD86IEF1dGhvcml6ZWRQZXJtaXNzaW9uTGV2ZWw7XG59XG5cbmV4cG9ydCBlbnVtIEF1dGhvcml6ZWRQZXJtaXNzaW9uTGV2ZWwge1xuICBWSUVXX09OTFkgPSAndmlld09ubHknLFxuICBNT05FWV9NT1ZFTUVOVCA9ICdtb25leU1vdmVtZW50JyxcbiAgRlVMTF9BQ0NFU1MgPSAnZnVsbEFjY2VzcycsXG59XG5cbmV4cG9ydCBlbnVtIEF1dGhvcml6ZWRVc2VyU3RhdHVzIHtcbiAgUEFVU0VEID0gJ1BBVVNFRCcsXG4gIEFXQUlUSU5HX1JFR0lTVFJBVElPTiA9ICdBV0FJVElOR19SRUdJU1RSQVRJT04nLFxuICBBQ1RJVkUgPSAnQUNUSVZFJyxcbn1cblxuZXhwb3J0IHR5cGUgUGFydGlhbEF1dGhvcml6ZWRVc2VycyA9IFBhcnRpYWw8QXV0aG9yaXplZFVzZXI+O1xuXG5leHBvcnQgdHlwZSBTYWZlVHlwZUFycmF5ID0gcmVhZG9ubHkgW10gfCByZWFkb25seSBhbnlbXTtcblxuZXhwb3J0IGludGVyZmFjZSBMZXZlbHNNYXBwaW5nQ29uZmlnIHtcbiAgZnJvbVN0cmluZ1RvUGVybWlzc2lvbkxldmVsKHZhbHVlOiBzdHJpbmcpOiBBdXRob3JpemVkUGVybWlzc2lvbkxldmVsO1xuICBmcm9tUGVybWlzc2lvbkxldmVsVG9TdHJpbmcodmFsdWU6IEF1dGhvcml6ZWRQZXJtaXNzaW9uTGV2ZWwgfCB1bmRlZmluZWQpOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGV2ZWxVSUNvbmZpZzxUPiB7XG4gIGljb246IHN0cmluZztcbiAgdGl0bGU6IHN0cmluZztcbiAgcGVybWlzc2lvbnNBc3NpZ25lZDogVDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMZXZlbFVJQ29uZmlnSGVhZGVyPFQ+IGV4dGVuZHMgTGV2ZWxVSUNvbmZpZzxUPiB7XG4gIGxldmVsOiBBdXRob3JpemVkUGVybWlzc2lvbkxldmVsO1xuICB2YWxpZGF0ZSgpOiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIExldmVsc1VJQ29uZmlnPFQ+IHtcbiAgbGV2ZWxzOiBbTGV2ZWxVSUNvbmZpZzxUPiwgTGV2ZWxVSUNvbmZpZzxUPiwgTGV2ZWxVSUNvbmZpZzxUPl07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGVybWlzc2lvblVJQ29uZmlnPFQ+IHtcbiAgcGVybWlzc2lvbnM6IFQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGV2ZWxzQ29uZmlnPFQgZXh0ZW5kcyBTYWZlVHlwZUFycmF5LCBTIGV4dGVuZHMgeyBbayBpbiBrZXlvZiBUXTogYW55IH0+IHtcbiAgbWFwcGluZ3M/OiBMZXZlbHNNYXBwaW5nQ29uZmlnO1xuICB1aUNvbmZpZz86IExldmVsc1VJQ29uZmlnPFQ+ICYgUGVybWlzc2lvblVJQ29uZmlnPFM+O1xufVxuXG5leHBvcnQgbmFtZXNwYWNlIEF1dGhvcml6ZWRVc2Vyc0xpc3Qge1xuICBleHBvcnQgZnVuY3Rpb24gYnVpbGRIdHRwUmVzcG9uc2UobGV2ZWxNYXBwaWduQ29uZmlnOiBMZXZlbHNNYXBwaW5nQ29uZmlnKSB7XG4gICAgcmV0dXJuIChyZXNwb25zZTogQXJyYXk8R2V0QXV0aG9yaXplZFVzZXJJdGVtPik6IFJhd0F1dGhvcml6ZWRVc2VyW10gPT4ge1xuICAgICAgaWYgKHJlc3BvbnNlKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBBcnJheS5pc0FycmF5KHJlc3BvbnNlKSA/IHJlc3BvbnNlIDogW3Jlc3BvbnNlXTtcbiAgICAgICAgcmV0dXJuIGRhdGEubWFwKFxuICAgICAgICAgICh7IGlkLCBzYWlkLCBmaXJzdE5hbWUsIGxhc3ROYW1lLCBlbWFpbCwgbW9iaWxlTnVtYmVyLCB1c2VybmFtZSwgc3RhdHVzLCBwZXJtaXNzaW9ucywgLi4ub3RoZXJzIH0pID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgICBzYWlkLFxuICAgICAgICAgICAgICBmaXJzdE5hbWUsXG4gICAgICAgICAgICAgIGxhc3ROYW1lLFxuICAgICAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICAgICAgbW9iaWxlTnVtYmVyLFxuICAgICAgICAgICAgICB1c2VybmFtZSxcbiAgICAgICAgICAgICAgc3RhdHVzOiBzdGF0dXMgYXMgQXV0aG9yaXplZFVzZXJTdGF0dXMsXG4gICAgICAgICAgICAgIHBlcm1pc3Npb25zOiBwZXJtaXNzaW9ucy5tYXAoKHsgYWNjb3VudElkLCBsZXZlbCwgLi4ub3RoZXJQZXJtaXNzaW9uc1Byb3BzIH0pID0+ICh7XG4gICAgICAgICAgICAgICAgYWNjb3VudElkLFxuICAgICAgICAgICAgICAgIGxldmVsOiBsZXZlbE1hcHBpZ25Db25maWcuZnJvbVN0cmluZ1RvUGVybWlzc2lvbkxldmVsKGxldmVsIHx8ICcnKSxcbiAgICAgICAgICAgICAgICAuLi5vdGhlclBlcm1pc3Npb25zUHJvcHMsXG4gICAgICAgICAgICAgIH0pKSxcbiAgICAgICAgICAgICAgLi4ub3RoZXJzLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9LFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gbWFwRGF0YShhdXRob3JpemVkVXNlcnM6IFJhd0F1dGhvcml6ZWRVc2VyW10sIGFjY291bnRzOiBBY2NvdW50TGlzdCk6IEF1dGhvcml6ZWRVc2Vyc0xpc3Qge1xuICAgIGNvbnN0IGl0ZW1zID0gYXV0aG9yaXplZFVzZXJzLm1hcCgoYXV0aG9yaXplZFVzZXIpID0+IHtcbiAgICAgIGNvbnN0IHsgcGVybWlzc2lvbnMsIC4uLm90aGVycyB9ID0gYXV0aG9yaXplZFVzZXI7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBwZXJtaXNzaW9uczogc2V0QWNjb3VudFRvUGVybWlzc2lvbnMocGVybWlzc2lvbnMsIGFjY291bnRzKSxcbiAgICAgICAgLi4ub3RoZXJzLFxuICAgICAgfTtcbiAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBpdGVtcyxcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0QWNjb3VudFRvUGVybWlzc2lvbnMoXG4gICAgcGVybWlzc2lvbnM6IFJhd0F1dGhvcml6ZWRQZXJtaXNzaW9uW10sXG4gICAgYWNjb3VudHM6IEFjY291bnRMaXN0LFxuICApOiBBdXRob3JpemVkUGVybWlzc2lvbltdIHtcbiAgICByZXR1cm4gcGVybWlzc2lvbnNcbiAgICAgIC5tYXAoKHBlcm1pc3Npb24pID0+IHtcbiAgICAgICAgY29uc3QgeyBhY2NvdW50SWQsIC4uLm90aGVycyB9ID0gcGVybWlzc2lvbjtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGFjY291bnQ6IGFjY291bnRzLml0ZW1zLmZpbmQoKGFjY291bnQpID0+IGFjY291bnQuaWQgPT09IGFjY291bnRJZCkhLFxuICAgICAgICAgIC4uLm90aGVycyxcbiAgICAgICAgfTtcbiAgICAgIH0pXG4gICAgICAuZmlsdGVyKChwZXJtaXNzaW9uKSA9PiAhIXBlcm1pc3Npb24uYWNjb3VudCk7XG4gIH1cbn1cblxuZXhwb3J0IG5hbWVzcGFjZSBBdXRob3JpemVkVXNlciB7XG4gIGV4cG9ydCBmdW5jdGlvbiBidWlsZEh0dHBSZXF1ZXN0KGxldmVsTWFwcGlnbkNvbmZpZzogTGV2ZWxzTWFwcGluZ0NvbmZpZykge1xuICAgIGNvbnN0IGZvcm1hdEF1dGhvcml6ZWRQZXJtaXNzaW9uID0gKHsgYWNjb3VudCwgbGV2ZWwsIC4uLm90aGVyc1Byb3BzUGVybWlzc2lvbnMgfTogQXV0aG9yaXplZFBlcm1pc3Npb24pID0+ICh7XG4gICAgICBhY2NvdW50SWQ6IGFjY291bnQuaWQsXG4gICAgICBsZXZlbDogbGV2ZWxNYXBwaWduQ29uZmlnLmZyb21QZXJtaXNzaW9uTGV2ZWxUb1N0cmluZyhsZXZlbCksXG4gICAgICAuLi5vdGhlcnNQcm9wc1Blcm1pc3Npb25zLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHBvc3QodXNlcjogUGFydGlhbEF1dGhvcml6ZWRVc2Vycyk6IFBvc3RBdXRob3JpemVkVXNlciB7XG4gICAgICAgIGNvbnN0IHsgZW1haWwgPSAnJywgZmlyc3ROYW1lID0gJycsIGxhc3ROYW1lID0gJycsIG1vYmlsZU51bWJlciA9ICcnLCBwZXJtaXNzaW9ucyA9IFtdLCAuLi5vdGhlcnMgfSA9IHVzZXI7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZW1haWwsXG4gICAgICAgICAgZmlyc3ROYW1lLFxuICAgICAgICAgIGxhc3ROYW1lLFxuICAgICAgICAgIG1vYmlsZU51bWJlcixcbiAgICAgICAgICBwZXJtaXNzaW9uczogcGVybWlzc2lvbnMubWFwKGZvcm1hdEF1dGhvcml6ZWRQZXJtaXNzaW9uKSxcbiAgICAgICAgICAuLi5vdGhlcnMsXG4gICAgICAgIH07XG4gICAgICB9LFxuXG4gICAgICBwdXQocGVybWlzc2lvbnM6IEF1dGhvcml6ZWRQZXJtaXNzaW9uW10pOiBQdXRBdXRob3JpemVkVXNlclBlcm1pc3Npb25zIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBwZXJtaXNzaW9uczogcGVybWlzc2lvbnMubWFwKGZvcm1hdEF1dGhvcml6ZWRQZXJtaXNzaW9uKSxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuIl19