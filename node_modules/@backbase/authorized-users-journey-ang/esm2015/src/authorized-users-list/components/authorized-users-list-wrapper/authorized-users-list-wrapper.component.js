import { Component, EventEmitter, Output } from '@angular/core';
import { BehaviorSubject, of } from 'rxjs';
import { catchError, mergeMap, tap } from 'rxjs/operators';
import { AuthorizedUserStatus, } from '../../../common/model/authorized-users.model';
import { parseError } from '../../../common/model/authorized-users-error.model';
import { SERVICE_AGREEMENT_DISABLED, SERVICE_AGREEMENT_ENABLED } from '../../../common/constants';
import * as i0 from "@angular/core";
import * as i1 from "@backbase/foundation-ang/core";
import * as i2 from "../../../common/services/user-data.service";
import * as i3 from "../../../common/services/users-ui.service";
import * as i4 from "@backbase/ui-ang/notification";
import * as i5 from "../authorized-users-list/authorized-users-list.component";
import * as i6 from "../authorized-users-empty-list/authorized-users-empty-list.component";
import * as i7 from "@backbase/ui-ang/loading-indicator";
import * as i8 from "@backbase/ui-ang/empty-state";
import * as i9 from "../authorized-users-list-confirmation-dialog/authorized-users-list-confirmation-remove-user-dialog.component";
import * as i10 from "../authorized-users-list-confirmation-dialog/authorized-user-list-confirmation-pause-user-dialog.component";
import * as i11 from "@angular/common";
import * as i12 from "@backbase/ui-ang/button";
export class AuthorizedUsersListWrapperComponent {
    constructor(assetsService, userDataService, usersUIService, notificationService) {
        this.assetsService = assetsService;
        this.userDataService = userDataService;
        this.usersUIService = usersUIService;
        this.notificationService = notificationService;
        this.refreshAuthorizedUsers = new BehaviorSubject(true);
        this.authorizedUsersListSubject = new BehaviorSubject({ items: [] });
        this.isLoading = new BehaviorSubject(true);
        this.authorizedUsersList = this.authorizedUsersListSubject.asObservable();
        this.showLoadingIndicator = this.isLoading.asObservable();
        this.selectedUser = new EventEmitter();
        this.getURIFromAssetID = (assetId) => `${assetId}-img.svg`;
        // eslint-disable-next-line @typescript-eslint/member-ordering
        this.resolveAsset = this.assetsService.createAssetsResolver({
            widgetName: 'bb-authorized-users-journey-ang',
            getURIFromAssetID: this.getURIFromAssetID,
        });
        this.handleLoadingError = (error) => {
            this.error = parseError(error);
            return of({ items: [] });
        };
        this.handleOperationsError = () => {
            this.setLoadingIndicator(false);
            this.pushNotification($localize `Something went wrong`, $localize `Please try again later.`, 'error');
        };
        this.refreshAuthorizedUsers
            .pipe(mergeMap(() => this.retrieveAuthorizedUsers()))
            .subscribe(this.authorizedUsersListSubject);
        this.levelsConfig = this.usersUIService.uiLevelsConfigValue;
    }
    retrieveAuthorizedUsers() {
        return this.userDataService.retrieveAuthorizedUser().pipe(catchError(this.handleLoadingError), tap(() => {
            this.setLoadingIndicator(false);
        }));
    }
    pushNotification(header, message, modifier) {
        this.notificationService.showNotification({
            header,
            message,
            modifier,
            dismissible: true,
            ttl: 5000,
        });
    }
    get imageEmptyStateUrl() {
        return this.resolveAsset('authorized-users-empty-state');
    }
    goToAuthorizedUser() {
        this.selectedUser.emit();
    }
    editPermissions(user) {
        this.selectedUser.emit(user.id);
    }
    setCurrentUser(user, actionName) {
        this.currentUser = user;
        this.actionName = actionName;
    }
    setLoadingIndicator(value) {
        this.isLoading.next(value);
    }
    removeUser(user) {
        const success = () => {
            this.pushNotification($localize `Authorized user removed`, $localize `Their permissions are permanently removed.`, 'success');
            this.refreshList();
        };
        if (user && user.id) {
            this.setLoadingIndicator(true);
            this.currentUser = undefined;
            this.userDataService.removeAuthorizedUser(user.id).subscribe(success, this.handleOperationsError);
        }
    }
    updateUserStatus(user) {
        const success = () => {
            if (user.status !== AuthorizedUserStatus.PAUSED) {
                this.pushNotification($localize `Authorized user paused`, $localize `You can resume their permissions at any time.`, 'success');
            }
            else {
                this.pushNotification($localize `User permissions resumed`, $localize `Their permissions are now active again.`, 'success');
            }
            this.refreshList();
        };
        if (user && user.id) {
            this.setLoadingIndicator(true);
            this.currentUser = undefined;
            this.userDataService
                .updateAuthorizedUserStatus(user.id, user.status !== AuthorizedUserStatus.PAUSED ? SERVICE_AGREEMENT_DISABLED : SERVICE_AGREEMENT_ENABLED)
                .subscribe(success, this.handleOperationsError);
        }
    }
    refreshList() {
        this.refreshAuthorizedUsers.next(true);
    }
    ngOnDestroy() {
        this.refreshAuthorizedUsers.complete();
        this.authorizedUsersListSubject.complete();
        this.isLoading.complete();
    }
}
AuthorizedUsersListWrapperComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: AuthorizedUsersListWrapperComponent, deps: [{ token: i1.AssetsService }, { token: i2.UserDataService }, { token: i3.UsersUIService }, { token: i4.NotificationService }], target: i0.ɵɵFactoryTarget.Component });
AuthorizedUsersListWrapperComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "12.2.16", type: AuthorizedUsersListWrapperComponent, selector: "bb-authorized-users-list-wrapper", outputs: { selectedUser: "selectedUser" }, ngImport: i0, template: "<ng-container *ngIf=\"!error; else errorState\">\n  <ng-container *ngIf=\"authorizedUsersList | async as list\">\n    <ng-container *ngIf=\"(showLoadingIndicator | async) === false; else loadingState\">\n      <ng-container *ngIf=\"list.items.length; else emptyState\">\n        <bb-authorized-users-list\n          [authorizedUsersList]=\"list.items\"\n          [levelsConfig]=\"levelsConfig\"\n          (edit)=\"editPermissions($event)\"\n          (remove)=\"setCurrentUser($event, 'remove')\"\n          (paused)=\"setCurrentUser($event, 'pause')\"\n          (resumed)=\"updateUserStatus($event)\"\n          (createAuthorizedUser)=\"goToAuthorizedUser()\"\n        ></bb-authorized-users-list>\n      </ng-container>\n    </ng-container>\n  </ng-container>\n</ng-container>\n\n<ng-template #emptyState>\n  <bb-authorized-users-empty-list\n    [imageUrl]=\"imageEmptyStateUrl | async\"\n    (createAuthorizedUser)=\"goToAuthorizedUser()\"\n  ></bb-authorized-users-empty-list>\n</ng-template>\n\n<ng-template #loadingState>\n  <div class=\"card\">\n    <bb-loading-indicator-ui \n      loaderSize=\"lg\" \n      text=\"Loading...\"\n      i18n-text=\"Loading|Text for the loading indicator@@authorized.users.loading.indicator.text\"\n    ></bb-loading-indicator-ui>\n  </div>\n</ng-template>\n\n<ng-template #errorState>\n  <div class=\"card\">\n    <div class=\"card-body bb-state-container\">\n      <bb-empty-state-ui\n        iconModifier=\"error-outline\"\n        iconColor=\"dark\"\n        title=\"Something Went Wrong\"\n        i18n-title=\"Error state title@@authorized.users.errorState.title\"\n        subtitle=\"Try to reload the page or contact the system administrator.\"\n        i18n-subtitle=\"Error state message@@authorized.users.errorState.message\"\n      ></bb-empty-state-ui>\n      <div class=\"bb-state-container__footer\">\n        <button \n          bbButton \n          color=\"primary\" \n          i18n=\"Reload button text@@authorized-users.errorState.reload.button\"\n        >\n          Reload\n        </button>\n      </div>\n    </div>\n  </div>\n</ng-template>\n\n<bb-authorized-user-list-remove-user-confirmation-dialog\n  [dialogOpen]=\"!!currentUser && actionName === 'remove'\"\n  (confirm)=\"removeUser(currentUser)\"\n  (closed)=\"setCurrentUser()\"\n></bb-authorized-user-list-remove-user-confirmation-dialog>\n\n<bb-authorized-user-list-confirmation-pause-user-dialog\n  [dialogOpen]=\"!!currentUser && actionName === 'pause'\"\n  (confirm)=\"updateUserStatus(currentUser)\"\n  (closed)=\"setCurrentUser()\"\n></bb-authorized-user-list-confirmation-pause-user-dialog>\n", components: [{ type: i5.AuthorizedUsersListComponent, selector: "bb-authorized-users-list", inputs: ["authorizedUsersList", "levelsConfig"], outputs: ["edit", "remove", "paused", "resumed", "createAuthorizedUser"] }, { type: i6.AuthorizedUsersEmptyListComponent, selector: "bb-authorized-users-empty-list", inputs: ["imageUrl"], outputs: ["createAuthorizedUser"] }, { type: i7.LoadingIndicatorComponent, selector: "bb-loading-indicator-ui", inputs: ["text", "loaderSize", "showDelay", "hasBackground", "inline"] }, { type: i8.EmptyStateComponent, selector: "bb-empty-state-ui", inputs: ["title", "subtitle", "showIcon", "iconClasses", "iconModifier", "iconSize", "iconColor"] }, { type: i9.AuthorizedUsersListConfirmationRemoveUserDialogComponent, selector: "bb-authorized-user-list-remove-user-confirmation-dialog" }, { type: i10.AuthorizedUserListConfirmationPauseUserDialogComponent, selector: "bb-authorized-user-list-confirmation-pause-user-dialog" }], directives: [{ type: i11.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i12.ButtonDirective, selector: "button[bbButton]", inputs: ["type", "color", "buttonSize", "block", "circle"] }], pipes: { "async": i11.AsyncPipe } });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: AuthorizedUsersListWrapperComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'bb-authorized-users-list-wrapper',
                    templateUrl: `authorized-users-list-wrapper.component.html`,
                }]
        }], ctorParameters: function () { return [{ type: i1.AssetsService }, { type: i2.UserDataService }, { type: i3.UsersUIService }, { type: i4.NotificationService }]; }, propDecorators: { selectedUser: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aG9yaXplZC11c2Vycy1saXN0LXdyYXBwZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vbGlicy9hdXRob3JpemVkLXVzZXJzLWpvdXJuZXkvc3JjL2F1dGhvcml6ZWQtdXNlcnMtbGlzdC9jb21wb25lbnRzL2F1dGhvcml6ZWQtdXNlcnMtbGlzdC13cmFwcGVyL2F1dGhvcml6ZWQtdXNlcnMtbGlzdC13cmFwcGVyLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL2xpYnMvYXV0aG9yaXplZC11c2Vycy1qb3VybmV5L3NyYy9hdXRob3JpemVkLXVzZXJzLWxpc3QvY29tcG9uZW50cy9hdXRob3JpemVkLXVzZXJzLWxpc3Qtd3JhcHBlci9hdXRob3JpemVkLXVzZXJzLWxpc3Qtd3JhcHBlci5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBYSxNQUFNLEVBQWUsTUFBTSxlQUFlLENBQUM7QUFFeEYsT0FBTyxFQUFFLGVBQWUsRUFBYyxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDdkQsT0FBTyxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFM0QsT0FBTyxFQUdMLG9CQUFvQixHQUdyQixNQUFNLDhDQUE4QyxDQUFDO0FBQ3RELE9BQU8sRUFBd0IsVUFBVSxFQUFFLE1BQU0sb0RBQW9ELENBQUM7QUFDdEcsT0FBTyxFQUFFLDBCQUEwQixFQUFFLHlCQUF5QixFQUFFLE1BQU0sMkJBQTJCLENBQUM7Ozs7Ozs7Ozs7Ozs7O0FBZ0JsRyxNQUFNLE9BQU8sbUNBQW1DO0lBbUk5QyxZQUNtQixhQUE0QixFQUM1QixlQUFnQyxFQUNoQyxjQUE4QixFQUM5QixtQkFBd0M7UUFIeEMsa0JBQWEsR0FBYixhQUFhLENBQWU7UUFDNUIsb0JB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Q0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNyQixDQUFDLENBQUM7UUFDRixJQUFJLElBQUksSUFBSSxJQUFJLENBQUMsRUFBRSxFQUFFO1lBQ25CLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMvQixJQUFJLENBQUMsV0FBVyxHQUFHLFNBQVMsQ0FBQztZQUM3QixJQUFJLENBQUMsZUFBZTtpQkFDakIsMEJBQTBCLENBQ3pCLElBQUksQ0FBQyxFQUFFLEVBQ1AsSUFBSSxDQUFDLE1BQU0sS0FBSyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLDBCQUEwQixDQUFDLENBQUMsQ0FBQyx5QkFBeUIsQ0FDckc7aUJBQ0EsU0FBUyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMscUJBQXFCLENBQUMsQ0FBQztTQUNuRDtJQUNILENBQUM7SUFFRCxXQUFXO1FBQ1QsSUFBSSxDQUFDLHNCQUFzQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN6QyxDQUFDO0lBRUQsV0FBVztRQUNULElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUN2QyxJQUFJLENBQUMsMEJBQTBCLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDM0MsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUM1QixDQUFDOztpSUFqSVUsbUNBQW1DO3FIQUFuQyxtQ0FBbUMsbUhDN0JoRCxta0ZBc0VBOzRGRHpDYSxtQ0FBbUM7a0JBSi9DLFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLGtDQUFrQztvQkFDNUMsV0FBVyxFQUFFLDhDQUE4QztpQkFDNUQ7aU1BV1csWUFBWTtzQkFBckIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBPbkRlc3Ryb3ksIE91dHB1dCwgVGVtcGxhdGVSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEFzc2V0c1Jlc29sdmVyLCBBc3NldHNTZXJ2aWNlIH0gZnJvbSAnQGJhY2tiYXNlL2ZvdW5kYXRpb24tYW5nL2NvcmUnO1xuaW1wb3J0IHsgQmVoYXZpb3JTdWJqZWN0LCBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgY2F0Y2hFcnJvciwgbWVyZ2VNYXAsIHRhcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IEh0dHBFcnJvclJlc3BvbnNlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHtcbiAgQXV0aG9yaXplZFVzZXIsXG4gIEF1dGhvcml6ZWRVc2Vyc0xpc3QsXG4gIEF1dGhvcml6ZWRVc2VyU3RhdHVzLFxuICBMZXZlbFVJQ29uZmlnSGVhZGVyLFxuICBTYWZlVHlwZUFycmF5LFxufSBmcm9tICcuLi8uLi8uLi9jb21tb24vbW9kZWwvYXV0aG9yaXplZC11c2Vycy5tb2RlbCc7XG5pbXBvcnQgeyBBdXRob3JpemVkVXNlcnNFcnJvciwgcGFyc2VFcnJvciB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9tb2RlbC9hdXRob3JpemVkLXVzZXJzLWVycm9yLm1vZGVsJztcbmltcG9ydCB7IFNFUlZJQ0VfQUdSRUVNRU5UX0RJU0FCTEVELCBTRVJWSUNFX0FHUkVFTUVOVF9FTkFCTEVEIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBVc2VyRGF0YVNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vc2VydmljZXMvdXNlci1kYXRhLnNlcnZpY2UnO1xuaW1wb3J0IHsgVXNlcnNVSVNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vc2VydmljZXMvdXNlcnMtdWkuc2VydmljZSc7XG5pbXBvcnQgeyBOb3RpZmljYXRpb25TZXJ2aWNlIH0gZnJvbSAnQGJhY2tiYXNlL3VpLWFuZy9ub3RpZmljYXRpb24nO1xuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdmFyXG5kZWNsYXJlIHZhciAkbG9jYWxpemU6IGFueTtcblxuZXhwb3J0IHR5cGUgQXV0aG9yaXplZFVzZXJMaXN0QWN0aW9ucyA9ICdwYXVzZScgfCAncmVtb3ZlJyB8IHVuZGVmaW5lZDtcbnR5cGUgTm90aWZpY2F0aW9uTWVzc2FnZSA9IHN0cmluZyB8IFRlbXBsYXRlUmVmPGFueT47XG50eXBlIE5vdGlmaWNhdGlvbk1vZGlmaWVyID0gJ3N1Y2Nlc3MnIHwgJ2luZm8nIHwgJ3dhcm5pbmcnIHwgJ2Vycm9yJyB8IHVuZGVmaW5lZDtcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYmItYXV0aG9yaXplZC11c2Vycy1saXN0LXdyYXBwZXInLFxuICB0ZW1wbGF0ZVVybDogYGF1dGhvcml6ZWQtdXNlcnMtbGlzdC13cmFwcGVyLmNvbXBvbmVudC5odG1sYCxcbn0pXG5leHBvcnQgY2xhc3MgQXV0aG9yaXplZFVzZXJzTGlzdFdyYXBwZXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkRlc3Ryb3kge1xuICBwcml2YXRlIHJlZnJlc2hBdXRob3JpemVkVXNlcnMgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+KHRydWUpO1xuICBwcml2YXRlIGF1dGhvcml6ZWRVc2Vyc0xpc3RTdWJqZWN0ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxBdXRob3JpemVkVXNlcnNMaXN0Pih7IGl0ZW1zOiBbXSB9KTtcbiAgcHJpdmF0ZSBpc0xvYWRpbmcgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+KHRydWUpO1xuICBsZXZlbHNDb25maWc6IEFycmF5PExldmVsVUlDb25maWdIZWFkZXI8U2FmZVR5cGVBcnJheT4+IHwgdW5kZWZpbmVkO1xuXG4gIGFjdGlvbk5hbWU6IEF1dGhvcml6ZWRVc2VyTGlzdEFjdGlvbnM7XG4gIGF1dGhvcml6ZWRVc2Vyc0xpc3QgPSB0aGlzLmF1dGhvcml6ZWRVc2Vyc0xpc3RTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xuICBzaG93TG9hZGluZ0luZGljYXRvciA9IHRoaXMuaXNMb2FkaW5nLmFzT2JzZXJ2YWJsZSgpO1xuXG4gIEBPdXRwdXQoKSBzZWxlY3RlZFVzZXIgPSBuZXcgRXZlbnRFbWl0dGVyPHN0cmluZyB8IHVuZGVmaW5lZD4oKTtcbiAgLyoqXG4gICAqIEVycm9yIG1lc3NhZ2UgaW4gY2FzZSBzb21ldGhpbmcgdW5leHBlY3RlZCBvY2N1cnMuXG4gICAqL1xuICBlcnJvcjogQXV0aG9yaXplZFVzZXJzRXJyb3IgfCB1bmRlZmluZWQ7XG5cbiAgY3VycmVudFVzZXI6IEF1dGhvcml6ZWRVc2VyIHwgdW5kZWZpbmVkO1xuXG4gIHByaXZhdGUgcmVhZG9ubHkgZ2V0VVJJRnJvbUFzc2V0SUQgPSAoYXNzZXRJZDogc3RyaW5nKSA9PiBgJHthc3NldElkfS1pbWcuc3ZnYDtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9tZW1iZXItb3JkZXJpbmdcbiAgcHJpdmF0ZSByZWFkb25seSByZXNvbHZlQXNzZXQ6IEFzc2V0c1Jlc29sdmVyID0gdGhpcy5hc3NldHNTZXJ2aWNlLmNyZWF0ZUFzc2V0c1Jlc29sdmVyKHtcbiAgICB3aWRnZXROYW1lOiAnYmItYXV0aG9yaXplZC11c2Vycy1qb3VybmV5LWFuZycsXG4gICAgZ2V0VVJJRnJvbUFzc2V0SUQ6IHRoaXMuZ2V0VVJJRnJvbUFzc2V0SUQsXG4gIH0pO1xuXG4gIHByaXZhdGUgaGFuZGxlTG9hZGluZ0Vycm9yID0gKGVycm9yOiBIdHRwRXJyb3JSZXNwb25zZSkgPT4ge1xuICAgIHRoaXMuZXJyb3IgPSBwYXJzZUVycm9yKGVycm9yKTtcbiAgICByZXR1cm4gb2YoeyBpdGVtczogW10gfSk7XG4gIH07XG5cbiAgcHJpdmF0ZSBoYW5kbGVPcGVyYXRpb25zRXJyb3IgPSAoKSA9PiB7XG4gICAgdGhpcy5zZXRMb2FkaW5nSW5kaWNhdG9yKGZhbHNlKTtcbiAgICB0aGlzLnB1c2hOb3RpZmljYXRpb24oJGxvY2FsaXplYFNvbWV0aGluZyB3ZW50IHdyb25nYCwgJGxvY2FsaXplYFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuYCwgJ2Vycm9yJyk7XG4gIH07XG5cbiAgcHJpdmF0ZSByZXRyaWV2ZUF1dGhvcml6ZWRVc2VycygpIHtcbiAgICByZXR1cm4gdGhpcy51c2VyRGF0YVNlcnZpY2UucmV0cmlldmVBdXRob3JpemVkVXNlcigpLnBpcGUoXG4gICAgICBjYXRjaEVycm9yKHRoaXMuaGFuZGxlTG9hZGluZ0Vycm9yKSxcbiAgICAgIHRhcCgoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0TG9hZGluZ0luZGljYXRvcihmYWxzZSk7XG4gICAgICB9KSxcbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBwdXNoTm90aWZpY2F0aW9uKGhlYWRlcjogTm90aWZpY2F0aW9uTWVzc2FnZSwgbWVzc2FnZTogTm90aWZpY2F0aW9uTWVzc2FnZSwgbW9kaWZpZXI6IE5vdGlmaWNhdGlvbk1vZGlmaWVyKSB7XG4gICAgdGhpcy5ub3RpZmljYXRpb25TZXJ2aWNlLnNob3dOb3RpZmljYXRpb24oe1xuICAgICAgaGVhZGVyLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIG1vZGlmaWVyLFxuICAgICAgZGlzbWlzc2libGU6IHRydWUsXG4gICAgICB0dGw6IDUwMDAsXG4gICAgfSk7XG4gIH1cblxuICBnZXQgaW1hZ2VFbXB0eVN0YXRlVXJsKCk6IE9ic2VydmFibGU8c3RyaW5nPiB7XG4gICAgcmV0dXJuIHRoaXMucmVzb2x2ZUFzc2V0KCdhdXRob3JpemVkLXVzZXJzLWVtcHR5LXN0YXRlJyk7XG4gIH1cblxuICBnb1RvQXV0aG9yaXplZFVzZXIoKSB7XG4gICAgdGhpcy5zZWxlY3RlZFVzZXIuZW1pdCgpO1xuICB9XG5cbiAgZWRpdFBlcm1pc3Npb25zKHVzZXI6IEF1dGhvcml6ZWRVc2VyKSB7XG4gICAgdGhpcy5zZWxlY3RlZFVzZXIuZW1pdCh1c2VyLmlkKTtcbiAgfVxuXG4gIHNldEN1cnJlbnRVc2VyKHVzZXI/OiBBdXRob3JpemVkVXNlciwgYWN0aW9uTmFtZT86IEF1dGhvcml6ZWRVc2VyTGlzdEFjdGlvbnMpIHtcbiAgICB0aGlzLmN1cnJlbnRVc2VyID0gdXNlcjtcbiAgICB0aGlzLmFjdGlvbk5hbWUgPSBhY3Rpb25OYW1lO1xuICB9XG5cbiAgc2V0TG9hZGluZ0luZGljYXRvcih2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuaXNMb2FkaW5nLm5leHQodmFsdWUpO1xuICB9XG5cbiAgcmVtb3ZlVXNlcih1c2VyOiBBdXRob3JpemVkVXNlciB8IHVuZGVmaW5lZCkge1xuICAgIGNvbnN0IHN1Y2Nlc3MgPSAoKSA9PiB7XG4gICAgICB0aGlzLnB1c2hOb3RpZmljYXRpb24oXG4gICAgICAgICRsb2NhbGl6ZWBBdXRob3JpemVkIHVzZXIgcmVtb3ZlZGAsXG4gICAgICAgICRsb2NhbGl6ZWBUaGVpciBwZXJtaXNzaW9ucyBhcmUgcGVybWFuZW50bHkgcmVtb3ZlZC5gLFxuICAgICAgICAnc3VjY2VzcycsXG4gICAgICApO1xuICAgICAgdGhpcy5yZWZyZXNoTGlzdCgpO1xuICAgIH07XG5cbiAgICBpZiAodXNlciAmJiB1c2VyLmlkKSB7XG4gICAgICB0aGlzLnNldExvYWRpbmdJbmRpY2F0b3IodHJ1ZSk7XG4gICAgICB0aGlzLmN1cnJlbnRVc2VyID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy51c2VyRGF0YVNlcnZpY2UucmVtb3ZlQXV0aG9yaXplZFVzZXIodXNlci5pZCkuc3Vic2NyaWJlKHN1Y2Nlc3MsIHRoaXMuaGFuZGxlT3BlcmF0aW9uc0Vycm9yKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGVVc2VyU3RhdHVzKHVzZXI6IEF1dGhvcml6ZWRVc2VyIHwgdW5kZWZpbmVkKSB7XG4gICAgY29uc3Qgc3VjY2VzcyA9ICgpID0+IHtcbiAgICAgIGlmICh1c2VyIS5zdGF0dXMgIT09IEF1dGhvcml6ZWRVc2VyU3RhdHVzLlBBVVNFRCkge1xuICAgICAgICB0aGlzLnB1c2hOb3RpZmljYXRpb24oXG4gICAgICAgICAgJGxvY2FsaXplYEF1dGhvcml6ZWQgdXNlciBwYXVzZWRgLFxuICAgICAgICAgICRsb2NhbGl6ZWBZb3UgY2FuIHJlc3VtZSB0aGVpciBwZXJtaXNzaW9ucyBhdCBhbnkgdGltZS5gLFxuICAgICAgICAgICdzdWNjZXNzJyxcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucHVzaE5vdGlmaWNhdGlvbihcbiAgICAgICAgICAkbG9jYWxpemVgVXNlciBwZXJtaXNzaW9ucyByZXN1bWVkYCxcbiAgICAgICAgICAkbG9jYWxpemVgVGhlaXIgcGVybWlzc2lvbnMgYXJlIG5vdyBhY3RpdmUgYWdhaW4uYCxcbiAgICAgICAgICAnc3VjY2VzcycsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICB0aGlzLnJlZnJlc2hMaXN0KCk7XG4gICAgfTtcbiAgICBpZiAodXNlciAmJiB1c2VyLmlkKSB7XG4gICAgICB0aGlzLnNldExvYWRpbmdJbmRpY2F0b3IodHJ1ZSk7XG4gICAgICB0aGlzLmN1cnJlbnRVc2VyID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy51c2VyRGF0YVNlcnZpY2VcbiAgICAgICAgLnVwZGF0ZUF1dGhvcml6ZWRVc2VyU3RhdHVzKFxuICAgICAgICAgIHVzZXIuaWQsXG4gICAgICAgICAgdXNlci5zdGF0dXMgIT09IEF1dGhvcml6ZWRVc2VyU3RhdHVzLlBBVVNFRCA/IFNFUlZJQ0VfQUdSRUVNRU5UX0RJU0FCTEVEIDogU0VSVklDRV9BR1JFRU1FTlRfRU5BQkxFRCxcbiAgICAgICAgKVxuICAgICAgICAuc3Vic2NyaWJlKHN1Y2Nlc3MsIHRoaXMuaGFuZGxlT3BlcmF0aW9uc0Vycm9yKTtcbiAgICB9XG4gIH1cblxuICByZWZyZXNoTGlzdCgpIHtcbiAgICB0aGlzLnJlZnJlc2hBdXRob3JpemVkVXNlcnMubmV4dCh0cnVlKTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHRoaXMucmVmcmVzaEF1dGhvcml6ZWRVc2Vycy5jb21wbGV0ZSgpO1xuICAgIHRoaXMuYXV0aG9yaXplZFVzZXJzTGlzdFN1YmplY3QuY29tcGxldGUoKTtcbiAgICB0aGlzLmlzTG9hZGluZy5jb21wbGV0ZSgpO1xuICB9XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSByZWFkb25seSBhc3NldHNTZXJ2aWNlOiBBc3NldHNTZXJ2aWNlLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgdXNlckRhdGFTZXJ2aWNlOiBVc2VyRGF0YVNlcnZpY2UsXG4gICAgcHJpdmF0ZSByZWFkb25seSB1c2Vyc1VJU2VydmljZTogVXNlcnNVSVNlcnZpY2UsXG4gICAgcHJpdmF0ZSByZWFkb25seSBub3RpZmljYXRpb25TZXJ2aWNlOiBOb3RpZmljYXRpb25TZXJ2aWNlLFxuICApIHtcbiAgICB0aGlzLnJlZnJlc2hBdXRob3JpemVkVXNlcnNcbiAgICAgIC5waXBlKG1lcmdlTWFwKCgpID0+IHRoaXMucmV0cmlldmVBdXRob3JpemVkVXNlcnMoKSkpXG4gICAgICAuc3Vic2NyaWJlKHRoaXMuYXV0aG9yaXplZFVzZXJzTGlzdFN1YmplY3QpO1xuXG4gICAgdGhpcy5sZXZlbHNDb25maWcgPSB0aGlzLnVzZXJzVUlTZXJ2aWNlLnVpTGV2ZWxzQ29uZmlnVmFsdWU7XG4gIH1cbn1cbiIsIjxuZy1jb250YWluZXIgKm5nSWY9XCIhZXJyb3I7IGVsc2UgZXJyb3JTdGF0ZVwiPlxuICA8bmctY29udGFpbmVyICpuZ0lmPVwiYXV0aG9yaXplZFVzZXJzTGlzdCB8IGFzeW5jIGFzIGxpc3RcIj5cbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiKHNob3dMb2FkaW5nSW5kaWNhdG9yIHwgYXN5bmMpID09PSBmYWxzZTsgZWxzZSBsb2FkaW5nU3RhdGVcIj5cbiAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJsaXN0Lml0ZW1zLmxlbmd0aDsgZWxzZSBlbXB0eVN0YXRlXCI+XG4gICAgICAgIDxiYi1hdXRob3JpemVkLXVzZXJzLWxpc3RcbiAgICAgICAgICBbYXV0aG9yaXplZFVzZXJzTGlzdF09XCJsaXN0Lml0ZW1zXCJcbiAgICAgICAgICBbbGV2ZWxzQ29uZmlnXT1cImxldmVsc0NvbmZpZ1wiXG4gICAgICAgICAgKGVkaXQpPVwiZWRpdFBlcm1pc3Npb25zKCRldmVudClcIlxuICAgICAgICAgIChyZW1vdmUpPVwic2V0Q3VycmVudFVzZXIoJGV2ZW50LCAncmVtb3ZlJylcIlxuICAgICAgICAgIChwYXVzZWQpPVwic2V0Q3VycmVudFVzZXIoJGV2ZW50LCAncGF1c2UnKVwiXG4gICAgICAgICAgKHJlc3VtZWQpPVwidXBkYXRlVXNlclN0YXR1cygkZXZlbnQpXCJcbiAgICAgICAgICAoY3JlYXRlQXV0aG9yaXplZFVzZXIpPVwiZ29Ub0F1dGhvcml6ZWRVc2VyKClcIlxuICAgICAgICA+PC9iYi1hdXRob3JpemVkLXVzZXJzLWxpc3Q+XG4gICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICA8L25nLWNvbnRhaW5lcj5cbiAgPC9uZy1jb250YWluZXI+XG48L25nLWNvbnRhaW5lcj5cblxuPG5nLXRlbXBsYXRlICNlbXB0eVN0YXRlPlxuICA8YmItYXV0aG9yaXplZC11c2Vycy1lbXB0eS1saXN0XG4gICAgW2ltYWdlVXJsXT1cImltYWdlRW1wdHlTdGF0ZVVybCB8IGFzeW5jXCJcbiAgICAoY3JlYXRlQXV0aG9yaXplZFVzZXIpPVwiZ29Ub0F1dGhvcml6ZWRVc2VyKClcIlxuICA+PC9iYi1hdXRob3JpemVkLXVzZXJzLWVtcHR5LWxpc3Q+XG48L25nLXRlbXBsYXRlPlxuXG48bmctdGVtcGxhdGUgI2xvYWRpbmdTdGF0ZT5cbiAgPGRpdiBjbGFzcz1cImNhcmRcIj5cbiAgICA8YmItbG9hZGluZy1pbmRpY2F0b3ItdWkgXG4gICAgICBsb2FkZXJTaXplPVwibGdcIiBcbiAgICAgIHRleHQ9XCJMb2FkaW5nLi4uXCJcbiAgICAgIGkxOG4tdGV4dD1cIkxvYWRpbmd8VGV4dCBmb3IgdGhlIGxvYWRpbmcgaW5kaWNhdG9yQEBhdXRob3JpemVkLnVzZXJzLmxvYWRpbmcuaW5kaWNhdG9yLnRleHRcIlxuICAgID48L2JiLWxvYWRpbmctaW5kaWNhdG9yLXVpPlxuICA8L2Rpdj5cbjwvbmctdGVtcGxhdGU+XG5cbjxuZy10ZW1wbGF0ZSAjZXJyb3JTdGF0ZT5cbiAgPGRpdiBjbGFzcz1cImNhcmRcIj5cbiAgICA8ZGl2IGNsYXNzPVwiY2FyZC1ib2R5IGJiLXN0YXRlLWNvbnRhaW5lclwiPlxuICAgICAgPGJiLWVtcHR5LXN0YXRlLXVpXG4gICAgICAgIGljb25Nb2RpZmllcj1cImVycm9yLW91dGxpbmVcIlxuICAgICAgICBpY29uQ29sb3I9XCJkYXJrXCJcbiAgICAgICAgdGl0bGU9XCJTb21ldGhpbmcgV2VudCBXcm9uZ1wiXG4gICAgICAgIGkxOG4tdGl0bGU9XCJFcnJvciBzdGF0ZSB0aXRsZUBAYXV0aG9yaXplZC51c2Vycy5lcnJvclN0YXRlLnRpdGxlXCJcbiAgICAgICAgc3VidGl0bGU9XCJUcnkgdG8gcmVsb2FkIHRoZSBwYWdlIG9yIGNvbnRhY3QgdGhlIHN5c3RlbSBhZG1pbmlzdHJhdG9yLlwiXG4gICAgICAgIGkxOG4tc3VidGl0bGU9XCJFcnJvciBzdGF0ZSBtZXNzYWdlQEBhdXRob3JpemVkLnVzZXJzLmVycm9yU3RhdGUubWVzc2FnZVwiXG4gICAgICA+PC9iYi1lbXB0eS1zdGF0ZS11aT5cbiAgICAgIDxkaXYgY2xhc3M9XCJiYi1zdGF0ZS1jb250YWluZXJfX2Zvb3RlclwiPlxuICAgICAgICA8YnV0dG9uIFxuICAgICAgICAgIGJiQnV0dG9uIFxuICAgICAgICAgIGNvbG9yPVwicHJpbWFyeVwiIFxuICAgICAgICAgIGkxOG49XCJSZWxvYWQgYnV0dG9uIHRleHRAQGF1dGhvcml6ZWQtdXNlcnMuZXJyb3JTdGF0ZS5yZWxvYWQuYnV0dG9uXCJcbiAgICAgICAgPlxuICAgICAgICAgIFJlbG9hZFxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICA8L2Rpdj5cbjwvbmctdGVtcGxhdGU+XG5cbjxiYi1hdXRob3JpemVkLXVzZXItbGlzdC1yZW1vdmUtdXNlci1jb25maXJtYXRpb24tZGlhbG9nXG4gIFtkaWFsb2dPcGVuXT1cIiEhY3VycmVudFVzZXIgJiYgYWN0aW9uTmFtZSA9PT0gJ3JlbW92ZSdcIlxuICAoY29uZmlybSk9XCJyZW1vdmVVc2VyKGN1cnJlbnRVc2VyKVwiXG4gIChjbG9zZWQpPVwic2V0Q3VycmVudFVzZXIoKVwiXG4+PC9iYi1hdXRob3JpemVkLXVzZXItbGlzdC1yZW1vdmUtdXNlci1jb25maXJtYXRpb24tZGlhbG9nPlxuXG48YmItYXV0aG9yaXplZC11c2VyLWxpc3QtY29uZmlybWF0aW9uLXBhdXNlLXVzZXItZGlhbG9nXG4gIFtkaWFsb2dPcGVuXT1cIiEhY3VycmVudFVzZXIgJiYgYWN0aW9uTmFtZSA9PT0gJ3BhdXNlJ1wiXG4gIChjb25maXJtKT1cInVwZGF0ZVVzZXJTdGF0dXMoY3VycmVudFVzZXIpXCJcbiAgKGNsb3NlZCk9XCJzZXRDdXJyZW50VXNlcigpXCJcbj48L2JiLWF1dGhvcml6ZWQtdXNlci1saXN0LWNvbmZpcm1hdGlvbi1wYXVzZS11c2VyLWRpYWxvZz5cbiJdfQ==