{"version":3,"file":"loan-info.component.js","sourceRoot":"","sources":["../../../../../../libs/loans-collection-ui-ang/src/lib/loan-info/loan-info.component.ts","../../../../../../libs/loans-collection-ui-ang/src/lib/loan-info/loan-info.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,uBAAuB,EAAE,SAAS,EAAE,KAAK,EAAmB,MAAM,eAAe,CAAC;AAW3F,OAAO,EAAE,uBAAuB,EAAE,MAAM,oCAAoC,CAAC;;;;;;;AAO7E,MAAM,OAAO,iBACX,SAAQ,uBAAoD;IAN9D;;QASE;;WAEG;QACM,yBAAoB,GAAG,KAAK,CAAC;QACtC;;WAEG;QACH,aAAQ,GAA6B,EAAE,CAAC;KA2DzC;IAzDC,WAAW;QACT,IAAI,CAAC,cAAc,EAAE,CAAC;IACxB,CAAC;IAED;;;;OAIG;IACH,gBAAgB,CAAC,IAAwB;QACvC,OAAO,IAA2B,CAAC;IACrC,CAAC;IAED;;;;OAIG;IACH,mBAAmB,CAAC,IAAwB;QAC1C,OAAQ,IAAiC,CAAC,YAAY,CAAC;IACzD,CAAC;IAED;;;;;OAKG;IACH,YAAY,CAA8B,MAAc,EAAE,EAAE,KAAK,EAAK;QACpE,OAAO,KAAK,CAAC;IACf,CAAC;IAED;;;;;;;;;OASG;IACK,cAAc;QACpB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAA2B,CAAC,KAAK,EAAE,OAAO,EAAE,EAAE;YAClF,MAAM,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAC1C,IAAI,CAAC,QAAQ;gBACX,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC;gBAC1C,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAE,IAA4B,CAAC,QAAQ,CAAC,CAAC,CAC/D,CAAC;YAEF,IAAI,KAAK,CAAC,MAAM,EAAE;gBAChB,KAAK,CAAC,IAAI,iCAAM,OAAO,KAAE,KAAK,IAAG,CAAC;aACnC;YAED,OAAO,KAAK,CAAC;QACf,CAAC,EAAE,EAAE,CAAC,CAAC;IACT,CAAC;;kIArEU,iBAAiB;sHAAjB,iBAAiB,0JClB9B,ylDA+CA;4FD7Ba,iBAAiB;kBAL7B,SAAS;mBAAC;oBACT,QAAQ,EAAE,cAAc;oBACxB,WAAW,EAAE,4BAA4B;oBACzC,eAAe,EAAE,uBAAuB,CAAC,MAAM;iBAChD;8BAQU,oBAAoB;sBAA5B,KAAK","sourcesContent":["import { ChangeDetectionStrategy, Component, Input, OnChanges, Type } from '@angular/core';\n\nimport {\n  LoanInfoDataConfig,\n  LoanInfoDataItem,\n  LoanInfoItem,\n  LoanInfoItemCustom,\n  LoanInfoTitleBase,\n  LoanItemCustomBase,\n} from './loan-info.model';\nimport { Loan } from '../models/loan.model';\nimport { LoanConfigBaseComponent } from '../base/loan-config-base.component';\n\n@Component({\n  selector: 'bb-loan-info',\n  templateUrl: './loan-info.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class LoanInfoComponent<T extends Loan, U extends LoanItemCustomBase<T>>\n  extends LoanConfigBaseComponent<T, LoanInfoDataConfig<T, U>>\n  implements OnChanges\n{\n  /**\n   * Whether currency local should be transformed to symbol\n   */\n  @Input() isCurrencySymbolUsed = false;\n  /**\n   * Filtered info sections\n   */\n  sections: LoanInfoDataConfig<T, U> = [];\n\n  ngOnChanges(): void {\n    this.filterSections();\n  }\n\n  /**\n   * Typed reference to info item\n   *\n   * @param item\n   */\n  getTypedDataItem(item: LoanInfoItem<T, U>): LoanInfoDataItem<T> {\n    return item as LoanInfoDataItem<T>;\n  }\n\n  /**\n   * Typed reference to custom item component ref\n   *\n   * @param item\n   */\n  getItemComponentRef(item: LoanInfoItem<T, U>): Type<U> {\n    return (item as LoanInfoItemCustom<T, U>).componentRef;\n  }\n\n  /**\n   * Track by method used by *ngFor directive\n   *\n   * @param _index\n   * @param title\n   */\n  trackByTitle<Y extends LoanInfoTitleBase>(_index: number, { title }: Y): string {\n    return title;\n  }\n\n  /**\n   * Filter sections by the items.\n   * There are two options:\n   * - check for the `showItem` function execution\n   * - check the property value by `fieldKey`\n   *\n   * In case if all items in the section do not fit the condition, the sections will be omitted\n   *\n   * @private\n   */\n  private filterSections(): void {\n    this.sections = this.dataConfig.reduce<LoanInfoDataConfig<T, U>>((accum, section) => {\n      const items = section.items.filter((item) =>\n        item.showItem\n          ? item.showItem.call(undefined, this.loan)\n          : Boolean(this.loan[(item as LoanInfoDataItem<T>).fieldKey]),\n      );\n\n      if (items.length) {\n        accum.push({ ...section, items });\n      }\n\n      return accum;\n    }, []);\n  }\n}\n","<div class=\"bb-loans-loan-info\">\n  <bb-loan-info-print-button class=\"bb-loans-loan-info__print-btn\"></bb-loan-info-print-button>\n\n  <div class=\"bb-list\">\n    <section\n      *ngFor=\"let section of sections; trackBy: trackByTitle\"\n      class=\"bb-list__item\"\n      data-role=\"loan-info-section\"\n    >\n      <bb-header-ui\n        [heading]=\"section.title\"\n        headingType=\"h3\"\n        headingClasses=\"bb-block bb-block--lg\"\n        data-role=\"loan-info-section__header\"\n      ></bb-header-ui>\n\n      <div class=\"row bb-loans-loan-info__section\">\n        <div\n          *ngFor=\"let item of section.items\"\n          [ngClass]=\"item.cssClasses\"\n          class=\"bb-block bb-block--lg\"\n          data-role=\"loan-info-section__item-wrapper\"\n        >\n          <ng-container *ngIf=\"getTypedDataItem(item).fieldKey; else customItemRef\">\n            <bb-loan-info-item\n              data-role=\"loan-info-section__data-item\"\n              *ngIf=\"getTypedDataItem(item) as dataItem\"\n              [value]=\"loan[dataItem.fieldKey]\"\n              [title]=\"dataItem.title\"\n              [type]=\"dataItem.fieldType\"\n              [currencyCode]=\"loan.currencyCode\"\n            >\n            </bb-loan-info-item>\n          </ng-container>\n\n          <ng-template #customItemRef>\n            <ng-container\n              bbLoanInfoCustomSection\n              [componentRef]=\"getItemComponentRef(item)\"\n              [loan]=\"loan\"\n            ></ng-container>\n          </ng-template>\n        </div>\n      </div>\n    </section>\n  </div>\n</div>\n"]}