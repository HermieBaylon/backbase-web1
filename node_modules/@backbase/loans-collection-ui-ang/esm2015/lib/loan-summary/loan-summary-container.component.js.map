{"version":3,"file":"loan-summary-container.component.js","sourceRoot":"","sources":["../../../../../../libs/loans-collection-ui-ang/src/lib/loan-summary/loan-summary-container.component.ts","../../../../../../libs/loans-collection-ui-ang/src/lib/loan-summary/loan-summary-container.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,uBAAuB,EAAE,SAAS,EAAE,YAAY,EAAE,KAAK,EAAa,MAAM,EAAE,MAAM,eAAe,CAAC;AAE3G,OAAO,EACL,kBAAkB,EAClB,iBAAiB,EAGjB,eAAe,GAChB,MAAM,gCAAgC,CAAC;AACxC,OAAO,EAAE,uBAAuB,EAAE,MAAM,oCAAoC,CAAC;AAC7E,OAAO,EAAE,YAAY,EAAE,aAAa,EAAE,MAAM,oBAAoB,CAAC;AAEjE,OAAO,EAAE,oBAAoB,EAAE,MAAM,oCAAoC,CAAC;AAC1E,OAAO,EAAE,iBAAiB,EAAE,MAAM,kCAAkC,CAAC;;;;;;;;;;;;;;;AASrE,MAAM,OAAO,6BACX,SAAQ,uBAAoD;IA4E5D,YAA6B,iBAAoC;QAC/D,KAAK,EAAE,CAAC;QADmB,sBAAiB,GAAjB,iBAAiB,CAAmB;QAxEjE;;;;WAIG;QACM,sBAAiB,GAAG,IAAI,CAAC;QAClC;;;;WAIG;QACM,yBAAoB,GAAG,IAAI,CAAC;QACrC;;;;WAIG;QACM,wBAAmB,GAAG,IAAI,CAAC;QAWpC;;WAEG;QACO,eAAU,GAAG,IAAI,YAAY,EAAQ,CAAC;QAChD;;WAEG;QACO,YAAO,GAAG,IAAI,YAAY,EAAQ,CAAC;QAE7C;;WAEG;QACO,gBAAW,GAAG,IAAI,YAAY,EAAU,CAAC;QACnD;;WAEG;QACO,sBAAiB,GAAG,IAAI,YAAY,EAAQ,CAAC;QAOvD;;WAEG;QACM,uBAAkB,GAAwB,IAAI,CAAC,iBAAiB,CAAC,wBAAwB,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;IAoBtH,CAAC;IAxDD;;OAEG;IACH,IAAa,cAAc,CAAC,KAA2B;QACrD,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;IAC/B,CAAC;IAED,IAAI,cAAc;QAChB,OAAO,IAAI,CAAC,eAAe,CAAC;IAC9B,CAAC;IAkBD;;OAEG;IACH,IAAI,oBAAoB;QACtB,OAAO,IAAI,CAAC,eAAe,KAAK,oBAAoB,CAAC,IAAI,CAAC;IAC5D,CAAC;IAyBD;;OAEG;IACH,WAAW;QACT,IAAI,CAAC,iBAAiB,GAAG,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAClD,IAAI,CAAC,SAAS,GAAG,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACzC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;QACrC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAChE,CAAC;IAED;;;;OAIG;IACH,gBAAgB,CAAC,OAAgC;QAC/C,QAAQ,OAAO,EAAE;YACf,KAAK,WAAW;gBACd,IAAI,CAAC,eAAe,GAAG,oBAAoB,CAAC,OAAO,CAAC;gBACpD,MAAM;YACR,KAAK,SAAS;gBACZ,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;gBACpB,MAAM;YACR,KAAK,YAAY;gBACf,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;SAC1B;IACH,CAAC;IAEO,YAAY;QAClB,MAAM,SAAS,GAA4C,EAAE,CAAC;QAE9D,IAAI,IAAI,CAAC,iBAAiB,EAAE;YAC1B,SAAS,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;SACjC;QAED,IAAI,IAAI,CAAC,oBAAoB,EAAE;YAC7B,SAAS,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;SACpC;QAED,IAAI,IAAI,CAAC,mBAAmB,EAAE;YAC5B,SAAS,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;SACnC;QAED,OAAO,SAAS,CAAC;IACnB,CAAC;;8IA5HU,6BAA6B;kIAA7B,6BAA6B,4ZCtB1C,g+HA0GA;4FDpFa,6BAA6B;kBALzC,SAAS;mBAAC;oBACT,QAAQ,EAAE,2BAA2B;oBACrC,WAAW,EAAE,yCAAyC;oBACtD,eAAe,EAAE,uBAAuB,CAAC,MAAM;iBAChD;wGAWU,iBAAiB;sBAAzB,KAAK;gBAMG,oBAAoB;sBAA5B,KAAK;gBAMG,mBAAmB;sBAA3B,KAAK;gBAIO,cAAc;sBAA1B,KAAK;gBAUI,UAAU;sBAAnB,MAAM;gBAIG,OAAO;sBAAhB,MAAM;gBAKG,WAAW;sBAApB,MAAM;gBAIG,iBAAiB;sBAA1B,MAAM","sourcesContent":["import { ChangeDetectionStrategy, Component, EventEmitter, Input, OnChanges, Output } from '@angular/core';\n\nimport {\n  drawAmountMenuItem,\n  editAliasMenuItem,\n  LoanSummaryDataConfig,\n  LoanSummaryMenuItemKeys,\n  payDownMenuItem,\n} from './loan-summary-container.model';\nimport { LoanConfigBaseComponent } from '../base/loan-config-base.component';\nimport { getLoanAlias, isLoanOverdue } from '../utils/loan.util';\nimport { Loan } from '../models/loan.model';\nimport { InputInlineEditState } from '@backbase/ui-ang/input-inline-edit';\nimport { MediaQueryService } from '@backbase/ui-ang/media-query-lib';\nimport { LoanMenuItem } from '../loan-list-item/loan-item-menu/loan-item-menu.model';\nimport { Observable } from 'rxjs';\n\n@Component({\n  selector: 'bb-loan-summary-container',\n  templateUrl: './loan-summary-container.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class LoanSummaryContainerComponent<T extends Loan = Loan>\n  extends LoanConfigBaseComponent<T, LoanSummaryDataConfig<T>>\n  implements OnChanges\n{\n  private _aliasEditState!: InputInlineEditState;\n  /**\n   * Indicator to show/hide `payDown` button\n   *\n   * @default true\n   */\n  @Input() showPayDownButton = true;\n  /**\n   * Indicator to show/hide `payDown` button\n   *\n   * @default true\n   */\n  @Input() showDrawAmountButton = true;\n  /**\n   * Indicator to show/hide `edit alias` button\n   *\n   * @default true\n   */\n  @Input() showEditAliasButton = true;\n  /**\n   * Represents alias update state\n   */\n  @Input() set aliasEditState(value: InputInlineEditState) {\n    this._aliasEditState = value;\n  }\n\n  get aliasEditState(): InputInlineEditState {\n    return this._aliasEditState;\n  }\n  /**\n   * Draw amount event emitter\n   */\n  @Output() drawAmount = new EventEmitter<void>();\n  /**\n   * Pay down event emitter\n   */\n  @Output() payDown = new EventEmitter<void>();\n\n  /**\n   * Emits on accepting new alias for save\n   */\n  @Output() updateAlias = new EventEmitter<string>();\n  /**\n   * Emits in canceling current alias update\n   */\n  @Output() cancelAliasUpdate = new EventEmitter<void>();\n  /**\n   * Flag represents IDLE state for alias editing\n   */\n  get isAliasEditIdleState(): boolean {\n    return this._aliasEditState === InputInlineEditState.IDLE;\n  }\n  /**\n   * Flag represents the screen resolution wider that `md` breakpoint\n   */\n  readonly isWiderThanMobile$: Observable<boolean> = this.mediaQueryService.isMediaBreakpointMatches('min-width', 'md');\n  /**\n   * Flag represents visibility of overdue banner\n   */\n  showOverdueBanner!: boolean;\n  /**\n   * Loan alias\n   */\n  loanAlias!: string | undefined;\n  /**\n   * Icon name by loan type\n   */\n  loanIconName!: string;\n  /**\n   * Context menu items\n   */\n  menuItems!: LoanMenuItem<LoanSummaryMenuItemKeys>[];\n\n  constructor(private readonly mediaQueryService: MediaQueryService) {\n    super();\n  }\n  /**\n   * @internal\n   */\n  ngOnChanges(): void {\n    this.showOverdueBanner = isLoanOverdue(this.loan);\n    this.loanAlias = getLoanAlias(this.loan);\n    this.menuItems = this.getMenuItems();\n    this.loanIconName = this.dataConfig.icons[this.loan.viewType];\n  }\n\n  /**\n   * Select an item for the context menu\n   *\n   * @param itemKey\n   */\n  onSelectMenuItem(itemKey: LoanSummaryMenuItemKeys) {\n    switch (itemKey) {\n      case 'editAlias':\n        this._aliasEditState = InputInlineEditState.EDITING;\n        break;\n      case 'payDown':\n        this.payDown.emit();\n        break;\n      case 'drawAmount':\n        this.drawAmount.emit();\n    }\n  }\n\n  private getMenuItems(): LoanMenuItem<LoanSummaryMenuItemKeys>[] {\n    const menuItems: LoanMenuItem<LoanSummaryMenuItemKeys>[] = [];\n\n    if (this.showPayDownButton) {\n      menuItems.push(payDownMenuItem);\n    }\n\n    if (this.showDrawAmountButton) {\n      menuItems.push(drawAmountMenuItem);\n    }\n\n    if (this.showEditAliasButton) {\n      menuItems.push(editAliasMenuItem);\n    }\n\n    return menuItems;\n  }\n}\n","<div class=\"bb-stack\">\n  <bb-icon-ui\n    *ngIf=\"isAliasEditIdleState\"\n    [name]=\"loanIconName\"\n    class=\"bb-stack__item bb-stack__item--align-top bb-d-lg-inline-flex bb-d-none\"\n    data-role=\"loans-summary__loan-icon\"\n    backgroundType=\"square\"\n    color=\"secondary\"\n    size=\"lg\"\n  ></bb-icon-ui>\n  <div class=\"bb-stack__item bb-stack__item--fill\">\n    <div class=\"bb-loans-summary-alias-wrapper\" [class.bb-loans-summary-alias-wrapper--editing]=\"!isAliasEditIdleState\">\n      <bb-loan-summary-edit-alias\n        [alias]=\"loanAlias\"\n        [showEditButton]=\"showEditAliasButton && (isWiderThanMobile$ | async)!\"\n        [(editState)]=\"aliasEditState\"\n        (updateAlias)=\"updateAlias.emit($event)\"\n        (cancelAliasUpdate)=\"cancelAliasUpdate.emit()\"\n        data-role=\"loans-summary__edit-alias\"\n      >\n      </bb-loan-summary-edit-alias>\n    </div>\n    <div *ngIf=\"isAliasEditIdleState\">\n      <bb-loan-item-type [loanType]=\"loan.loanTypeAlias\"></bb-loan-item-type>\n      <bb-loan-item-status [status]=\"loan.loanStatus\"></bb-loan-item-status>\n    </div>\n  </div>\n  <div class=\"bb-stack__item bb-stack__item--no-shrink bb-stack__item--align-top\">\n    <ng-container *ngIf=\"isWiderThanMobile$ | async; else contextMenuRef\">\n      <button\n        *ngIf=\"showPayDownButton\"\n        (click)=\"payDown.emit()\"\n        class=\"bb-stack__item bb-inline-stack bb-inline-stack--density-sm\"\n        color=\"primary\"\n        bbButton\n        data-role=\"loans-summary__pay-down-btn\"\n      >\n        <bb-icon-ui name=\"call-received\" class=\"bb-inline-stack__item\"></bb-icon-ui>\n        <span\n          class=\"bb-inline-stack__item\"\n          i18n=\"Loan summary pay down button text@@loans.loan-summary.button.pay-down.text\"\n        >\n          Pay Down\n        </span>\n      </button>\n      <button\n        *ngIf=\"showDrawAmountButton\"\n        (click)=\"drawAmount.emit()\"\n        class=\"bb-stack__item bb-inline-stack bb-inline-stack--density-sm\"\n        color=\"secondary\"\n        bbButton\n        data-role=\"loans-summary__draw-amount-btn\"\n      >\n        <bb-icon-ui name=\"savings-accounts\" class=\"bb-inline-stack__item\"></bb-icon-ui>\n        <span\n          class=\"bb-inline-stack__item\"\n          i18n=\"Loan summary draw amount button text@@loans.loan-summary.button.draw-amount.text\"\n        >\n          Draw Amount\n        </span>\n      </button>\n    </ng-container>\n\n    <ng-template #contextMenuRef>\n      <bb-loan-item-menu\n        data-role=\"loans-summary__menu-items\"\n        *ngIf=\"menuItems.length > 0 && isAliasEditIdleState\"\n        [items]=\"menuItems\"\n        (itemSelect)=\"onSelectMenuItem($event)\"\n      ></bb-loan-item-menu>\n    </ng-template>\n  </div>\n</div>\n\n<hr class=\"bb-block bb-block--md\" />\n\n<div class=\"bb-block bb-block--xl\">\n  <bb-loan-item-payment-info [loan]=\"loan\" [dataConfig]=\"dataConfig.paymentInfo\" class=\"bb-subtitle\">\n  </bb-loan-item-payment-info>\n</div>\n\n<bb-loan-summary-overdue-banner\n  *ngIf=\"showOverdueBanner\"\n  [showPayNowButton]=\"false\"\n  [overdueAmount]=\"loan.inArrearsAmount\"\n  [overdueDate]=\"loan.inArrearsDate\"\n  [currencyCode]=\"loan.currencyCode\"\n  (payNow)=\"payDown.emit()\"\n></bb-loan-summary-overdue-banner>\n\n<div class=\"bb-block bb-block--xl\">\n  <bb-loan-summary-progress-bar [loan]=\"loan\" [dataConfig]=\"dataConfig.progressBar\">\n    <div class=\"bb-block bb-block--md bb-text-align-right--sm-up bb-text-align-left\">\n      <bb-loan-summary-amount-item\n        [amount]=\"loan.interestRate\"\n        [showPercent]=\"true\"\n        title=\"Interest rate\"\n        i18n-title=\"Loan summary interest rate title@@loans.loan-summary.interest-rate.title\"\n        titleClasses=\"bb-text-support\"\n      >\n      </bb-loan-summary-amount-item>\n    </div>\n  </bb-loan-summary-progress-bar>\n</div>\n\n<bb-loan-summary-formula [loan]=\"loan\" [dataConfig]=\"dataConfig.formula\"></bb-loan-summary-formula>\n"]}