{"version":3,"file":"retail-loan-summary-progress-bar.component.js","sourceRoot":"","sources":["../../../../../../../libs/loans-collection-ui-ang/src/lib/loan-summary/retail-loan-summary-progress-bar/retail-loan-summary-progress-bar.component.ts","../../../../../../../libs/loans-collection-ui-ang/src/lib/loan-summary/retail-loan-summary-progress-bar/retail-loan-summary-progress-bar.component.html"],"names":[],"mappings":"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","sourcesContent":["import { ChangeDetectionStrategy, Component, Input, OnChanges } from '@angular/core';\n\nimport BigNumber from 'bignumber.js';\n\nimport { ProgressbarType } from '@backbase/ui-ang/progressbar';\nimport { PresentationLoan } from '@backbase/data-ang/loans';\n\nimport { RetailLoanProgressBarDataConfig } from './retail-loan-summary-progress-bar.model';\nimport { LoanConfigBaseComponent } from '../../base/loan-config-base.component';\n\n@Component({\n  selector: 'bb-retail-loan-summary-progress-bar',\n  templateUrl: './retail-loan-summary-progress-bar.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class RetailLoanSummaryProgressBarComponent<T extends PresentationLoan = PresentationLoan>\n  extends LoanConfigBaseComponent<T, RetailLoanProgressBarDataConfig<T>>\n  implements OnChanges\n{\n  /**\n   * Active amount value\n   */\n  activeAmount: string | undefined;\n  /**\n   * Active amount value\n   */\n  availableAmount: string | undefined;\n  /**\n   * Total amount value\n   */\n  totalAmount: string | undefined; // creditLimit\n  /**\n   * Whether all conditions for displaying the activeAmount are met\n   */\n  showActiveAmount = false;\n  /**\n   * Whether all conditions for displaying the availableAmount are met\n   */\n  showAvailableAmount = false;\n  /**\n   * Whether all conditions for displaying the totalAmount are met\n   */\n  showTotalAmount = false;\n  /**\n   * Percentage value for progress bar\n   */\n  progressPercentage = NaN;\n  /**\n   * Progress type for progress bar\n   */\n  progressType: ProgressbarType = 'primary';\n  /**\n   * Flag represents progress bar visibility\n   */\n  isProgressBarVisible = false;\n\n  @Input() owedAmountFocus: boolean | undefined;\n\n  ngOnChanges() {\n    this.updateProperties();\n  }\n\n  private getProgressPercentage(activeAmount: BigNumber, totalAmount: BigNumber): number {\n    return totalAmount.isLessThanOrEqualTo(0) || activeAmount.isLessThan(0)\n      ? NaN\n      : Math.floor(activeAmount.div(totalAmount).toNumber() * 100);\n  }\n\n  private updateProperties(): void {\n    this.activeAmount = this.loan[this.dataConfig.activeAmount.fieldKey] as unknown as string;\n    this.availableAmount = this.loan[this.dataConfig.availableAmount.fieldKey] as unknown as string;\n    this.totalAmount = this.loan[this.dataConfig.totalAmount.fieldKey] as unknown as string;\n    let showProgressBar: boolean;\n\n    if (this.dataConfig.showData) {\n      this.showActiveAmount = this.dataConfig.showData(this.loan);\n      this.showAvailableAmount = this.dataConfig.showData(this.loan);\n      this.showTotalAmount = this.dataConfig.showData(this.loan);\n      showProgressBar = this.dataConfig.showData(this.loan);\n    } else {\n      this.showActiveAmount = this.dataConfig.showActiveAmount ? this.dataConfig.showActiveAmount(this.loan) : false;\n      this.showAvailableAmount = this.dataConfig.showAvailableAmount\n        ? this.dataConfig.showAvailableAmount(this.loan)\n        : false;\n      this.showTotalAmount = this.dataConfig.showTotalAmount ? this.dataConfig.showTotalAmount(this.loan) : false;\n      showProgressBar = this.dataConfig.showProgressBar ? this.dataConfig.showProgressBar(this.loan) : true;\n    }\n\n    const activeAmount = this.activeAmount && new BigNumber(this.activeAmount);\n    const totalAmount = this.totalAmount && new BigNumber(this.totalAmount);\n\n    if (activeAmount && totalAmount) {\n      this.progressPercentage = this.getProgressPercentage(activeAmount, totalAmount);\n    }\n\n    this.isProgressBarVisible = !isNaN(this.progressPercentage) && showProgressBar;\n  }\n}\n","<div class=\"bb-loans-summary-progress\">\n  <div class=\"row no-gutters bb-block bb-block--sm\">\n    <div class=\"col-12 col-sm-9\">\n      <div class=\"row no-gutters\" *ngIf=\"loan.currencyCode as currencyCode\">\n        <div *ngIf=\"activeAmount && showActiveAmount\" class=\"col-12 col-md-6 bb-block bb-block--md\">\n          <div\n            [ngClass]=\"{\n              'bb-loans-summary-progress__legend-item': isProgressBarVisible,\n              'bb-loans-summary-progress__legend-item--success': isProgressBarVisible && progressType === 'success',\n              'bb-loans-summary-progress__legend-item--active': isProgressBarVisible && progressType === 'primary'\n            }\"\n            data-role=\"loan-summary-progress__active-wrapper\"\n          >\n            <bb-loan-summary-amount-item\n              [amount]=\"activeAmount\"\n              [currency]=\"currencyCode\"\n              [title]=\"dataConfig.activeAmount.title\"\n              [showLabel]=\"showTotalAmount\"\n              [totalAmount]=\"totalAmount\"\n              [isCurrencySymbolUsed]=\"true\"\n              titleClasses=\"bb-text-support\"\n              data-role=\"loan-summary-progress__active\"\n            >\n            </bb-loan-summary-amount-item>\n          </div>\n        </div>\n        <div *ngIf=\"availableAmount && showAvailableAmount\" class=\"col-12 col-md-6 bb-block bb-block--md\">\n          <div\n            [class.bb-loans-summary-progress__legend-item]=\"isProgressBarVisible\"\n            data-role=\"loan-summary-progress__total-wrapper\"\n          >\n            <bb-loan-summary-amount-item\n              [amount]=\"availableAmount\"\n              [currency]=\"currencyCode\"\n              [title]=\"dataConfig.availableAmount.title\"\n              [isCurrencySymbolUsed]=\"true\"\n              titleClasses=\"bb-text-support\"\n              data-role=\"loan-summary-progress__total\"\n            >\n            </bb-loan-summary-amount-item>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"col-12 col-sm-3\">\n      <ng-content></ng-content>\n    </div>\n  </div>\n  <div *ngIf=\"isProgressBarVisible && loan.currencyCode\" class=\"row no-gutters bb-block bb-block--md\">\n    <div class=\"col-12\">\n      <bb-progressbar-ui\n        class=\"bb-loans-summary-progress__progressbar\"\n        [animated]=\"true\"\n        [max]=\"100\"\n        [value]=\"progressPercentage\"\n        [type]=\"progressType\"\n        data-role=\"loan-summary-progress__progressbar\"\n      >\n      </bb-progressbar-ui>\n    </div>\n  </div>\n</div>\n"]}