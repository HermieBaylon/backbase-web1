{"version":3,"file":"retail-loan-summary-container.component.js","sourceRoot":"","sources":["../../../../../../../libs/loans-collection-ui-ang/src/lib/loan-summary/retail-loan-summary-container/retail-loan-summary-container.component.ts","../../../../../../../libs/loans-collection-ui-ang/src/lib/loan-summary/retail-loan-summary-container/retail-loan-summary-container.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,uBAAuB,EAAE,SAAS,EAAE,YAAY,EAAE,KAAK,EAAa,MAAM,EAAE,MAAM,eAAe,CAAC;AAE3G,OAAO,EACL,kBAAkB,EAElB,eAAe,GAEhB,MAAM,iCAAiC,CAAC;AACzC,OAAO,EAAE,uBAAuB,EAAE,MAAM,uCAAuC,CAAC;AAChF,OAAO,EAAE,YAAY,EAAE,aAAa,EAAE,MAAM,uBAAuB,CAAC;AAEpE,OAAO,EAAE,iBAAiB,EAAE,MAAM,kCAAkC,CAAC;;;;;;;;;;;;;;AASrE,MAAM,OAAO,mCACX,SAAQ,uBAA0D;IAuElE,YAA6B,iBAAoC;QAC/D,KAAK,EAAE,CAAC;QADmB,sBAAiB,GAAjB,iBAAiB,CAAmB;QApEjE;;;;WAIG;QACM,sBAAiB,GAAG,IAAI,CAAC;QAClC;;;;WAIG;QACM,yBAAoB,GAAG,IAAI,CAAC;QACrC;;;;WAIG;QACM,gBAAW,GAAG,IAAI,CAAC;QAC5B;;;;WAIG;QACM,0BAAqB,GAAG,KAAK,CAAC;QAOvC;;WAEG;QACO,eAAU,GAAG,IAAI,YAAY,EAAQ,CAAC;QAChD;;WAEG;QACO,YAAO,GAAG,IAAI,YAAY,EAAQ,CAAC;QAE7C;;WAEG;QACO,gBAAW,GAAG,IAAI,YAAY,EAAU,CAAC;QACnD;;WAEG;QACO,sBAAiB,GAAG,IAAI,YAAY,EAAQ,CAAC;QACvD;;WAEG;QACM,uBAAkB,GAAwB,IAAI,CAAC,iBAAiB,CAAC,wBAAwB,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;IAoBtH,CAAC;IACD;;OAEG;IACH,WAAW;QACT,IAAI,CAAC,iBAAiB,GAAG,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAClD,IAAI,CAAC,SAAS,GAAG,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACzC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;QACrC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAChE,CAAC;IAED;;;;OAIG;IACH,gBAAgB,CAAC,OAAgC;QAC/C,QAAQ,OAAO,EAAE;YACf,KAAK,SAAS;gBACZ,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;gBACpB,MAAM;YACR,KAAK,YAAY;gBACf,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;SAC1B;IACH,CAAC;IAEO,YAAY;QAClB,MAAM,SAAS,GAA4C,EAAE,CAAC;QAE9D,IAAI,IAAI,CAAC,iBAAiB,EAAE;YAC1B,SAAS,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;SACjC;QAED,IAAI,IAAI,CAAC,oBAAoB,EAAE;YAC7B,SAAS,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;SACpC;QAED,OAAO,SAAS,CAAC;IACnB,CAAC;;oJAhHU,mCAAmC;wIAAnC,mCAAmC,qcCpBhD,i/HAkHA;4FD9Fa,mCAAmC;kBAL/C,SAAS;mBAAC;oBACT,QAAQ,EAAE,kCAAkC;oBAC5C,WAAW,EAAE,gDAAgD;oBAC7D,eAAe,EAAE,uBAAuB,CAAC,MAAM;iBAChD;wGAUU,iBAAiB;sBAAzB,KAAK;gBAMG,oBAAoB;sBAA5B,KAAK;gBAMG,WAAW;sBAAnB,KAAK;gBAMG,qBAAqB;sBAA7B,KAAK;gBAMG,eAAe;sBAAvB,KAAK;gBAII,UAAU;sBAAnB,MAAM;gBAIG,OAAO;sBAAhB,MAAM;gBAKG,WAAW;sBAApB,MAAM;gBAIG,iBAAiB;sBAA1B,MAAM","sourcesContent":["import { ChangeDetectionStrategy, Component, EventEmitter, Input, OnChanges, Output } from '@angular/core';\n\nimport {\n  drawAmountMenuItem,\n  LoanSummaryMenuItemKeys,\n  payDownMenuItem,\n  RetailLoanSummaryDataConfig,\n} from '../loan-summary-container.model';\nimport { LoanConfigBaseComponent } from '../../base/loan-config-base.component';\nimport { getLoanAlias, isLoanOverdue } from '../../utils/loan.util';\nimport { Loan } from '../../models/loan.model';\nimport { MediaQueryService } from '@backbase/ui-ang/media-query-lib';\nimport { LoanMenuItem } from '../../loan-list-item/loan-item-menu/loan-item-menu.model';\nimport { Observable } from 'rxjs';\n\n@Component({\n  selector: 'bb-retail-loan-summary-container',\n  templateUrl: './retail-loan-summary-container.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class RetailLoanSummaryContainerComponent<T extends Loan = Loan>\n  extends LoanConfigBaseComponent<T, RetailLoanSummaryDataConfig<T>>\n  implements OnChanges\n{\n  /**\n   * Indicator to show/hide `payDown` button\n   *\n   * @default true\n   */\n  @Input() showPayDownButton = true;\n  /**\n   * Indicator to show/hide `payDown` button\n   *\n   * @default true\n   */\n  @Input() showDrawAmountButton = true;\n  /**\n   * Indicator to show/hide `summary formula`\n   *\n   * @default true\n   */\n  @Input() showFormula = true;\n  /**\n   * Indicator to show `interest rate` over or below the progress bar\n   *\n   * @default false\n   */\n  @Input() showInterestRateOnTop = false;\n  /**\n   * Indicator to change the amount focus or not\n   *\n   * @default false\n   */\n  @Input() owedAmountFocus: boolean | undefined;\n  /**\n   * Draw amount event emitter\n   */\n  @Output() drawAmount = new EventEmitter<void>();\n  /**\n   * Pay down event emitter\n   */\n  @Output() payDown = new EventEmitter<void>();\n\n  /**\n   * Emits on accepting new alias for save\n   */\n  @Output() updateAlias = new EventEmitter<string>();\n  /**\n   * Emits in canceling current alias update\n   */\n  @Output() cancelAliasUpdate = new EventEmitter<void>();\n  /**\n   * Flag represents the screen resolution wider that `md` breakpoint\n   */\n  readonly isWiderThanMobile$: Observable<boolean> = this.mediaQueryService.isMediaBreakpointMatches('min-width', 'md');\n  /**\n   * Flag represents visibility of overdue banner\n   */\n  showOverdueBanner!: boolean;\n  /**\n   * Loan alias\n   */\n  loanAlias!: string | undefined;\n  /**\n   * Icon name by loan type\n   */\n  loanIconName!: string;\n  /**\n   * Context menu items\n   */\n  menuItems!: LoanMenuItem<LoanSummaryMenuItemKeys>[];\n\n  constructor(private readonly mediaQueryService: MediaQueryService) {\n    super();\n  }\n  /**\n   * @internal\n   */\n  ngOnChanges(): void {\n    this.showOverdueBanner = isLoanOverdue(this.loan);\n    this.loanAlias = getLoanAlias(this.loan);\n    this.menuItems = this.getMenuItems();\n    this.loanIconName = this.dataConfig.icons[this.loan.viewType];\n  }\n\n  /**\n   * Select an item for the context menu\n   *\n   * @param itemKey\n   */\n  onSelectMenuItem(itemKey: LoanSummaryMenuItemKeys) {\n    switch (itemKey) {\n      case 'payDown':\n        this.payDown.emit();\n        break;\n      case 'drawAmount':\n        this.drawAmount.emit();\n    }\n  }\n\n  private getMenuItems(): LoanMenuItem<LoanSummaryMenuItemKeys>[] {\n    const menuItems: LoanMenuItem<LoanSummaryMenuItemKeys>[] = [];\n\n    if (this.showPayDownButton) {\n      menuItems.push(payDownMenuItem);\n    }\n\n    if (this.showDrawAmountButton) {\n      menuItems.push(drawAmountMenuItem);\n    }\n\n    return menuItems;\n  }\n}\n","<bb-retail-loan-summary-overdue-banner\n  *ngIf=\"showOverdueBanner\"\n  [overdueAmount]=\"loan.inArrearsAmount\"\n  [overdueDate]=\"loan.inArrearsDate\"\n  [currencyCode]=\"loan.currencyCode\"\n  [overduePaymentsCount]=\"loan.overduePaymentsCount\"\n></bb-retail-loan-summary-overdue-banner>\n<div class=\"bb-block\">\n  <bb-retail-loan-item-payment-info\n    [loan]=\"loan\"\n    [dataConfig]=\"dataConfig.paymentInfo\"\n    class=\"bb-subtitle\"\n  ></bb-retail-loan-item-payment-info>\n</div>\n<div class=\"bb-stack bb-block--lg\">\n  <bb-icon-ui\n    [name]=\"loanIconName\"\n    class=\"bb-stack__item bb-stack__item--align-top bb-d-lg-inline-flex bb-d-none\"\n    data-role=\"loans-summary__loan-icon\"\n    backgroundType=\"square\"\n    color=\"secondary\"\n    size=\"lg\"\n  ></bb-icon-ui>\n  <div class=\"bb-stack__item bb-stack__item--fill\">\n    <bb-loan-item-name\n      [headingLevel]=\"2\"\n      [loanName]=\"loanAlias\"\n      class=\"bb-stack__item bb-stack__item--spacing-sm\"\n    ></bb-loan-item-name>\n    <div>\n      <bb-loan-item-type [loanType]=\"loan.loanTypeAlias\" [useSubtitleClass]=\"true\"></bb-loan-item-type>\n    </div>\n  </div>\n</div>\n\n<div class=\"bb-block bb-block--lg\">\n  <bb-retail-loan-summary-progress-bar\n    [loan]=\"loan\"\n    [dataConfig]=\"dataConfig.progressBar\"\n    [owedAmountFocus]=\"owedAmountFocus\"\n  >\n    <bb-loan-summary-amount-item\n      *ngIf=\"showInterestRateOnTop\"\n      [amount]=\"loan.interestRate\"\n      [showPercent]=\"true\"\n      title=\"Interest rate\"\n      i18n-title=\"Loan summary interest rate title@@loans.loan-summary.interest-rate.title\"\n      titleClasses=\"bb-text-support\"\n    >\n    </bb-loan-summary-amount-item>\n  </bb-retail-loan-summary-progress-bar>\n</div>\n\n<div class=\"bb-block bb-stack justify-content-between\">\n  <div class=\"bb-stack__item bb-stack__item--no-shrink bb-stack__item--align-top\">\n    <ng-container *ngIf=\"isWiderThanMobile$ | async; else contextMenuRef\">\n      <button\n        *ngIf=\"showPayDownButton\"\n        (click)=\"payDown.emit()\"\n        class=\"bb-stack__item bb-inline-stack bb-inline-stack--density-sm\"\n        color=\"primary\"\n        bbButton\n        data-role=\"loans-summary__pay-down-btn\"\n      >\n        <bb-icon-ui name=\"call-received\" class=\"bb-inline-stack__item\"></bb-icon-ui>\n        <span\n          class=\"bb-inline-stack__item\"\n          i18n=\"Loan summary pay down button text@@loans.loan-summary.button.pay-down.text\"\n        >\n          Pay Down\n        </span>\n      </button>\n      <button\n        *ngIf=\"showDrawAmountButton\"\n        (click)=\"drawAmount.emit()\"\n        class=\"bb-stack__item bb-inline-stack bb-inline-stack--density-sm\"\n        color=\"secondary\"\n        bbButton\n        data-role=\"loans-summary__draw-amount-btn\"\n      >\n        <bb-icon-ui name=\"savings-accounts\" class=\"bb-inline-stack__item\"></bb-icon-ui>\n        <span\n          class=\"bb-inline-stack__item\"\n          i18n=\"Loan summary draw amount button text@@loans.loan-summary.button.draw-amount.text\"\n        >\n          Draw Amount\n        </span>\n      </button>\n    </ng-container>\n\n    <ng-template #contextMenuRef>\n      <bb-loan-item-menu\n        data-role=\"loans-summary__menu-items\"\n        *ngIf=\"menuItems.length > 0\"\n        [items]=\"menuItems\"\n        [position]=\"'bottom-left'\"\n        (itemSelect)=\"onSelectMenuItem($event)\"\n      ></bb-loan-item-menu>\n    </ng-template>\n  </div>\n\n  <div *ngIf=\"!showInterestRateOnTop\" class=\"bb-inline-stack bb-text-align-center\">\n    <bb-loan-summary-amount-item\n      [amount]=\"loan.interestRate\"\n      [showPercent]=\"true\"\n      title=\"Interest rate\"\n      i18n-title=\"Loan summary interest rate title@@loans.loan-summary.interest-rate.title\"\n      titleClasses=\"bb-text-support\"\n    >\n    </bb-loan-summary-amount-item>\n  </div>\n</div>\n\n<bb-loan-summary-formula *ngIf=\"showFormula\" [loan]=\"loan\" [dataConfig]=\"dataConfig.formula\"></bb-loan-summary-formula>\n"]}