{"version":3,"file":"loan-summary-progress-bar.component.js","sourceRoot":"","sources":["../../../../../../../libs/loans-collection-ui-ang/src/lib/loan-summary/loan-summary-progress-bar/loan-summary-progress-bar.component.ts","../../../../../../../libs/loans-collection-ui-ang/src/lib/loan-summary/loan-summary-progress-bar/loan-summary-progress-bar.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,uBAAuB,EAAE,SAAS,EAAa,MAAM,eAAe,CAAC;AAE9E,OAAO,SAAS,MAAM,cAAc,CAAC;AAMrC,OAAO,EAAE,uBAAuB,EAAE,MAAM,uCAAuC,CAAC;;;;;AAOhF,MAAM,OAAO,+BACX,SAAQ,uBAAwD;IANlE;;QAiBE;;WAEG;QACH,uBAAkB,GAAG,GAAG,CAAC;QACzB;;WAEG;QACH,iBAAY,GAAoB,SAAS,CAAC;QAC1C;;WAEG;QACH,yBAAoB,GAAG,KAAK,CAAC;KA4B9B;IA1BC,WAAW;QACT,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC1B,CAAC;IAED,4BAA4B;IACpB,gBAAgB;QACtB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,QAAQ,CAAsB,CAAC;QAC1F,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,QAAQ,CAAsB,CAAC;QAExF,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,WAAW,EAAE;YACzC,MAAM,WAAW,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YACpD,MAAM,YAAY,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YAEtD,IAAI,CAAC,kBAAkB;gBACrB,WAAW,CAAC,mBAAmB,CAAC,CAAC,CAAC,IAAI,YAAY,CAAC,UAAU,CAAC,CAAC,CAAC;oBAC9D,CAAC,CAAC,GAAG;oBACL,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,QAAQ,EAAE,GAAG,GAAG,CAAC,CAAC;SAClE;aAAM;YACL,IAAI,CAAC,kBAAkB,GAAG,GAAG,CAAC;SAC/B;QAED,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,kBAAkB,IAAI,GAAG,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC;QAE3E,MAAM,eAAe,GAAG,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QAC5G,IAAI,CAAC,oBAAoB,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,eAAe,CAAC;IACjF,CAAC;;gJAlDU,+BAA+B;oIAA/B,+BAA+B,gHCf5C,62EA0DA;4FD3Ca,+BAA+B;kBAL3C,SAAS;mBAAC;oBACT,QAAQ,EAAE,8BAA8B;oBACxC,WAAW,EAAE,4CAA4C;oBACzD,eAAe,EAAE,uBAAuB,CAAC,MAAM;iBAChD","sourcesContent":["import { ChangeDetectionStrategy, Component, OnChanges } from '@angular/core';\n\nimport BigNumber from 'bignumber.js';\n\nimport { ProgressbarType } from '@backbase/ui-ang/progressbar';\nimport { PresentationLoan } from '@backbase/data-ang/loans';\n\nimport { LoanProgressBarDataConfig } from './loan-summary-progress-bar.model';\nimport { LoanConfigBaseComponent } from '../../base/loan-config-base.component';\n\n@Component({\n  selector: 'bb-loan-summary-progress-bar',\n  templateUrl: './loan-summary-progress-bar.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class LoanSummaryProgressBarComponent<T extends PresentationLoan = PresentationLoan>\n  extends LoanConfigBaseComponent<T, LoanProgressBarDataConfig<T>>\n  implements OnChanges\n{\n  /**\n   * Active amount value\n   */\n  activeAmount: string | undefined;\n  /**\n   * Total amount value\n   */\n  totalAmount: string | undefined;\n  /**\n   * Percentage value for progress bar\n   */\n  progressPercentage = NaN;\n  /**\n   * Progress type for progress bar\n   */\n  progressType: ProgressbarType = 'primary';\n  /**\n   * Flag represents progress bar visibility\n   */\n  isProgressBarVisible = false;\n\n  ngOnChanges() {\n    this.updateProperties();\n  }\n\n  // TODO move to config logic\n  private updateProperties(): void {\n    this.activeAmount = this.loan[this.dataConfig.activeAmount.fieldKey] as unknown as string;\n    this.totalAmount = this.loan[this.dataConfig.totalAmount.fieldKey] as unknown as string;\n\n    if (this.activeAmount && this.totalAmount) {\n      const totalAmount = new BigNumber(this.totalAmount);\n      const activeAmount = new BigNumber(this.activeAmount);\n\n      this.progressPercentage =\n        totalAmount.isLessThanOrEqualTo(0) || activeAmount.isLessThan(0)\n          ? NaN\n          : Math.floor(activeAmount.div(totalAmount).toNumber() * 100);\n    } else {\n      this.progressPercentage = NaN;\n    }\n\n    this.progressType = this.progressPercentage >= 100 ? 'success' : 'primary';\n\n    const showProgressBar = this.dataConfig.showProgressBar ? this.dataConfig.showProgressBar(this.loan) : true;\n    this.isProgressBarVisible = !isNaN(this.progressPercentage) && showProgressBar;\n  }\n}\n","<div class=\"bb-loans-summary-progress\">\n  <div class=\"row no-gutters bb-block bb-block--sm bb-loans-summary-progress__legend-wrapper\">\n    <div class=\"col-12 col-sm-9\">\n      <div class=\"row no-gutters\" *ngIf=\"loan.currencyCode as currencyCode\">\n        <div *ngIf=\"activeAmount\" class=\"col-12 col-md-6 bb-block bb-block--md\">\n          <div\n            [ngClass]=\"{\n              'bb-loans-summary-progress__legend-item': isProgressBarVisible,\n              'bb-loans-summary-progress__legend-item--success': isProgressBarVisible && progressType === 'success',\n              'bb-loans-summary-progress__legend-item--active': isProgressBarVisible && progressType === 'primary'\n            }\"\n            data-role=\"loan-summary-progress__active-wrapper\"\n          >\n            <bb-loan-summary-amount-item\n              [amount]=\"activeAmount\"\n              [currency]=\"currencyCode\"\n              [title]=\"dataConfig.activeAmount.title\"\n              titleClasses=\"bb-text-support\"\n              data-role=\"loan-summary-progress__active\"\n            >\n            </bb-loan-summary-amount-item>\n          </div>\n        </div>\n        <div *ngIf=\"totalAmount\" class=\"col-12 col-md-6 bb-block bb-block--md\">\n          <div\n            [class.bb-loans-summary-progress__legend-item]=\"isProgressBarVisible\"\n            data-role=\"loan-summary-progress__total-wrapper\"\n          >\n            <bb-loan-summary-amount-item\n              [amount]=\"totalAmount\"\n              [currency]=\"currencyCode\"\n              [title]=\"dataConfig.totalAmount.title\"\n              titleClasses=\"bb-text-support\"\n              data-role=\"loan-summary-progress__total\"\n            >\n            </bb-loan-summary-amount-item>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"col-12 col-sm-3\">\n      <ng-content></ng-content>\n    </div>\n  </div>\n  <div *ngIf=\"isProgressBarVisible && loan.currencyCode\" class=\"row no-gutters bb-block bb-block--md\">\n    <div class=\"col-12\">\n      <bb-progressbar-ui\n        class=\"bb-loans-summary-progress__progressbar\"\n        [animated]=\"true\"\n        [max]=\"100\"\n        [value]=\"progressPercentage\"\n        [type]=\"progressType\"\n        data-role=\"loan-summary-progress__progressbar\"\n      >\n      </bb-progressbar-ui>\n    </div>\n  </div>\n</div>\n"]}