{"ast":null,"code":"import * as i0 from '@angular/core';\nimport { InjectionToken, Injectable, Optional, Inject, Component, Input, ViewChild, NgModule } from '@angular/core';\nimport * as i2 from '@angular/common';\nimport { CommonModule } from '@angular/common';\nimport * as i1$1 from '@backbase/foundation-ang/core';\nimport { BackbaseCoreModule } from '@backbase/foundation-ang/core';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport * as i1 from '@backbase/engagement-http-ang';\nimport { filter, tap, delay, takeUntil } from 'rxjs/operators';\nimport { ENGAGEMENT_BASE_PATH } from '@backbase/data-ang/engagement';\nimport { WebSdkApiModule } from '@backbase/foundation-ang/web-sdk';\nimport { HttpClientModule } from '@angular/common/http';\nimport { createMocks } from '@backbase/foundation-ang/data-http';\nconst _c0 = [\"iframeRef\"];\n\nfunction CampaignSpaceComponent_ng_container_0_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 2);\n    i0.ɵɵelement(1, \"a\", 3);\n    i0.ɵɵelementStart(2, \"iframe\", 4, 5);\n    i0.ɵɵlistener(\"load\", function CampaignSpaceComponent_ng_container_0_div_1_Template_iframe_load_2_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext(2);\n      return ctx_r4.iframeLoad();\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngStyle\", ctx_r1.widgetStyles);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"href\", ctx_r1.targetUrl, i0.ɵɵsanitizeUrl)(\"ngStyle\", ctx_r1.widgetStyles)(\"target\", ctx_r1.targetMode);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngStyle\", ctx_r1.widgetStyles);\n  }\n}\n\nfunction CampaignSpaceComponent_ng_container_0_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 2);\n    i0.ɵɵelementStart(1, \"div\", 6);\n    i0.ɵɵelementStart(2, \"span\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngStyle\", ctx_r2.widgetStyles);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngStyle\", ctx_r2.widgetStyles);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.placeholderTitle);\n  }\n}\n\nfunction CampaignSpaceComponent_ng_container_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, CampaignSpaceComponent_ng_container_0_div_1_Template, 4, 5, \"div\", 1);\n    i0.ɵɵtemplate(2, CampaignSpaceComponent_ng_container_0_div_2_Template, 4, 3, \"div\", 1);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.designMode && ctx_r0.campaign);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.designMode);\n  }\n}\n\nconst CampaignSpaceConfigurationToken = new InjectionToken('CampaignSpaceConfiguration injection token');\nconst staticConfig = {\n  portalName: 'backbase-wc3',\n  locale: 'en-US',\n  designMode: false\n};\n\nclass CampaignService {\n  constructor(selectCampaignService, config) {\n    this.selectCampaignService = selectCampaignService;\n    this._config = Object.assign(Object.assign({}, staticConfig), config);\n  }\n\n  get portalName() {\n    return this._config.portalName;\n  }\n\n  get locale() {\n    return this._config.locale;\n  }\n\n  get designMode() {\n    return this._config.designMode;\n  }\n\n  selectCampaign(widgetName, dimensions, pageName) {\n    const spaceId = `${this.portalName}.${pageName}.${widgetName}`;\n    return this.selectCampaignService.selectCampaign({\n      locale: this.locale,\n      dimensions,\n      spaceId\n    });\n  }\n\n  b64Decode(str) {\n    return decodeURIComponent(atob(str).split('').map(function (c) {\n      return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n    }).join(''));\n  }\n\n}\n\nCampaignService.ɵfac = function CampaignService_Factory(t) {\n  return new (t || CampaignService)(i0.ɵɵinject(i1.SelectCampaignService), i0.ɵɵinject(CampaignSpaceConfigurationToken, 8));\n};\n\nCampaignService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: CampaignService,\n  factory: CampaignService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(CampaignService, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: i1.SelectCampaignService\n    }, {\n      type: undefined,\n      decorators: [{\n        type: Optional\n      }, {\n        type: Inject,\n        args: [CampaignSpaceConfigurationToken]\n      }]\n    }];\n  }, null);\n})();\n\nvar TargetUrlMode;\n\n(function (TargetUrlMode) {\n  TargetUrlMode[\"SELF\"] = \"self\";\n  TargetUrlMode[\"BLANK\"] = \"blank\";\n})(TargetUrlMode || (TargetUrlMode = {}));\n\nvar TargetAttribute;\n\n(function (TargetAttribute) {\n  TargetAttribute[\"self\"] = \"_self\";\n  TargetAttribute[\"blank\"] = \"_blank\";\n})(TargetAttribute || (TargetAttribute = {}));\n\nclass CampaignSpaceComponent {\n  constructor(campaignService, renderer, cdr, basePath) {\n    this.campaignService = campaignService;\n    this.renderer = renderer;\n    this.cdr = cdr;\n    this.basePath = basePath;\n    /**\n     * Component name\n     */\n\n    this.name = '';\n    /**\n     * Campaign banner dimensions\n     */\n\n    this.dimensions = '300x250';\n    /**\n     * Page name\n     */\n\n    this.pageName = 'index';\n    /**\n     * Is banner responsive\n     */\n\n    this.responsive = false;\n    /**\n     * Banner title\n     */\n\n    this.title = 'Campaign Space';\n    this.designMode = this.campaignService.designMode;\n    this.placeholderTitle = '';\n    this.iframeContext = new BehaviorSubject(undefined);\n    this.destroy$ = new Subject();\n  }\n\n  ngOnInit() {\n    this.widgetStyles = this.getWidgetStyles();\n\n    if (this.designMode) {\n      this.initDesignMode();\n    } else {\n      this.initLiveMode();\n    }\n  }\n\n  ngOnDestroy() {\n    this.destroy$.next();\n  }\n\n  initDesignMode() {\n    this.placeholderTitle = this.getPlaceholderTitle();\n  }\n\n  initLiveMode() {\n    this.campaignService.selectCampaign(this.name, this.dimensions, this.pageName).subscribe(campaign => {\n      if (campaign) {\n        this.campaign = campaign;\n        this.setTargetUrl();\n        this.content = this.campaignService.b64Decode(campaign.creative.content);\n        this.iframeContext.next(this.content);\n        this.targetMode = TargetAttribute[campaign.targetUrlDisplayMode || 'self'];\n        this.cdr.detectChanges();\n      }\n    });\n  }\n\n  setTargetUrl() {\n    var _a, _b;\n\n    const basePath = this.basePath.endsWith('/') ? this.basePath.slice(0, -1) : this.basePath;\n    const campaignUrl = ((_a = this.campaign) === null || _a === void 0 ? void 0 : _a.targetUrl.startsWith('/')) ? this.campaign.targetUrl.slice(1) : (_b = this.campaign) === null || _b === void 0 ? void 0 : _b.targetUrl;\n    this.targetUrl = `${basePath}/${campaignUrl}`;\n  }\n\n  iframeLoad() {\n    this.cdr.detectChanges();\n    const iframeElement = this.iframeRef.nativeElement;\n    const iframeBody = iframeElement.contentDocument.body;\n    this.renderer.setStyle(iframeElement, 'width', '100%');\n    this.renderer.setStyle(iframeElement, 'border', '0');\n    this.renderer.setStyle(iframeBody, 'margin', '0');\n    this.iframeContext.pipe(filter(Boolean), tap(content => this.renderer.setProperty(iframeBody, 'innerHTML', content)), delay(300), takeUntil(this.destroy$)).subscribe(() => {\n      let currentHeight = iframeBody.scrollHeight;\n      let previousHeight = 0;\n      let counter = 0;\n\n      do {\n        this.renderer.setStyle(iframeElement, 'height', `${currentHeight}px`);\n        previousHeight = currentHeight;\n        currentHeight = iframeBody.scrollHeight;\n        counter++;\n      } while (previousHeight !== currentHeight && counter < 5);\n\n      this.cdr.detectChanges();\n    });\n  }\n\n  getWidgetStyles() {\n    const [width, height] = this.getDimensions(this.dimensions);\n    const properties = {\n      width: this.responsive ? '100%' : this.toPx(width),\n      height: this.toPx(height)\n    };\n\n    if (this.responsive) {\n      properties.maxWidth = this.toPx(width);\n    }\n\n    return properties;\n  }\n\n  getPlaceholderTitle() {\n    const [width, height] = this.getDimensions(this.dimensions);\n    let placeholderTitle = `${this.title} - ${this.dimensions}`;\n\n    if (this.responsive) {\n      placeholderTitle = `${this.title} - Responsive Max-width: ${width}, Height: ${height}`;\n    }\n\n    return placeholderTitle;\n  }\n\n  toPx(value) {\n    return value + 'px';\n  }\n\n  getDimensions(dimensions) {\n    return dimensions.split('x');\n  }\n\n}\n\nCampaignSpaceComponent.ɵfac = function CampaignSpaceComponent_Factory(t) {\n  return new (t || CampaignSpaceComponent)(i0.ɵɵdirectiveInject(CampaignService), i0.ɵɵdirectiveInject(i0.Renderer2), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(ENGAGEMENT_BASE_PATH, 8));\n};\n\nCampaignSpaceComponent.ɵcmp = /* @__PURE__ */i0.ɵɵdefineComponent({\n  type: CampaignSpaceComponent,\n  selectors: [[\"bb-campaign-space-ang\"]],\n  viewQuery: function CampaignSpaceComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.iframeRef = _t.first);\n    }\n  },\n  inputs: {\n    name: \"name\",\n    dimensions: \"dimensions\",\n    pageName: \"pageName\",\n    responsive: \"responsive\",\n    title: \"title\"\n  },\n  features: [i0.ɵɵProvidersFeature([CampaignService])],\n  decls: 1,\n  vars: 1,\n  consts: [[4, \"ngIf\"], [\"class\", \"bb-campaign-space-widget\", 3, \"ngStyle\", 4, \"ngIf\"], [1, \"bb-campaign-space-widget\", 3, \"ngStyle\"], [1, \"bb-campaign-space-widget__overlay\", 3, \"href\", \"ngStyle\", \"target\"], [1, \"bb-campaign-space-widget__iframe\", 3, \"ngStyle\", \"load\"], [\"iframeRef\", \"\"], [1, \"bb-campaign-space-widget__placeholder\", 3, \"ngStyle\"]],\n  template: function CampaignSpaceComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, CampaignSpaceComponent_ng_container_0_Template, 3, 2, \"ng-container\", 0);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.widgetStyles);\n    }\n  },\n  directives: [i2.NgIf, i2.NgStyle],\n  styles: [\"[_nghost-%COMP%]{position:relative}.bb-campaign-space-widget[_ngcontent-%COMP%]{position:relative;left:50%;transform:translate(-50%)}.bb-campaign-space-widget__overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;z-index:1}.bb-campaign-space-widget__iframe[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;z-index:0}.bb-campaign-space-widget__placeholder[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:relative;background-color:#0000001a;border:1px solid #bfbfbf;text-align:center}\"]\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(CampaignSpaceComponent, [{\n    type: Component,\n    args: [{\n      selector: 'bb-campaign-space-ang',\n      templateUrl: './campaign-space.component.html',\n      styleUrls: ['./campaign-space.component.css'],\n      providers: [CampaignService]\n    }]\n  }], function () {\n    return [{\n      type: CampaignService\n    }, {\n      type: i0.Renderer2\n    }, {\n      type: i0.ChangeDetectorRef\n    }, {\n      type: undefined,\n      decorators: [{\n        type: Optional\n      }, {\n        type: Inject,\n        args: [ENGAGEMENT_BASE_PATH]\n      }]\n    }];\n  }, {\n    name: [{\n      type: Input\n    }],\n    dimensions: [{\n      type: Input\n    }],\n    pageName: [{\n      type: Input\n    }],\n    responsive: [{\n      type: Input\n    }],\n    title: [{\n      type: Input\n    }],\n    iframeRef: [{\n      type: ViewChild,\n      args: ['iframeRef', {\n        static: false\n      }]\n    }]\n  });\n})();\n\nclass CampaignSpaceModule {}\n\nCampaignSpaceModule.ɵfac = function CampaignSpaceModule_Factory(t) {\n  return new (t || CampaignSpaceModule)();\n};\n\nCampaignSpaceModule.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n  type: CampaignSpaceModule\n});\nCampaignSpaceModule.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({\n  imports: [[CommonModule, WebSdkApiModule, HttpClientModule, BackbaseCoreModule.withConfig({\n    classMap: {\n      CampaignSpaceComponent: CampaignSpaceComponent\n    }\n  })]]\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(CampaignSpaceModule, [{\n    type: NgModule,\n    args: [{\n      imports: [CommonModule, WebSdkApiModule, HttpClientModule, BackbaseCoreModule.withConfig({\n        classMap: {\n          CampaignSpaceComponent: CampaignSpaceComponent\n        }\n      })],\n      exports: [CampaignSpaceComponent],\n      declarations: [CampaignSpaceComponent]\n    }]\n  }], null, null);\n})();\n\nconst mockCampaign = {\n  targetUrl: '../../../../',\n  targetUrlDisplayMode: TargetUrlMode.BLANK,\n  creative: {\n    uuid: '34793c5e-bc0b-454b-b97a-994159d01904',\n    dimensions: '300x250',\n    entryAsset: './index.html',\n    basePath: '../../assets/creatives/' // ../../ to avoid the prepended gateway/api (apiRoot)\n\n  }\n};\n/**\n * Patterns to setup mock provider.\n */\n\nconst examples = [{\n  urlPattern: 'gateway/api/engagement/client-api/v1/engagements/banner',\n  method: 'GET',\n  responses: [{\n    status: 200,\n    body: mockCampaign,\n    type: 'json'\n  }]\n}];\n/**\n * Mocks provider for set campaign space widget.\n */\n\nconst CampaignSpaceHttpMocksProvider = createMocks(examples);\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { CampaignService, CampaignSpaceComponent, CampaignSpaceConfigurationToken, CampaignSpaceHttpMocksProvider, CampaignSpaceModule };","map":{"version":3,"sources":["C:/Users/hbaylon/Documents/West Monroe/Projects/Backbase2/web/retail-usa-web/node_modules/@backbase/campaign-space-ang/fesm2015/backbase-campaign-space-ang.js"],"names":["i0","InjectionToken","Injectable","Optional","Inject","Component","Input","ViewChild","NgModule","i2","CommonModule","i1$1","BackbaseCoreModule","BehaviorSubject","Subject","i1","filter","tap","delay","takeUntil","ENGAGEMENT_BASE_PATH","WebSdkApiModule","HttpClientModule","createMocks","CampaignSpaceConfigurationToken","staticConfig","portalName","locale","designMode","CampaignService","constructor","selectCampaignService","config","_config","Object","assign","selectCampaign","widgetName","dimensions","pageName","spaceId","b64Decode","str","decodeURIComponent","atob","split","map","c","charCodeAt","toString","slice","join","ɵfac","SelectCampaignService","ɵprov","type","undefined","decorators","args","TargetUrlMode","TargetAttribute","CampaignSpaceComponent","campaignService","renderer","cdr","basePath","name","responsive","title","placeholderTitle","iframeContext","destroy$","ngOnInit","widgetStyles","getWidgetStyles","initDesignMode","initLiveMode","ngOnDestroy","next","getPlaceholderTitle","subscribe","campaign","setTargetUrl","content","creative","targetMode","targetUrlDisplayMode","detectChanges","_a","_b","endsWith","campaignUrl","targetUrl","startsWith","iframeLoad","iframeElement","iframeRef","nativeElement","iframeBody","contentDocument","body","setStyle","pipe","Boolean","setProperty","currentHeight","scrollHeight","previousHeight","counter","width","height","getDimensions","properties","toPx","maxWidth","value","Renderer2","ChangeDetectorRef","ɵcmp","NgIf","NgStyle","selector","templateUrl","styleUrls","providers","static","CampaignSpaceModule","ɵmod","ɵinj","withConfig","classMap","imports","exports","declarations","mockCampaign","BLANK","uuid","entryAsset","examples","urlPattern","method","responses","status","CampaignSpaceHttpMocksProvider"],"mappings":"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","sourcesContent":["import * as i0 from '@angular/core';\nimport { InjectionToken, Injectable, Optional, Inject, Component, Input, ViewChild, NgModule } from '@angular/core';\nimport * as i2 from '@angular/common';\nimport { CommonModule } from '@angular/common';\nimport * as i1$1 from '@backbase/foundation-ang/core';\nimport { BackbaseCoreModule } from '@backbase/foundation-ang/core';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport * as i1 from '@backbase/engagement-http-ang';\nimport { filter, tap, delay, takeUntil } from 'rxjs/operators';\nimport { ENGAGEMENT_BASE_PATH } from '@backbase/data-ang/engagement';\nimport { WebSdkApiModule } from '@backbase/foundation-ang/web-sdk';\nimport { HttpClientModule } from '@angular/common/http';\nimport { createMocks } from '@backbase/foundation-ang/data-http';\n\nconst CampaignSpaceConfigurationToken = new InjectionToken('CampaignSpaceConfiguration injection token');\nconst staticConfig = {\n    portalName: 'backbase-wc3',\n    locale: 'en-US',\n    designMode: false,\n};\nclass CampaignService {\n    constructor(selectCampaignService, config) {\n        this.selectCampaignService = selectCampaignService;\n        this._config = Object.assign(Object.assign({}, staticConfig), config);\n    }\n    get portalName() {\n        return this._config.portalName;\n    }\n    get locale() {\n        return this._config.locale;\n    }\n    get designMode() {\n        return this._config.designMode;\n    }\n    selectCampaign(widgetName, dimensions, pageName) {\n        const spaceId = `${this.portalName}.${pageName}.${widgetName}`;\n        return this.selectCampaignService.selectCampaign({ locale: this.locale, dimensions, spaceId });\n    }\n    b64Decode(str) {\n        return decodeURIComponent(atob(str)\n            .split('')\n            .map(function (c) {\n            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n        })\n            .join(''));\n    }\n}\nCampaignService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.2.16\", ngImport: i0, type: CampaignService, deps: [{ token: i1.SelectCampaignService }, { token: CampaignSpaceConfigurationToken, optional: true }], target: i0.ɵɵFactoryTarget.Injectable });\nCampaignService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"12.2.16\", ngImport: i0, type: CampaignService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.2.16\", ngImport: i0, type: CampaignService, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: i1.SelectCampaignService }, { type: undefined, decorators: [{\n                    type: Optional\n                }, {\n                    type: Inject,\n                    args: [CampaignSpaceConfigurationToken]\n                }] }]; } });\n\nvar TargetUrlMode;\n(function (TargetUrlMode) {\n    TargetUrlMode[\"SELF\"] = \"self\";\n    TargetUrlMode[\"BLANK\"] = \"blank\";\n})(TargetUrlMode || (TargetUrlMode = {}));\nvar TargetAttribute;\n(function (TargetAttribute) {\n    TargetAttribute[\"self\"] = \"_self\";\n    TargetAttribute[\"blank\"] = \"_blank\";\n})(TargetAttribute || (TargetAttribute = {}));\n\nclass CampaignSpaceComponent {\n    constructor(campaignService, renderer, cdr, basePath) {\n        this.campaignService = campaignService;\n        this.renderer = renderer;\n        this.cdr = cdr;\n        this.basePath = basePath;\n        /**\n         * Component name\n         */\n        this.name = '';\n        /**\n         * Campaign banner dimensions\n         */\n        this.dimensions = '300x250';\n        /**\n         * Page name\n         */\n        this.pageName = 'index';\n        /**\n         * Is banner responsive\n         */\n        this.responsive = false;\n        /**\n         * Banner title\n         */\n        this.title = 'Campaign Space';\n        this.designMode = this.campaignService.designMode;\n        this.placeholderTitle = '';\n        this.iframeContext = new BehaviorSubject(undefined);\n        this.destroy$ = new Subject();\n    }\n    ngOnInit() {\n        this.widgetStyles = this.getWidgetStyles();\n        if (this.designMode) {\n            this.initDesignMode();\n        }\n        else {\n            this.initLiveMode();\n        }\n    }\n    ngOnDestroy() {\n        this.destroy$.next();\n    }\n    initDesignMode() {\n        this.placeholderTitle = this.getPlaceholderTitle();\n    }\n    initLiveMode() {\n        this.campaignService.selectCampaign(this.name, this.dimensions, this.pageName).subscribe(campaign => {\n            if (campaign) {\n                this.campaign = campaign;\n                this.setTargetUrl();\n                this.content = this.campaignService.b64Decode(campaign.creative.content);\n                this.iframeContext.next(this.content);\n                this.targetMode = TargetAttribute[campaign.targetUrlDisplayMode || 'self'];\n                this.cdr.detectChanges();\n            }\n        });\n    }\n    setTargetUrl() {\n        var _a, _b;\n        const basePath = this.basePath.endsWith('/') ? this.basePath.slice(0, -1) : this.basePath;\n        const campaignUrl = ((_a = this.campaign) === null || _a === void 0 ? void 0 : _a.targetUrl.startsWith('/'))\n            ? this.campaign.targetUrl.slice(1)\n            : (_b = this.campaign) === null || _b === void 0 ? void 0 : _b.targetUrl;\n        this.targetUrl = `${basePath}/${campaignUrl}`;\n    }\n    iframeLoad() {\n        this.cdr.detectChanges();\n        const iframeElement = this.iframeRef.nativeElement;\n        const iframeBody = iframeElement.contentDocument.body;\n        this.renderer.setStyle(iframeElement, 'width', '100%');\n        this.renderer.setStyle(iframeElement, 'border', '0');\n        this.renderer.setStyle(iframeBody, 'margin', '0');\n        this.iframeContext\n            .pipe(filter(Boolean), tap(content => this.renderer.setProperty(iframeBody, 'innerHTML', content)), delay(300), takeUntil(this.destroy$))\n            .subscribe(() => {\n            let currentHeight = iframeBody.scrollHeight;\n            let previousHeight = 0;\n            let counter = 0;\n            do {\n                this.renderer.setStyle(iframeElement, 'height', `${currentHeight}px`);\n                previousHeight = currentHeight;\n                currentHeight = iframeBody.scrollHeight;\n                counter++;\n            } while (previousHeight !== currentHeight && counter < 5);\n            this.cdr.detectChanges();\n        });\n    }\n    getWidgetStyles() {\n        const [width, height] = this.getDimensions(this.dimensions);\n        const properties = {\n            width: this.responsive ? '100%' : this.toPx(width),\n            height: this.toPx(height),\n        };\n        if (this.responsive) {\n            properties.maxWidth = this.toPx(width);\n        }\n        return properties;\n    }\n    getPlaceholderTitle() {\n        const [width, height] = this.getDimensions(this.dimensions);\n        let placeholderTitle = `${this.title} - ${this.dimensions}`;\n        if (this.responsive) {\n            placeholderTitle = `${this.title} - Responsive Max-width: ${width}, Height: ${height}`;\n        }\n        return placeholderTitle;\n    }\n    toPx(value) {\n        return value + 'px';\n    }\n    getDimensions(dimensions) {\n        return dimensions.split('x');\n    }\n}\nCampaignSpaceComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.2.16\", ngImport: i0, type: CampaignSpaceComponent, deps: [{ token: CampaignService }, { token: i0.Renderer2 }, { token: i0.ChangeDetectorRef }, { token: ENGAGEMENT_BASE_PATH, optional: true }], target: i0.ɵɵFactoryTarget.Component });\nCampaignSpaceComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: \"12.0.0\", version: \"12.2.16\", type: CampaignSpaceComponent, selector: \"bb-campaign-space-ang\", inputs: { name: \"name\", dimensions: \"dimensions\", pageName: \"pageName\", responsive: \"responsive\", title: \"title\" }, providers: [CampaignService], viewQueries: [{ propertyName: \"iframeRef\", first: true, predicate: [\"iframeRef\"], descendants: true }], ngImport: i0, template: \"<ng-container *ngIf=\\\"widgetStyles\\\">\\n  <div *ngIf=\\\"!designMode && campaign\\\" class=\\\"bb-campaign-space-widget\\\" [ngStyle]=\\\"widgetStyles\\\">\\n    <a [href]=\\\"targetUrl\\\" [ngStyle]=\\\"widgetStyles\\\" [target]=\\\"targetMode\\\" class=\\\"bb-campaign-space-widget__overlay\\\"> </a>\\n    <iframe #iframeRef class=\\\"bb-campaign-space-widget__iframe\\\" [ngStyle]=\\\"widgetStyles\\\" (load)=\\\"iframeLoad()\\\">\\n    </iframe>\\n  </div>\\n  <div *ngIf=\\\"designMode\\\" [ngStyle]=\\\"widgetStyles\\\" class=\\\"bb-campaign-space-widget\\\">\\n    <div [ngStyle]=\\\"widgetStyles\\\" class=\\\"bb-campaign-space-widget__placeholder\\\">\\n      <span>{{ placeholderTitle }}</span>\\n    </div>\\n  </div>\\n</ng-container>\\n\", styles: [\":host{position:relative}.bb-campaign-space-widget{position:relative;left:50%;transform:translate(-50%)}.bb-campaign-space-widget__overlay{position:absolute;top:0;left:0;right:0;bottom:0;z-index:1}.bb-campaign-space-widget__iframe{position:absolute;top:0;left:0;right:0;bottom:0;z-index:0}.bb-campaign-space-widget__placeholder{display:flex;justify-content:center;align-items:center;position:relative;background-color:#0000001a;border:1px solid #bfbfbf;text-align:center}\\n\"], directives: [{ type: i2.NgIf, selector: \"[ngIf]\", inputs: [\"ngIf\", \"ngIfThen\", \"ngIfElse\"] }, { type: i2.NgStyle, selector: \"[ngStyle]\", inputs: [\"ngStyle\"] }] });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.2.16\", ngImport: i0, type: CampaignSpaceComponent, decorators: [{\n            type: Component,\n            args: [{\n                    selector: 'bb-campaign-space-ang',\n                    templateUrl: './campaign-space.component.html',\n                    styleUrls: ['./campaign-space.component.css'],\n                    providers: [CampaignService],\n                }]\n        }], ctorParameters: function () { return [{ type: CampaignService }, { type: i0.Renderer2 }, { type: i0.ChangeDetectorRef }, { type: undefined, decorators: [{\n                    type: Optional\n                }, {\n                    type: Inject,\n                    args: [ENGAGEMENT_BASE_PATH]\n                }] }]; }, propDecorators: { name: [{\n                type: Input\n            }], dimensions: [{\n                type: Input\n            }], pageName: [{\n                type: Input\n            }], responsive: [{\n                type: Input\n            }], title: [{\n                type: Input\n            }], iframeRef: [{\n                type: ViewChild,\n                args: ['iframeRef', { static: false }]\n            }] } });\n\nclass CampaignSpaceModule {\n}\nCampaignSpaceModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.2.16\", ngImport: i0, type: CampaignSpaceModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });\nCampaignSpaceModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"12.0.0\", version: \"12.2.16\", ngImport: i0, type: CampaignSpaceModule, declarations: [CampaignSpaceComponent], imports: [CommonModule,\n        WebSdkApiModule,\n        HttpClientModule, i1$1.BackbaseCoreModule], exports: [CampaignSpaceComponent] });\nCampaignSpaceModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"12.2.16\", ngImport: i0, type: CampaignSpaceModule, imports: [[\n            CommonModule,\n            WebSdkApiModule,\n            HttpClientModule,\n            BackbaseCoreModule.withConfig({\n                classMap: { CampaignSpaceComponent: CampaignSpaceComponent },\n            }),\n        ]] });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.2.16\", ngImport: i0, type: CampaignSpaceModule, decorators: [{\n            type: NgModule,\n            args: [{\n                    imports: [\n                        CommonModule,\n                        WebSdkApiModule,\n                        HttpClientModule,\n                        BackbaseCoreModule.withConfig({\n                            classMap: { CampaignSpaceComponent: CampaignSpaceComponent },\n                        }),\n                    ],\n                    exports: [CampaignSpaceComponent],\n                    declarations: [CampaignSpaceComponent],\n                }]\n        }] });\n\nconst mockCampaign = {\n    targetUrl: '../../../../',\n    targetUrlDisplayMode: TargetUrlMode.BLANK,\n    creative: {\n        uuid: '34793c5e-bc0b-454b-b97a-994159d01904',\n        dimensions: '300x250',\n        entryAsset: './index.html',\n        basePath: '../../assets/creatives/', // ../../ to avoid the prepended gateway/api (apiRoot)\n    },\n};\n/**\n * Patterns to setup mock provider.\n */\nconst examples = [\n    {\n        urlPattern: 'gateway/api/engagement/client-api/v1/engagements/banner',\n        method: 'GET',\n        responses: [\n            {\n                status: 200,\n                body: mockCampaign,\n                type: 'json',\n            },\n        ],\n    },\n];\n/**\n * Mocks provider for set campaign space widget.\n */\nconst CampaignSpaceHttpMocksProvider = createMocks(examples);\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { CampaignService, CampaignSpaceComponent, CampaignSpaceConfigurationToken, CampaignSpaceHttpMocksProvider, CampaignSpaceModule };\n"]},"metadata":{},"sourceType":"module"}